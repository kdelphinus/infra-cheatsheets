{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":[" "],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\ud83d\ude80 Infra Cheatsheets","text":"<p>DevOps \uc2e4\ubb34\ub97c \uc704\ud55c \uac1c\uc778 \uc9c0\uc2dd \uc800\uc7a5\uc18c (Knowledge Base) &gt; \uc78a\uc5b4\ubc84\ub9ac\uae30 \uc26c\uc6b4 \uba85\ub839\uc5b4, \uc124\uce58 \uc808\ucc28, \ud2b8\ub7ec\ube14\uc288\ud305 \uac00\uc774\ub4dc\ub97c \ubaa8\uc544\ub450\uc5c8\uc2b5\ub2c8\ub2e4.</p>"},{"location":"#topics","title":"\ud83d\udcda Topics","text":"<p>\ucd94\ud6c4 \ucc44\uc6cc\uc9c8 \uc608\uc815\uc785\ub2c8\ub2e4.</p>"},{"location":"#quick-links","title":"\ud83d\udd25 Quick Links","text":"<p>\ucd94\ud6c4 \ucc44\uc6cc\uc9c8 \uc608\uc815\uc785\ub2c8\ub2e4.</p>"},{"location":"#tip","title":"Tip","text":"<p>\uc0c1\ub2e8 \uac80\uc0c9\ucc3d(Search)\uc744 \uc774\uc6a9\ud558\uba74 \uba85\ub839\uc5b4 \ub2e8\uc704\ub85c \uac80\uc0c9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. <code>Ctrl + K</code> (\ub610\ub294 <code>Cmd + K</code>)\ub97c \ub20c\ub7ec\ubcf4\uc138\uc694!</p>"},{"location":"k8s/token-check/","title":"K8s Admin \ud1a0\ud070 \ub9cc\ub8cc \ud655\uc778","text":"<p>\uc778\uc99d\uc11c \ub9cc\ub8cc\uc77c\uc744 \ud655\uc778\ud558\ub294 \uba85\ub839\uc5b4\uc785\ub2c8\ub2e4.</p> <pre><code>kubeadm certs check-expiration\n</code></pre> <p>!! warning \"\uc8fc\uc758\uc0ac\ud56d\" \uc778\uc99d\uc11c\ub294 1\ub144\ub9c8\ub2e4 \uac31\uc2e0\ud574\uc57c \ud569\ub2c8\ub2e4!</p>"},{"location":"openstack/2024.2-Dalmatian/install/","title":"\ud83c\udfdb\ufe0f \ud1b5\ud569 OpenStack \uc124\uce58 \uac00\uc774\ub4dc (Ver. 2024.2)","text":"<p>\uc774 \uac00\uc774\ub4dc\ub294 Kolla-Ansible\uc744 \uc0ac\uc6a9\ud558\uc5ec OpenStack 2024.2 \ubc84\uc804\uc744 \uc124\uce58\ud558\ub294 \ud45c\uc900 \uc808\ucc28\uc785\ub2c8\ub2e4. \uc544\ub798\uc758 \ubcc0\uc218 \uc815\uc758\ub97c \uba3c\uc800 \ud655\uc778\ud558\uace0 \ubcf8\uc778\uc758 \ud658\uacbd\uc5d0 \ub9de\ucdb0 \ub300\uc785\ud558\uc5ec \uc9c4\ud589\ud574 \uc8fc\uc138\uc694.</p>"},{"location":"openstack/2024.2-Dalmatian/install/#_1","title":"\ud83d\udcdd \ubcc0\uc218 \uc815\uc758 (\uce58\ud658 \ud544\uc694)","text":"<ul> <li><code>&lt;USER_ID&gt;</code> : \uc11c\ubc84 \uc811\uc18d \uacc4\uc815 (\uc608: strato)</li> <li><code>&lt;PASSWORD&gt;</code> : \uc811\uc18d \ube44\ubc00\ubc88\ud638 (\uc608: strt0103!)</li> <li><code>&lt;MASTER_IP&gt;</code> : \ub9c8\uc2a4\ud130(Control) \ub178\ub4dc IP (\uc608: 10.10.10.60)</li> <li><code>&lt;TARGET_NODE_IP&gt;</code> : \ubc30\ud3ec \ub300\uc0c1(Compute) \ub178\ub4dc IP</li> </ul>"},{"location":"openstack/2024.2-Dalmatian/install/#1","title":"1\ub2e8\uacc4: \uae30\ubcf8 \uc2dc\uc2a4\ud15c \uc124\uc815 (\uacf5\ud1b5)","text":"<p>\ud55c\uad6d \ud45c\uc900\uc2dc(KST) \uc124\uc815\uc740 \ubaa8\ub4e0 \ub178\ub4dc(Master, Compute \ub4f1)\uc5d0\uc11c \uc218\ud589\ud569\ub2c8\ub2e4.</p> <pre><code># \ud55c\uad6d \uc2dc\uac04\uc73c\ub85c \ubcc0\uacbd\nsudo timedatectl set-timezone Asia/Seoul\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#2-os","title":"2\ub2e8\uacc4: \ud328\ud0a4\uc9c0 \uc5c5\ub370\uc774\ud2b8 \ubc0f \uc758\uc874\uc131 \uc124\uce58 (OS\ubcc4 \uc120\ud0dd)","text":"<p>\uc0ac\uc6a9 \uc911\uc778 OS\uc5d0 \ub9de\ub294 \uba85\ub839\uc5b4\ub97c \uc120\ud0dd\ud558\uc5ec \uc2e4\ud589\ud558\uc138\uc694. Ubuntu \ud658\uacbd\ub3c4 2024.2 \ubc84\uc804\uc5d0 \ub9de\uac8c \uc758\uc874\uc131\uc744 \uad6c\uc131\ud588\uc2b5\ub2c8\ub2e4.</p>"},{"location":"openstack/2024.2-Dalmatian/install/#ubuntu-2204","title":"\ud83c\udd70\ufe0f Ubuntu 22.04 \uc0ac\uc6a9\uc790","text":"<pre><code># 1. \ud328\ud0a4\uc9c0 \ucd5c\uc2e0 \uc5c5\ub370\uc774\ud2b8 \ubc0f \ud544\uc218 \ub3c4\uad6c \uc124\uce58\nsudo apt update\nsudo apt install net-tools -y\n\n# 2. \uac1c\ubc1c \ub3c4\uad6c \ubc0f \ub77c\uc774\ube0c\ub7ec\ub9ac \uc124\uce58\n# OpenStack 2024.2 \uad6c\ub3d9\uc744 \uc704\ud55c \ud544\uc218 \ub77c\uc774\ube0c\ub7ec\ub9ac \ud3ec\ud568\nsudo apt install git python3-dev libffi-dev gcc libssl-dev -y\n\n# 3. \ud30c\uc774\uc36c \uac00\uc0c1\ud658\uacbd \uad00\ub9ac\ub3c4\uad6c \uc124\uce58\nsudo apt install python3-venv -y\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#rocky-linux","title":"\ud83c\udd71\ufe0f Rocky Linux \uc0ac\uc6a9\uc790","text":"<pre><code># 1. \ud328\ud0a4\uc9c0 \ucd5c\uc2e0 \uc5c5\ub370\uc774\ud2b8 \ubc0f \ud544\uc218 \ub3c4\uad6c \uc124\uce58\nsudo dnf update -y\nsudo dnf install net-tools -y\n\n# 2. \uac1c\ubc1c \ub3c4\uad6c \ubc0f \ub77c\uc774\ube0c\ub7ec\ub9ac \uc124\uce58 (Python 3.11 \uc0ac\uc6a9)\nsudo dnf install git python3.11 python3.11-devel libffi-devel gcc openssl-devel python3-libselinux net-tools -y\n\n# 3. \ud30c\uc774\uc36c \uac00\uc0c1\ud658\uacbd \uad00\ub9ac\ub3c4\uad6c \uc124\uce58 (pip)\nsudo dnf install python3-pip -y\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#3-venv-ansible","title":"3\ub2e8\uacc4: \uac00\uc0c1\ud658\uacbd(Venv) \uad6c\uc131 \ubc0f Ansible \uc124\uce58 (\ud1b5\ud569)","text":"<p>OpenStack 2024.2 \ubc84\uc804\uc744 \uc704\ud55c \uac00\uc0c1\ud658\uacbd\uc744 \uad6c\uc131\ud558\uace0, \ud638\ud658\ub418\ub294 Ansible Core \ubc84\uc804\uc744 \uc124\uce58\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/2024.2-Dalmatian/install/#1_1","title":"1. \uac00\uc0c1\ud658\uacbd \uc0dd\uc131 \ubc0f \ud65c\uc131\ud654","text":"<p>Ubuntu:</p> <pre><code>python3 -m venv $HOME/venv\nsource $HOME/venv/bin/activate\n</code></pre> <p>Rocky Linux:</p> <pre><code>python3.11 -m venv $HOME/venv\nsource $HOME/venv/bin/activate\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#2-pip-ansible-kolla-ansible","title":"2. Pip, Ansible, Kolla-Ansible \uc124\uce58 (\uacf5\ud1b5)","text":"<p>\uac00\uc0c1\ud658\uacbd\uc774 \ud65c\uc131\ud654\ub41c \uc0c1\ud0dc(<code>(venv)</code> \ud45c\uc2dc \ud655\uc778)\uc5d0\uc11c \uc9c4\ud589\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># 1. pip \ud328\ud0a4\uc9c0\ub97c \ucd5c\uc2e0\ubc84\uc804\uc73c\ub85c \uc5c5\uadf8\ub808\uc774\ub4dc\npip install -U pip\n\n# 2. ansible-core \uc124\uce58 (2024.2 \ubc84\uc804 \ud638\ud658\uc131 \uace0\ub824)\n# 2.16 \uc774\uc0c1 2.17 \ubbf8\ub9cc \ubc84\uc804 \uad8c\uc7a5\npip install 'ansible-core&gt;=2.16,&lt;2.17'\n\n# 3. kolla-ansible \ub2e4\uc6b4\ub85c\ub4dc (2024.2 Stable \ubc84\uc804)\npip install git+https://opendev.org/openstack/kolla-ansible@stable/2024.2\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#4","title":"4\ub2e8\uacc4: \uc124\uc815 \ud30c\uc77c \uad6c\uc131 (\uacf5\ud1b5)","text":"<p>Kolla-Ansible \uad6c\ub3d9\uc5d0 \ud544\uc694\ud55c \uc124\uc815 \ud30c\uc77c\ub4e4\uc744 \ubcf5\uc0ac\ud558\uace0 \ub514\ub809\ud1a0\ub9ac \uad8c\ud55c\uc744 \uc218\uc815\ud569\ub2c8\ub2e4.</p> <pre><code># 1. /etc/kolla \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131 \ubc0f \uc18c\uc720\uc790 \ubcc0\uacbd\nsudo mkdir -p /etc/kolla\nsudo chown $USER:$USER /etc/kolla\n\n# 2. \uae30\ubcf8 \uc124\uc815 \ud30c\uc77c(globals.yml, password.yaml) \ubcf5\uc0ac\ncp -r $HOME/venv/share/kolla-ansible/etc_examples/kolla/* /etc/kolla\n\n# 3. \uc778\ubca4\ud1a0\ub9ac \ud30c\uc77c(all-in-one, multinode) \ubcf5\uc0ac\ncp $HOME/venv/share/kolla-ansible/ansible/inventory/* .\n\n# 4. Kolla-Ansible \ud504\ub85c\uc81d\ud2b8 \uc758\uc874\uc131(Galaxy Role \ub4f1) \uc124\uce58\nkolla-ansible install-deps\n\n# 5. \ud328\uc2a4\uc6cc\ub4dc \ud30c\uc77c \uc0dd\uc131\nkolla-genpwd\n\n# 6. Ansible \uc124\uc815 \uc800\uc7a5 \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131\nsudo mkdir -p /etc/ansible\nsudo chown $USER:$USER /etc/ansible\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#5-master","title":"5\ub2e8\uacc4: \uba40\ud2f0\ub178\ub4dc \ud1b5\uc2e0 \uc124\uc815 (Master \ub178\ub4dc \uc804\uc6a9)","text":"<p>Master \ub178\ub4dc\uc5d0\uc11c Compute \ub178\ub4dc \ub4f1\uc73c\ub85c \ube44\ubc00\ubc88\ud638 \uc5c6\uc774 SSH \uc811\uc18d\uc774 \uac00\ub2a5\ud558\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4.</p> <pre><code># 1. SSH \uacf5\uac1c \ud0a4\ub97c \ubc30\ud3ec \ub300\uc0c1 \uc11c\ubc84\uc5d0 \ubcf5\uc0ac (\uac01 \ub178\ub4dc IP\ubcc4\ub85c \ubc18\ubcf5 \uc218\ud589)\nssh-copy-id -i ~/.ssh/id_rsa.pub &lt;USER_ID&gt;@&lt;TARGET_NODE_IP&gt;\n\n# 2. \uc811\uc18d \ud14c\uc2a4\ud2b8 (\uc554\ud638 \uc5c6\uc774 \ub85c\uadf8\uc778 \ub418\uba74 \uc131\uacf5)\nssh &lt;USER_ID&gt;@&lt;TARGET_NODE_IP&gt;\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#_2","title":"\uc778\ubca4\ud1a0\ub9ac \ud30c\uc77c \uc218\uc815","text":"<p><code>multinode</code> \ud30c\uc77c\uc744 \uc5f4\uc5b4 \ubc30\ud3ec \ub300\uc0c1 \uc11c\ubc84 \uc815\ubcf4\ub97c \uc785\ub825\ud569\ub2c8\ub2e4.</p> <pre><code># 3. \uc778\ubca4\ud1a0\ub9ac \uc218\uc815\nsudo vi multinode\n</code></pre> <p>\ud30c\uc77c \ub0b4\uc6a9 \uc218\uc815 \uc608\uc2dc:</p> <pre><code>[control]\n&lt;MASTER_IP&gt;\n\n[network]\n&lt;MASTER_IP&gt;\n\n[compute]\n# Compute \ub178\ub4dc IP\uc640 \uacc4\uc815 \uc815\ubcf4\ub97c \uae30\uc785\n&lt;TARGET_NODE_IP&gt; ansible_user=&lt;USER_ID&gt; ansible_become=true\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#_3","title":"\ud1b5\uc2e0 \ud655\uc778","text":"<pre><code># 4. Ansible Ping \ud14c\uc2a4\ud2b8\nansible -i multinode all -m ping\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#6-openstack-master","title":"6\ub2e8\uacc4: OpenStack \ubc30\ud3ec (Master \ub178\ub4dc \uc804\uc6a9)","text":"<p>\uc124\uc815\uc774 \uc644\ub8cc\ub418\uba74 \uc2e4\uc81c \ubc30\ud3ec\ub97c \uc9c4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \uc11c\ubc84 \ubd80\ud2b8\uc2a4\ud2b8\ub7a9 (Docker \uc124\uce58 \ubc0f \uae30\ubcf8 \uc124\uc815)\nkolla-ansible bootstrap-servers -i ./multinode\n\n# 2. \uc0ac\uc804 \uc810\uac80 (Prechecks)\nkolla-ansible prechecks -i ./multinode\n\n# 3. \ubc30\ud3ec (Deploy)\nkolla-ansible deploy -i ./multinode\n\n# (\ucc38\uace0) \uc124\uc815 \ubcc0\uacbd \uc2dc \uc7ac\ubc30\ud3ec (Reconfigure)\n# kolla-ansible reconfigure -i ./multinode\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/install/#devops","title":"\ud83d\udca1 DevOps \uc5d4\uc9c0\ub2c8\uc5b4\uc758 \ud301","text":"<ul> <li>IP \uc124\uc815 \uc8fc\uc758: <code>globals.yml</code> \ud30c\uc77c \uc218\uc815 \uc2dc <code>network_interface</code>\uc640 <code>neutron_external_interface</code>\uac00 \uc2e4\uc81c \uc11c\ubc84\uc758 \uc778\ud130\ud398\uc774\uc2a4 \uba85(\uc608: <code>eth0</code>, <code>ens3</code> \ub4f1)\uacfc \uc77c\uce58\ud558\ub294\uc9c0 \ubc18\ub4dc\uc2dc \ud655\uc778\ud574\uc57c \ud569\ub2c8\ub2e4.</li> <li>\uac00\uc0c1\ud658\uacbd \ud544\uc218: \ubaa8\ub4e0 <code>kolla-ansible</code> \ubc0f <code>ansible</code> \uba85\ub839\uc5b4\ub294 <code>source $HOME/venv/bin/activate</code> \uba85\ub839\uc5b4\ub85c \uac00\uc0c1\ud658\uacbd\uc774 \ud65c\uc131\ud654\ub41c \uc0c1\ud0dc\uc5d0\uc11c \uc2e4\ud589\ud574\uc57c \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.</li> </ul>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/","title":"PCI Passthrougu + Placement API \uc801\uc6a9","text":""},{"location":"openstack/2024.2-Dalmatian/pci-placement/#0","title":"0. \uc0ac\uc804 \ud655\uc778 \uc0ac\ud56d","text":"<ul> <li>Ubuntu 24.04 + Openstack 2024.1 \ud658\uacbd\uc5d0\uc11c \uc9c4\ud589</li> <li>GPU \ub178\ub4dc\uc5d0 IOMMU \ucee4\ub110 \uc124\uc815 \ud655\uc778</li> <li>GPU \uad00\ub9ac\uc790\uac00 VFIO\uc778\uc9c0 \ud655\uc778</li> </ul>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#1-nova-gpu","title":"1. Nova \uc124\uc815 \uc624\ubc84\ub77c\uc774\ub529 (GPU \uc778\uc2dd\uc2dc\ud0a4\uae30)","text":"<p>Kolla-Ansible\uc740 <code>/etc/kolla/config/nova/nova.conf</code> \ud30c\uc77c\uc744 \uc6b0\uc120\uc21c\uc704\ub85c \uc801\uc6a9\ud569\ub2c8\ub2e4. \uc5ec\uae30\uc5d0 GPU \uc815\ubcf4\ub97c \ubc15\uc81c\ud569\ub2c8\ub2e4.</p> <pre><code># \uc0ac\uc6a9\ud560 PCI \uc7a5\ube44\uc758 \uc774\ub984 \uc0dd\uc131\n# CUSTOM_ \uc811\ub450\uc0ac\ub294 \ud544\uc218\ub85c \ub4e4\uc5b4\uac00\uc57c \ud568\nopenstack resource class create CUSTOM_&lt;RESOURCE_NAME&gt;\n</code></pre> <pre><code># \uc124\uc815 \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131\nsudo mkdir -p /etc/kolla/config/nova\n\n# \uc124\uc815 \ud30c\uc77c \uc791\uc131\nsudo nano /etc/kolla/config/nova/nova.conf\n</code></pre> <pre><code>[pci]\n# 1. [Compute \ub178\ub4dc\uc6a9] \ubb3c\ub9ac \uc11c\ubc84\uc758 PCI \uc7a5\uce58 \ud654\uc774\ud2b8\ub9ac\uc2a4\ud2b8\n# 10de(NVIDIA)\uc758 20b7 \ubaa8\ub378\uc744 \uc0ac\uc6a9\ud558\uaca0\ub2e4\uace0 \uc120\uc5b8\ndevice_spec = [{\"vendor_id\": \"&lt;VENDOR_ID&gt;\", \"product_id\": \"&lt;PRODUCT_ID&gt;\"}]\n\n# 2. [API \ub178\ub4dc\uc6a9] Flavor\uc5d0\uc11c \uc0ac\uc6a9\ud560 \ubcc4\uce6d(Alias) \uc815\uc758\n# name\uc740 \ub098\uc911\uc5d0 Flavor \ub9cc\ub4e4 \ub54c \uc501\ub2c8\ub2e4. (\uc5ec\uae30\uc11c\ub294 'nvidia-gpu'\ub85c \uc815\ud568)\n# nova\uac00 \uc7a5\uce58\ub97c \ubabb \ucc3e\uaca0\ub2e4 \ud560 \ub54c, type-PCI \ubcc0\uacbd \ud544\uc694\nalias = {\"vendor_id\": \"&lt;VENDOR_ID&gt;\", \"product_id\": \"&lt;PRODUCT_ID&gt;\", \"device_type\": \"type-PCI\", \"name\": \"&lt;RESOURCE_NAME&gt;\"}\n\n# 3. PCI\ub97c placement\uc5d0 \ud1b5\ud569\nreport_in_placement = true\n\n[filter_scheduler]\n# 3. [Scheduler \ub178\ub4dc\uc6a9] PCI \ud544\ud130 \ud65c\uc131\ud654 (\uae30\uc874 \ud544\ud130 \ub4a4\uc5d0 \ucd94\uac00)\navailable_filters = nova.scheduler.filters.all_filters\nenabled_filters = ComputeFilter,ImagePropertiesFilter,PciPassthroughFilter\n\n# \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \uc635\uc158\uc778\uc9c0 \ud655\uc778 \ud544\uc694\npci_in_placement = true\n</code></pre> <p>(\uc800\uc7a5: <code>Ctrl+O</code> -&gt; \uc5d4\ud130 -&gt; <code>Ctrl+X</code>)</p>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#2-reconfigure","title":"2. \uc124\uc815 \uc801\uc6a9 (Reconfigure)","text":"<p>\uae30\uc874 \uc624\ud508\uc2a4\ud0dd\uc744 \ub044\uc9c0 \uc54a\uace0 \uc124\uc815\ub9cc \uc5c5\ub370\uc774\ud2b8\ud569\ub2c8\ub2e4.</p> <pre><code># \uac00\uc0c1\ud658\uacbd \ud65c\uc131\ud654 \ud544\uc218\nsource ~/kolla-venv/bin/activate\n\n# \uc7ac\uc124\uc815 \uc801\uc6a9 (Nova \uc11c\ube44\uc2a4\ub4e4\ub9cc \uc7ac\uc2dc\uc791\ub428)\nkolla-ansible reconfigure -i multinode --tags nova\n</code></pre> <p>(\uc804\uccb4\ub97c \ub2e4 \ub3cc\ub9ac\uba74 \uc624\ub798 \uac78\ub9ac\ub2c8 <code>--tags nova</code>\ub85c \uc2dc\uac04 \ub2e8\ucd95 \uac00\ub2a5\ud569\ub2c8\ub2e4.)</p>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#3-placement","title":"3. Placement \ub4f1\ub85d \uac80\uc99d","text":"<p>Nova\uac00 GPU\ub97c \uac10\uc9c0\ud558\uace0 Placement\uc5d0 \"\ub098 GPU \uc788\uc5b4!\"\ub77c\uace0 \ubcf4\uace0\ud588\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#31-compute-node-uuid","title":"3.1. \ubb3c\ub9ac \uc11c\ubc84(Compute Node) UUID \ud655\uc778","text":"<pre><code>openstack resource provider list\n</code></pre> <ul> <li>\uc5ec\uae30\uc11c GPU \ub178\ub4dc\uc758 \uc790\uc2dd <code>ID</code> (UUID)\ub97c \ubcf5\uc0ac\ud558\uc138\uc694.</li> </ul>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#32","title":"3.2. \uc778\ubca4\ud1a0\ub9ac \uc870\ud68c","text":"<pre><code># [UUID] \uc790\ub9ac\uc5d0 \ubcf5\uc0ac\ud55c ID\ub97c \ub123\uc73c\uc138\uc694\nopenstack resource provider inventory list [UUID]\n</code></pre> <p>[\uc131\uacf5 \ud310\ub3c5] \ucd9c\ub825 \uacb0\uacfc\uc5d0 \uc544\ub798\uc640 \ube44\uc2b7\ud55c \ud56d\ubaa9\uc774 \ubcf4\uc5ec\uc57c \ud569\ub2c8\ub2e4.</p> <ul> <li><code>PCI_DEVICE</code>: <code>total: 1</code> (\ub610\ub294 GPU \uac1c\uc218\ub9cc\ud07c)</li> <li>\ub610\ub294 <code>CUSTOM_PCI_10DE_20B7</code>: <code>total: ...</code></li> </ul>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#4-external-network","title":"4. \uc678\ubd80 \ub124\ud2b8\uc6cc\ud06c(External Network) \ub6ab\uae30","text":"<p>\uc778\uc2a4\ud134\uc2a4\uac00 \uc678\ubd80(\uc778\ud130\ub137)\uc640 \ud1b5\uc2e0\ud558\ub824\uba74 \"\ubb3c\ub9ac \uc11c\ubc84\uc758 \ube48 \uae61\ud1b5 \uc778\ud130\ud398\uc774\uc2a4(\uc608: eno2)\"\uc640 \uc5f0\uacb0\ub41c \uac00\uc0c1 \ub124\ud2b8\uc6cc\ud06c\ub97c \ub9cc\ub4e4\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p> <p>\uc804\uc81c \uc870\uac74:</p> <ul> <li><code>globals.yml</code>\uc5d0 <code>neutron_external_interface: \"eno2\"</code> (\ubb3c\ub9ac\uc11c\ubc84\uc758 \uc678\ubd80\uc6a9 \ud3ec\ud2b8)\uac00 \uc124\uc815\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> <li>\ud574\ub2f9 \ud3ec\ud2b8\ub294 \uc2a4\uc704\uce58\uc5d0\uc11c \uc778\ud130\ub137\uc774 \ub418\ub294 VLAN(\ub610\ub294 Untagged)\uc5d0 \uaf42\ud600 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#41-flat","title":"4.1. \ub124\ud2b8\uc6cc\ud06c \uc0dd\uc131 (Flat \ud0c0\uc785)","text":"<p>\uc0ac\ub0b4\ub9dd IP \ub300\uc5ed\uc744 \uadf8\ub300\ub85c \uc4f0\ub294 \ubc29\uc2dd\uc785\ub2c8\ub2e4. (\uc608: \uc0ac\ub0b4\ub9dd\uc774 <code>192.168.0.0/24</code>\ub77c\uace0 \uac00\uc815)</p> <pre><code># 1. Provider Network \uc0dd\uc131 (\uc774\ub984: public)\n# physnet1\uc740 kolla \uae30\ubcf8 \ubb3c\ub9ac \ub124\ud2b8\uc6cc\ud06c \uc774\ub984\uc785\ub2c8\ub2e4.\nopenstack network create --share --external \\\n  --provider-physical-network physnet1 \\\n  --provider-network-type flat \\\n  public\n\n# 2. Subnet \uc0dd\uc131 (\uc5ec\uae30\uc5d0 \uc2e4\uc81c \uc0ac\ub0b4\ub9dd \uc815\ubcf4\ub97c \ub123\uc5b4\uc57c \ud568!)\n# gateway: \uc0ac\ub0b4\ub9dd \uac8c\uc774\ud2b8\uc6e8\uc774 (\uc608: 192.168.0.1)\n# allocation-pool: DHCP\ub85c \uc4f8 \ubc94\uc704 (\uc608: 100~200\ubc88)\nopenstack subnet create --network public \\\n  --allocation-pool start=192.168.0.100,end=192.168.0.200 \\\n  --dns-nameserver 8.8.8.8 \\\n  --gateway 192.168.0.1 \\\n  --subnet-range 192.168.0.0/24 \\\n  public_subnet\n</code></pre> <pre><code># 3. \ub124\ud2b8\uc6cc\ud06c \uad00\ub828 \uc124\uc815(MTU \uc870\uc808)\n# VM \uc548\uc5d0\uc11c \uc2e4\ud589 (\ud5e4\ub354 \ud06c\uae30 \uac10\uc548\ud574\uc11c 1450\uc73c\ub85c \ud551)\nping -M do -s 1422 8.8.8.8  # (1422 + 28\ud5e4\ub354 = 1450) -&gt; \uc798 \ub420 \uac81\ub2c8\ub2e4.\nping -M do -s 1472 8.8.8.8  # (1472 + 28\ud5e4\ub354 = 1500) -&gt; \uc2e4\ud328\ud558\uac70\ub098 \ud0c0\uc784\uc544\uc6c3 \ub0a0 \uac81\ub2c8\ub2e4.\n\n# 3-1. 1472 \ud551\uc5d0\uc11c \uc624\ub958 \ubc1c\uc0dd \uc2dc\n# /etc/kolla/globals.yml\nnetwork_mtu: 1450 # (\uae30\ubcf8\uac12 1500 -&gt; 1450 \ucd95\uc18c)\n\n# 3-2. \uc218\uc815 \ud6c4 \uc7ac\ubc30\ud3ec\nkolla-ansible reconfigure -i multinode\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#mtu","title":"MTU \uad00\ub828 \uc18d\ub3c4 \uc9c0\uc5f0\uc774 \uc0dd\uae30\ub294 \uc774\uc720","text":"<p>1) \uae30\ubcf8 \ud328\ud0b7 \ud06c\uae30 \uc81c\ud55c\uc774 1500 byte, \uc624\ud508\uc2a4\ud0dd \ub0b4\ubd80\uc5d0\uc11c\ub294 \ud328\ud0b7\uc5d0 \uc624\ubc84\ud5e4\ub4dc(VXLAN, UDP, IP, Ethernet \ud5e4\ub354 -&gt; \ucd1d 50 byte)\ub97c \ubd99\uc5ec\uc11c \ud3ec\uc7a5 \ud6c4 \uc804\uc1a1 2) \ub530\ub77c\uc11c vm\uc774 1500 byte \ub370\uc774\ud130\ub97c \uc804\uc1a1 \uc2dc, vm\uc5d0\uc11c 50 byte\ucd94\uac00\ub418\uc5b4 1550 byte \uc804\uc1a1 \uc694\uccad 3) \ubb3c\ub9ac \ub79c\uce74\ub4dc\uc5d0\uc11c \ud328\ud0b7 \ud06c\uae30 \ucd08\uacfc \uc778\uc9c0 -&gt; \ud328\ud0b7 \ud3d0\uae30 \ub610\ub294 \ucabc\uac1c\uae30 4) \ud328\ud0b7 \uc190\uc2e4 \ud639\uc740 \uc7ac\uc804\uc1a1\uc774 \ubc1c\uc0dd\ud558\uba70 \ub124\ud2b8\uc6cc\ud06c \uc18d\ub3c4 \uc800\ud558(\ud2b9\ud788 HTTPS \uc811\uc18d\uc774\ub098 \ub300\uc6a9\ub7c9 \ub2e4\uc6b4\ub85c\ub4dc \uc2dc)</p>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#5","title":"5. \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 \ud14c\uc2a4\ud2b8","text":"<p>\uc774\uc81c \"GPU\uac00 \ub2ec\ub9b0 + \uc778\ud130\ub137\uc774 \ub418\ub294\" \uc778\uc2a4\ud134\uc2a4\ub97c \ub9cc\ub4ed\ub2c8\ub2e4.</p>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#51-gpu-flavor","title":"5.1. GPU Flavor \uc0dd\uc131","text":"<p>\uc544\uae4c <code>nova.conf</code>\uc5d0\uc11c \uc815\ud55c alias \uc774\ub984(<code>nvidia-gpu</code>)\uc744 \uc501\ub2c8\ub2e4.</p> <pre><code>openstack flavor create --ram 8192 --disk 50 --vcpus 4 gpu.flavor\nopenstack flavor set \\\n  --property \"pci_passthrough:alias\"=\"&lt;RESOURCE_NAME&gt;:1\" \\\n  --property \"resources:&lt;CUSTOM_RESOURCE_CLASS&gt;=1\" \\\n  --property \"hw:pci_numa_affinity_policy\"=\"preferred\" \\\n  --property hw_machine_type=q35 \\\n  gpu-flavor\n</code></pre> <p>\ub9cc\uc57d RTX \uacc4\uc5f4\uc758 \uac1c\uc778\uc6a9 GPU\ub97c \uc0ac\uc6a9\ud55c\ub2e4\uba74 <code>--property hw:kvm_hidden=true</code> \uc635\uc158\ub3c4 \ud568\uaed8 \uc801\uc6a9\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#52","title":"5.2. \uc778\uc2a4\ud134\uc2a4 \uc2dc\uc791","text":"<pre><code>openstack server create --flavor gpu.flavor \\\n  --image \"Ubuntu 24.04\" \\\n  --network internal \\\n  my-gpu-vm\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#53","title":"5.3. \ucd5c\uc885 \ud655\uc778","text":"<p>VM \uc811\uc18d \ud6c4:</p> <ul> <li><code>lspci</code>: NVIDIA \uc7a5\uce58\uac00 \ubcf4\uc774\ub294\uc9c0?</li> <li><code>ping 8.8.8.8</code>: \uc778\ud130\ub137\uc774 \ub418\ub294\uc9c0?</li> <li><code>nvidia-smi</code>: \ub4dc\ub77c\uc774\ubc84 \uc124\uce58 \ud6c4 GPU\uac00 \uc7a1\ud788\ub294\uc9c0?</li> </ul>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#6-api-advanced-verification","title":"6. API \uae30\ubc18 \ud560\ub2f9 \uac80\uc99d (Advanced Verification)","text":"<p>CLI\ub098 \ub300\uc2dc\ubcf4\ub4dc \uc0c1\uc5d0\uc11c\ub294 \ud655\uc778\ud558\uae30 \uc5b4\ub824\uc6b4 \"\uc2e4\uc81c \ub9ac\uc18c\uc2a4 \uc810\uc720 \ud604\ud669(Placement)\"\uacfc \"Flavor \ub0b4\ubd80 \uc124\uc815(Nova)\"\uc744 API\ub97c \ud1b5\ud574 \uc9c1\uc811 \uac80\uc99d\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#60","title":"6.0. \ud658\uacbd \ubcc0\uc218 \uc124\uc815","text":"<p>\uac80\uc99d\uc5d0 \ud544\uc694\ud55c \ubcc0\uc218\ub4e4\uc744 \ubbf8\ub9ac \uc120\uc5b8\ud569\ub2c8\ub2e4. <code>&lt; &gt;</code>\ub85c \ud45c\uc2dc\ub41c \ubd80\ubd84\uc5d0 \uc2e4\uc81c \uac12\uc744 \uc785\ub825\ud558\uc138\uc694.</p> <pre><code># 1. \uc811\uc18d \uc815\ubcf4\nexport CONTROLLER_IP=$(openstack endpoint list --service keystone --interface public -c URL -f value | awk -F/ '{print $3}' | cut -d: -f1)\nexport PLACEMENT_PORT=$(openstack endpoint list --service placement --interface public -c URL -f value | awk -F: '{print $3}' | cut -d/ -f1)\nexport NOVA_PORT=$(openstack endpoint list --service compute --interface public -c URL -f value | awk -F: '{print $3}' | cut -d/ -f1)\n\n# 2. \uac80\uc99d \ub300\uc0c1 UUID (\uc0ac\uc804 \ud655\uc778 \ud544\uc694)\n# \uc0dd\uc131\ub41c \uc778\uc2a4\ud134\uc2a4\uc758 ID\nexport SERVER_ID=\"&lt;INSTANCE_ID&gt;\"\n# \uc0dd\uc131\ud55c GPU Flavor\uc758 ID\nexport FLAVOR_ID=\"&lt;FLAVOR_ID&gt;\"\n# GPU \uc790\uc6d0\uc744 \uac00\uc9c4 \ubb3c\ub9ac \ub178\ub4dc(\ud639\uc740 \uc790\uc2dd \ub178\ub4dc)\uc758 UUID\nexport RP_UUID=$(openstack resource provider allocation show $SERVER_ID -c resource_provider -c resources -f value | grep \"CUSTOM_\" | awk '{print $1}')\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#61","title":"6.1. \uc778\uc99d \ud1a0\ud070 \ubc1c\uae09 (\ud1a0\ud070\uc774 \uc5c6\ub294 \uacbd\uc6b0)","text":"<pre><code># \uad00\ub9ac\uc790 \uad8c\ud55c \ub85c\ub4dc \ud6c4 \ud1a0\ud070 \ubc1c\uae09\nsource /etc/kolla/admin-openrc.sh\nexport OS_TOKEN=$(openstack token issue -c id -f value)\necho \"Token: $OS_TOKEN\"\n</code></pre>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#62-placement-api","title":"6.2. Placement API \uac80\uc99d (\ud558\ub4dc\uc6e8\uc5b4 \uad00\uc810)","text":"<p>GPU \uc790\uc6d0\uc774 \ubb3c\ub9ac\uc801\uc73c\ub85c \uc874\uc7ac\ud558\uba70, \uc0dd\uc131\ud55c \uc778\uc2a4\ud134\uc2a4\uac00 \uc774\ub97c \uc2e4\uc81c\ub85c \uc810\uc720\ud558\uace0 \uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#1-resource-inventory","title":"1) Resource Inventory \uc870\ud68c (\uc7ac\uace0 \ud655\uc778)","text":"<pre><code>curl -s -X GET \"http://${CONTROLLER_IP}:${PLACEMENT_PORT}/resource_providers/${RP_UUID}/inventories\" \\\n  -H \"X-Auth-Token: ${OS_TOKEN}\" \\\n  -H \"OpenStack-API-Version: placement 1.28\" \\\n  -H \"Content-Type: application/json\" | json_pp\n</code></pre> <p>[\ud655\uc778 \ud3ec\uc778\ud2b8]</p> <ul> <li><code>total</code> \uac12\uc774 \uc2e4\uc81c \ubb3c\ub9ac GPU \uac1c\uc218\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778</li> <li>\ub9ac\uc18c\uc2a4 \ud074\ub798\uc2a4 \uc774\ub984\uc774 <code>CUSTOM_&lt;RESOURCE_NAME&gt;</code> (\ub610\ub294 \uc790\ub3d9 \uc0dd\uc131\ub41c \uc774\ub984)\uc778\uc9c0 \ud655\uc778</li> </ul>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#2-resource-allocations","title":"2) Resource Allocations \uc870\ud68c (\uc810\uc720 \ud655\uc778 \u2605\uc911\uc694)","text":"<pre><code>curl -s -X GET \"http://${CONTROLLER_IP}:${PLACEMENT_PORT}/resource_providers/${RP_UUID}/allocations\" \\\n  -H \"X-Auth-Token: ${OS_TOKEN}\" \\\n  -H \"OpenStack-API-Version: placement 1.28\" \\\n  -H \"Content-Type: application/json\" | json_pp\n</code></pre> <p>[\ud655\uc778 \ud3ec\uc778\ud2b8]</p> <ul> <li>\uc751\ub2f5 JSON\uc758 Key \uac12(Consumer UUID)\uc5d0 <code>&lt;INSTANCE_ID&gt;</code>\uac00 \ud3ec\ud568\ub418\uc5b4 \uc788\uc5b4\uc57c \ud568</li> <li>\ud574\ub2f9 \uc778\uc2a4\ud134\uc2a4\uac00 <code>CUSTOM_&lt;RESOURCE_NAME&gt;</code> \uc790\uc6d0\uc744 <code>1</code>\uac1c \uc0ac\uc6a9 \uc911\uc774\uc5b4\uc57c \ud568</li> </ul>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#63-nova-api","title":"6.3. Nova API \uac80\uc99d (\uc18c\ud504\ud2b8\uc6e8\uc5b4 \uad00\uc810)","text":"<p>\uc778\uc2a4\ud134\uc2a4\uac00 \uc62c\ubc14\ub978 Flavor\uc640 \uc2a4\ud399\uc73c\ub85c \uc0dd\uc131\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#1-flavor-extra-specs","title":"1) Flavor \uc0c1\uc138 \uc2a4\ud399(Extra Specs) \uc870\ud68c","text":"<p>Flavor \uc870\ud68c \uc2dc \uae30\ubcf8 \uc815\ubcf4\uc5d0\ub294 GPU \uad00\ub828 \uc124\uc815\uc774 \ub098\uc624\uc9c0 \uc54a\uc73c\ubbc0\ub85c, <code>/os-extra_specs</code> \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ub97c \ud638\ucd9c\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>curl -s -X GET \"http://${CONTROLLER_IP}:${NOVA_PORT}/v2.1/flavors/${FLAVOR_ID}/os-extra_specs\" \\\n  -H \"X-Auth-Token: ${OS_TOKEN}\" \\\n  -H \"Content-Type: application/json\" | json_pp\n</code></pre> <p>[\ud655\uc778 \ud3ec\uc778\ud2b8]</p> <ul> <li><code>\"pci_passthrough:alias\": \"&lt;RESOURCE_NAME&gt;:1\"</code> \uc124\uc815 \uc874\uc7ac \uc5ec\ubd80</li> <li><code>\"resources:CUSTOM_&lt;RESOURCE_CLASS&gt;\": \"1\"</code> \uc124\uc815 \uc874\uc7ac \uc5ec\ubd80</li> <li><code>\"hw:pci_numa_affinity_policy\": \"preferred\"</code> \uc124\uc815 \uc874\uc7ac \uc5ec\ubd80</li> </ul>"},{"location":"openstack/2024.2-Dalmatian/pci-placement/#2-instance","title":"2) Instance \uc0c1\uc138 \uc815\ubcf4 \uc870\ud68c","text":"<pre><code>curl -s -X GET \"http://${CONTROLLER_IP}:${NOVA_PORT}/v2.1/servers/${SERVER_ID}\" \\\n  -H \"X-Auth-Token: ${OS_TOKEN}\" \\\n  -H \"Content-Type: application/json\" | json_pp\n</code></pre> <p>[\ud655\uc778 \ud3ec\uc778\ud2b8]</p> <ul> <li><code>status</code>: \"ACTIVE\"</li> <li><code>flavor.id</code>: \uc704\uc5d0\uc11c \uc870\ud68c\ud55c <code>&lt;FLAVOR_ID&gt;</code>\uc640 \uc77c\uce58\ud574\uc57c \ud568</li> </ul>"},{"location":"openstack/2025.1-Epoxy/install/","title":"\ud83d\udee0\ufe0f OpenStack 2025.1 (Epoxy) GPU/PCI Passthrough \uc124\uce58 \uac00\uc774\ub4dc","text":""},{"location":"openstack/2025.1-Epoxy/install/#0","title":"0. \uc0ac\uc804 \ud658\uacbd \uac00\uc815","text":"<ul> <li>OS: Ubuntu 24.04 LTS (\ubaa8\ub4e0 \ub178\ub4dc \ub3d9\uc77c)</li> <li>Control Node IP: <code>10.10.10.60</code></li> <li>Compute Node IP: <code>10.10.10.62</code> (GPU \uc7a5\ucc29)</li> <li>Target GPU: NVIDIA (Vendor: <code>10de</code>, Product: <code>20b7</code>)</li> </ul>"},{"location":"openstack/2025.1-Epoxy/install/#1","title":"1. [\ubaa8\ub4e0 \ub178\ub4dc] \uacf5\ud1b5 \uae30\ubcf8 \uc124\uc815","text":"<p>\ub300\uc0c1: Control Node(Master), Compute Node \ub4f1 \ubaa8\ub4e0 \uc11c\ubc84 \uad8c\ud55c: Root (<code>sudo -i</code>)</p> <pre><code># 1. Root \uad8c\ud55c \ud68d\ub4dd\nsudo -i\n\n# 2. \ud55c\uad6d \ud45c\uc900\uc2dc \uc124\uc815\ntimedatectl set-timezone Asia/Seoul\n\n# 3. \ud328\ud0a4\uc9c0 \uc5c5\ub370\uc774\ud2b8 \ubc0f \ud544\uc218 \uc720\ud2f8\ub9ac\ud2f0 \uc124\uce58\napt update &amp;&amp; apt install -y git python3-dev libffi-dev gcc libssl-dev python3-venv net-tools\n\n# 4. \ud638\uc2a4\ud2b8 \ub4f1\ub85d (DNS\uac00 \uc5c6\uc744 \uacbd\uc6b0 /etc/hosts \ub4f1\ub85d \ud544\uc218)\n# (\uc544\ub798 IP\uc640 \ud638\uc2a4\ud2b8\uba85\uc740 \ubcf8\uc778 \ud658\uacbd\uc5d0 \ub9de\uac8c \uc218\uc815\ud558\uc138\uc694)\necho \"10.10.10.60 control\" &gt;&gt; /etc/hosts\necho \"10.10.10.62 compute\" &gt;&gt; /etc/hosts\n</code></pre>"},{"location":"openstack/2025.1-Epoxy/install/#2-compute-gpu","title":"2. [Compute \ub178\ub4dc] GPU \uaca9\ub9ac \ubc0f \ud558\ub4dc\uc6e8\uc5b4 \uc124\uc815","text":"<p>\ub300\uc0c1: GPU\uac00 \uc7a5\ucc29\ub41c Compute Node (<code>10.10.10.62</code>) \ubaa9\uc801: \ucee4\ub110 \ub808\ubca8\uc5d0\uc11c GPU\ub97c \uaca9\ub9ac\ud558\uc5ec VM\uc5d0 \ud560\ub2f9\ud560 \uc900\ube44\ub97c \ud569\ub2c8\ub2e4.</p> <pre><code># 1. IOMMU \ud65c\uc131\ud654 (GRUB \uc124\uc815 \uc218\uc815)\n# \uae30\uc874 \uc124\uc815\uc744 \ubc31\uc5c5 \ud6c4 intel_iommu=on iommu=pt \ucd94\uac00 (AMD CPU\uc778 \uacbd\uc6b0 intel_iommu \ub300\uc2e0 amd_iommu \uc0ac\uc6a9)\ncp /etc/default/grub /etc/default/grub.bak\nsed -i 's/GRUB_CMDLINE_LINUX_DEFAULT=\"/GRUB_CMDLINE_LINUX_DEFAULT=\"intel_iommu=on iommu=pt /' /etc/default/grub\nupdate-grub\n\n# 2. VFIO \ubaa8\ub4c8 \ub85c\ub4dc \uc124\uc815\ncat &lt;&lt;EOF &gt; /etc/modules-load.d/vfio.conf\nvfio\nvfio_iommu_type1\nvfio_pci\nEOF\n\n# 3. GPU \uc7a5\uce58 \ubc14\uc778\ub529 (vfio-pci)\n# [\uc8fc\uc758] 10de:20b7 \ubd80\ubd84\uc740 'lspci -nn | grep NVIDIA'\ub85c \ud655\uc778\ub41c \ubcf8\uc778\uc758 ID\ub85c \ubc18\ub4dc\uc2dc \ubcc0\uacbd\ud558\uc138\uc694.\necho \"options vfio-pci ids=10de:20b7\" &gt; /etc/modprobe.d/vfio.conf\n\n# 4. \uc124\uc815 \uc801\uc6a9\uc744 \uc704\ud574 initramfs \uac31\uc2e0 \ubc0f \uc7ac\ubd80\ud305\nupdate-initramfs -u\nreboot\n\n# --- \uc7ac\ubd80\ud305 \ud6c4 \ud655\uc778 \uba85\ub839\uc5b4 ---\n# lspci -nnk -d 10de:20b7\n# \uacb0\uacfc\uc5d0 \"Kernel driver in use: vfio-pci\"\uac00 \ucd9c\ub825\ub418\uc5b4\uc57c \uc131\uacf5\n</code></pre>"},{"location":"openstack/2025.1-Epoxy/install/#3-control-kolla-ansible","title":"3. [Control \ub178\ub4dc] Kolla-Ansible \uc124\uce58 \ubc0f \uc900\ube44","text":"<p>\ub300\uc0c1: Control Node (<code>10.10.10.60</code>) \ubaa9\uc801: \ubc30\ud3ec \ub3c4\uad6c \uc124\uce58 \ubc0f \uae30\ubcf8 \uc124\uc815</p> <pre><code># 1. Python \uac00\uc0c1\ud658\uacbd \uc0dd\uc131 (\uc2dc\uc2a4\ud15c \ud328\ud0a4\uc9c0 \ucda9\ub3cc \ubc29\uc9c0)\npython3 -m venv $HOME/kolla-venv\nsource $HOME/kolla-venv/bin/activate\n\n# 2. pip \ubc0f Ansible \uc124\uce58\npip install -U pip\npip install 'ansible-core&gt;=2.16,&lt;2.18'\n\n# docker\ub294 \uae30\ubcf8 \uc2dc\uc2a4\ud15c \uacbd\ub85c\uc5d0 \uc124\uce58\n/root/kolla-venv/bin/python3.12 -m pip install docker\n\n\n# 3. Kolla-Ansible 2025.1 \uc124\uce58\npip install git+https://opendev.org/openstack/kolla-ansible@stable/2025.1\n\n# 4. \uc124\uc815 \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131 \ubc0f \uc608\uc81c \ud30c\uc77c \ubcf5\uc0ac\nsudo mkdir -p /etc/kolla\nsudo chown $USER:$USER /etc/kolla\ncp -r $HOME/kolla-venv/share/kolla-ansible/etc_examples/kolla/* /etc/kolla/\ncp $HOME/kolla-venv/share/kolla-ansible/ansible/inventory/* .\n\n# 5. \uc758\uc874\uc131 \uc124\uce58 \ubc0f \ud328\uc2a4\uc6cc\ub4dc \uc0dd\uc131\nkolla-ansible install-deps\nkolla-genpwd\n\n# 6. SSH \ud0a4 \ubc30\ud3ec (Control -&gt; Compute \uc811\uc18d\uc6a9)\n# (\uc774\ubbf8 \ub418\uc5b4 \uc788\ub2e4\uba74 \uc0dd\ub7b5 \uac00\ub2a5)\nssh-keygen -t rsa -N \"\" -f ~/.ssh/id_rsa\nssh-copy-id root@10.10.10.62\n\n# 7. \uc778\ubca4\ud1a0\ub9ac \ud30c\uc77c \uc218\uc815\n# vi multinode \uba85\ub839\uc73c\ub85c \uc544\ub798 \ub0b4\uc6a9 \ubc18\uc601\n# [control]\n# 10.10.10.60\n# [compute]\n# 10.10.10.62\n</code></pre>"},{"location":"openstack/2025.1-Epoxy/install/#4-control-placement-pci","title":"4. [Control \ub178\ub4dc] Placement &amp; PCI \uc5f0\ub3d9 \uc124\uc815 (\u2605\uc911\uc694\u2605)","text":"<p>\ub300\uc0c1: Control Node (<code>10.10.10.60</code>) \uc124\uba85: \ubc30\ud3ec \uc2dc \uc801\uc6a9\ub420 Nova \uc124\uc815 \ud30c\uc77c\uc744 \ubbf8\ub9ac \uc791\uc131\ud569\ub2c8\ub2e4.</p> <pre><code># \uc124\uc815 \ud30c\uc77c \uc800\uc7a5 \uacbd\ub85c \uc0dd\uc131\nmkdir -p /etc/kolla/config/nova\n\n# -------------------------------------------------------\n# 4-1. Nova Compute \uc124\uc815 (Compute \ub178\ub4dc\uc5d0 \uc801\uc6a9\ub420 \uc124\uc815)\n# -------------------------------------------------------\ncat &lt;&lt;EOF &gt; /etc/kolla/config/nova/nova-compute.conf\n[pci]\n# Placement API\uc5d0 PCI \uc7a5\uce58\ub97c \ubcf4\uace0\ud558\ub3c4\ub85d \uc124\uc815 (\ucd5c\uc2e0 \ud45c\uc900)\nreport_in_placement = True\n\n# PCI \uc7a5\uce58 \uc815\uc758 (device_spec)\n# resource_class\ub294 \ubc18\ub4dc\uc2dc 'CUSTOM_'\uc73c\ub85c \uc2dc\uc791\ud558\uace0 \ub300\ubb38\uc790\uc5ec\uc57c \ud568\ndevice_spec = { \"vendor_id\": \"10de\", \"product_id\": \"20b7\", \"resource_class\": \"CUSTOM_GPU_NVIDIA\", \"name\": \"nvidia-gpu\" }\nEOF\n\n# -------------------------------------------------------\n# 4-2. Nova API \uc124\uc815 (API \uc11c\ube44\uc2a4\uac00 \uc54c\uac8c \ub420 \ubcc4\uce6d)\n# -------------------------------------------------------\ncat &lt;&lt;EOF &gt; /etc/kolla/config/nova/nova-api.conf\n[pci]\n# Flavor \uc0dd\uc131 \uc2dc \uc0ac\uc6a9\ud560 \ubcc4\uce6d \uc815\uc758\nalias = { \"name\": \"gpu-alias\", \"device_type\": \"type-PF\", \"custom_resource_class\": \"CUSTOM_GPU_NVIDIA\" }\nEOF\n\n# -------------------------------------------------------\n# 4-3. Nova Scheduler \uc124\uc815\n# -------------------------------------------------------\ncat &lt;&lt;EOF &gt; /etc/kolla/config/nova/nova-scheduler.conf\n[filter_scheduler]\n# PciPassthroughFilter \ud65c\uc131\ud654\nenabled_filters = PciPassthroughFilter, ComputeFilter, AvailabilityZoneFilter, ImagePropertiesFilter, ValidationFilter\nEOF\n</code></pre>"},{"location":"openstack/2025.1-Epoxy/install/#5-control","title":"5. [Control \ub178\ub4dc] \ubc30\ud3ec \uc2e4\ud589","text":"<p>\ub300\uc0c1: Control Node (<code>10.10.10.60</code>)</p> <pre><code># 1. \uac00\uc0c1\ud658\uacbd \ud65c\uc131\ud654 (\ud544\uc218)\nsource $HOME/kolla-venv/bin/activate\n\n# 2. \uc5f0\uacb0 \ud14c\uc2a4\ud2b8\nansible -i multinode all -m ping\n\n# 3. OpenStack \ubc30\ud3ec (\uc21c\uc11c\ub300\ub85c \uc2e4\ud589)\nkolla-ansible bootstrap-servers -i multinode\nkolla-ansible prechecks -i multinode\nkolla-ansible deploy -i multinode\n\n# 4. \ud074\ub77c\uc774\uc5b8\ud2b8 \ub3c4\uad6c \uc124\uce58 (\ubc30\ud3ec \uc644\ub8cc \ud6c4)\npip install python-openstackclient\n</code></pre>"},{"location":"openstack/2025.1-Epoxy/install/#6-control-flavor","title":"6. [Control \ub178\ub4dc] \uac80\uc99d \ubc0f Flavor \uc0dd\uc131","text":"<p>\ub300\uc0c1: Control Node (<code>10.10.10.60</code>) \uc124\uba85: \ubc30\ud3ec \ud6c4 GPU \uc790\uc6d0\uc774 \uc815\uc0c1\uc801\uc73c\ub85c Placement\uc5d0 \ub4f1\ub85d\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud558\uace0 Flavor\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <pre><code># 1. Admin \ud658\uacbd \ubcc0\uc218 \ub85c\ub4dc\nsource /etc/kolla/admin-openrc.sh\n\n# 2. Placement \uc790\uc6d0 \ud655\uc778 (\uac00\uc7a5 \uc911\uc694\ud55c \uac80\uc99d \ub2e8\uacc4)\n# Compute \ub178\ub4dc\uac00 GPU\ub97c 'CUSTOM_GPU_NVIDIA'\ub77c\ub294 \uc790\uc6d0\uc73c\ub85c \ubcf4\uace0\ud588\ub294\uc9c0 \ud655\uc778\n# \uc544\ub798 \uba85\ub839 \uacb0\uacfc\uc5d0\uc11c USAGE / CAPACITY \ud655\uc778\nopenstack resource provider list\nopenstack resource provider inventory list &lt;COMPUTE_NODE_UUID&gt;\n\n# 3. GPU Flavor \uc0dd\uc131 (Placement \ubb38\ubc95 \uc0ac\uc6a9)\n# --property resources:\uc790\uc6d0\ud074\ub798\uc2a4\uba85=\uac1c\uc218\nopenstack flavor create --vcpus 8 --ram 16384 --disk 100 gpu.flavor\nopenstack flavor set --property \"resources:CUSTOM_GPU_NVIDIA=1\" gpu.flavor\n\n# 4. \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 \ud14c\uc2a4\ud2b8\nopenstack server create --flavor gpu.flavor --image &lt;IMAGE_NAME&gt; --network &lt;NETWORK_NAME&gt; gpu-test-vm\n</code></pre>"},{"location":"openstack/common/golden-image/","title":"OpenStack \uace8\ub4e0 \uc774\ubbf8\uc9c0(Golden Image) \uc0dd\uc131 \uac00\uc774\ub4dc","text":"<p>OpenStack \ud658\uacbd(Nova, Glance)\uc5d0\uc11c \uc778\uc2a4\ud134\uc2a4 \ubc30\ud3ec \uc2dc \uc989\uc2dc \uc0ac\uc6a9 \uac00\ub2a5\ud55c \uae68\ub057\ud55c Cloud Image\ub97c \ub9cc\ub4e4\uae30 \uc704\ud55c \uc808\ucc28\uc785\ub2c8\ub2e4.</p> <p>\ud544\uc218 \uc804\uc81c \uc870\uac74:</p> <ul> <li>\uc791\uc5c5\uc740 \ub85c\uceec KVM/QEMU \ud658\uacbd\uc774\ub098 OpenStack \ub0b4 \uc784\uc2dc \uc778\uc2a4\ud134\uc2a4\uc5d0\uc11c \uc218\ud589\ud569\ub2c8\ub2e4.</li> <li>\ubaa8\ub4e0 \uba85\ub839\uc740 root \uad8c\ud55c\uc73c\ub85c \uc2e4\ud589\ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"openstack/common/golden-image/#1","title":"1. \ubca0\uc774\uc2a4 \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc","text":"<p>\ud074\ub77c\uc6b0\ub4dc\uc6a9\uc73c\ub85c \ubbf8\ub9ac \ube4c\ub4dc\ub41c Cloud Image(qcow2, img)\ub97c \ubc1b\uc2b5\ub2c8\ub2e4.</p> <pre><code>mkdir -p ~/golden-image-work\ncd ~/golden-image-work\n</code></pre> <p>1. Ubuntu 24.04 LTS (Noble):</p> <pre><code>wget https://cloud-images.ubuntu.com/noble/current/noble-server-cloudimg-amd64.img -O ubuntu-24.04-base.qcow2\n</code></pre> <p>2. Rocky Linux 9:</p> <pre><code>wget https://dl.rockylinux.org/pub/rocky/9/images/x86_64/Rocky-9-GenericCloud-Base.latest.x86_64.qcow2 -O rocky-9-base.qcow2\n</code></pre> <p>3. AlmaLinux 9:</p> <pre><code>wget https://repo.almalinux.org/almalinux/9/cloud/x86_64/images/AlmaLinux-9-GenericCloud-latest.x86_64.qcow2 -O AlmaLinux-9-base.qcow2\n</code></pre> <p>4. CentOS Stream 9:</p> <pre><code>wget https://cloud.centos.org/centos/9-stream/x86_64/images/CentOS-Stream-GenericCloud-9-latest.x86_64.qcow2 -O CentOS-Stream-9-base.qcow2\n</code></pre> <p>5. Debian 12:</p> <pre><code>wget https://cloud.debian.org/images/cloud/bookworm/latest/debian-12-generic-amd64.qcow2 -O debian-12-base.qcow2\n</code></pre> <pre><code># `unable to resolve host addree` \uc624\ub958 \ubc1c\uc0dd \uc2dc, dns \uc11c\ubc84 \ucd94\uac00\necho \"nameserver 8.8.8.8\" | sudo tee -a /etc/resolv.conf\n</code></pre>"},{"location":"openstack/common/golden-image/#2","title":"2. \uc774\ubbf8\uc9c0 \uc811\uadfc \uad8c\ud55c \uc124\uc815","text":"<p>Cloud Image\ub294 \uae30\ubcf8\uc801\uc73c\ub85c root \ube44\ubc00\ubc88\ud638\uc640 SSH \uc811\uc18d\uc774 \ub9c9\ud600\uc788\uc2b5\ub2c8\ub2e4.</p> <p>\ub530\ub77c\uc11c \ub85c\uceec KVM\uc5d0\uc11c \ubd80\ud305 \ubc0f \uc791\uc5c5\uc744 \uc704\ud574 <code>libguestfs-tools</code> \uc640 <code>virt-customize</code> \ub3c4\uad6c\ub97c \uc124\uce58\ud558\uc5ec \ube44\ubc00\ubc88\ud638\ub97c \uac15\uc81c\ub85c \uc124\uc815\ud569\ub2c8\ub2e4.</p> <pre><code># \ub3c4\uad6c \uc124\uce58 (Ubuntu \uae30\uc900)\nsudo apt update\nsudo apt install -y libguestfs-tools qemu-kvm virt-manager\n\n# \uc774\ubbf8\uc9c0\uc5d0 root \ube44\ubc00\ubc88\ud638 \uc124\uc815 (\uc608: root1234)\n# \uc8fc\uc758: \uc774 \ube44\ubc00\ubc88\ud638\ub294 \ub098\uc911\uc5d0 \uc2a4\ud06c\ub9bd\ud2b8 \uc2e4\ud589 \ud6c4 \uc81c\uac70\ud560 \uac83\uc785\ub2c8\ub2e4.\nsudo virt-customize -a ubuntu-24.04-base.qcow2 --root-password password:root1234\n</code></pre>"},{"location":"openstack/common/golden-image/#3-kvm-vm","title":"3. KVM\uc73c\ub85c VM \ubd80\ud305 \ubc0f \uc811\uc18d","text":""},{"location":"openstack/common/golden-image/#31-ubuntudebian","title":"3.1 Ubuntu/Debian","text":"<pre><code># Ubuntu\ub294 \uae30\ubcf8 \uc6a9\ub7c9\uc774 \uc801\uc5b4 \uc6a9\ub7c9\uc744 \ub298\ub824\uc90d\ub2c8\ub2e4.\nqemu-img resize ubuntu-24.04-base.qcow2 +10G\n\n# KVM\uc73c\ub85c \ubd80\ud305 (\uba54\ubaa8\ub9ac 4G, CPU 2 Core)\nsudo kvm -m 2048 -smp 2 -hda ubuntu-24.04-base.qcow2 -net nic -net user,hostfwd=tcp::2222-:22 -nographic\n</code></pre> <p>\uc704\uc5d0\uc11c <code>login:</code> \ud654\uba74\uc774 \ub728\uba74 \uc704\uc5d0\uc11c \uc124\uc815\ud55c \ube44\ubc00\ubc88\ud638\ub85c \uc811\uc18d\ud569\ub2c8\ub2e4.</p> <p>\ud3b8\ud558\uac8c \ubd99\uc5ec\ub123\uae30 \uc704\ud574\uc11c ssh \uc811\uc18d \uc124\uc815\uc744 \ud65c\uc131\ud654\ud574\uc90d\ub2c8\ub2e4. (\uae30\uc874 \ud130\ubbf8\ub110\uc740 \uae00\uc790\uac00 \ubc00\ub9bd\ub2c8\ub2e4.)</p> <p>\uae30\ubcf8 \uc774\ubbf8\uc9c0\uc5d0 \ud0a4\uac00 \uc5c6\ub294 \uacbd\uc6b0\uac00 \uc788\uc5b4\uc11c \ud0a4\ubd80\ud130 \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <pre><code># \ucd9c\ub825 \uacb0\uacfc\uac00 \uc5c6\ub2e4\uba74 \ud0a4\ub97c \ub9cc\ub4e4\uc5b4\uc918\uc57c \ud569\ub2c8\ub2e4.\nls -l /etc/ssh/ssh_host_*\n</code></pre> <pre><code># \ud0a4 \uc0dd\uc131\nssh-keygen -A\n\n# sshd \uc124\uc815 \uc911 \uc544\ub798 \ub450 \ud56d\ubaa9\uc744 yes\ub85c \ubcc0\uacbd\nvi /etc/ssh/sshd_config\n...\nPermitRootLogin yes\nPasswordAuthentication yes\n...\n\n# Override \ud558\ub294 \uc124\uc815 \ud30c\uc77c \uc81c\uac70\nrm -f /etc/ssh/sshd_config.d/60-cloudimg-settings.conf\n\n# ssh \uc7ac\uc2dc\uc791\nsystemctl restart ssh\n\n# \uc124\uc815 \ud655\uc778\nsshd -T | grep passwordauthentication\n</code></pre> <pre><code># \uc0c1\ud0dc \ud655\uc778\nsystemctl status ssh\n\n# \ud639\uc2dc disable\uc774\ub77c\uba74 enable\ub85c \ubcc0\uacbd\nsystemctl enable ssh\n</code></pre> <p>\uc544\ub798 \uba85\ub839 \uc2e4\ud589 \uc2dc, ens3\uacfc \uac19\uc740 \ub124\ud2b8\uc6cc\ud06c\uac00 DOWN \uc0c1\ud0dc\ub77c\uba74 \uc544\ub798 \uc870\uce58\ub97c \ucde8\ud569\ub2c8\ub2e4.</p> <pre><code>ip a\n</code></pre> <p>ens3\uc740 \uc2e4\uc81c \ub124\ud2b8\uc6cc\ud06c \uc774\ub984\uc73c\ub85c \ubcc0\uacbd\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># \uc778\ud130\ud398\uc774\uc2a4 \ucf1c\uae30\nip link set ens3 up\n\n# IP \uc8fc\uc18c \ud560\ub2f9(10.0.2.15\ub294 KVM \uae30\ubcf8 IP)\nip addr add 10.0.2.15/24 dev ens3\n\n# \uac8c\uc774\ud2b8\uc6e8\uc774 \uc5f0\uacb0\nip route add default via 10.0.2.2\n\n# DNS \uc124\uc815\necho \"nameserver 8.8.8.8\" &gt; /etc/resolv.conf\n</code></pre> <pre><code># \ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0 \ud655\uc778\nping -c 3 8.8.8.8\n</code></pre>"},{"location":"openstack/common/golden-image/#32-rockyrhel","title":"3.2 Rocky/RHEL","text":"<p>Rocky\ub294 CPU\uc758 \uc5ec\ub7ec \uae30\ub2a5\uc744 \uc694\uad6c\ud569\ub2c8\ub2e4. \ub530\ub77c\uc11c \uc544\ub798\uc640 \uac19\uc774 \ud638\uc2a4\ud2b8 CPU\ub97c \uadf8\ub300\ub85c VM\uc5d0 \uc804\ub2ec\ud558\ub3c4\ub85d <code>-cpu host</code> \uc635\uc158\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code>sudo kvm -m 4096 -smp 2 -cpu host -hda rocky-9-base.qcow2 -net nic -net user,hostfwd=tcp::2222-:22 -nographic\n</code></pre> <p>ssh \uc811\uc18d\uc744 \uc704\ud574 \uc124\uc815\uc744 \ubcc0\uacbd\ud569\ub2c8\ub2e4.</p> <pre><code># sshd \uc124\uc815 \uc911 \uc544\ub798 \ub450 \ud56d\ubaa9\uc744 yes\ub85c \ubcc0\uacbd\nvi /etc/ssh/sshd_config\n\n...\nPermitRootLogin yes\nPasswordAuthentication yes\n...\n\n# ssh \uc7ac\uc2dc\uc791\nsystemctl restart sshd\n</code></pre> <p>\uc0c8\ub85c\uc6b4 \ud130\ubbf8\ub110\uc744 \uc5f4\uc5b4 ssh\ub85c \uc811\uc18d\ud569\ub2c8\ub2e4.</p> <pre><code>ssh root@localhost -p 2222\n</code></pre> <p>\uc791\uc5c5 \uc911 VM\uc744 \uba48\ucd94\uac70\ub098 \uc885\ub8cc\ud558\uace0 \uc2f6\ub2e4\uba74 <code>Ctrl + A</code> \ud0a4\ub97c  \ub20c\ub800\ub2e4\uac00 \ub5bc\uace0, \ubc14\ub85c <code>x</code> \ud0a4\ub97c \ub204\ub974\uba74 KVM\uc774 \uac15\uc81c \uc885\ub8cc\ub429\ub2c8\ub2e4.</p>"},{"location":"openstack/common/golden-image/#kvm","title":"KVM \uad00\ub828 \uc624\ub958","text":""},{"location":"openstack/common/golden-image/#1-lock","title":"1 ) <code>Lock</code> \uc624\ub958","text":"<p>KVM \ubd80\ud305 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uac70\ub098, <code>lock</code> \uc624\ub958\uac00 \ubc1c\uc0dd\ud55c\ub2e4\uba74 \ud504\ub85c\uc138\uc2a4\ub97c \uc8fd\uc774\uace0 \ub2e4\uc2dc \uc704 \uacfc\uc815\uc744 \uc9c4\ud589\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># \uc2e4\ud589 \uc911\uc778 kvm \ud504\ub85c\uc138\uc2a4 \ud655\uc778\nps -ef | grep kvm\n</code></pre> <pre><code># 'ubuntu-24.04-base.qcow2'\uac00 \ud3ec\ud568\ub41c \ubaa8\ub4e0 \ud504\ub85c\uc138\uc2a4 \uac15\uc81c \uc885\ub8cc\npkill -f ubuntu-24.04-base.qcow2\n\n# \ub9cc\uc57d \uc704\uc5d0 \uba85\ub839\uc774 \uc2e4\ud589\ub418\uc9c0 \uc54a\ub294\ub2e4\uba74\npkill -9 &lt;PID&gt;\n</code></pre>"},{"location":"openstack/common/golden-image/#2-kvm-vm","title":"2) KVM \uc6a9\ub7c9\uc744 \ub298\ub824\ub3c4 VM \uc6a9\ub7c9\uc774 \ub3d9\uc77c\ud55c \uacbd\uc6b0","text":"<p>\ud604\uc7ac \uc544\ub798 \uba85\ub839\uc744 \ud1b5\ud574 <code>sda</code> \ub294 \ub298\ub9b0 \uc6a9\ub7c9\uc778\ub370, <code>sda1</code> \uc774 \uc5ec\uc804\ud788 \uadf8\ub300\ub85c\uc778 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code># \ud604\uc7ac \uc0c1\ud669 \ud655\uc778\nlsblk\n</code></pre> <p>\uc6b0\uc120 \ud30c\ud2f0\uc158\uc744 \ub514\uc2a4\ud06c \ub05d\uae4c\uc9c0 \ub298\ub9bd\ub2c8\ub2e4.</p> <pre><code>growpart /dev/sda 1\n</code></pre> <p>\ub298\uc5b4\ub09c \ud30c\ud2f0\uc158\uc5d0 \ub9de\ucdb0\uc11c \ud30c\uc77c\uc2dc\uc2a4\ud15c\uc744 \ud655\uc7a5\ud569\ub2c8\ub2e4.</p> <pre><code>resize2fs /dev/sda1\n</code></pre> <p>\uc6a9\ub7c9\uc774 \ub298\uc5b4\ub0ac\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>df -h\n</code></pre>"},{"location":"openstack/common/golden-image/#4-vm","title":"4. VM \ub0b4\ubd80 \uc124\uc815 \ubcc0\uacbd","text":"<p>OpenStack\uc758 Horizon \ucf58\uc194 \ub85c\uadf8 \ud655\uc778 \ubc0f \ud558\uc774\ud37c\ubc14\uc774\uc800 \ud1b5\uc2e0\uc744 \uc704\ud574 \uc544\ub798 \uc124\uc815\uc774 \ubaa8\ub4e0 \uc774\ubbf8\uc9c0\uc5d0 \uc801\uc6a9\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/common/golden-image/#41-serial-console-openstack","title":"4.1 Serial Console \ud65c\uc131\ud654 (OpenStack \ud544\uc218)","text":"<p>OpenStack \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \ub85c\uadf8\ub97c \ubcf4\ub824\uba74 \ucee4\ub110 \ud30c\ub77c\ubbf8\ud130 \uc218\uc815\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.</p> <p>Ubuntu/Debian:</p> <pre><code># /etc/default/grub \ud30c\uc77c \uc218\uc815\nsed -i 's/GRUB_CMDLINE_LINUX_DEFAULT=\".*\"/GRUB_CMDLINE_LINUX_DEFAULT=\"console=tty1 console=ttyS0,115200n8\"/' /etc/default/grub\n\n# \uc218\uc815 \ub0b4\uc6a9 \uc801\uc6a9\nupdate-grub\n</code></pre> <p>RHEL/Rocky/CentOS:</p> <pre><code># /etc/default/grub \ud30c\uc77c \uc218\uc815\ncat &gt; /etc/default/grub &lt;&lt; 'EOF'\nGRUB_TIMEOUT=1\nGRUB_DISTRIBUTOR=\"$(sed 's, release .*$,,g' /etc/system-release)\"\nGRUB_DEFAULT=saved\nGRUB_DISABLE_SUBMENU=true\nGRUB_TERMINAL_OUTPUT=\"console\"\nGRUB_CMDLINE_LINUX=\"crashkernel=auto console=tty1 console=ttyS0,115200n8\"\nGRUB_DISABLE_RECOVERY=\"true\"\nGRUB_ENABLE_BLSCFG=true\nEOF\n\n# \uc218\uc815 \ub0b4\uc6a9 \uc801\uc6a9\ngrub2-mkconfig -o /boot/grub2/grub.cfg\n</code></pre>"},{"location":"openstack/common/golden-image/#42","title":"4.2 \uae30\ubcf8 \ud328\ud0a4\uc9c0 \uc124\uce58","text":"<p>VMware Tools \ub300\uc2e0 QEMU Guest Agent\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <p>Ubuntu/Debian:</p> <pre><code># DNS \uc11c\ubc84 \uc218\ub3d9 \ub4f1\ub85d\necho \"nameserver 8.8.8.8\" &gt; /etc/resolv.conf\n\n# \ud544\uc218 \ud328\ud0a4\uc9c0 \uc124\uce58\napt update\napt install -y qemu-guest-agent cloud-init\n</code></pre> <p>Rocky/RHEL:</p> <pre><code># DNS \uc11c\ubc84 \uc218\ub3d9 \ub4f1\ub85d\necho \"nameserver 8.8.8.8\" &gt; /etc/resolv.conf\n\n# \ud544\uc218 \ud328\ud0a4\uc9c0 \uc124\uce58\nyum install -y qemu-guest-agent cloud-init\n</code></pre>"},{"location":"openstack/common/golden-image/#5","title":"5. \uc635\uc158 \uc18c\ud504\ud2b8\uc6e8\uc5b4 \uc124\uce58","text":""},{"location":"openstack/common/golden-image/#51-docker","title":"5.1 \uc635\uc158: Docker \uc124\uce58","text":"<p>Docker\ub97c \ud3ec\ud568\ud558\ub294 \uacbd\uc6b0\uc5d0\ub9cc \uc774 \ub2e8\uacc4\ub97c \uc218\ud589\ud558\uc138\uc694.</p> <p>Ubuntu/Debian:</p> <pre><code># 1. \ud544\uc218 \ud328\ud0a4\uc9c0 \ubc0f GPG Key \uc124\uc815\napt-get install -y ca-certificates curl\ninstall -m 0755 -d /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nchmod a+r /etc/apt/keyrings/docker.asc\n\n# 2. \uc800\uc7a5\uc18c \ucd94\uac00\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n  $(. /etc/os-release &amp;&amp; echo \"$VERSION_CODENAME\") stable\" | \\\n  tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\napt-get update\n\n# 3. Docker \uc124\uce58\napt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# 4. \ud65c\uc131\ud654\nsystemctl enable --now docker\n\n# -------------------------------------------------------\n# [GPU \uc774\ubbf8\uc9c0\uc778 \uacbd\uc6b0\ub9cc] NVIDIA Container Toolkit \uc124\uce58\n# -------------------------------------------------------\n\n# 5. \uc800\uc7a5\uc18c \ucd94\uac00 \ubc0f \uc124\uce58\ncurl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \\\n  &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \\\n    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \\\n    tee /etc/apt/sources.list.d/nvidia-container-toolkit.list\n\napt-get update\napt-get install -y nvidia-container-toolkit\n\n# 6. Docker \uc124\uc815 \ubc0f \uc7ac\uc2dc\uc791\nnvidia-ctk runtime configure --runtime=docker\nsystemctl restart docker\n</code></pre> <p>Rocky/RHEL:</p> <pre><code># 1. Docker \uc800\uc7a5\uc18c \ucd94\uac00\ndnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n\n# 2. Docker \uc5d4\uc9c4 \uc124\uce58\ndnf install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# \uc635\uc158. Rocky 10\uc758 \uacbd\uc6b0 \uc544\ub798 \ud328\ud0a4\uc9c0\ub3c4 \uc124\uce58\ndnf install -y iptables-nft iptables-services\n\n# 3. Docker \uc2e4\ud589 \ubc0f \uc790\ub3d9 \uc2dc\uc791 \uc124\uc815\nsystemctl enable --now docker\n\n# -------------------------------------------------------\n# [GPU \uc774\ubbf8\uc9c0\uc778 \uacbd\uc6b0\ub9cc] NVIDIA Container Toolkit \uc124\uce58\n# (Docker\uac00 GPU\ub97c \uc4f0\uac8c \ud574\uc8fc\ub294 \ud544\uc218 \ub3c4\uad6c\uc785\ub2c8\ub2e4)\n# -------------------------------------------------------\n\n# 4. NVIDIA Toolkit \uc800\uc7a5\uc18c \ucd94\uac00\ncurl -s -L https://nvidia.github.io/libnvidia-container/stable/rpm/nvidia-container-toolkit.repo | \\\n  tee /etc/yum.repos.d/nvidia-container-toolkit.repo\n\n# 5. Toolkit \uc124\uce58\ndnf install -y nvidia-container-toolkit\n\n# 6. Docker\uac00 NVIDIA Runtime\uc744 \uc4f0\ub3c4\ub85d \uc124\uc815 (\uc911\uc694!)\n# \uc774 \uba85\ub839\uc5b4\uac00 /etc/docker/daemon.json \ud30c\uc77c\uc744 \uc790\ub3d9\uc73c\ub85c \uc218\uc815\ud574\uc90d\ub2c8\ub2e4.\nnvidia-ctk runtime configure --runtime=docker\n\n# 7. \uc801\uc6a9\uc744 \uc704\ud574 Docker \uc7ac\uc2dc\uc791\nsystemctl restart docker\n</code></pre>"},{"location":"openstack/common/golden-image/#52-nvidia-gpu","title":"5.2 \uc635\uc158: NVIDIA GPU \ub4dc\ub77c\uc774\ubc84 \uc124\uce58","text":"<p>GPU \ubc84\uc804 \uc774\ubbf8\uc9c0\ub97c \uc0dd\uc131\ud560 \ub54c\ub9cc \uc774 \ub2e8\uacc4\ub97c \uc218\ud589\ud558\uc138\uc694. CPU \uc804\uc6a9 \uc774\ubbf8\uc9c0\ub294 \uc774 \ub2e8\uacc4\ub97c \uac74\ub108\ub701\ub2c8\ub2e4.</p> <p>\uc804\uc81c: \uc778\uc2a4\ud134\uc2a4\uc5d0 \uc774\ubbf8 NVIDIA GPU\uac00 Passthrough \ub418\uc5b4 \uc788\uac70\ub098, \ub85c\uceec\uc5d0\uc11c \ub4dc\ub77c\uc774\ubc84 \ube4c\ub4dc \ud658\uacbd\uc774 \uac16\ucdb0\uc838\uc57c \ud569\ub2c8\ub2e4.</p> <p>Ubuntu/Debian:</p> <pre><code># 1. Nouveau \ube14\ub799\ub9ac\uc2a4\ud2b8 \ucc98\ub9ac\ncat &lt;&lt;EOF &gt; /etc/modprobe.d/blacklist-nouveau.conf\nblacklist nouveau\noptions nouveau modeset=0\nEOF\n\n# \uc635\uc158. RTX \uacc4\uc5f4\uc758 \uac1c\uc778 GPU \uc0ac\uc6a9 \uc2dc MSI \ube44\ud65c\uc131\ud654\necho \"options nvidia NVreg_EnableMSI=0\" | sudo tee /etc/modprobe.d/nvidia.conf\n\n# 2. \ubcc0\uacbd \uc0ac\ud56d \ucee4\ub110\uc5d0 \uc801\uc6a9\nupdate-initramfs -u\n\n# 3. \ube4c\ub4dc \uc758\uc874\uc131 \ud328\ud0a4\uc9c0 \uc124\uce58\napt-get install -y build-essential linux-headers-$(uname -r) pkg-config libglvnd-dev\n\n# 4. NVIDIA \ub4dc\ub77c\uc774\ubc84 \ub2e4\uc6b4\ub85c\ub4dc\ncd /root\nwget https://us.download.nvidia.com/XFree86/Linux-x86_64/550.127.05/NVIDIA-Linux-x86_64-550.127.05.run\nchmod +x NVIDIA-Linux-x86_64-*.run\n\n# 5. \ub4dc\ub77c\uc774\ubc84 \uc124\uce58 (\ud558\ub4dc\uc6e8\uc5b4 \uc5c6\uc774 \uc124\uce58)\n# \ub098\uc911\uc5d0 \ub85c\uadf8\uc778\ud574\uc11c 'install-gpu'\ub9cc \uce58\uba74 \uc124\uce58\ub418\ub3c4\ub85d \uc124\uc815\necho \"alias install-gpu='/root/NVIDIA-Linux-x86_64-*.run --silent --dkms &amp;&amp; echo \\\"\uc124\uce58 \uc644\ub8cc! nvidia-smi\ub97c \uc785\ub825\ud574\ubcf4\uc138\uc694.\\\"' \" &gt;&gt; /root/.bashrc\n</code></pre> <p>Rocky/RHEL:</p> <pre><code># 1. Nouveau(\uc624\ud508\uc18c\uc2a4 \ub4dc\ub77c\uc774\ubc84) \ube14\ub799\ub9ac\uc2a4\ud2b8 \ucc98\ub9ac\ncat &lt;&lt;EOF &gt; /etc/modprobe.d/blacklist-nouveau.conf\nblacklist nouveau\noptions nouveau modeset=0\nEOF\n\n# \uc635\uc158. RTX \uacc4\uc5f4\uc758 \uac1c\uc778 GPU \uc0ac\uc6a9 \uc2dc MSI \ube44\ud65c\uc131\ud654\necho \"options nvidia NVreg_EnableMSI=0\" | sudo tee /etc/modprobe.d/nvidia.conf\n\n# 2. \ubcc0\uacbd \uc0ac\ud56d \ucee4\ub110\uc5d0 \uc801\uc6a9 (initramfs \uac31\uc2e0)\ndracut --force\n\n# 3. \ube4c\ub4dc \uc758\uc874\uc131 \ud328\ud0a4\uc9c0 \uc124\uce58\n# (\ub4dc\ub77c\uc774\ubc84 \ucef4\ud30c\uc77c\uc744 \uc704\ud574 gcc, make, kernel source \ub4f1\uc774 \ud544\uc694\ud568)\nyum groupinstall -y \"Development Tools\"\nyum install -y epel-release\nyum update -y  # \ucee4\ub110 \ucd5c\uc2e0\ud654 (\uc911\uc694)\nyum install -y kernel-devel kernel-headers dkms gcc make wget pciutils\n\n# \ub4dc\ub77c\uc774\ubc84 \ub2e4\uc6b4\ub85c\ub4dc\ncd /root\nwget https://us.download.nvidia.com/XFree86/Linux-x86_64/550.127.05/NVIDIA-Linux-x86_64-550.127.05.run\nchmod +x NVIDIA-Linux-x86_64-*.run\n\n# 5. \ub4dc\ub77c\uc774\ubc84 \uc124\uce58 (\ud558\ub4dc\uc6e8\uc5b4 \uc5c6\uc774 \uc124\uce58)\n# --silent: \ubb34\uc778 \uc124\uce58\n# \ub098\uc911\uc5d0 \ub85c\uadf8\uc778\ud574\uc11c 'install-gpu'\ub9cc \uce58\uba74 \uc124\uce58\ub418\ub3c4\ub85d \uc124\uc815\necho \"alias install-gpu='/root/NVIDIA-Linux-x86_64-*.run --silent --dkms &amp;&amp; echo \\\"\uc124\uce58 \uc644\ub8cc! nvidia-smi\ub97c \uc785\ub825\ud574\ubcf4\uc138\uc694.\\\"' \" &gt;&gt; /root/.bashrc\n</code></pre>"},{"location":"openstack/common/golden-image/#6-vm","title":"6. VM \uc815\ub9ac \uc791\uc5c5","text":"<p><code>Cloud-init</code> \uc774 \uc815\uc0c1\uc801\uc73c\ub85c \uc791\ub3d9\ud558\ub3c4\ub85d \uc124\uc815\ub4e4\uc744 \ucd08\uae30\ud654 \ud569\ub2c8\ub2e4.</p> <p>Ubuntu/Debian:</p> <pre><code># 1. DataSource \uc124\uc815\ncat &gt; /etc/cloud/cloud.cfg.d/90_datasource.cfg &lt;&lt; 'EOF'\ndatasource_list: [ OpenStack, ConfigDrive, None ]\nEOF\n\n# 2. SSH \ubcf4\uc548 \uc124\uc815\n# (Ubuntu\ub294 \uc11c\ube44\uc2a4\uba85\uc774 'ssh' \uc785\ub2c8\ub2e4)\nsed -i 's/^#*PermitRootLogin.*/PermitRootLogin prohibit-password/' /etc/ssh/sshd_config\nsed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' /etc/ssh/sshd_config\nsystemctl restart ssh\n\n# 3. \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \ucd08\uae30\ud654\n# Netplan \uc124\uc815 \uc0ad\uc81c\nrm -f /etc/netplan/*.yaml\n# \uad6c\ubc84\uc804 \uc778\ud130\ud398\uc774\uc2a4 \uc124\uc815 \uc0ad\uc81c\nrm -f /etc/network/interfaces.d/*\n\n# 4. \uace0\uc720 \uc2dd\ubcc4\uc790 \ubc0f Cloud-init \ucd08\uae30\ud654\nrm -f /etc/udev/rules.d/70-persistent-net.rules\nrm -f /etc/ssh/ssh_host_*key*\ntruncate -s 0 /etc/machine-id\nrm -f /var/lib/dbus/machine-id\n\n# Cloud-init \ub370\uc774\ud130 \uc0ad\uc81c\nrm -rf /var/lib/cloud/*\nrm -rf /var/log/cloud-init*\n\n# 5. \ud328\ud0a4\uc9c0 \uce90\uc2dc \uc815\ub9ac\napt-get clean\nrm -rf /var/lib/apt/lists/*\n</code></pre> <p>Rocky/RHEL:</p> <pre><code># 1. DataSource \uc124\uc815 (OpenStack \ucd5c\uc6b0\uc120)\ncat &gt; /etc/cloud/cloud.cfg.d/90_datasource.cfg &lt;&lt; 'EOF'\ndatasource_list: [ OpenStack, ConfigDrive, None ]\nEOF\n\n# 2. SSH \ubcf4\uc548 \uc124\uc815 (\ud074\ub77c\uc6b0\ub4dc \ud45c\uc900: \ud328\uc2a4\uc6cc\ub4dc \uc778\uc99d \ube44\ud65c\uc131\ud654)\n# (Root \ub85c\uadf8\uc778\uc740 \ubcf4\uc548 \uc815\ucc45\uc5d0 \ub530\ub77c 'prohibit-password' \ub610\ub294 'yes'\ub85c \uc124\uc815)\nsed -i 's/^#*PermitRootLogin.*/PermitRootLogin prohibit-password/' /etc/ssh/sshd_config\nsed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' /etc/ssh/sshd_config\nsystemctl restart sshd\n\n# 3. \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \ucd08\uae30\ud654 (\uae30\uc874 IP \uc815\ubcf4 \uc0ad\uc81c)\n# NetworkManager \uc5f0\uacb0 \uc815\ubcf4 \uc0ad\uc81c\nrm -f /etc/NetworkManager/system-connections/*.nmconnection\n# \uad6c\ubc84\uc804 \uc2a4\ud06c\ub9bd\ud2b8\uac00 \uc788\ub2e4\uba74 \uc0ad\uc81c (ifcfg-lo \uc81c\uc678)\nrm -f /etc/sysconfig/network-scripts/ifcfg-e*\n\n# 4. \uace0\uc720 \uc2dd\ubcc4\uc790 \ubc0f Cloud-init \ucd08\uae30\ud654\nrm -f /etc/udev/rules.d/70-persistent-net.rules\nrm -f /etc/ssh/ssh_host_*key*\ntruncate -s 0 /etc/machine-id\nrm -f /var/lib/dbus/machine-id\n\n# Cloud-init \ub370\uc774\ud130 \uc0ad\uc81c (\uc7ac\ubd80\ud305 \uc2dc \uc0c8\ub85c \ubc1b\uae30 \uc704\ud568)\nrm -rf /var/lib/cloud/*\nrm -rf /var/log/cloud-init*\n\n# 5. \ud328\ud0a4\uc9c0 \uce90\uc2dc \uc815\ub9ac\nyum clean all\nrm -rf /var/cache/yum\n</code></pre>"},{"location":"openstack/common/golden-image/#7","title":"7. \ucd5c\uc885 \uc815\ub9ac \ubc0f \uc774\ubbf8\uc9c0 \ubcc0\ud658","text":"<p>\ubaa8\ub4e0 \uc124\uc815\uc774 \ub05d\ub0ac\uc73c\uba74 \ub9c8\uc9c0\ub9c9\uc73c\ub85c cloud-init\uc744 \ucd08\uae30\ud654\ud558\uace0 VM\uc744 \uc885\ub8cc\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/common/golden-image/#71","title":"7.1 \ucd5c\uc885 \uba85\ub839\uc5b4","text":"<pre><code># \ub85c\uadf8 \ud30c\uc77c \ube44\uc6b0\uae30\nfind /var/log -type f -exec truncate -s 0 {} \\;\n\n# cloud-init \uc815\ub9ac (\uac00\uc7a5 \uc911\uc694)\ncloud-init clean --logs\n\n# history \uc0ad\uc81c\nhistory -c\n\n# \uc2dc\uc2a4\ud15c \uc885\ub8cc (\uc7ac\ubd80\ud305 \ud558\uc9c0 \ub9c8\uc138\uc694!)\nshutdown -h now\n</code></pre>"},{"location":"openstack/common/golden-image/#72-glance-openstack-cli","title":"7.2 Glance \uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc (OpenStack CLI)","text":"<p>VM \uc774\ubbf8\uc9c0 \ud30c\uc77c(qcow2 \ub4f1)\uc744 OpenStack Glance\uc5d0 \uc5c5\ub85c\ub4dc\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \uc774\ubbf8\uc9c0 \uc555\ucd95 (Shrink)\n# \uc6d0\ubcf8(base) -&gt; \ucd5c\uc885\ubcf8(golden)\nqemu-img convert -c -O qcow2 ubuntu-24.04-base.qcow2 ubuntu-24.04-golden.qcow2\n\n# 2. \uc6a9\ub7c9 \ud655\uc778 (\ud655 \uc904\uc5b4\ub4e4\uc5c8\ub294\uc9c0 \ud655\uc778)\nls -lh ubuntu-24.04-golden.qcow2\n</code></pre> <p>CPU \uc804\uc6a9 \uc774\ubbf8\uc9c0:</p> <pre><code>openstack image create \"Ubuntu-24.04-Golden\" \\\n  --file ubuntu-24.04-golden.qcow2 \\\n  --disk-format qcow2 \\\n  --container-format bare \\\n  --public \\\n  --property hw_machine_type=q35 \\\n  --property hw_qemu_guest_agent=yes\n</code></pre> <p>GPU \ud3ec\ud568 \uc774\ubbf8\uc9c0 (\uba54\ud0c0\ub370\uc774\ud130 \uc911\uc694): OpenStack Nova\uac00 GPU\ub97c \uc801\uc808\ud788 \uc2a4\ucf00\uc904\ub9c1\ud558\ub3c4\ub85d \uba54\ud0c0\ub370\uc774\ud130\ub97c \ucd94\uac00\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code>openstack image create \"Ubuntu-24.04-Golden-GPU\" \\\n  --file ubuntu-24.04-golden.qcow2 \\\n  --disk-format qcow2 \\\n  --container-format bare \\\n  --public \\\n  --property hw_video_model=vga \\\n  --property hw_machine_type=q35 \\\n  --property hw_qemu_guest_agent=yes\n</code></pre> <p>\ub9cc\uc57d RTX \uacc4\uc5f4\uc758 \uac1c\uc778\uc6a9 GPU \uc0ac\uc6a9\ud55c\ub2e4\uba74 \uc774\ubbf8\uc9c0 \ud639\uc740 flavor\uc5d0 <code>--property hw:kvm_hidden=true</code> \uac12\uc744 \ub123\uc5b4\uc8fc\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/common/golden-image/#8-gpu","title":"8. \uc635\uc158: GPU \ub4dc\ub77c\uc774\ubc84 \uc124\uce58","text":"<p>GPU \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131\ud558\uace0, \ud50c\ub85c\ud305 IP\ub97c \uc5f0\uacb0\ud558\uc5ec VM \ub0b4\ubd80\uc5d0 \uc811\uc18d\ud55c \ub4a4, \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\uc2dc\ud0b5\ub2c8\ub2e4.</p> <pre><code># root \uacc4\uc815 \uc0ac\uc6a9\nsudo su -\n</code></pre> <pre><code># \uc0ac\uc804\uc5d0 \ubc1b\uc544\ub454 nvidia \ub4dc\ub77c\uc774\ubc84 \uc124\uce58\ninstall-gpu\n</code></pre>"},{"location":"openstack/common/golden-image/#rtx-gpu-reset-bug","title":"RTX \uacc4\uc5f4 GPU \uc0ac\uc6a9 \uc2dc \ubb38\uc81c\uc810(Reset Bug)","text":"<p>RTX \uacc4\uc5f4\uacfc \uac19\uc740 \uc18c\ube44\uc790\uc6a9 GPU\ub294 \uac00\uc0c1\ud654 \ud658\uacbd\uc744 \uace0\ub824\ud558\uc9c0 \uc54a\uae30\uc5d0 FLR(Function Level Reset) \uae30\ub2a5\uc744 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c GPU \uc778\uc2a4\ud134\uc2a4\ub97c \uc885\ub8cc\ud558\uac70\ub098 \uc7ac\ubd80\ud305\ud558\uba74, GPU \ud558\ub4dc\uc6e8\uc5b4\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uace0 Stuck \uc0c1\ud0dc\ub85c \ub0a8\uc544 \ub370\uc774\ud130 \ucc0c\uaebc\uae30\ub97c \uac00\uc9c0\uace0 \uc788\ub2e4\uac00 VM\uc758 \ub2e4\uc74c \ub3d9\uc791\uc744 \ubc29\ud574\ud558\uace0, \uc774\ub97c \ud638\uc2a4\ud2b8\uac00 \uc751\ub2f5\uc774 \uc5c6\ub294 \uac83\uc73c\ub85c \uc778\uc2dd\ud558\uace0 \uc778\uc2a4\ud134\uc2a4\ub97c PAUSED \uc0c1\ud0dc\ub85c \uac15\uc81c \uc815\uc9c0\uc2dc\ucf1c\ubc84\ub9bd\ub2c8\ub2e4.</p> <p>\uc704\uc5d0\uc11c RTX \uacc4\uc5f4 GPU\ub97c \uc704\ud55c \uc124\uc815\uc744 \ucd94\uac00\ud588\uc9c0\ub9cc, \uc774\uac83\ub9cc\uc73c\ub85c \ubb38\uc81c\ub97c \ub9c9\uc744 \uc218\ub294 \uc5c6\uc2b5\ub2c8\ub2e4. FLR \uae30\ub2a5\uc774 \uc5c6\ub294 \ud55c \uc7ac\ubd80\ud305 \ud639\uc740 \uc0ad\uc81c \uc2dc \ub192\uc740 \ud655\ub960\ub85c \ud558\ub4dc\uc6e8\uc5b4 \ub9ac\uc14b \uc2e4\ud328\uac00 \ubc1c\uc0dd\ud558\uae30\uc5d0 RTX \uacc4\uc5f4 GPU\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294 \uac83\uc744 \uad8c\uc7a5\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/common/init-gpu-node/","title":"\ud83d\udda5\ufe0f GPU Passthrough\ub97c \uc704\ud55c OS \uc0ac\uc804 \uc124\uc815 \uac00\uc774\ub4dc","text":"<p>\uc774 \uac00\uc774\ub4dc\ub294 OpenStack Compute \ub178\ub4dc\uc5d0\uc11c GPU\ub97c \uac00\uc0c1 \uba38\uc2e0(VM)\uc5d0 \uc9c1\uc811 \ud560\ub2f9(Passthrough)\ud558\uae30 \uc704\ud574 \ud544\uc694\ud55c \ucee4\ub110 \ubc0f \ub4dc\ub77c\uc774\ubc84 \uc124\uc815 \uc808\ucc28\uc785\ub2c8\ub2e4.</p>"},{"location":"openstack/common/init-gpu-node/#_1","title":"\ud83d\udcdd \ubcc0\uc218 \uc815\uc758 (\uce58\ud658 \ud544\uc694)","text":"<ul> <li><code>&lt;VENDOR_ID&gt;</code> : GPU \uc81c\uc870\uc0ac ID (\uc608: NVIDIA\uc758 \uacbd\uc6b0 <code>10de</code>)</li> <li><code>&lt;PRODUCT_ID&gt;</code> : GPU \ubaa8\ub378 ID (\uc608: <code>20b7</code>)</li> </ul>"},{"location":"openstack/common/init-gpu-node/#1-iommu-grub","title":"1\ub2e8\uacc4: IOMMU \ud65c\uc131\ud654 (Grub \uc124\uc815)","text":"<p>CPU\uc758 \uac00\uc0c1\ud654 \uae30\ub2a5\uc744 \ud65c\uc131\ud654\ud558\uace0, \ud638\uc2a4\ud2b8 OS\uac00 GPU\ub97c \uc810\uc720\ud558\uc9c0 \uc54a\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/common/init-gpu-node/#1","title":"1. \uc124\uc815 \ud30c\uc77c \uc218\uc815 (\uacf5\ud1b5)","text":"<p><code>/etc/default/grub</code> \ud30c\uc77c\uc744 \uc5f4\uc5b4 <code>GRUB_CMDLINE_LINUX</code> \ub77c\uc778\uc744 \uc218\uc815\ud569\ub2c8\ub2e4.</p> <pre><code># \uc778\ud154 CPU \uae30\uc900 \uc124\uc815 (AMD\uc758 \uacbd\uc6b0 intel_iommu \ub300\uc2e0 amd_iommu=on \uc0ac\uc6a9)\n# \uae30\uc874 \ub77c\uc778 \ub4a4\uc5d0 \uc544\ub798 \uc635\uc158\ub4e4\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4.\n# nouveau, nvidia \ub4dc\ub77c\uc774\ubc84\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\ub3c4\ub85d blacklist \ucc98\ub9ac\ud569\ub2c8\ub2e4.\nGRUB_CMDLINE_LINUX=\"... intel_iommu=on iommu=pt modprobe.blacklist=nouveau,nvidia,nvidia_drm\"\n</code></pre>"},{"location":"openstack/common/init-gpu-node/#2-grub-os","title":"2. Grub \uc801\uc6a9 \ubc0f \uc7ac\ubd80\ud305 (OS\ubcc4 \uc120\ud0dd)","text":"<p>\ud83c\udd70\ufe0f Ubuntu 22.04:</p> <pre><code>sudo update-grub\nsudo reboot\n</code></pre> <p>\ud83c\udd71\ufe0f Rocky Linux:</p> <pre><code># BIOS \ubaa8\ub4dc\uc77c \uacbd\uc6b0\nsudo grub2-mkconfig -o /boot/grub2/grub.cfg\n# UEFI \ubaa8\ub4dc\uc77c \uacbd\uc6b0 (\ub300\ubd80\ubd84\uc758 \ucd5c\uc2e0 \uc11c\ubc84)\nsudo grub2-mkconfig -o /boot/efi/EFI/rocky/grub.cfg\n\nsudo reboot\n</code></pre>"},{"location":"openstack/common/init-gpu-node/#3-iommu","title":"3. IOMMU \ud65c\uc131\ud654 \ud655\uc778","text":"<p>\uc7ac\ubd80\ud305 \ud6c4 \uc124\uc815\uc774 \uc801\uc6a9\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>cat /proc/cmdline\n# \ucd9c\ub825 \uacb0\uacfc\uc5d0 intel_iommu=on \ub4f1\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\uc5b4\uc57c \ud568\n</code></pre>"},{"location":"openstack/common/init-gpu-node/#2-gpu-id","title":"2\ub2e8\uacc4: GPU \uc7a5\uce58 ID \ud655\uc778 \ubc0f \ubcc0\uc218 \ud655\ubcf4","text":"<p>\uc2dc\uc2a4\ud15c\uc5d0 \uc7a5\ucc29\ub41c GPU\uc758 PCI ID\ub97c \uc2dd\ubcc4\ud569\ub2c8\ub2e4.</p> <pre><code># NVIDIA GPU \uac80\uc0c9 \uc608\uc2dc\nlspci -nn | grep -i NVIDIA\n</code></pre> <p>\ucd9c\ub825 \uc608\uc2dc: <code>03:00.0 3D controller [0302]: NVIDIA Corporation ... [10de:20b7] ...</code></p> <ul> <li>\uc704 \uc608\uc2dc\uc5d0\uc11c <code>&lt;VENDOR_ID&gt;</code>\ub294 <code>10de</code>, <code>&lt;PRODUCT_ID&gt;</code>\ub294 <code>20b7</code>\uc785\ub2c8\ub2e4.</li> </ul>"},{"location":"openstack/common/init-gpu-node/#3-vfio","title":"3\ub2e8\uacc4: VFIO \ubaa8\ub4c8 \ub85c\ub4dc \uc124\uc815","text":"<p>GPU\ub97c \ud638\uc2a4\ud2b8 OS \ub300\uc2e0 VM\uc774 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub3c4\ub85d VFIO \ub4dc\ub77c\uc774\ubc84\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/common/init-gpu-node/#1_1","title":"1. \uc218\ub3d9 \ub85c\ub4dc (\ud14c\uc2a4\ud2b8\uc6a9)","text":"<pre><code>sudo modprobe vfio\nsudo modprobe vfio_iommu_type1\nsudo modprobe vfio-pci\n</code></pre>"},{"location":"openstack/common/init-gpu-node/#2-os","title":"2. \uc601\uad6c \uc801\uc6a9 \uc124\uc815 (OS\ubcc4 \uc120\ud0dd)","text":"<p>\ubd80\ud305 \uc2dc \uc790\ub3d9\uc73c\ub85c \ubaa8\ub4c8\uc774 \ub85c\ub4dc\ub418\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4.</p> <p>\ud83c\udd70\ufe0f Ubuntu 22.04:</p> <pre><code># /etc/modules \ud30c\uc77c \ud3b8\uc9d1\nsudo vi /etc/modules\n\n# \uc544\ub798 \ub0b4\uc6a9 \ucd94\uac00\nvfio\nvfio_iommu_type1\nvfio_pci\n</code></pre> <p>\ud83c\udd71\ufe0f Rocky Linux:</p> <pre><code># /etc/modules-load.d/vfio.conf \ud30c\uc77c \uc0dd\uc131\nsudo vi /etc/modules-load.d/vfio.conf\n\n# \uc544\ub798 \ub0b4\uc6a9 \ucd94\uac00\nvfio\nvfio_iommu_type1\nvfio-pci\n</code></pre>"},{"location":"openstack/common/init-gpu-node/#4-gpu-driver-binding","title":"4\ub2e8\uacc4: GPU \uc7a5\uce58 \ubc14\uc778\ub529 (Driver Binding)","text":"<p>\uc2dd\ubcc4\ud55c GPU ID\ub97c VFIO \ub4dc\ub77c\uc774\ubc84\uc5d0 \ubc14\uc778\ub529\ud558\uc5ec \ud638\uc2a4\ud2b8\uac00 \uc0ac\uc6a9\ud558\uc9c0 \ubabb\ud558\uac8c \ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/common/init-gpu-node/#1_2","title":"1. \ubc14\uc778\ub529 \uc124\uc815 \ud30c\uc77c \uc0dd\uc131 (\uacf5\ud1b5)","text":"<pre><code># /etc/modprobe.d/vfio.conf \ud30c\uc77c \uc0dd\uc131 \ub610\ub294 \uc218\uc815\nsudo vi /etc/modprobe.d/vfio.conf\n\n# \uc544\ub798 \ub0b4\uc6a9 \ucd94\uac00 (\ubcc0\uc218 \uce58\ud658 \ud544\uc694)\noptions vfio-pci ids=&lt;VENDOR_ID&gt;:&lt;PRODUCT_ID&gt;\n</code></pre>"},{"location":"openstack/common/init-gpu-node/#2-ramdisk-os","title":"2. \ub7a8\ub514\uc2a4\ud06c(Ramdisk) \uc5c5\ub370\uc774\ud2b8 \ubc0f \uc7ac\ubd80\ud305 (OS\ubcc4 \uc120\ud0dd)","text":"<p>\uc124\uc815 \ub0b4\uc6a9\uc744 \ucd08\uae30 \ubd80\ud305 \uc774\ubbf8\uc9c0\uc5d0 \ubc18\uc601\ud569\ub2c8\ub2e4.</p> <p>\ud83c\udd70\ufe0f Ubuntu 22.04:</p> <pre><code>sudo update-initramfs -u\nsudo reboot\n</code></pre> <p>\ud83c\udd71\ufe0f Rocky Linux:</p> <pre><code>sudo dracut -f\nsudo reboot\n</code></pre>"},{"location":"openstack/common/init-gpu-node/#5","title":"5\ub2e8\uacc4: \ucd5c\uc885 \uac80\uc99d","text":"<p>\uc7ac\ubd80\ud305 \ud6c4 GPU\uac00 <code>vfio-pci</code> \ub4dc\ub77c\uc774\ubc84\ub97c \uc0ac\uc6a9 \uc911\uc778\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/common/init-gpu-node/#1_3","title":"1. \ub4dc\ub77c\uc774\ubc84 \ud655\uc778","text":"<pre><code># Kernel driver in use\uac00 vfio-pci\ub85c \ub418\uc5b4 \uc788\uc5b4\uc57c \uc131\uacf5\nlspci -nnk -d &lt;VENDOR_ID&gt;:&lt;PRODUCT_ID&gt;\n</code></pre>"},{"location":"openstack/common/init-gpu-node/#2","title":"2. (\ud2b8\ub7ec\ube14\uc288\ud305) \ubc14\uc778\ub529\uc774 \uc548 \ub41c \uacbd\uc6b0 \uac15\uc81c \uc801\uc6a9","text":"<p>\ub9cc\uc57d \uc704 \ub2e8\uacc4 \ud6c4\uc5d0\ub3c4 \ub4dc\ub77c\uc774\ubc84\uac00 \uc7a1\ud788\uc9c0 \uc54a\ub294\ub2e4\uba74 \uc544\ub798 \uba85\ub839\uc5b4\ub85c \uac15\uc81c \ubc14\uc778\ub529\uc744 \uc2dc\ub3c4\ud569\ub2c8\ub2e4.</p> <pre><code>echo \"&lt;VENDOR_ID&gt; &lt;PRODUCT_ID&gt;\" | sudo tee /sys/bus/pci/drivers/vfio-pci/new_id\n</code></pre> <p>\uc774\ud6c4 \ub2e4\uc2dc <code>lspci -nnk</code> \uba85\ub839\uc5b4\ub85c \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/common/init-gpu-node/#rtx-gpu","title":"RTX \uacc4\uc5f4\uc758 GPU \uc0ac\uc6a9 \uc2dc","text":"<p>RTX \uacc4\uc5f4\uacfc \uac19\uc740 \uc18c\ube44\uc790\uc6a9 GPU\ub294 \uac00\uc0c1\ud654 \ud658\uacbd\uc744 \uace0\ub824\ud558\uc9c0 \uc54a\uae30\uc5d0 FLR(Function Level Reset) \uae30\ub2a5\uc744 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c GPU \uc778\uc2a4\ud134\uc2a4\ub97c \uc885\ub8cc\ud558\uac70\ub098 \uc7ac\ubd80\ud305\ud558\uba74, GPU \ud558\ub4dc\uc6e8\uc5b4\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uace0 Stuck \uc0c1\ud0dc\ub85c \ub0a8\uc544 \ub370\uc774\ud130 \ucc0c\uaebc\uae30\ub97c \uac00\uc9c0\uace0 \uc788\ub2e4\uac00 VM\uc758 \ub2e4\uc74c \ub3d9\uc791\uc744 \ubc29\ud574\ud558\uace0, \uc774\ub97c \ud638\uc2a4\ud2b8\uac00 \uc751\ub2f5\uc774 \uc5c6\ub294 \uac83\uc73c\ub85c \uc778\uc2dd\ud558\uace0 \uc778\uc2a4\ud134\uc2a4\ub97c PAUSED \uc0c1\ud0dc\ub85c \uac15\uc81c \uc815\uc9c0\uc2dc\ucf1c\ubc84\ub9bd\ub2c8\ub2e4.</p> <p>\uc774\ub97c \ub9c9\uae30 \uc704\ud574 <code>vendor-reset</code> \ub4f1\uc758 \ud504\ub85c\uadf8\ub7a8\uc744 \uc0ac\uc6a9\ud558\uac70\ub098 \uc784\uc2dc\ub85c \uc258 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud558\ub294 \ubc29\ubc95\uc774 \uc788\uc2b5\ub2c8\ub2e4. \uc544\ub798\ub294 \uc258 \uc2a4\ud06c\ub9bd\ud2b8\ub85c FLR \uae30\ub2a5\uc744 \uc784\uc2dc \uc870\uce58\ud558\ub294 \ubc29\ubc95\uc785\ub2c8\ub2e4. \ubaa8\ub4e0 \uba85\ub839\uc740 GPU \ud638\uc2a4\ud2b8 \ub178\ub4dc\uc5d0\uc11c \uc2e4\ud589\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>cat &lt;&lt; 'EOF' &gt; qemu-hook.sh\n#!/bin/bash\n# GPU reset hook for RTX Passthrough VMs\n\nVM_NAME=\"$1\"\nACTION=\"$2\"\nPHASE=\"$3\"\n\n# \uc2e4\uc81c ID\ub294 lspci\ub85c \ud655\uc778 \ud6c4 \uc218\uc815 \ud544\uc694\nGPU_PCI=\"0000:01:00.0\"\nAUDIO_PCI=\"0000:01:00.1\" # \uc624\ub514\uc624 \uc7a5\uce58\uac00 \uc788\ub2e4\uba74 \uac19\uc774 \ub9ac\uc14b\ud574\uc57c \uc548\uc804\ud568\n\n# \ub85c\uadf8 \ud30c\uc77c \uc704\uce58 (Kolla \ub85c\uadf8 \ud3f4\ub354\ub85c \uc9c0\uc815\ud558\uc5ec \ud638\uc2a4\ud2b8\uc5d0\uc11c\ub3c4 \ubcfc \uc218 \uc788\uac8c \ud568)\nLOGFILE=\"/var/log/libvirt/gpu-reset.log\"\n\nif [[ \"$ACTION\" == \"stopped\" &amp;&amp; \"$PHASE\" == \"end\" ]]; then\n    echo \"[$(date)] VM $VM_NAME stopped. Resetting GPU...\" &gt;&gt; $LOGFILE\n\n    # 1. Remove (\uc7a5\uce58 \uc81c\uac70)\n    echo 1 &gt; /sys/bus/pci/devices/$GPU_PCI/remove\n    echo 1 &gt; /sys/bus/pci/devices/$AUDIO_PCI/remove 2&gt;/dev/null\n\n    # \uc7a0\uc2dc \ub300\uae30\n    sleep 2\n\n    # 2. Rescan (\uc7a5\uce58 \uc7ac\uc778\uc2dd)\n    echo 1 &gt; /sys/bus/pci/rescan\n\n    echo \"[$(date)] GPU Reset done.\" &gt;&gt; $LOGFILE\nfi\nEOF\n</code></pre> <p>\uc704 \uc258 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \ucee8\ud14c\uc774\ub108 \ub0b4\ubd80\uc5d0 \ubcf5\uc0ac\ud558\uace0, \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \ucee8\ud14c\uc774\ub108 \ub0b4\ubd80 \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131\nsudo docker exec -u root nova_libvirt mkdir -p /etc/libvirt/hooks\n\n# 2. \ud30c\uc77c \ubcf5\uc0ac (docker cp \uc0ac\uc6a9)\nsudo docker cp qemu-hook.sh nova_libvirt:/etc/libvirt/hooks/qemu\n\n# 3. \uad8c\ud55c \uc124\uc815 (\uc2e4\ud589 \uad8c\ud55c \ud544\uc218)\nsudo docker exec -u root nova_libvirt chmod +x /etc/libvirt/hooks/qemu\nsudo docker exec -u root nova_libvirt chown root:root /etc/libvirt/hooks/qemu\n\n# 4. \ucee8\ud14c\uc774\ub108 \uc7ac\uc2dc\uc791\nsudo docker restart nova_libvirt\n</code></pre> <p>\uc124\uc815\uc774 \uc798 \uc801\uc6a9\ub418\uc5c8\ub2e4\uba74, gpu \uc778\uc2a4\ud134\uc2a4\uac00 \uc0ad\uc81c\ub418\uc5c8\uc744 \ub54c\ub9c8\ub2e4 \uc544\ub798 \ub85c\uadf8\uac00 \ucc0d\ud788\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code>sudo docker exec -it nova_libvirt cat /var/log/libvirt/gpu-reset.log\n</code></pre> <pre><code>[Wed Nov 26 09:44:01 KST 2025] VM instance-0000001a stopped. Resetting GPU...\n[Wed Nov 26 09:44:03 KST 2025] GPU Reset done.\n[Wed Nov 26 09:49:32 KST 2025] VM instance-0000001b stopped. Resetting GPU...\n[Wed Nov 26 09:49:34 KST 2025] GPU Reset done.\n[Wed Nov 26 09:51:46 KST 2025] VM instance-0000001b stopped. Resetting GPU...\n[Wed Nov 26 09:51:49 KST 2025] GPU Reset done.\n[Wed Nov 26 09:56:32 KST 2025] VM instance-0000001c stopped. Resetting GPU...\n[Wed Nov 26 09:56:35 KST 2025] GPU Reset done.\n[Wed Nov 26 10:02:11 KST 2025] VM instance-0000001d stopped. Resetting GPU...\n[Wed Nov 26 10:02:13 KST 2025] GPU Reset done.\n[Wed Nov 26 10:03:10 KST 2025] VM instance-0000001d stopped. Resetting GPU...\n[Wed Nov 26 10:03:12 KST 2025] GPU Reset done.\n</code></pre>"},{"location":"ubuntu/init-ubuntu-env/","title":"Ubuntu \uae30\ubcf8 \uc138\ud305","text":"<ul> <li>Ubuntu 24.04 \uae30\uc900</li> </ul>"},{"location":"ubuntu/init-ubuntu-env/#index","title":"Index","text":"<ul> <li>Oh My Zsh \uc124\uce58</li> <li>npm \uc124\uce58</li> </ul>"},{"location":"ubuntu/init-ubuntu-env/#oh-my-zsh","title":"Oh My Zsh \uc124\uce58","text":""},{"location":"ubuntu/init-ubuntu-env/#1-oh-my-zsh","title":"1. Oh My Zsh \uc124\uce58","text":"<pre><code># zsh \uc124\uce58\nsudo apt install zsh\n</code></pre> <pre><code># oh-my-zsh \uc124\uce58\nsh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"\n</code></pre>"},{"location":"ubuntu/init-ubuntu-env/#2-powerlevel10k","title":"2. Powerlevel10k \ubc0f \ud50c\ub7ec\uadf8\uc778 \uc124\uce58","text":"<pre><code># Powerlevel10k\ngit clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/themes/powerlevel10k\n\n# zsh-autosuggestions\ngit clone https://github.com/zsh-users/zsh-autosuggestions.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions\n\n# zsh-syntax-highlighting\ngit clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting\n</code></pre>"},{"location":"ubuntu/init-ubuntu-env/#3-zshrc","title":"3. ~/.zshrc \ud30c\uc77c \uc218\uc815","text":"<pre><code># ZSH_THEME=\"robbyrussell\"\nZSH_THEME=\"powerlevel10k/powerlevel10k\"\n\nplugins=(\n    git\n    zsh-autosuggestions\n    zsh-syntax-highlighting\n)\n</code></pre>"},{"location":"ubuntu/init-ubuntu-env/#4","title":"4. \uc178 \uc0c8\ub85c\uace0\uce68","text":"<pre><code>source ~/.zshrc\n</code></pre> <p>\uc124\uc815: source ~/.zshrc\ub97c \uc2e4\ud589\ud558\uba74, \uc124\uc815 \ub9c8\ubc95\uc0ac(p10k configure)\uac00 \uc790\ub3d9\uc73c\ub85c \uc2e4\ud589\ub429\ub2c8\ub2e4. \uc9c8\ubb38\uc5d0 \ub2f5\ud558\uba74\uc11c \uc6d0\ud558\ub294 \uc544\uc774\ucf58\uacfc \ubaa8\uc591\uc744 \uc120\ud0dd\ud558\uba74 \ub429\ub2c8\ub2e4. \ud544\uc218: \uc774 \ud14c\ub9c8\ub97c \uc81c\ub300\ub85c \uc0ac\uc6a9\ud558\ub824\uba74 Nerd Fonts (\uc608: MesloLGS NF)\ub97c Tabby \ud130\ubbf8\ub110\uc758 \uae00\uaf34\ub85c \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"ubuntu/init-ubuntu-env/#npm","title":"npm \uc124\uce58","text":""},{"location":"ubuntu/init-ubuntu-env/#1-nvm","title":"1. NVM \uc124\uce58","text":"<pre><code># NVM \uc124\uce58\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash\n\n# NVM \ud65c\uc131\ud654\nsource ~/.zshrc\n</code></pre>"},{"location":"ubuntu/init-ubuntu-env/#2-nodejs","title":"2. Node.js \uc124\uce58","text":"<pre><code># Node.js LTS \ubc84\uc804 \uc124\uce58\nnvm install --lts\n</code></pre> <pre><code># \uc124\uce58 \ud655\uc778\nnode -v\nnpm -v\n</code></pre>"},{"location":"wsl/wsl-network-setting/","title":"WSL \uc18d\ub3c4 \ud5a5\uc0c1 \uc124\uc815","text":""},{"location":"wsl/wsl-network-setting/#1-dns","title":"\ud83d\ude80 \ud574\uacb0 \ubc29\ubc95 1: DNS \uc11c\ubc84 \uc218\ub3d9 \uace0\uc815 (\uac00\uc7a5 \ud6a8\uacfc\uc801 \u2b50)","text":"<p>WSL2\uac00 \uc708\ub3c4\uc6b0 \ud638\uc2a4\ud2b8\ub97c \uac70\uccd0\uc11c DNS\ub97c \uc870\ud68c\ud558\ub294 \uacfc\uc815\uc774 \ub290\ub9ac\uae30 \ub54c\ubb38\uc5d0, \uad6c\uae00(8.8.8.8)\uc774\ub098 \ud074\ub77c\uc6b0\ub4dc\ud50c\ub808\uc5b4(1.1.1.1) DNS\ub97c \uc9c1\uc811 \ubc14\ub77c\ubcf4\uac8c \uc124\uc815\ud558\uba74 \uc18d\ub3c4\uac00 \ube44\uc57d\uc801\uc73c\ub85c \ube68\ub77c\uc9d1\ub2c8\ub2e4.</p>"},{"location":"wsl/wsl-network-setting/#1-etcwslconf","title":"1. \uc790\ub3d9 \uc0dd\uc131 \uc124\uc815 \ub044\uae30 (<code>/etc/wsl.conf</code>)","text":"<p>WSL \ub0b4\ubd80 \ud130\ubbf8\ub110\uc5d0\uc11c \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc785\ub825\ud574 \uc124\uc815 \ud30c\uc77c\uc744 \ub9cc\ub4ed\ub2c8\ub2e4.</p> <pre><code># wsl.conf \ud30c\uc77c \uc0dd\uc131/\uc218\uc815\nsudo nano /etc/wsl.conf\n</code></pre> <p>\uc544\ub798 \ub0b4\uc6a9\uc744 \ubcf5\uc0ac\ud574\uc11c \ubd99\uc5ec\ub123\uc73c\uc138\uc694. (\uc774\ubbf8 \ub0b4\uc6a9\uc774 \uc788\ub2e4\uba74 <code>[network]</code> \ubd80\ubd84\uc5d0 \ucd94\uac00)</p> <pre><code>[network]\ngenerateResolvConf = false\n</code></pre> <p>(<code>Ctrl + O</code> \uc800\uc7a5, <code>Enter</code>, <code>Ctrl + X</code> \uc885\ub8cc)</p>"},{"location":"wsl/wsl-network-setting/#2-dns-etcresolvconf","title":"2. DNS \ud30c\uc77c \uc9c1\uc811 \uc218\uc815 (<code>/etc/resolv.conf</code>)","text":"<p>\uae30\uc874\uc758 \uc2ec\ubcfc\ub9ad \ub9c1\ud06c\ub97c \ub04a\uace0 \uc9c1\uc811 DNS\ub97c \uc785\ub825\ud569\ub2c8\ub2e4.</p> <pre><code># \uae30\uc874 \ud30c\uc77c \uc0ad\uc81c (\uc2ec\ubcfc\ub9ad \ub9c1\ud06c\uc784)\nsudo rm /etc/resolv.conf\n\n# \uc0c8 \ud30c\uc77c \uc0dd\uc131 \ubc0f DNS \uc785\ub825\nsudo bash -c 'echo \"nameserver 8.8.8.8\" &gt; /etc/resolv.conf'\nsudo bash -c 'echo \"nameserver 1.1.1.1\" &gt;&gt; /etc/resolv.conf'\n</code></pre>"},{"location":"wsl/wsl-network-setting/#3-wsl-powershell","title":"3. WSL \uc7ac\uc2dc\uc791 (PowerShell\uc5d0\uc11c)","text":"<pre><code>wsl --shutdown\n</code></pre> <p>\ub2e4\uc2dc WSL\uc744 \ucf1c\uc11c <code>apt update</code> \ub4f1\uc744 \ud574\ubcf4\uba74 \ud6e8\uc52c \ube68\ub77c\uc9c4 \uac83\uc744 \ub290\ub084 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p>"},{"location":"wsl/wsl-network-setting/#2-mirrored-windows-11","title":"\ud83d\ude80 \ud574\uacb0 \ubc29\ubc95 2: \"Mirrored\" \ubaa8\ub4dc \uc0ac\uc6a9 (Windows 11 \ud544\uc218 \u2b50\u2b50)","text":"<p>\ucd5c\uc2e0 Windows 11(22H2 \uc774\uc0c1)\uacfc \ucd5c\uc2e0 WSL \ubc84\uc804\uc744 \uc4f0\uace0 \uacc4\uc2dc\ub2e4\uba74, **\"\ubbf8\ub7ec\ub9c1 \ubaa8\ub4dc\"**\ub97c \ucf1c\ub294 \uac83\uc774 \uac8c\uc784 \uccb4\uc778\uc800\uc785\ub2c8\ub2e4. NAT\ub97c \uac70\uce58\uc9c0 \uc54a\uace0 \ud638\uc2a4\ud2b8(Windows)\uc758 \ub124\ud2b8\uc6cc\ud06c \uc778\ud130\ud398\uc774\uc2a4\ub97c \uadf8\ub300\ub85c \uacf5\uc720\ud558\ubbc0\ub85c \uc18d\ub3c4\uac00 \ub124\uc774\ud2f0\ube0c \uae09\uc73c\ub85c \ube68\ub77c\uc9d1\ub2c8\ub2e4.</p>"},{"location":"wsl/wsl-network-setting/#1","title":"1. \uc708\ub3c4\uc6b0 \uc0ac\uc6a9\uc790 \ud3f4\ub354\uc5d0 \uc124\uc815 \ud30c\uc77c \uc0dd\uc131","text":"<p>\uc708\ub3c4\uc6b0 \ud0d0\uc0c9\uae30 \uc8fc\uc18c\ucc3d\uc5d0 <code>%UserProfile%</code>\uc744 \uc785\ub825\ud558\uace0 \uc5d4\ud130\ub97c \uce69\ub2c8\ub2e4. \uc5ec\uae30\uc5d0 <code>.wslconfig</code> \ub77c\ub294 \ud30c\uc77c\uc744 \ub9cc\ub4e4\uace0(\uba54\ubaa8\uc7a5 \uc774\uc6a9) \uc544\ub798 \ub0b4\uc6a9\uc744 \ub123\uc73c\uc138\uc694.</p> <pre><code>[wsl2]\nnetworkingMode=mirrored\ndnsTunneling=true\nfirewall=true\nautoProxy=true\n</code></pre> <ul> <li><code>networkingMode=mirrored</code>: NAT\ub97c \uc5c6\uc560\uace0 \uc708\ub3c4\uc6b0 IP\ub97c \uadf8\ub300\ub85c \uc501\ub2c8\ub2e4. (\uc18d\ub3c4 \ub300\ud3ed \ud5a5\uc0c1)</li> <li><code>dnsTunneling=true</code>: DNS \uc694\uccad\uc744 \uac00\uc0c1\ud654 \uacc4\uce35 \ub300\uc2e0 \ud130\ub110\ub9c1\uc73c\ub85c \ucc98\ub9ac\ud574 \ub51c\ub808\uc774\ub97c \uc904\uc785\ub2c8\ub2e4.</li> </ul>"},{"location":"wsl/wsl-network-setting/#2","title":"2. \uc801\uc6a9","text":"<p>PowerShell\uc5d0\uc11c <code>wsl --shutdown</code> \ud6c4 \ub2e4\uc2dc \uc2dc\uc791.</p>"},{"location":"wsl/wsl-network-setting/#3-ipv6","title":"\ud83d\ude80 \ud574\uacb0 \ubc29\ubc95 3: IPv6 \ube44\ud65c\uc131\ud654 (\ud2b9\uc815 \ud1b5\uc2e0\uc0ac/\ud658\uacbd\uc6a9)","text":"<p><code>apt-get</code>\uc774\ub098 <code>curl</code>\uc774 \ucc98\uc74c\uc5d0 \uba48\uce6b\ud558\ub2e4\uac00 \uc9c4\ud589\ub418\ub294 \uacbd\uc6b0, IPv6 \uc5f0\uacb0\uc744 \uc2dc\ub3c4\ud558\ub2e4\uac00 \ud0c0\uc784\uc544\uc6c3\uc774 \ub098\uc11c IPv4\ub85c \ub118\uc5b4\uac00\ub294 \ub51c\ub808\uc774\uc77c \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <p>WSL \ub0b4\ubd80\uc5d0\uc11c \uc2e4\ud589:</p> <pre><code>sudo sysctl -w net.ipv6.conf.all.disable_ipv6=1\nsudo sysctl -w net.ipv6.conf.default.disable_ipv6=1\n</code></pre> <p>(\uc774\uac8c \ud6a8\uacfc\uac00 \uc788\ub2e4\uba74 <code>/etc/sysctl.conf</code>\uc5d0 \uc601\uad6c \ub4f1\ub85d\ud558\uc138\uc694.)</p>"},{"location":"wsl/wsl-network-setting/#_1","title":"\ucd94\uac00 \uc815\ubcf4","text":"<ol> <li>Windows 11 \uc0ac\uc6a9\uc790\ub77c\uba74 **[\ubc29\ubc95 2 (Mirrored Mode)]**\uac00 \uac00\uc7a5 \uae54\ub054\ud558\uace0 \uc131\ub2a5\uc774 \uc88b\uc2b5\ub2c8\ub2e4. (<code>apt</code> \uc18d\ub3c4\ubfd0\ub9cc \uc544\ub2c8\ub77c \ub85c\uceec\ud638\uc2a4\ud2b8 \uc811\uc18d \ubb38\uc81c\ub3c4 \ud574\uacb0\ub428)</li> <li>Windows 10 \uc0ac\uc6a9\uc790\uac70\ub098 Mirrored \ubaa8\ub4dc\uac00 \ubd88\uc548\uc815\ud558\ub2e4\uba74 **[\ubc29\ubc95 1 (DNS \uace0\uc815)]**\ub9cc \uc801\uc6a9\ud574\ub3c4 \ucda9\ubd84\ud788 \ube68\ub77c\uc9d1\ub2c8\ub2e4.</li> </ol>"}]}