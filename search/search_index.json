{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":[" "],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\ud83d\ude80 Infra Cheatsheets","text":"<p>DevOps \uc2e4\ubb34\ub97c \uc704\ud55c \uac1c\uc778 \uc9c0\uc2dd \uc800\uc7a5\uc18c (Knowledge Base) \uc78a\uc5b4\ubc84\ub9ac\uae30 \uc26c\uc6b4 \uba85\ub839\uc5b4, \uc124\uce58 \uc808\ucc28, \ud2b8\ub7ec\ube14\uc288\ud305 \uac00\uc774\ub4dc\ub97c \uccb4\uacc4\uc801\uc73c\ub85c \uc815\ub9ac\ud574 \ub450\uc5c8\uc2b5\ub2c8\ub2e4.</p>"},{"location":"#documentation-site","title":"\ud83c\udf10 Documentation Site","text":""},{"location":"#infra-cheatsheets-github","title":"\ud83d\udc49 Infra cheatsheets\uc758 Github \uc8fc\uc18c","text":""},{"location":"#github","title":"\ud83d\udc49 \uc124\uce58 \ud30c\uc77c GitHub","text":""},{"location":"#_1","title":"\ud83d\udc49 \uc124\uce58 \ud30c\uc77c \ub4dc\ub77c\uc774\ube0c","text":""},{"location":"#categories","title":"\ud83d\udcc2 Categories","text":""},{"location":"#kubernetes","title":"\u2638\ufe0f Kubernetes","text":"<ul> <li>Cheat Sheets : \uc790\uc8fc \uc0ac\uc6a9\ud558\ub294 <code>kubectl</code> \uba85\ub839\uc5b4 \ubaa8\uc74c</li> <li>\ud3d0\uc1c4\ub9dd \uc124\uce58: \uc900\ube44 \u00b7 K8s \uc124\uce58 \u00b7 \uae30\ubc18 \uc778\ud504\ub77c(Helm/Harbor) \uad6c\uc131</li> <li>Gateway API: Envoy \uc124\uce58 \u00b7 HTTPRoute \uc124\uc815 \u00b7 \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \u00b7 ContainerPort \ub204\ub77d \ud574\uacb0</li> </ul>"},{"location":"#openstack","title":"\u2601\ufe0f OpenStack","text":"<ul> <li>Cheat Sheets : OpenStack CLI \ud575\uc2ec \uba85\ub839\uc5b4</li> <li>\uae30\ubcf8 \uac00\uc774\ub4dc: \uc11c\ube44\uc2a4 \ubaa9\ub85d \u00b7 \uc124\uce58 \uac00\uc774\ub4dc \u00b7 API \uba85\uc138</li> <li>\uace0\uae09 \uc124\uc815: GPU \ub178\ub4dc \ucd08\uae30\ud654 \u00b7 PCI Placement</li> <li>Troubleshooting: K8s \ub124\ud2b8\uc6cc\ud06c \ud1b5\uc2e0 \uc7a5\uc560 \ud574\uacb0</li> <li>Tools: Ironic \ub178\ub4dc \ucd94\uac00</li> <li>Utils: Cloud-init \uc124\uc815 \u00b7 Golden Image \uc0dd\uc131</li> </ul>"},{"location":"#devops-utilities","title":"\ud83d\udee0\ufe0f DevOps Utilities","text":"<ul> <li>Cloud: GCP Terraform \uc5f0\ub3d9</li> <li>CI/CD: \ud3d0\uc1c4\ub9dd GitLab &amp; Jenkins \uc124\uce58</li> <li>Database: MariaDB Galera Cluster \u00b7 \ud3d0\uc1c4\ub9dd \uc124\uce58 \ud30c\uc77c \uc900\ube44</li> <li>Ubuntu/WSL: \ucd08\uae30 \ud658\uacbd \uc124\uc815 \u00b7 WSL \ub124\ud2b8\uc6cc\ud06c \uc124\uc815</li> </ul>"},{"location":"#reference","title":"\ud83d\udcdd Reference","text":"<ul> <li>Git: Cheat Sheets</li> <li>IDE: VSCode \ub2e8\ucd95\ud0a4 \ubaa8\uc74c</li> <li>Network: \ub3c4\uba54\uc778 \uc2e4\uc81c IP \uccb4\ud06c \u00b7 \ub124\ud2b8\uc6cc\ud06c \uc11c\ube0c\ub137 \ud655\uc778</li> </ul>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/","title":"1. \ud3d0\uc1c4\ub9dd\uc5d0\uc11c GitLab \ubc0f Jenkins \uc124\uce58 \ubc0f \uc5f0\ub3d9","text":"<ol> <li> <p>\uac00\uc774\ub4dc \ud658\uacbd</p> <ul> <li>OS: Rocky Linux 9.6</li> <li>K8s Version: 1.30.14</li> <li>Container Runtime: containerd (<code>ctr</code>)</li> </ul> </li> <li> <p>\uc804\uc81c \uc870\uac74</p> <ul> <li>Kubernetes \ud074\ub7ec\uc2a4\ud130\uac00 \uc815\uc0c1 \ub3d9\uc791 \uc911\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4 (<code>kubectl get nodes</code> -&gt; Ready).</li> <li>Harbor\uac00 \uc124\uce58\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> <li>\uc2a4\ud1a0\ub9ac\uc9c0 \ud074\ub798\uc2a4(<code>local-path</code>)\uac00 \uad6c\uc131\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> <li>\uc774 \uac00\uc774\ub4dc\ub294 \ub9c8\uc2a4\ud130 \ub178\ub4dc\uc758 <code>~/gitlab</code> , <code>~/jenkins</code> \uacbd\ub85c\uc5d0 \uc900\ube44\ub418\uc5b4 \uc788\ub2e4\uace0 \uac00\uc815\ud558\uace0 \uc2dc\uc791\ud569\ub2c8\ub2e4.</li> <li>\uc124\uce58 \ud30c\uc77c \uc704\uce58</li> </ul> </li> </ol>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#phase-1","title":"\ud83d\ude80 Phase 1: \uc774\ubbf8\uc9c0 \ub85c\ub4dc (\uc804\uccb4 \ub178\ub4dc)","text":"<p>Harbor\uc5d0 \uc774\ubbf8\uc9c0\ub97c \uc5c5\ub85c\ub4dc\ud569\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: Master 1]</p> <p>\uba3c\uc800 <code>upload_images_to_harbor_v2.sh</code> \uc124\uc815 \ubd80\ubd84\uc744 \ud604\uc7ac \ud658\uacbd\uc5d0 \ub9de\uac8c \ubcc0\uacbd\ud569\ub2c8\ub2e4.</p> <ul> <li><code>HARBOR_REGISTRY</code> : Harbor domain</li> <li><code>HARBOR_PROJECT</code> : Harbor Project</li> <li><code>HARBOR_USER</code> : ID</li> <li><code>HARBOR_PASSWORD</code> : Password</li> <li><code>USE_PLAIN_HTTP</code> : HTTP \uc811\uc18d \uc5ec\ubd80</li> </ul> <pre><code>cd ~/gitlab-18.7/images\nsudo bash upload_images_to_harbor_v2.sh\n\ncd ~/jenkins-2.528.3/images\nsudo bash upload_images_to_harbor_v2.sh\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#phase-2-pv","title":"\ud83d\ude80 Phase 2: \ub370\uc774\ud130 \uc601\uc18d\uc131 \uad6c\uc131 (PV \uc124\uc815)","text":"<p><code>local-path</code> \uc2a4\ud1a0\ub9ac\uc9c0 \ud074\ub798\uc2a4\ub97c \uc0ac\uc6a9\ud558\ub354\ub77c\ub3c4, \ud504\ub85c\ub355\uc158 \ub370\uc774\ud130\ub97c \uc548\uc804\ud558\uac8c \ubcf4\uad00\ud558\uae30 \uc704\ud574 \ud638\uc2a4\ud2b8 \uacbd\ub85c\ub97c \uace0\uc815(HostPath)\ud558\uc5ec PV\ub97c \uc0dd\uc131\ud558\ub294 \uac83\uc744 \uad8c\uc7a5\ud569\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: Master 1]</p>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#1","title":"1. \ud638\uc2a4\ud2b8 \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131 (\ubaa8\ub4e0 \uc6cc\ucee4 \ub178\ub4dc)","text":"<p>\ub370\uc774\ud130\uac00 \uc800\uc7a5\ub420 \uc2e4\uc81c \ud3f4\ub354\ub97c \ubaa8\ub4e0 \uc6cc\ucee4 \ub178\ub4dc\uc5d0 \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <p>\ud658\uacbd\uc5d0 \ub9de\ucdb0 \uacbd\ub85c\ub97c \uc218\uc815\ud574\ub3c4 \ub429\ub2c8\ub2e4.</p> <pre><code># (\uac01 \uc6cc\ucee4 \ub178\ub4dc\uc5d0\uc11c \uc2e4\ud589\ud558\uac70\ub098, Ansible \ub4f1\uc73c\ub85c \uc77c\uad04 \uc2e4\ud589)\nsudo mkdir -p /data/jenkins_home\nsudo mkdir -p /data/gitlab_data\nsudo mkdir -p /data/gitlab_pg\nsudo mkdir -p /data/gitlab_redis\nsudo chmod -R 777 /data\n\nsudo mkdir -p /data/gitlab_data/minio\nsudo chmod -R 777 /data/gitlab_data/minio\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#2-pv-master","title":"2. PV \uc0dd\uc131 (Master \ub178\ub4dc)","text":"<p>\uc704\uc5d0\uc11c \uacbd\ub85c\ub97c \uc218\uc815\ud588\ub2e4\uba74, <code>pv-volume.yaml</code> \ud30c\uc77c\uc5d0\uc11c\ub3c4 \ub3d9\uc77c\ud55c \uacbd\ub85c\ub85c <code>sepc.hostPath.path</code> \uac12\uc744 \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>cd ~/jenkins\nkubectl apply -f pv-volume.yaml\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#phase-3-jenkins-master-1","title":"\ud83d\ude80 Phase 3: Jenkins \uc124\uce58 (Master-1)","text":"<p>\uc6b0\ub9ac\uac00 \ube4c\ub4dc\ud55c Custom Image (\ud50c\ub7ec\uadf8\uc778 \ud3ec\ud568)\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc124\uce58\ud569\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: K8s-Master-Node]</p>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#1_1","title":"1. \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc0dd\uc131","text":"<pre><code>kubectl create namespace jenkins\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#2-jenkins-helm","title":"2. Jenkins Helm \ubc30\ud3ec","text":"<p><code>deploy-jenkins.sh</code> \ud30c\uc77c \uc704\uc5d0 \uc788\ub294 <code>REGISTRY_URL</code> \ub4f1\uc758 \ubcc0\uc218\ub97c \ud658\uacbd\uc5d0 \ub9de\ucdb0 \uc218\uc815 \ud6c4 \uc2e4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code>sudo bash deploy-jenkins.sh\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#3-jenkins","title":"3. Jenkins \uc811\uc18d \uc815\ubcf4 \ud655\uc778","text":"<pre><code># 1. Pod \uc0c1\ud0dc \ud655\uc778 (Running\uc774 \ub420 \ub54c\uae4c\uc9c0 \ub300\uae30)\nwatch kubectl get pods -n jenkins\n\n# 2. \ucd08\uae30 \uad00\ub9ac\uc790 \uacc4\uc815 \ud655\uc778\n# \ucd08\uae30 ID\ub294 admin\n# PW \ud655\uc778\nkubectl get secret -n jenkins jenkins -o jsonpath=\"{.data.jenkins-admin-password}\" | base64 --decode\necho \"\"\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#phase-4-gitlab-master-1","title":"\ud83d\ude80 Phase 4: GitLab \uc124\uce58 (Master-1)","text":"<p>GitLab\uc740 \ub9ac\uc18c\uc2a4\ub97c \ub9ce\uc774 \uc0ac\uc6a9\ud558\ubbc0\ub85c, \ubd88\ud544\uc694\ud55c \uae30\ub2a5(NGINX, Prometheus \ub4f1)\uc744 \ub044\uace0 \ud575\uc2ec \uae30\ub2a5\ub9cc \uc124\uce58\ud569\ub2c8\ub2e4. \ud2b9\ud788 Envoy Gateway \uc804\ud658\uc744 \uace0\ub824\ud558\uc5ec Ingress \uc124\uc815\ub9cc \ub0a8\uae41\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: K8s-Master-Node]</p>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#1-install-gitlab-valuesyaml","title":"1. \uc124\uc815 \ud30c\uc77c \ud655\uc778 (<code>install-gitlab-values.yaml</code>)","text":"<p>\uc0ac\uc6a9\ud558\ub294 \ud658\uacbd\uc5d0 \ub9de\ucdb0 <code>domain</code> , <code>image</code> , <code>ingress</code> , <code>nginx-ingress</code> \ubd80\ubd84\uc744 \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>global:\n  edition: ce\n  hosts:\n    domain: devops.internal # \ub0b4\ubd80 \ub3c4\uba54\uc778\uc5d0 \ub9de\uac8c \ubcc0\uacbd\n    https: false\n\n  image:\n    registry: 1.1.1.213:30002 # Harbor domain \ub9de\ucdb0 \ubcc0\uacbd\n    repository: library # Harbor Project \ub9de\ucdb0\uc11c \ubcc0\uacbd\n    pullPolicy: IfNotPresent\n\n  # [\ud575\uc2ec] Ingress \uc124\uc815\n  # 1. Gateway API\ub97c \uc0ac\uc6a9\ud560 \ub54c\n  ingress:\n    enabled: false\n    configureCertmanager: false\n    tls:\n      enabled: false          # TLS \ube44\ud65c\uc131\ud654 (HTTP \uc811\uc18d)\n\n  # 2. \uc774\ubbf8 \uc124\uce58\ub41c ingress nginx\ub97c \uc0ac\uc6a9\ud560 \ub54c\n  # ingress:\n  #   enabled: true           # Ingress \uac1d\uccb4(\ub77c\uc6b0\ud305 \uaddc\uce59) \uc0dd\uc131: YES\n  #   configureCertmanager: false\n  #   class: \"none\"           # NGINX\uac00 \ucc44\uac00\uba74 \uc548\ub418\ubbc0\ub85c none \uc124\uc815 (\ub098\uc911\uc5d0 Envoy\uac00 \ucc98\ub9ac)\n  #   tls:\n  #     enabled: false          # TLS \ube44\ud65c\uc131\ud654 (HTTP \uc811\uc18d)\n\n  # 3. gitlab\uc758 ingress nginx\ub97c \uc0ac\uc6a9\ud560 \ub584\n  # ingress:\n  #   enabled: true             # Ingress \ud65c\uc131\ud654\n  #   configureCertmanager: false # \uc778\uc99d\uc11c \uad00\ub9ac\uc790 \ub054 (HTTP \uc0ac\uc6a9)\n  #   class: gitlab-nginx              # \ub0b4\uc7a5 NGINX \uc0ac\uc6a9\n  #   tls:\n  #     enabled: false          # TLS \ube44\ud65c\uc131\ud654 (HTTP \uc811\uc18d)\n\n# [\ud575\uc2ec] NGINX \ucee8\ud2b8\ub864\ub7ec \ube44\ud65c\uc131\ud654 (\uc774\ubbf8\uc9c0\ub294 \ubc1b\uc558\uc9c0\ub9cc \uc124\uce58\ub294 \uc548 \ud568)\n# 1,2. Gateway API\ub97c \uc0ac\uc6a9\ud560 \ub54c \ud639\uc740 \uc774\ubbf8 \uc124\uce58\ub41c ingress nginx\ub97c \uc0ac\uc6a9\ud560 \ub54c\nnginx-ingress:\n  enabled: false\n\n# 3. gitlab\uc758 ingress nginx\ub97c \uc0ac\uc6a9\ud560 \ub54c\n# nginx-ingress:\n#   enabled: true\n#   controller:\n#     ingressClassResource:\n#       # [\ud575\uc2ec] IngressClass \uc774\ub984 \ubcc0\uacbd (\ucda9\ub3cc \ubc29\uc9c0)\n#       name: gitlab-nginx\n#       # \ucee8\ud2b8\ub864\ub7ec \uac12\ub3c4 \uc720\ub2c8\ud06c\ud558\uac8c \ubcc0\uacbd\n#       controllerValue: \"k8s.io/gitlab-nginx\"\n#     image:\n#       registry: 1.1.1.213:30002 # Harbor domain\n#       repository: library/ingress-nginx-controller # Harbor\uc5d0 \uc62c\ub77c\uac04 \uc774\ubbf8\uc9c0\n#       tag: \"v1.11.8\"\n#       digest: \"\"\n#     service:\n#       type: NodePort\n#       nodePorts:\n#         http: 30080\n#         https: 30443\n#         ssh: 30022\n...\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#2-gitlab-helm","title":"2. GitLab Helm \ubc30\ud3ec","text":"<p><code>install-gitlab.sh</code> \ud30c\uc77c \uc704\uc5d0 \uc788\ub294 \uc124\uc815 \ubcc0\uc218\ub97c \ud658\uacbd\uc5d0 \ub9de\uac8c \uc815\uc758\ud55c \ud6c4 \uc2e4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code>./install-gitlab.sh\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#_1","title":"\uc624\ub958\ub85c \uc778\ud55c \uc7ac\ubc30\ud3ec \uc2dc","text":"<p>\uc624\ub958\ub85c \uc778\ud55c \uc7ac\ubc30\ud3ec\uac00 \ud544\uc694\ud558\ub2e4\uba74 \uba3c\uc800 \uc544\ub798 \uba85\ub839\uc5b4\ub85c \ube44\ubc00\ubc88\ud638\ub97c \ud655\ubcf4\ud569\ub2c8\ub2e4. \ud639\uc5ec\ub098 \uc774\ubbf8 \ube44\ubc00\ubc88\ud638\ub97c \ub0a0\ub838\ub2e4\uba74, \ubcfc\ub968\uc73c\ub85c \uc0ac\uc6a9\ud55c \ubb3c\ub9ac\uc801 \uc704\uce58(\uac00\uc774\ub4dc\uc5d0\uc120 \uc9c0\uc815\ud55c \uc6cc\ucee4 \ub178\ub4dc\uc758 <code>/data/gitlab_pg</code> \ud3f4\ub354)\uc5d0\uc11c \uc0ad\uc81c \ud6c4 \uc7ac\uc0dd\uc131 \ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># \ube44\ubc00\ubc88\ud638 \ucd94\ucd9c (\ubcf5\uc0ac\ud574\ub450\uc138\uc694!)\nkubectl get secret -n gitlab gitlab-postgresql-password -o jsonpath=\"{.data.postgresql-password}\" | base64 -d\n</code></pre> <p>\uc7ac\uc0dd\uc131 \uc2dc, DB\uc758 Password\uac00 \ub2e4\uc2dc \ubb34\uc791\uc704\ub85c \uad6c\uc131\ub429\ub2c8\ub2e4. \uc774\ub54c PV\uc5d0 \uc788\ub294 \ube44\ubc00\ubc88\ud638\uc640 \ub9de\uc9c0 \uc0c8\ub85c \uc0dd\uc131\ub41c \ube44\ubc00\ubc88\ud638\uac00 \ub2ec\ub77c <code>migration job</code> \uc774 \uc815\uc0c1 \ub3d9\uc791\ud558\uc9c0 \ubabb\ud560 \ub54c\uac00 \uc788\uc2b5\ub2c8\ub2e4. \uc774\ub54c \uc544\ub798 \ubc29\ubc95\uc73c\ub85c \ube44\ubc00\ubc88\ud638\ub97c \uac15\uc81c \ub3d9\uae30\ud654 \uc2dc\ucf1c\uc8fc\uc138\uc694.</p> <pre><code># 1. DB \ud30c\ub4dc \uc774\ub984 \ud655\uc778\nkubectl get po -n gitlab -l app=postgresql\n\n# 2. \ud30c\ub4dc \ub0b4\ubd80 \uc258 \uc811\uc18d (\uc774\ub984\uc774 gitlab-postgresql-0 \uc774\ub77c\uace0 \uac00\uc815)\nkubectl exec -it -n gitlab gitlab-postgresql-0 -- bash\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#3-gitlab","title":"3. GitLab \uc811\uc18d \uc815\ubcf4 \ud655\uc778","text":"<p>GitLab\uc774 \uc644\uc804\ud788 \uad6c\ub3d9\ub418\ub294 \ub370\uc5d0\ub294 \uc57d 5~10\ubd84\uc774 \uc18c\uc694\ub429\ub2c8\ub2e4.</p> <pre><code># 1. \uc0c1\ud0dc \ubaa8\ub2c8\ud130\ub9c1\nwatch kubectl get pods -n gitlab\n\n# \ucd08\uae30 ID\ub294 root\n# 2. \ucd08\uae30 root \ube44\ubc00\ubc88\ud638 \ud655\uc778\nkubectl get secret gitlab-gitlab-initial-root-password \\\n  -n gitlab -ojsonpath='{.data.password}' | base64 --decode ; echo\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#phase-5-pc","title":"\ud83d\ude80 Phase 5: \ub124\ud2b8\uc6cc\ud06c \ubc0f PC \uc811\uc18d \uc124\uc815","text":"<p>\ub85c\ub4dc\ubc38\ub7f0\uc11c\ub098 Gateway\uac00 \uc544\uc9c1 \uad6c\uc131\ub418\uc9c0 \uc54a\uc740 \uc0c1\ud0dc\uc5d0\uc11c \uc6f9 \uc811\uc18d\uc744 \ud655\uc778\ud558\uae30 \uc704\ud574, K8s \uc11c\ube44\uc2a4\uc758 \ud3ec\ud2b8\ub97c \uc784\uc2dc\ub85c \ud3ec\uc6cc\ub529\ud558\uac70\ub098 NodePort\ub97c \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#1-gitlab-nodeport","title":"1. GitLab \uc11c\ube44\uc2a4 \ub178\ucd9c (\uc784\uc2dc NodePort)","text":"<p>GitLab Webservice\ub97c \uc678\ubd80\uc5d0\uc11c \uc811\uc18d\ud558\uae30 \uc704\ud574 NodePort\ub85c \ubcc0\uacbd\ud569\ub2c8\ub2e4.</p> <pre><code># gitlab-webservice-default \uc11c\ube44\uc2a4 \uc218\uc815\nkubectl patch svc gitlab-webservice-default -n gitlab -p '{\"spec\": {\"type\": \"NodePort\"}}'\n\n# \ud560\ub2f9\ub41c \ud3ec\ud2b8 \ud655\uc778 (30000\ubc88\ub300 \ud3ec\ud2b8 \ud655\uc778)\nkubectl get svc -n gitlab gitlab-webservice-default\n</code></pre>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#2-pc-hosts","title":"2. \uc0ac\uc6a9\uc790 PC Hosts \uc124\uc815","text":"<p>\uc0ac\uc6a9\uc790 PC(Windows/Mac)\uc758 <code>hosts</code> \ud30c\uc77c\uc5d0 \ub3c4\uba54\uc778\uc744 \ub4f1\ub85d\ud569\ub2c8\ub2e4.</p> <pre><code># \uc608\uc2dc: \uc6cc\ucee4\ub178\ub4dc IP\uc640 NodePort \uc0ac\uc6a9 \uc2dc\n# &lt;Worker-Node-IP&gt;  gitlab.devops.internal\n10.10.10.73  gitlab.devops.internal\n</code></pre> <p>\uc774\uc81c \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c <code>http://gitlab.devops.internal:&lt;NodePort&gt;</code> \ub85c \uc811\uc18d\ud558\uc5ec <code>root</code> \uacc4\uc815\uc73c\ub85c \ub85c\uadf8\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#phase-6-jenkins-gitlab","title":"\ud83d\ude80 Phase 6: Jenkins &lt;-&gt; GitLab \uc5f0\ub3d9","text":"<p>\uc774\uc81c \ub450 \uc2dc\uc2a4\ud15c\uc744 \uc5f0\uacb0\ud558\uc5ec CI \ud30c\uc774\ud504\ub77c\uc778\uc744 \uad6c\uc131\ud569\ub2c8\ub2e4.</p>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#1-gitlab-access-token","title":"1. GitLab: Access Token \ubc1c\uae09","text":"<ol> <li>GitLab \uc811\uc18d -&gt; \uc6b0\uce21 \uc0c1\ub2e8 \ud504\ub85c\ud544 \uc544\uc774\ucf58 -&gt; Preferences.</li> <li>\uc88c\uce21 \uba54\ub274 Personal Access Tokens.</li> <li>Add new token:<ul> <li>Name: <code>jenkins-integration</code></li> <li>Scopes: <code>api</code> (\uccb4\ud06c)</li> <li>Create personal access token \ud074\ub9ad -&gt; \ud1a0\ud070 \uac12 \ubcf5\uc0ac.</li> </ul> </li> </ol>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#2-jenkins-credential","title":"2. Jenkins: Credential \ub4f1\ub85d","text":"<ol> <li>Jenkins \uc811\uc18d (<code>http://&lt;NodeIP&gt;:30000</code>).</li> <li>Manage Jenkins -&gt; Credentials -&gt; System -&gt; Global credentials (unrestricted).</li> <li>Add Credentials:<ul> <li>Kind: <code>GitLab API token</code></li> <li>Scope: <code>Global</code></li> <li>API token: (\ubcf5\uc0ac\ud55c GitLab \ud1a0\ud070 \ubd99\uc5ec\ub123\uae30)</li> <li>ID: <code>gitlab-token-id</code></li> <li>Description: GitLab Connection Token</li> <li>Create.</li> </ul> </li> </ol>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#3-jenkins_1","title":"3. Jenkins: \uc2dc\uc2a4\ud15c \uc124\uc815","text":"<ol> <li>Manage Jenkins -&gt; System.</li> <li>\uc2a4\ud06c\ub864\uc744 \ub0b4\ub824 GitLab \uc139\uc158 \uc774\ub3d9.</li> <li>Connection Name: <code>cmp-gitlab</code> (\ud30c\uc774\ud504\ub77c\uc778\uc5d0\uc11c \uc0ac\uc6a9\ud560 \uc774\ub984).</li> <li>GitLab host URL:</li> </ol> <p>\uc911\uc694: Jenkins \ud30c\ub4dc \ub0b4\ubd80\uc5d0\uc11c GitLab\uc73c\ub85c \ud1b5\uc2e0\ud574\uc57c \ud558\ubbc0\ub85c K8s \ub0b4\ubd80 \ub3c4\uba54\uc778\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4. <code>http://gitlab-webservice-default.gitlab.svc.cluster.local:8181</code></p> <ol> <li>Credentials: <code>GitLab Connection Token</code> \uc120\ud0dd.</li> <li>Test Connection -&gt; <code>Success</code> \ud655\uc778 \ud6c4 Save.</li> </ol>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#phase-7","title":"\ud83d\ude80 Phase 7: \ud30c\uc774\ud504\ub77c\uc778 \ud14c\uc2a4\ud2b8 (\uac80\uc99d)","text":"<p>\uc2e4\uc81c \ucf54\ub4dc\uac00 \ucee4\ubc0b\ub418\uc5c8\uc744 \ub54c Jenkins\uac00 \ube4c\ub4dc\ub97c \uc218\ud589\ud558\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#1-jenkins-job","title":"1. Jenkins Job \uc0dd\uc131","text":"<ol> <li>New Item -&gt; \uc774\ub984: <code>test-pipeline</code> -&gt; Pipeline \uc120\ud0dd.</li> <li>Build Triggers: <code>Build when a change is pushed to GitLab</code> \uccb4\ud06c.<ul> <li>Advanced -&gt; <code>Secret token</code> \uc744 \uc0dd\uc131\ud558\uace0 \ubcf5\uc0ac\ud569\ub2c8\ub2e4.</li> </ul> </li> <li> <p>Pipeline Script: \uc544\ub798 <code>image:</code> \uacbd\ub85c\ub294 \uc2e4\uc81c Harbor \uacbd\ub85c\ub85c \ubcc0\uacbd\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>pipeline {\n    agent {\n        kubernetes {\n            // yaml \ubcd1\ud569\uc744 \ud1b5\ud574 \uba85\uc2dc\uc801\uc73c\ub85c \ub85c\uceec \uc774\ubbf8\uc9c0\ub97c \uc0ac\uc6a9\ud558\ub3c4\ub85d \uc9c0\uc815\n            yaml \"\"\"\napiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    app: builder\nspec:\n  containers:\n  # ---------------------------------------------------------\n  # 1. \uc791\uc5c5\uc6a9 \ub3c4\uad6c (Golden Image) - \uc6b0\ub9ac\uac00 \ub9cc\ub4e0 \uc62c\uc778\uc6d0 \uc774\ubbf8\uc9c0 \uc0ac\uc6a9\n  # ---------------------------------------------------------\n  - name: shell\n    # [\uc911\uc694] busybox \ub300\uc2e0 \ud234\uc774 \ub2e4 \uc124\uce58\ub41c \uc6b0\ub9ac \uc774\ubbf8\uc9c0\ub97c \uc9c0\uc815 (\ub808\uc9c0\uc2a4\ud2b8\ub9ac \uc8fc\uc18c \ud3ec\ud568)\n    image: '1.1.1.213:30002/library/cmp-jenkins-full:2.528.3'\n    # \ucee8\ud14c\uc774\ub108\uac00 \uc8fd\uc9c0 \uc54a\uace0 \uacc4\uc18d \uc0b4\uc544\uc788\ub3c4\ub85d \uc720\uc9c0\n    command: ['/bin/sh', '-c', 'sleep 86400']\n    tty: true\n    volumeMounts:\n      - mountPath: \"/home/jenkins/agent\"\n        name: \"workspace-volume\"\n        readOnly: false\n\n  # ---------------------------------------------------------\n  # 2. Jenkins \uc5d0\uc774\uc804\ud2b8 (\ud544\uc218 \ud1b5\uc2e0\uc6a9)\n  # ---------------------------------------------------------\n  - name: jnlp\n    # Docker Hub \ucc28\ub2e8\uc744 \uc704\ud574 \ub85c\uceec \ub808\uc9c0\uc2a4\ud2b8\ub9ac \uba85\uc2dc\n    image: '1.1.1.213:30002/library/inbound-agent:latest'\n    volumeMounts:\n      - mountPath: \"/home/jenkins/agent\"\n        name: \"workspace-volume\"\n        readOnly: false\n\"\"\"\n        }\n    }\n    stages {\n        stage('Tool Verification') {\n            steps {\n                // 'shell' \ucee8\ud14c\uc774\ub108(Golden Image) \ub0b4\ubd80\uc5d0\uc11c \uba85\ub839\uc5b4 \uc2e4\ud589\n                container('shell') {\n                    script {\n                        echo \"\ud83c\udf89 1. OS \ud655\uc778\"\n                        sh 'cat /etc/os-release'\n\n                        echo \"\ud83c\udf89 2. OpenTofu \ubc84\uc804 \ud655\uc778\"\n                        sh 'tofu --version'\n\n                        echo \"\ud83c\udf89 3. K8s \ub3c4\uad6c (Kubectl &amp; Helm) \ud655\uc778\"\n                        sh 'kubectl version --client'\n                        sh 'helm version'\n\n                        echo \"\ud83c\udf89 4. Provider \ubc88\ub4e4\ub9c1 \ud655\uc778\"\n                        sh 'ls -al /usr/local/share/tofu-providers'\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre> </li> <li> <p>Save</p> </li> </ol>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#2-gitlab","title":"2. GitLab \uc124\uc815 \ubcc0\uacbd","text":"<ol> <li>GitLab\uc758 \uc6b0\uce21 \uc0c1\ub2e8\uc758 Profile \uc544\uc774\ucf58 -&gt; Admin \ud074\ub9ad</li> <li>LNB\uc5d0\uc11c Settings -&gt; Network</li> <li>Outbound requests -&gt; \uc544\ub798 \ud56d\ubaa9 \uccb4\ud06c<ul> <li><code>Allow requests to the local network from webhooks and integrations</code></li> <li><code>Allow requests to the local network from system hooks</code></li> </ul> </li> <li>Save</li> </ol>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#3-webhook-gitlab","title":"3. Webhook \ub4f1\ub85d (GitLab)","text":"<ol> <li> <p>Jenkins Job -&gt; Configuration \ud654\uba74\uc758 GitLab webhook URL\uc744 \ubcf5\uc0ac\ud569\ub2c8\ub2e4.</p> <ul> <li>\uc608: <code>http://1.1.1.213:30000/project/test-pipeline</code></li> <li>Floating IP\ub85c \ub418\uc5b4\uc788\ub2e4\uba74 \uc704\uc640 \uac19\uc774 project \uc55e\ubd80\ubd84\uc744 \ub0b4\ubd80 IP\ub85c \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul> </li> <li> <p>GitLab \ud504\ub85c\uc81d\ud2b8 -&gt; Project Settings -&gt; LNB\uc758 Webhooks -&gt; Add new webhook</p> </li> <li>\uc544\ub798 \uac12 \uc124\uc815 \ud6c4, Webhook \ucd94\uac00<ul> <li>URL: \uc704\uc5d0\uc11c \uc218\uc815\ud55c \ub0b4\ubd80 \uc8fc\uc18c \uc785\ub825.</li> <li>Secret token: Jenkins\uc5d0\uc11c \uc0dd\uc131\ud55c Secret token.</li> <li>Trigger: Push events.</li> <li>Add webhook.</li> </ul> </li> <li>Test -&gt; Push events<ul> <li><code>HTTP 200</code>\uc774 \ub728\uba74 \uc5f0\ub3d9 \uc131\uacf5\uc785\ub2c8\ub2e4.</li> <li>Jenkins \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \ube4c\ub4dc\uac00 \uc218\ud589\ub418\ub294\uc9c0 \ud655\uc778\ud558\uc138\uc694.</li> </ul> </li> </ol>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#4-jenkins-kubernetes-cloud","title":"4. Jenkins Kubernetes Cloud \uc124\uc815","text":"<p>Webhook\uc744 \ud1b5\ud574 \ub4e4\uc5b4\uc628 \uc694\uccad\uc744 \ucc98\ub9ac\ud560 K8s \uc5d0\uc774\uc804\ud2b8(Pod) \uc5f0\uacb0 \uc815\ubcf4\ub97c \uc124\uc815\ud569\ub2c8\ub2e4. \uc774 \uc124\uc815\uc774 \uc120\ud589\ub418\uc5b4\uc57c Jenkins\uac00 K8s \ud074\ub7ec\uc2a4\ud130 \ub0b4\ubd80\uc5d0 \uc5d0\uc774\uc804\ud2b8\ub97c \uc0dd\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <p>\uacbd\ub85c: Manage Jenkins &gt; Clouds &gt; New cloud</p> <ol> <li> <p>Kubernetes \uae30\ubcf8 \uc124\uc815</p> <ul> <li>Name: <code>Kubernetes</code></li> <li>Kubernetes URL: <code>https://kubernetes.default</code> (\ub0b4\ubd80 API \ud1b5\uc2e0\uc6a9)</li> <li>Kubernetes Namespace: <code>jenkins</code></li> <li>Disable HTTPS certificate check: \u2705 \uccb4\ud06c (Enable) -&gt;</li> <li>Test Connection: <code>Credentials</code> \ud56d\ubaa9\uc5d0 \uc788\ub294 <code>Test Connection</code> \ud655\uc778</li> <li>Jenkins URL: <code>http://jenkins.jenkins.svc.cluster.local:8080</code></li> <li>Jenkins tunnel: <code>jenkins-agent.jenkins.svc.cluster.local:50000</code></li> <li>\uc8fc\uc758: <code>kubectl get svc -n jenkins</code> \uba85\ub839\uc5b4\ub85c 50000\ubc88 \ud3ec\ud2b8\ub97c \uac00\uc9c4 \uc11c\ube44\uc2a4\uc758 \uc815\ud655\ud55c \uc774\ub984 (\uc608: <code>jenkins</code> \ub610\ub294 <code>cmp-jenkins</code>)\uc744 \ud655\uc778\ud558\uc5ec \uc785\ub825\ud558\uc138\uc694.</li> </ul> </li> <li> <p>Pod Templates \uc124\uc815 (Global Default)</p> <ul> <li>Name: <code>kubernetes</code></li> <li>Namespace: <code>jenkins</code></li> <li>Labels: <code>kubernetes</code> (\ud30c\uc774\ud504\ub77c\uc778\uc774 \ud638\ucd9c\ud560 \ub77c\ubca8)</li> <li>Usage: <code>Use this node as much as possible</code> \uc120\ud0dd</li> </ul> </li> </ol>"},{"location":"cicd/offline-install/001-gitlab_jenkins_install/#5-git-push-trigger","title":"5. Git \uc124\uce58 \ubc0f \uc18c\uc2a4 \ucf54\ub4dc Push (Trigger)","text":"<p>\ubaa8\ub4e0 \uc124\uc815\uc774 \uc644\ub8cc\ub418\uc5c8\uc73c\ubbc0\ub85c, \uc2e4\uc81c \ucf54\ub4dc\ub97c GitLab\uc5d0 \ud478\uc2dc\ud558\uc5ec Jenkins \ube4c\ub4dc\ub97c \ud2b8\ub9ac\uac70\ud569\ub2c8\ub2e4.</p> <ol> <li> <p>Git \uc124\uce58</p> <p>\ub9cc\uc57d Git\uc774 \uc124\uce58\ub418\uc5b4 \uc788\uc9c0 \uc54a\ub2e4\uba74 \ud3d0\uc1c4\ub9dd\uc6a9 git rpm\uc744 \uc0ac\uc6a9\ud574 git\uc744 \uc124\uce58\ud569\ub2c8\ub2e4.</p> <pre><code>cd ~/gitlab/git-2.47.3\ntar -zxvf git_bundle_rocky96_20260107.tar.gzgit_offline_bundle\nsudo rpm -Uvh --force --nodeps git_offline_bundle/*.rpm\n</code></pre> </li> <li> <p>\ub85c\uceec \uc124\uc815</p> <p><code>/etc/hosts</code> \ud30c\uc77c\uc5d0 GitLab \uc11c\ubc84\uc758 IP\uc640 \ub3c4\uba54\uc778\uc744 \ub4f1\ub85d\ud569\ub2c8\ub2e4.</p> </li> <li> <p>\ud504\ub85c\uc81d\ud2b8 Clone</p> <pre><code>git clone http://&lt;GitLab_\ub3c4\uba54\uc778&gt;/&lt;\uadf8\ub8f9\uba85&gt;/&lt;\ud504\ub85c\uc81d\ud2b8\uba85&gt;.git\n# \uc608: git clone http://gitlab.example.com/root/test-pipeline.git\n</code></pre> </li> <li> <p>\ud14c\uc2a4\ud2b8 \ud30c\uc77c \uc791\uc131 \ubc0f Push</p> <p>Clone \ubc1b\uc740 \ud3f4\ub354 \uc548\uc5d0 \ud30c\uc77c\uc744 \ud558\ub098 \uc791\uc131\ud569\ub2c8\ub2e4. \uc791\uc131 \ud6c4 GitLab\uc73c\ub85c \ud478\uc2dc\ud569\ub2c8\ub2e4.</p> <pre><code>git add .\ngit commit -m \"Test Jenkins Pipeline\"\ngit push origin main\n</code></pre> </li> <li> <p>\uacb0\uacfc \ud655\uc778</p> <p><code>git push</code> \uc131\uacf5 \uc9c1\ud6c4 Jenkins \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \uc790\ub3d9\uc73c\ub85c \ube4c\ub4dc\uac00 \uc2dc\uc791(<code>Pending</code> -&gt; <code>Running</code> -&gt; <code>Success</code>)\ub418\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> </li> </ol>"},{"location":"cloud/gcp-cheatsheet/","title":"\ud83d\udcd8 Google Cloud SDK (<code>gcloud</code>) \uce58\ud2b8\uc2dc\ud2b8","text":"<p>GCP \ub9ac\uc18c\uc2a4 \uad00\ub9ac\ub97c \uc704\ud55c \ud544\uc218 \uba85\ub839\uc5b4 \ubaa8\uc74c\uc785\ub2c8\ub2e4.</p> <p>\ubc94\ub840:</p> <ul> <li><code>&lt;\uac12&gt;</code> : \ud544\uc218 \uc785\ub825 \uac12 (\uc608: \uc778\uc2a4\ud134\uc2a4\uba85, \ud504\ub85c\uc81d\ud2b8ID)</li> <li><code>[\uc635\uc158]</code> : \uc120\ud0dd \uc785\ub825 \uac12</li> </ul>"},{"location":"cloud/gcp-cheatsheet/#0","title":"0. \ud658\uacbd \uc124\uc815 \ubc0f \uc778\uc99d (\ud544\uc218)","text":"<p>GCP CLI\ub97c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 \uacc4\uc815\uc744 \uc5f0\ub3d9\ud558\uace0 \ud504\ub85c\uc81d\ud2b8\ub97c \uc124\uc815\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \ube0c\ub77c\uc6b0\uc800\ub97c \ud1b5\ud55c \uc778\uc99d (\ucd08\uae30 \uc124\uc815)\ngcloud auth login\n\n# 2. \ud504\ub85c\uc81d\ud2b8 \uc124\uc815 (\uc791\uc5c5 \ub300\uc0c1 \ud504\ub85c\uc81d\ud2b8 \uc9c0\uc815)\ngcloud config set project &lt;\ud504\ub85c\uc81d\ud2b8_ID&gt;\n\n# 3. \uae30\ubcf8 \ub9ac\uc804/\uc874 \uc124\uc815 (\ub9e4\ubc88 \uc785\ub825\ud558\uae30 \uadc0\ucc2e\uc744 \ub54c)\ngcloud config set compute/region asia-northeast3  # \uc11c\uc6b8 \ub9ac\uc804\ngcloud config set compute/zone asia-northeast3-a  # \uc11c\uc6b8 A\uc874\n\n# 4. \uc124\uc815 \ud655\uc778\ngcloud config list\n</code></pre> <p>\ud83d\udca1 \ud301: \ub2e4\uc911 \uacc4\uc815/\ud658\uacbd \uad00\ub9ac (Configuration) OpenStack\uc758 <code>source rc</code> \ud30c\uc77c \uad50\uccb4\uc640 \ube44\uc2b7\ud558\uac8c, GCP\ub294 config \uad6c\uc131\uc744 \uc2a4\uc704\uce6d\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code># \uc0c8 \ud504\ub85c\ud544 \uc0dd\uc131\ngcloud config configurations create &lt;\uc0c8_\ud504\ub85c\ud544\uba85&gt;\n# \ud504\ub85c\ud544 \uc804\ud658\ngcloud config configurations activate &lt;\ud504\ub85c\ud544\uba85&gt;\n</code></pre>"},{"location":"cloud/gcp-cheatsheet/#1-compute-engine","title":"1. \uc778\uc2a4\ud134\uc2a4 (Compute Engine) \uad00\ub9ac","text":"<p>VM \uc778\uc2a4\ud134\uc2a4(GCE)\uc758 \uc0dd\uba85\uc8fc\uae30\ub97c \uad00\ub9ac\ud569\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \uc124\uba85 \ubaa9\ub85d \uc870\ud68c <code>gcloud compute instances list</code> \ud604\uc7ac \ud504\ub85c\uc81d\ud2b8\uc758 \ubaa8\ub4e0 VM \uc870\ud68c \uc0c1\uc138 \uc870\ud68c <code>gcloud compute instances describe &lt;VM\uc774\ub984&gt;</code> \ud2b9\uc815 VM\uc758 \uc0c1\uc138 \uc2a4\ud399/\uc0c1\ud0dc \uc870\ud68c (YAML \ucd9c\ub825) \uc0dd\uc131 <code>gcloud compute instances create &lt;VM\uc774\ub984&gt; --image-family &lt;OS\uacc4\uc5f4&gt; --machine-type &lt;\ud0c0\uc785&gt;</code> \uae30\ubcf8 VM \uc0dd\uc131 \uc0ad\uc81c <code>gcloud compute instances delete &lt;VM\uc774\ub984&gt;</code> VM \uc0ad\uc81c (\ub514\uc2a4\ud06c \uc720\uc9c0 \uc635\uc158 \uac00\ub2a5) \uc2dc\ub9ac\uc5bc \ud3ec\ud2b8 <code>gcloud compute instances get-serial-port-output &lt;VM\uc774\ub984&gt;</code> \ubd80\ud305 \ub85c\uadf8 \ud655\uc778 (\ub514\ubc84\uae45\uc6a9) SSH \uc811\uc18d <code>gcloud compute ssh &lt;VM\uc774\ub984&gt;</code> (\uac15\ucd94) \ud0a4 \uad00\ub9ac \uc5c6\uc774 \ubc14\ub85c SSH \uc811\uc18d"},{"location":"cloud/gcp-cheatsheet/#_1","title":"\u26a1 \uc804\uc6d0 \ubc0f \uc0c1\ud0dc \uad00\ub9ac","text":"<pre><code># VM \uc2dc\uc791 (Start)\ngcloud compute instances start &lt;VM\uc774\ub984&gt;\n\n# VM \uc911\uc9c0 (Stop - \uacfc\uae08 \uc911\ub2e8, \ub514\uc2a4\ud06c \ube44\uc6a9\uc740 \ubc1c\uc0dd)\ngcloud compute instances stop &lt;VM\uc774\ub984&gt;\n\n# VM \uc7ac\uc124\uc815 (Reset - \uac15\uc81c \uc7ac\ubd80\ud305 \ud6a8\uacfc)\ngcloud compute instances reset &lt;VM\uc774\ub984&gt;\n\n# \uc2e4\ud589 \uc911\uc778 VM\uc758 \uba38\uc2e0 \ud0c0\uc785 \ubcc0\uacbd (\uc911\uc9c0 \ud6c4 \uc2e4\ud589 \ud544\uc694)\ngcloud compute instances set-machine-type &lt;VM\uc774\ub984&gt; --machine-type e2-standard-4\n</code></pre>"},{"location":"cloud/gcp-cheatsheet/#2-image","title":"2. \uc774\ubbf8\uc9c0 (Image) \uad00\ub9ac","text":"<p>\ubd80\ud305 \ub514\uc2a4\ud06c\uc6a9 OS \uc774\ubbf8\uc9c0 \uad00\ub828 \uba85\ub839\uc5b4\uc785\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \uc124\uba85 \ubaa9\ub85d \uc870\ud68c <code>gcloud compute images list</code> \uc0ac\uc6a9 \uac00\ub2a5\ud55c \uacf5\uc6a9/\uc0ac\uc124 \uc774\ubbf8\uc9c0 \ubaa9\ub85d \uc0c1\uc138 \uc870\ud68c <code>gcloud compute images describe &lt;\uc774\ubbf8\uc9c0\uba85&gt; --project &lt;\ud504\ub85c\uc81d\ud2b8ID&gt;</code> \uc774\ubbf8\uc9c0 \uc0c1\uc138 \uc815\ubcf4 \ud655\uc778 \uc774\ubbf8\uc9c0 \uc0dd\uc131 <code>gcloud compute images create &lt;\uc774\ubbf8\uc9c0\uba85&gt; --source-disk &lt;\uc6d0\ubcf8\ub514\uc2a4\ud06c&gt; --source-disk-zone &lt;\uc874&gt;</code> \ub514\uc2a4\ud06c\ub85c\ubd80\ud130 \ucee4\uc2a4\ud140 \uc774\ubbf8\uc9c0 \uc0dd\uc131 \uc0ad\uc81c <code>gcloud compute images delete &lt;\uc774\ubbf8\uc9c0\uba85&gt;</code> \ucee4\uc2a4\ud140 \uc774\ubbf8\uc9c0 \uc0ad\uc81c"},{"location":"cloud/gcp-cheatsheet/#os","title":"\ud83d\udd27 OS \uc774\ubbf8\uc9c0 \ucc3e\uae30 (\ud544\ud130\ub9c1)","text":"<pre><code># Rocky Linux 9 \uacc4\uc5f4 \uc774\ubbf8\uc9c0 \ucc3e\uae30\ngcloud compute images list --project rocky-linux-cloud --filter=\"name ~ rocky-linux-9\"\n\n# \ud2b9\uc815 OS\uc758 \ucd5c\uc2e0 \ubc84\uc804 Family \ud655\uc778\ngcloud compute images describe-from-family rocky-linux-9 --project rocky-linux-cloud\n\n# --show-deprecated \uc635\uc158\uc744 \ud1b5\ud574 \uc608\uc804 \uc774\ubbf8\uc9c0\ub3c4 \ud655\uc778 \uac00\ub2a5\ngcloud compute images list \\\n  --project rocky-linux-cloud \\\n  --show-deprecated \\\n  --sort-by=\"~creationTimestamp\"\n</code></pre>"},{"location":"cloud/gcp-cheatsheet/#3-flavor","title":"3. \uba38\uc2e0 \ud0c0\uc785 (Flavor) \uc870\ud68c","text":"<p>GCP\ub294 \uc0ac\uc6a9\uc790\uac00 Flavor\ub97c \uc9c1\uc811 \ub9cc\ub4e4\uae30\ubcf4\ub2e4, \ubbf8\ub9ac \uc815\uc758\ub41c Machine Type\uc744 \uc870\ud68c\ud558\uc5ec \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \ubaa9\ub85d \uc870\ud68c <code>gcloud compute machine-types list</code> \ud544\ud130\ub9c1 \uc870\ud68c <code>gcloud compute machine-types list --filter=\"name ~ e2-standard\"</code> \uc0c1\uc138 \uc2a4\ud399 <code>gcloud compute machine-types describe &lt;\ud0c0\uc785\uba85&gt;</code>"},{"location":"cloud/gcp-cheatsheet/#gpu","title":"\ud83c\udfae GPU \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 \uc608\uc2dc","text":"<p>GCP\uc5d0\uc11c GPU\ub97c \ubd99\uc77c \ub54c\ub294 <code>--accelerator</code> \uc635\uc158\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code># T4 GPU 1\uac1c\ub97c \ubd80\ucc29\ud55c \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131\ngcloud compute instances create &lt;VM\uc774\ub984&gt; \\\n    --machine-type n1-standard-4 \\\n    --accelerator type=nvidia-tesla-t4,count=1 \\\n    --maintenance-policy TERMINATE \\\n    --image-family common-cu113 \\\n    --image-project deeplearning-platform-release\n</code></pre>"},{"location":"cloud/gcp-cheatsheet/#4-vpc","title":"4. \ub124\ud2b8\uc6cc\ud06c (VPC) \uad00\ub9ac","text":"<p>VPC \ub124\ud2b8\uc6cc\ud06c \ubc0f \ubc29\ud654\ubcbd \uaddc\uce59 \uad00\ub9ac\uc785\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \uc124\uba85 \ub124\ud2b8\uc6cc\ud06c \ubaa9\ub85d <code>gcloud compute networks list</code> VPC \ubaa9\ub85d \uc870\ud68c \uc11c\ube0c\ub137 \ubaa9\ub85d <code>gcloud compute networks subnets list</code> \uc11c\ube0c\ub137 IP \ub300\uc5ed \ud655\uc778 \ubc29\ud654\ubcbd \ubaa9\ub85d <code>gcloud compute firewall-rules list</code> \uc801\uc6a9\ub41c \ubc29\ud654\ubcbd \uaddc\uce59 \ud655\uc778 \ubc29\ud654\ubcbd \uc0dd\uc131 <code>gcloud compute firewall-rules create &lt;\uaddc\uce59\uba85&gt; --allow tcp:80,tcp:443</code> \ud3ec\ud2b8 \uac1c\ubc29 \ubc29\ud654\ubcbd \uc0ad\uc81c <code>gcloud compute firewall-rules delete &lt;\uaddc\uce59\uba85&gt;</code> \uaddc\uce59 \uc0ad\uc81c"},{"location":"cloud/gcp-cheatsheet/#ip-static-external-ip","title":"\ud83c\udf10 \uace0\uc815 IP (Static External IP)","text":"<p>OpenStack\uc758 Floating IP\uc5d0 \ud574\ub2f9\ud569\ub2c8\ub2e4.</p> <pre><code># \uace0\uc815 IP \uc608\uc57d (\uc0dd\uc131)\ngcloud compute addresses create &lt;IP\uc774\ub984&gt; --region &lt;\ub9ac\uc804&gt;\n\n# \uc608\uc57d\ub41c IP \ubaa9\ub85d \ud655\uc778 (\uc2e4\uc81c IP \uc8fc\uc18c \ud655\uc778)\ngcloud compute addresses list\n\n# \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 \uc2dc \uace0\uc815 IP \ud560\ub2f9\ngcloud compute instances create &lt;VM\uc774\ub984&gt; --address &lt;IP\uc8fc\uc18c_\ub610\ub294_IP\uc774\ub984&gt;\n</code></pre>"},{"location":"cloud/gcp-cheatsheet/#5-disk-bucket","title":"5. \uc2a4\ud1a0\ub9ac\uc9c0 (Disk &amp; Bucket) \uad00\ub9ac","text":"<p>\ube14\ub85d \uc2a4\ud1a0\ub9ac\uc9c0(Persistent Disk)\uc640 \uac1d\uccb4 \uc2a4\ud1a0\ub9ac\uc9c0(GCS) \uad00\ub9ac\uc785\ub2c8\ub2e4.</p>"},{"location":"cloud/gcp-cheatsheet/#persistent-disk-cinder","title":"\ud83d\udcbe \uc601\uad6c \ub514\uc2a4\ud06c (Persistent Disk) - Cinder \ub300\uc751","text":"\uc791\uc5c5 \uba85\ub839\uc5b4 \ubaa9\ub85d \uc870\ud68c <code>gcloud compute disks list</code> \uc0dd\uc131 <code>gcloud compute disks create &lt;\ub514\uc2a4\ud06c\uba85&gt; --size 100GB --type pd-ssd</code> \ud06c\uae30 \ud655\uc7a5 <code>gcloud compute disks resize &lt;\ub514\uc2a4\ud06c\uba85&gt; --size 200GB</code> VM \ubd80\ucc29 <code>gcloud compute instances attach-disk &lt;VM\uc774\ub984&gt; --disk &lt;\ub514\uc2a4\ud06c\uba85&gt;</code> \uc2a4\ub0c5\uc0f7 <code>gcloud compute disks snapshot &lt;\ub514\uc2a4\ud06c\uba85&gt; --snapshot-names &lt;\uc2a4\ub0c5\uc0f7\uba85&gt;</code>"},{"location":"cloud/gcp-cheatsheet/#gcs-object-storage-swifts3","title":"\ud83d\udce6 GCS \ubc84\ud0b7 (Object Storage) - Swift/S3 \ub300\uc751","text":"<p><code>gcloud storage</code> \ub610\ub294 \uad6c\ud615 <code>gsutil</code> \uba85\ub839\uc5b4\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4. (\ucd5c\uc2e0 \ubc84\uc804\uc740 <code>gcloud storage</code> \uad8c\uc7a5)</p> <pre><code># \ubc84\ud0b7 \ubaa9\ub85d \uc870\ud68c\ngcloud storage buckets list\n\n# \ud30c\uc77c \uc5c5\ub85c\ub4dc (\ub85c\uceec -&gt; \ubc84\ud0b7)\ngcloud storage cp &lt;\ub85c\uceec\ud30c\uc77c&gt; gs://&lt;\ubc84\ud0b7\uba85&gt;/\n\n# \ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc (\ubc84\ud0b7 -&gt; \ub85c\uceec)\ngcloud storage cp gs://&lt;\ubc84\ud0b7\uba85&gt;/&lt;\ud30c\uc77c&gt; &lt;\ub85c\uceec\uacbd\ub85c&gt;\n</code></pre>"},{"location":"cloud/gcp-cheatsheet/#6-kubernetes-gke","title":"6. Kubernetes (GKE) \uad00\ub9ac","text":"<p>GCP\uc758 \ud575\uc2ec\uc778 \uad00\ub9ac\ud615 \ucfe0\ubc84\ub124\ud2f0\uc2a4 \uc5d4\uc9c4 \uba85\ub839\uc5b4\uc785\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \uc124\uba85 \ud074\ub7ec\uc2a4\ud130 \ubaa9\ub85d <code>gcloud container clusters list</code> GKE \ud074\ub7ec\uc2a4\ud130 \uc0c1\ud0dc \ud655\uc778 \ud074\ub7ec\uc2a4\ud130 \uc0dd\uc131 <code>gcloud container clusters create &lt;\uc774\ub984&gt; --num-nodes 3</code> \uae30\ubcf8 \ud074\ub7ec\uc2a4\ud130 \uc0dd\uc131 \uc790\uaca9\uc99d\uba85 \uac00\uc838\uc624\uae30 <code>gcloud container clusters get-credentials &lt;\uc774\ub984&gt;</code> (\ud544\uc218) <code>kubectl</code> \uc0ac\uc6a9\uc744 \uc704\ud55c kubeconfig \uc790\ub3d9 \uc124\uc815 \ub178\ub4dc\ud480 \uad00\ub9ac <code>gcloud container node-pools list --cluster &lt;\ud074\ub7ec\uc2a4\ud130\uba85&gt;</code> \ub178\ub4dc \uadf8\ub8f9 \ud655\uc778"},{"location":"cloud/gcp-cheatsheet/#7-iam","title":"7. IAM \ubc0f \ud504\ub85c\uc81d\ud2b8 \uad00\ub9ac","text":"<p>\uad8c\ud55c \ubc0f \ud504\ub85c\uc81d\ud2b8 \uc124\uc815\uc785\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \uc124\uba85 \ud504\ub85c\uc81d\ud2b8 \ubaa9\ub85d <code>gcloud projects list</code> \uc811\uadfc \uac00\ub2a5\ud55c \ud504\ub85c\uc81d\ud2b8 ID \ud655\uc778 \ud604\uc7ac \uc124\uc815 <code>gcloud config list</code> \ud604\uc7ac \ud65c\uc131\ud654\ub41c \uacc4\uc815/\ud504\ub85c\uc81d\ud2b8/\ub9ac\uc804 \ud655\uc778 IAM \uc815\ucc45 \uc870\ud68c <code>gcloud projects get-iam-policy &lt;\ud504\ub85c\uc81d\ud2b8ID&gt;</code> \ub204\uad6c\uc5d0\uac8c \uc5b4\ub5a4 \uad8c\ud55c\uc774 \uc788\ub294\uc9c0 \ud655\uc778 \uc11c\ube44\uc2a4 \uacc4\uc815 \ud0a4 <code>gcloud iam service-accounts keys create key.json --iam-account &lt;\uacc4\uc815\uba54\uc77c&gt;</code> API \ud0a4 \ud30c\uc77c(JSON) \ub2e4\uc6b4\ub85c\ub4dc"},{"location":"cloud/gcp-cheatsheet/#_2","title":"\ud83d\udca1 \ud301: \ucd9c\ub825 \ud3ec\ub9f7\ud305 (\uc2a4\ud06c\ub9bd\ud2b8\uc6a9)","text":"<p>OpenStack\uc758 <code>-c</code>, <code>-f</code> \uc635\uc158\uacfc \uc720\uc0ac\ud558\uac8c GCP\ub294 <code>--format</code> \ud50c\ub798\uadf8\uac00 \ub9e4\uc6b0 \uac15\ub825\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \ud14c\uc774\ube14\uc5d0\uc11c \ud2b9\uc815 \uceec\ub7fc\ub9cc \ubcf4\uae30\ngcloud compute instances list --format=\"table(name, status, networkInterfaces[0].networkIP)\"\n\n# 2. JSON \ud615\ud0dc\ub85c \uc804\uccb4 \ubcf4\uae30\ngcloud compute instances describe &lt;VM\uc774\ub984&gt; --format=\"json\"\n\n# 3. \ud2b9\uc815 \uac12\ub9cc \ub531 \ubf51\uc544\ub0b4\uae30 (\uc2a4\ud06c\ub9bd\ud2b8 \ubcc0\uc218 \ud560\ub2f9\uc6a9)\n# \uc608: \ud2b9\uc815 VM\uc758 \uc678\ubd80 IP(NAT IP)\ub9cc \ucd94\ucd9c\ngcloud compute instances describe &lt;VM\uc774\ub984&gt; \\\n  --format=\"value(networkInterfaces[0].accessConfigs[0].natIP)\"\n\n# 4. \ud544\ud130 \ubc0f \uc815\ub82c\n# \uc608: \uc0dd\uc131\ub41c \uc2dc\uac04\uc5d0 \ub530\ub77c \uc815\ub82c\ngcloud compute images list \\\n  --project rocky-linux-cloud \\\n  --sort-by=\"~creationTimestamp\"\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/","title":"\ud83d\udcd8 [GCP] \ud3d0\uc1c4\ub9dd Kubernetes \uc778\ud504\ub77c \uad6c\ucd95 \uc644\ubcbd \uac00\uc774\ub4dc","text":"<p>\uc774 \ubb38\uc11c\ub294 Windows WSL2(Ubuntu) \ud658\uacbd\uc5d0\uc11c Google Cloud Platform(GCP) \uc0c1\uc5d0 \uc644\uc804 \ud3d0\uc1c4\ub9dd(Air-gapped) \uae30\ubc18\uc758 \uace0\uac00\uc6a9\uc131(HA) \uc778\ud504\ub77c\ub97c \uad6c\ucd95\ud558\ub294 \ub9e4\ub274\uc5bc\uc785\ub2c8\ub2e4.</p> <p>\uad6c\uc131 \ubaa9\ud45c: Bastion(1\ub300) + Master(3\ub300) + Worker(3\ub300) + DB(3\ub300) = \ucd1d 10\ub300 \uc8fc\uc758: \uc2e0\uaddc \uacc4\uc815\uc740 vCPU \uc81c\ud55c(12\uac1c)\uc774 \uc788\uc5b4, \ubc18\ub4dc\uc2dc \ud560\ub2f9\ub7c9 \uc0c1\ud5a5 \uc694\uccad(Step 3)\uc744 \uba3c\uc800 \uc218\ud589\ud574\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"cloud/use_terraform_with_gcp/#1","title":"\ud83d\ude80 1\ub2e8\uacc4: \ud544\uc218 \ub3c4\uad6c \uc124\uce58","text":"<p>GCP\uc640 \ud1b5\uc2e0\ud558\uae30 \uc704\ud55c \ucd5c\uc2e0 \ub3c4\uad6c\ub97c \uc124\uce58\ud569\ub2c8\ub2e4.</p>"},{"location":"cloud/use_terraform_with_gcp/#1-terraform","title":"1. Terraform \uc124\uce58","text":"<pre><code>sudo apt-get update &amp;&amp; sudo apt-get install -y gnupg software-properties-common\n\nwget -O- https://apt.releases.hashicorp.com/gpg | \\\ngpg --dearmor | \\\nsudo tee /usr/share/keyrings/hashicorp-archive-keyring.gpg &gt; /dev/null\n\necho \"deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] \\\nhttps://apt.releases.hashicorp.com $(lsb_release -cs) main\" | \\\nsudo tee /etc/apt/sources.list.d/hashicorp.list\n\nsudo apt-get update &amp;&amp; sudo apt-get install terraform\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/#2-google-cloud-sdk-gcloud-cli","title":"2. Google Cloud SDK (gcloud CLI) \uc124\uce58","text":"<pre><code>echo \"deb [signed-by=/usr/share/keyrings/cloud.google.gpg] https://packages.cloud.google.com/apt cloud-sdk main\" | sudo tee -a /etc/apt/sources.list.d/google-cloud-sdk.list\n\ncurl https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key --keyring /usr/share/keyrings/cloud.google.gpg add -\n\nsudo apt-get update &amp;&amp; sudo apt-get install google-cloud-cli\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/#2-gcp","title":"\ud83d\ude80 2\ub2e8\uacc4: GCP \uc778\uc99d \ubc0f \uc0ac\uc804 \uc900\ube44","text":"<p>\uc774 \uacfc\uc815\uc744 \uac74\ub108\ub6f0\uba74 <code>403 Forbidden</code> \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud569\ub2c8\ub2e4.</p>"},{"location":"cloud/use_terraform_with_gcp/#1-adc","title":"1. \ub85c\uadf8\uc778 \ubc0f ADC \uc124\uc815","text":"<pre><code># \ube0c\ub77c\uc6b0\uc800 \ub85c\uadf8\uc778 (\uacc4\uc815 \uad8c\ud55c \ud68d\ub4dd)\ngcloud auth login\n\n# Terraform\uc6a9 \uc778\uc99d \ud1a0\ud070 \uc0dd\uc131 (\ud544\uc218 \uacfc\uc815)\ngcloud auth application-default login\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/#2-api","title":"2. \ud504\ub85c\uc81d\ud2b8 \uc5f0\uacb0 \ubc0f API \ud65c\uc131\ud654","text":"<p>\ubcf8\uc778\uc758 \ud504\ub85c\uc81d\ud2b8 ID\ub97c \uc815\ud655\ud788 \uc785\ub825\ud558\uc138\uc694.</p> <pre><code># [\uc218\uc815] \ubcf8\uc778\uc758 \ud504\ub85c\uc81d\ud2b8 ID\ub85c \ubcc0\uacbd\nexport MY_PROJECT_ID=\"rocky-k8s-airgap\" \n\n# \ud504\ub85c\uc81d\ud2b8 \uc9c0\uc815\ngcloud config set project $MY_PROJECT_ID\n\n# Compute Engine API \ud65c\uc131\ud654 (\uac00\uc0c1\uba38\uc2e0 \uc0dd\uc131 \uad8c\ud55c \ucf1c\uae30)\ngcloud services enable compute.googleapis.com\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/#3-ssh","title":"3. SSH \ud0a4 \uc0dd\uc131","text":"<pre><code># \uc5d4\ud130\ub9cc \uacc4\uc18d \ub20c\ub7ec\uc11c \uae30\ubcf8 \uacbd\ub85c(~/.ssh/gcp_key)\uc5d0 \uc0dd\uc131\nssh-keygen -t rsa -f ~/.ssh/gcp_key -C \"rocky\"\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/#3-vcpu-quota","title":"\ud83d\ude80 3\ub2e8\uacc4: vCPU \ud560\ub2f9\ub7c9(Quota) \uc0c1\ud5a5 \uc694\uccad (\u2605 \ud544\uc218)","text":"<p>\ubcf8 \uac00\uc774\ub4dc\uc758 3\uc911\ud654 \uad6c\uc131\uc740 \uc57d 19 vCPU\uac00 \ud544\uc694\ud569\ub2c8\ub2e4. \ud558\uc9c0\ub9cc \uc2e0\uaddc \uacc4\uc815\uc758 \uae30\ubcf8 \ud55c\ub3c4\ub294 12 vCPU\uc774\ubbc0\ub85c, \ubc30\ud3ec \uc804 \ubc18\ub4dc\uc2dc \ud55c\ub3c4\ub97c \ub298\ub824\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"cloud/use_terraform_with_gcp/#_1","title":"\ud83d\udcca \ud544\uc694 \uc790\uc6d0 \uacc4\uc0b0","text":"<ul> <li>Bastion (e2-micro): \uc57d 1 vCPU</li> <li>Master 3\ub300 (e2-standard-2): 2 * 3 = 6 vCPU</li> <li>Worker 3\ub300 (e2-standard-2): 2 * 3 = 6 vCPU</li> <li>DB 3\ub300 (e2-standard-2): 2 * 3 = 6 vCPU</li> <li>\ucd1d\ud569: 19 vCPU \ud544\uc694 (\uc5ec\uc720 \uc788\uac8c 24 \uc774\uc0c1\uc73c\ub85c \uc694\uccad \uad8c\uc7a5)</li> </ul>"},{"location":"cloud/use_terraform_with_gcp/#_2","title":"\ud83d\udee0\ufe0f \uc0c1\ud5a5 \uc694\uccad \ubc29\ubc95 (\uc6f9 \ucf58\uc194)","text":"<ol> <li>GCP \ucf58\uc194 - \ud560\ub2f9\ub7c9(Quotas) \ud398\uc774\uc9c0 \ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4.</li> <li>\ud544\ud130 \ucc3d\uc5d0 <code>CPUS_ALL_REGIONS</code>\ub77c\uace0 \uc785\ub825\ud569\ub2c8\ub2e4.</li> <li>\uc11c\ube44\uc2a4\uac00 Compute Engine API\uc778 \ud56d\ubaa9(<code>CPUS-ALL-REGIONS-per-project</code>)\uc744 \ucc3e\uc544 \uccb4\ud06c\ubc15\uc2a4\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4.</li> <li>\uc0c1\ub2e8\uc758 [\ud560\ub2f9\ub7c9 \uc218\uc815 (EDIT QUOTAS)] \ubc84\ud2bc\uc744 \ud074\ub9ad\ud569\ub2c8\ub2e4.</li> <li>\uc0c8 \ud55c\ub3c4 \uc785\ub825 \uce78\uc5d0 24 (\ub610\ub294 32)\ub97c \uc785\ub825\ud569\ub2c8\ub2e4.</li> <li>\uc694\uccad \uc0ac\uc720\uc5d0 <code>Kubernetes HA Cluster Test</code> \ub77c\uace0 \uc801\uace0 \uc81c\ucd9c\ud569\ub2c8\ub2e4.<ul> <li>\uc2b9\uc778\uc740 \ubcf4\ud1b5 \uba87 \ubd84 \ub0b4\ub85c \uc644\ub8cc\ub418\uc9c0\ub9cc, \uc2e0\uaddc \uacc4\uc815 \uac80\ud1a0\ub85c \uc778\ud574 \ucd5c\ub300 1~2\uc77c\uc774 \uac78\ub9b4 \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4.</li> <li>\uc2b9\uc778 \uba54\uc77c\uc744 \ubc1b\uc73c\uba74 4\ub2e8\uacc4\ub85c \ub118\uc5b4\uac00\uc138\uc694.</li> </ul> </li> </ol>"},{"location":"cloud/use_terraform_with_gcp/#4-terraform","title":"\ud83d\ude80 4\ub2e8\uacc4: Terraform \ucf54\ub4dc \uc791\uc131","text":""},{"location":"cloud/use_terraform_with_gcp/#1_1","title":"1. \ud30c\uc77c \uc0dd\uc131","text":"<pre><code>mkdir ~/gcp-k8s-airgap &amp;&amp; cd ~/gcp-k8s-airgap\nnano main.tf\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/#2-maintf","title":"2. <code>main.tf</code> \ub0b4\uc6a9 \uc791\uc131","text":"<p>\uc0dd\uc131\ud560 \uc790\uc6d0\ub4e4 \uad6c\uc131\uc740 \uc544\ub798\uc640 \uac19\uc2b5\ub2c8\ub2e4.</p> <p></p> <p><code>project</code> \uac12\uc740 \ubc18\ub4dc\uc2dc \ubcf8\uc778 ID\ub85c \uc218\uc815\ud558\uc138\uc694.</p> <pre><code>provider \"google\" {\n  # \u2605 \ubcf8\uc778\uc758 \ud504\ub85c\uc81d\ud2b8 ID\ub85c \ubc18\ub4dc\uc2dc \uc218\uc815\ud558\uc138\uc694!\n  project = \"rocky-k8s-airgap\"\n  region  = \"asia-northeast3\"    # \uc11c\uc6b8 \ub9ac\uc804\n}\n\n# SSH \ud0a4 \ud504\ub85c\uc81d\ud2b8 \uc804\uccb4 \ub4f1\ub85d\nresource \"google_compute_project_metadata\" \"ssh_keys\" {\n  metadata = {\n    ssh-keys = \"rocky:${file(\"~/.ssh/gcp_key.pub\")}\"\n  }\n}\n\n# 1. VPC \ub124\ud2b8\uc6cc\ud06c (\ud3d0\uc1c4\ub9dd)\nresource \"google_compute_network\" \"vpc\" {\n  name                    = \"k8s-airgap-vpc\"\n  auto_create_subnetworks = false  # \uc11c\ube0c\ub137 \uc790\ub3d9 \uc0dd\uc131 \ube44\ud65c\uc131\ud654\n}\n\nresource \"google_compute_subnetwork\" \"public_subnet\" {\n  name          = \"public-subnet\"\n  ip_cidr_range = \"10.0.1.0/24\"\n  region        = \"asia-northeast3\"\n  network       = google_compute_network.vpc.id\n}\n\nresource \"google_compute_subnetwork\" \"private_subnet\" {\n  name                     = \"private-subnet\"\n  ip_cidr_range            = \"10.0.2.0/24\"\n  region                   = \"asia-northeast3\"\n  network                  = google_compute_network.vpc.id\n  private_ip_google_access = false # \uc644\uc804 \ud3d0\uc1c4 (\uc778\ud130\ub137 \ubd88\uac00)\n}\n\n# 2. \ubc29\ud654\ubcbd \uaddc\uce59\nresource \"google_compute_firewall\" \"allow_ssh_bastion\" {\n  name    = \"allow-ssh-bastion\"\n  network = google_compute_network.vpc.id\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n  source_ranges = [\"0.0.0.0/0\"]\n  target_tags   = [\"bastion\"]\n}\n\nresource \"google_compute_firewall\" \"allow_internal\" {\n  name    = \"allow-internal\"\n  network = google_compute_network.vpc.id\n  allow { protocol = \"all\" }\n  source_tags = [\"internal-node\", \"bastion\"]\n  target_tags = [\"internal-node\", \"bastion\"]\n}\n\n# 3. VM \uc778\uc2a4\ud134\uc2a4\nresource \"google_compute_instance\" \"bastion\" {\n  name         = \"bastion-host\"\n  machine_type = \"e2-micro\"\n  zone         = \"asia-northeast3-a\"\n  tags         = [\"bastion\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"rocky-linux-cloud/rocky-linux-9\"\n    }\n  }\n\n  network_interface {\n    subnetwork = google_compute_subnetwork.public_subnet.id\n    access_config {} # \uacf5\uc778 IP \ud560\ub2f9\n  }\n}\n\nresource \"google_compute_instance\" \"k8s_masters\" {\n  count        = 3\n  name         = \"k8s-master-${count.index + 1}\"\n  machine_type = \"e2-standard-2\" # 2 vCPU, 8GB Ram\n  zone         = \"asia-northeast3-a\"\n  tags         = [\"k8s-master\", \"internal-node\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"rocky-linux-cloud/rocky-linux-9\"\n      size  = 30\n    }\n  }\n\n  network_interface {\n    subnetwork = google_compute_subnetwork.private_subnet.id\n  }\n}\n\nresource \"google_compute_instance\" \"k8s_workers\" {\n  count        = 3\n  name         = \"k8s-worker-${count.index + 1}\"\n  machine_type = \"e2-standard-2\"\n  zone         = \"asia-northeast3-a\"\n  tags         = [\"k8s-worker\", \"internal-node\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"rocky-linux-cloud/rocky-linux-9\"\n      size  = 30\n    }\n  }\n\n  network_interface {\n    subnetwork = google_compute_subnetwork.private_subnet.id\n  }\n}\n\nresource \"google_compute_instance\" \"db_nodes\" {\n  count        = 3\n  name         = \"mariadb-node-${count.index + 1}\"\n  machine_type = \"e2-standard-2\"\n  zone         = \"asia-northeast3-a\"\n  tags         = [\"db-node\", \"internal-node\"]\n\n  boot_disk {\n    initialize_params {\n      image = \"rocky-linux-cloud/rocky-linux-9\"\n      size  = 30\n    }\n  }\n\n  network_interface {\n    subnetwork = google_compute_subnetwork.private_subnet.id\n  }\n}\n\noutput \"bastion_ip\" {\n  value = google_compute_instance.bastion.network_interface.0.access_config.0.nat_ip\n}\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/#5","title":"\ud83d\ude80 5\ub2e8\uacc4: \ubc30\ud3ec \ubc0f \uc811\uc18d \uc124\uc815","text":""},{"location":"cloud/use_terraform_with_gcp/#1_2","title":"1. \uc778\ud504\ub77c \ubc30\ud3ec","text":"<pre><code>terraform init\nterraform plan\nterraform apply\n# (\ub0b4\uc6a9 \ud655\uc778 \ud6c4 yes \uc785\ub825)\n</code></pre> <p>\ucc38\uace0: \ud560\ub2f9\ub7c9 \uc0c1\ud5a5\uc774 \uc544\uc9c1 \uc548 \ub418\uc5c8\ub2e4\uba74 \uc5ec\uae30\uc11c \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud569\ub2c8\ub2e4.</p>"},{"location":"cloud/use_terraform_with_gcp/#2-sshconfig","title":"2. \uc811\uc18d \ud3b8\uc758\uc131 \uc124\uc815 (<code>~/.ssh/config</code>)","text":"<p>\ubc30\ud3ec \ud6c4 \ucd9c\ub825\ub41c <code>bastion_ip</code>\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc124\uc815 \ud30c\uc77c\uc744 \uc218\uc815\ud569\ub2c8\ub2e4.</p> <pre><code>nano ~/.ssh/config\n</code></pre> <p>[\ubd99\uc5ec\ub123\uc744 \ub0b4\uc6a9]</p> <pre><code># 1. Bastion Host\nHost bastion\n    HostName 34.xx.xx.xx        # \u2605 Terraform Output\uc758 Bastion IP\ub85c \uc218\uc815\ud558\uc138\uc694!\n    User rocky\n    IdentityFile ~/.ssh/gcp_key\n\n# 2. \ub0b4\ubd80 \ud3d0\uc1c4\ub9dd \ub178\ub4dc (\uc790\ub3d9 \uc810\ud504)\nHost 10.0.2.*\n    User rocky\n    IdentityFile ~/.ssh/gcp_key\n    ProxyJump bastion             # Bastion\uc744 \uac70\uccd0\uc11c \uc811\uc18d\n    StrictHostKeyChecking no      # (\ud14c\uc2a4\ud2b8\uc6a9) \uc9c0\ubb38 \ubcc0\uacbd \uacbd\uace0 \ubb34\uc2dc\n    UserKnownHostsFile /dev/null\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/#6","title":"\ud83d\ude80 6\ub2e8\uacc4: \uc811\uc18d \ud14c\uc2a4\ud2b8 \ubc0f \uc6b4\uc601","text":""},{"location":"cloud/use_terraform_with_gcp/#a","title":"A. \uc811\uc18d \ud14c\uc2a4\ud2b8","text":"<p>\ub0b4 PC(WSL) \ud130\ubbf8\ub110\uc5d0\uc11c \ubc14\ub85c \ub0b4\ubd80 IP\ub97c \uc785\ub825\ud558\uc5ec \uc811\uc18d\ud569\ub2c8\ub2e4.</p> <pre><code># Bastion\uc744 \uac70\uccd0 \ub9c8\uc2a4\ud130 1\ubc88 \ub178\ub4dc\ub85c \ubc14\ub85c \uc811\uc18d\nssh 10.0.2.2\n</code></pre> <p><code>[rocky@k8s-master-1 ~]$</code> \ud504\ub86c\ud504\ud2b8\uac00 \ub728\uba74 \uc131\uacf5\uc785\ub2c8\ub2e4.</p>"},{"location":"cloud/use_terraform_with_gcp/#b-scp","title":"B. \ud30c\uc77c \uc804\uc1a1 (SCP)","text":"<pre><code># \ub85c\uceec \ud30c\uc77c -&gt; \ub0b4\ubd80 \uc11c\ubc84 \uc804\uc1a1\nscp my-file.tar.gz 10.0.2.2:/home/rocky/\n</code></pre>"},{"location":"cloud/use_terraform_with_gcp/#7-clean-up","title":"\ud83d\ude80 7\ub2e8\uacc4: \uc790\uc6d0 \uc0ad\uc81c (Clean Up)","text":"<p>\ube44\uc6a9 \ubc1c\uc0dd\uc744 \ub9c9\uae30 \uc704\ud574 \ud14c\uc2a4\ud2b8\uac00 \ub05d\ub098\uba74 \ubc18\ub4dc\uc2dc \uc790\uc6d0\uc744 \uc815\ub9ac\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>terraform destroy\n# (yes \uc785\ub825)\n</code></pre>"},{"location":"db/ha/galera-cluster/","title":"\ud83d\udcd8 [\ud3d0\uc1c4\ub9dd] MariaDB 10.11 Galera Cluster \uc124\uce58 \uac00\uc774\ub4dc","text":"<p>\ud658\uacbd: Rocky Linux 9.6 / MariaDB 10.11 (Offline) \ub514\ub809\ud1a0\ub9ac: <code>mariadb-10.11.14-for-air-gapped</code> \uad6c\uc870 \uae30\ubc18 \uacc4\uc815: \uc77c\ubc18 \uc0ac\uc6a9\uc790 (sudo \uad8c\ud55c \ud544\uc218)</p>"},{"location":"db/ha/galera-cluster/#1-topology","title":"1. \uad6c\uc131 \uc815\ubcf4 (Topology)","text":"<ul> <li>Cluster Name: <code>my_galera_svc</code></li> <li>DB Root User: <code>root</code></li> </ul> \ud638\uc2a4\ud2b8\uba85 (Hostname) \uc5ed\ud560 IP (\uc791\uc131 \ud544\uc694) \ube44\uace0 galera-cluster-1 Primary (Bootstrap) <code>IP_1</code> \ucd5c\ucd08 \ud074\ub7ec\uc2a4\ud130 \uc2dc\uc791 galera-cluster-2 Member <code>IP_2</code> galera-cluster-3 Member <code>IP_3</code>"},{"location":"db/ha/galera-cluster/#2-os-3","title":"2. OS \ubc0f \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 (3\ub300 \uacf5\ud1b5)","text":""},{"location":"db/ha/galera-cluster/#21","title":"2.1 \ud638\uc2a4\ud2b8 \ud30c\uc77c \ub4f1\ub85d","text":"<p>IP \ud655\uc815 \ud6c4 3\ub300 \uc11c\ubc84 \ubaa8\ub450 \ub3d9\uc77c\ud558\uac8c \uc218\uc815\ud569\ub2c8\ub2e4.</p> <pre><code># sudo vi /etc/hosts\n# [IP\uc8fc\uc18c]          [\ud638\uc2a4\ud2b8\uba85]\n192.168.XXX.XX   galera-cluster-1\n192.168.XXX.XX   galera-cluster-2\n192.168.XXX.XX   galera-cluster-3\n</code></pre>"},{"location":"db/ha/galera-cluster/#22","title":"2.2 \ud638\uc2a4\ud2b8\ub124\uc784 \ubc0f \ubc29\ud654\ubcbd \uc124\uc815","text":"<pre><code># 1. \ud638\uc2a4\ud2b8\ub124\uc784 \ubcc0\uacbd (\uac01 \uc11c\ubc84 \ubc88\ud638\uc5d0 \ub9de\uac8c \uc2e4\ud589)\nsudo hostnamectl set-hostname galera-cluster-1\n\n# 2. SELinux Permissive \ubcc0\uacbd (\ud544\uc218)\nsudo setenforce 0\nsudo sed -i 's/^SELINUX=enforcing/SELINUX=permissive/' /etc/selinux/config\n\n# 3. \ubc29\ud654\ubcbd \ud3ec\ud2b8 \uc624\ud508\nsudo firewall-cmd --permanent --add-port={3306,4567,4568,4444}/tcp\nsudo firewall-cmd --permanent --add-port=4567/udp\nsudo firewall-cmd --reload\n</code></pre>"},{"location":"db/ha/galera-cluster/#3-offline-3","title":"3. \uc124\uce58 (Offline) - 3\ub300 \uacf5\ud1b5","text":"<p><code>mariadb-10.11.14-for-air-gapped</code> \ud3f4\ub354\uac00 \uac01 \uc11c\ubc84\uc758 \ud648 \ub514\ub809\ud1a0\ub9ac(\uc608: <code>/home/rocky</code>)\uc5d0 \uc5c5\ub85c\ub4dc\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"db/ha/galera-cluster/#31-rocky-linux-mariadb","title":"3.1 Rocky Linux \uae30\ubcf8 MariaDB \ubaa8\ub4c8 \ube44\ud65c\uc131\ud654 (\ub9e4\uc6b0 \uc911\uc694)","text":"<p>Rocky 9\uc5d0 \ub0b4\uc7a5\ub41c \uad6c\ubc84\uc804 MariaDB\uc640 \ucda9\ub3cc\ud558\uc9c0 \uc54a\ub3c4\ub85d \ubaa8\ub4c8\uc744 \ub055\ub2c8\ub2e4.</p> <pre><code>sudo dnf module disable mariadb -y --disablerepo=*\n</code></pre> <p>\ub9cc\uc57d \uc544\ub798\uc640 \uac19\uc740 \uc624\ub958\uac00 \ub0ac\ub2e4\uba74 \ucda9\ub3cc \uc704\ud5d8\uc774 \uc5c6\uc73c\ubbc0\ub85c \ub118\uc5b4\uac00\uba74 \ub429\ub2c8\ub2e4.</p> <pre><code>Unable to resolve argument mariadb\nError: Problems in request:\nmissing groups or modules: mariadb\n</code></pre>"},{"location":"db/ha/galera-cluster/#32-common","title":"3.2 \uacf5\ud1b5 \uc758\uc874\uc131 \ud328\ud0a4\uc9c0 \uc124\uce58 (<code>common</code>)","text":"<p>\uba3c\uc800 \ubca0\uc774\uc2a4\uac00 \ub418\ub294 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub4e4\uc744 \uc124\uce58\ud569\ub2c8\ub2e4.</p> <pre><code># 1. common \ud3f4\ub354\ub85c \uc774\ub3d9\ncd ~/mariadb-10.11.14-for-air-gapped/common/rpms\n\n# 2. \uc77c\uad04 \uc124\uce58\n# --disablerepo=* : \uc778\ud130\ub137 \uc5f0\uacb0 \uc2dc\ub3c4 \ucc28\ub2e8\n# --skip-broken : \uc911\ubcf5/\ucda9\ub3cc \ud328\ud0a4\uc9c0\uac00 \uc788\uc744 \uacbd\uc6b0 \ubb34\uc2dc\ud558\uace0 \uc9c4\ud589\nsudo dnf install -y ./*.rpm --disablerepo=* --skip-broken\n</code></pre>"},{"location":"db/ha/galera-cluster/#33-db-galera-db","title":"3.3 DB \ubc0f Galera \ud328\ud0a4\uc9c0 \uc124\uce58 (<code>db</code>)","text":"<p>\uc2e4\uc81c DB \uc11c\ubc84\uc640 Galera, \ubc31\uc5c5 \ub3c4\uad6c\ub97c \uc124\uce58\ud569\ub2c8\ub2e4.</p> <pre><code># 1. db \ud3f4\ub354\ub85c \uc774\ub3d9\ncd ~/mariadb-10.11.14-for-air-gapped/db/rpms\n\n# 2. \uc77c\uad04 \uc124\uce58\nsudo dnf install -y ./*.rpm --disablerepo=* --skip-broken\n</code></pre>"},{"location":"db/ha/galera-cluster/#34","title":"3.4 \uc11c\ube44\uc2a4 \ub4f1\ub85d","text":"<p>\uc124\uce58\uac00 \uc644\ub8cc\ub418\uba74 \uc11c\ube44\uc2a4\ub97c \ub4f1\ub85d\ud569\ub2c8\ub2e4. (\uc544\uc9c1 \uc2dc\uc791\ud558\uc9c0 \ub9c8\uc138\uc694!)</p> <pre><code>sudo systemctl enable mariadb\n</code></pre> <p>\uc800\uc7a5 \uacbd\ub85c\ub97c \ubcc0\uacbd\ud558\ub824\uba74 \ubbf8\ub9ac \uacbd\ub85c\uc5d0 \ub514\ub809\ud1a0\ub9ac\ub97c \uc0dd\uc131\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># 1. \ub370\uc774\ud130 \uc800\uc7a5\uc18c \ud3f4\ub354 \uc0dd\uc131 (\uc608: /app/mariadb_data)\nsudo mkdir -p /app/mariadb_data\n\n# 2. \uc18c\uc720\uad8c \ubcc0\uacbd (mysql \uacc4\uc815\uc740 RPM \uc124\uce58 \uc2dc \uc790\ub3d9 \uc0dd\uc131\ub428)\nsudo chown -R mysql:mysql /app/mariadb_data\nsudo chmod 750 /app/mariadb_data\n\n# 3. (\uc911\uc694) DB \ucd08\uae30\ud654\n# \uacbd\ub85c\ub97c \ubc14\uafe8\uae30 \ub54c\ubb38\uc5d0 \uae30\ubcf8 \uc0dd\uc131\ub41c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uc218\ub3d9\uc73c\ub85c \uc2dc\uc2a4\ud15c \ud14c\uc774\ube14\uc744 \uae54\uc544\uc918\uc57c \ud569\ub2c8\ub2e4.\nsudo mysql_install_db --user=mysql --datadir=/app/mariadb_data\n</code></pre>"},{"location":"db/ha/galera-cluster/#4-galera-3","title":"4. Galera \uc124\uc815 \ud30c\uc77c \uc791\uc131 (3\ub300 \uacf5\ud1b5)","text":"<p><code>/etc/my.cnf.d/01-galera.cnf</code> \ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <pre><code>sudo vi /etc/my.cnf.d/01-galera.cnf\n</code></pre> <p>[\uc544\ub798 \ub0b4\uc6a9 \ubd99\uc5ec\ub123\uae30 - \u26a0\ufe0f \uc11c\ubc84\ubcc4 IP \uc218\uc815 \ud544\uc218!]</p> <pre><code>[mariadb]\n# ----------------------------------------------\n# 1. \uae30\ubcf8 \ubc0f \ud638\ud658\uc131 \uc124\uc815 (Basic &amp; Compatibility)\n# ----------------------------------------------\ndatadir=/app/mariadb_data\n# \uc18c\ucf13 \ud30c\uc77c\uc740 \uac00\uae09\uc801 \uae30\ubcf8 \uc704\uce58 \uc720\uc9c0 \uad8c\uc7a5 (\ud074\ub77c\uc774\uc5b8\ud2b8 \uc811\uc18d \ud3b8\uc758\uc131)\n# \ub9cc\uc57d \uc18c\ucf13\ub3c4 \uc62e\uae30\uace0 \uc2f6\ub2e4\uba74 socket=/app/mariadb_data/mysql.sock \ucd94\uac00\n\nbind-address=0.0.0.0\ndefault_storage_engine=InnoDB\nbinlog_format=ROW\ninnodb_autoinc_lock_mode=2\n\n# [\ud29c\ub2dd] \ub300\uc18c\ubb38\uc790 \uad6c\ubd84 \uc548 \ud568 (1 = \ubb34\uc2dc, \uc18c\ubb38\uc790\ub85c \uc800\uc7a5)\n# \uc8fc\uc758: \uc774 \uc124\uc815\uc740 DB \ucd08\uae30\ud654 \uc804\uc5d0 \uc801\uc6a9\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.\nlower_case_table_names=1\n\n# [\ud29c\ub2dd] \ucee4\ub125\uc158 \uc99d\uc124 (\uae30\ubcf8 151 -&gt; 1000)\nmax_connections=1000\n\n# [\ud29c\ub2dd] SQL Mode \uc644\ud654 (ONLY_FULL_GROUP_BY \uc81c\uac70)\n# \ucffc\ub9ac \uc791\uc131 \uc2dc GROUP BY \uc808 \uc81c\uc57d\uc744 \uc644\ud654\ud558\uc5ec \ud638\ud658\uc131 \ud655\ubcf4\nsql_mode=\"STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION\"\n\n# ----------------------------------------------\n# 2. Galera Cluster \uc124\uc815 (Provider)\n# ----------------------------------------------\nwsrep_on=ON\n# \uc124\uce58\ub41c \ub77c\uc774\ube0c\ub7ec\ub9ac \uacbd\ub85c (\uacbd\ub85c \ud655\uc778 \ud544\uc218)\nwsrep_provider=/usr/lib64/galera-4/libgalera_smm.so\n\n# ----------------------------------------------\n# 3. \ud074\ub7ec\uc2a4\ud130 \uacf5\ud1b5 \uc124\uc815 (3\ub300 \uc11c\ubc84 \ubaa8\ub450 \ub3d9\uc77c)\n# ----------------------------------------------\nwsrep_cluster_name=\"my_galera_svc\"\n# 3\ub300 \ub178\ub4dc\uc758 IP\ub97c \uacf5\ubc31 \uc5c6\uc774 \ucf64\ub9c8\ub85c \ub098\uc5f4\nwsrep_cluster_address=\"gcomm://IP_1,IP_2,IP_3\"\n\n# ----------------------------------------------\n# 4. \ub178\ub4dc\ubcc4 \uace0\uc720 \uc124\uc815 (\u26a0\ufe0f \uc11c\ubc84\ub9c8\ub2e4 \uc218\uc815 \ud544\uc218!)\n# ----------------------------------------------\n# \ud604\uc7ac \uc11c\ubc84\uc758 IP \uc8fc\uc18c\nwsrep_node_address=\"\ubcf8\uc778_\uc11c\ubc84_IP\"\n# \ud604\uc7ac \uc11c\ubc84\uc758 \ud638\uc2a4\ud2b8\uba85 (galera-cluster-1, 2, 3)\nwsrep_node_name=\"galera-cluster-X\"\n\n# ----------------------------------------------\n# 5. \ub3d9\uae30\ud654 \ubc29\uc2dd (SST)\n# ----------------------------------------------\nwsrep_sst_method=mariabackup\n</code></pre>"},{"location":"db/ha/galera-cluster/#5","title":"5. \ud074\ub7ec\uc2a4\ud130 \uae30\ub3d9 (\uc21c\uc11c \uc900\uc218!)","text":""},{"location":"db/ha/galera-cluster/#step-1-galera-cluster-1-bootstrap","title":"\ud83d\ude80 [Step 1] galera-cluster-1 (Bootstrap)","text":"<p>\ubc18\ub4dc\uc2dc 1\ubc88 \uc11c\ubc84\uc5d0\uc11c \uac00\uc7a5 \uba3c\uc800 \uc2e4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \ud074\ub7ec\uc2a4\ud130 \ucd08\uae30\ud654 (New Cluster)\nsudo galera_new_cluster\n\n# 2. \ud074\ub7ec\uc2a4\ud130 \uc0c1\ud0dc \ud655\uc778 (Size\uac00 1\uc774\uc5b4\uc57c \ud568)\nsudo mariadb -u root -e \"SHOW STATUS LIKE 'wsrep_cluster_size';\"\n</code></pre>"},{"location":"db/ha/galera-cluster/#step-2-galera-cluster-2","title":"\ud83d\ude80 [Step 2] galera-cluster-2","text":"<pre><code># 1. \uc11c\ube44\uc2a4 \uc2dc\uc791 (\uc790\ub3d9\uc73c\ub85c 1\ubc88\uc5d0 \ud569\ub958)\nsudo systemctl start mariadb\n\n# 2. \ud655\uc778 (Size\uac00 2\ub85c \ub298\uc5b4\ub098\uc57c \ud568)\nsudo mariadb -u root -e \"SHOW STATUS LIKE 'wsrep_cluster_size';\"\n</code></pre>"},{"location":"db/ha/galera-cluster/#step-3-galera-cluster-3","title":"\ud83d\ude80 [Step 3] galera-cluster-3","text":"<pre><code># 1. \uc11c\ube44\uc2a4 \uc2dc\uc791\nsudo systemctl start mariadb\n\n# 2. \ucd5c\uc885 \ud655\uc778 (Size\uac00 3\uc774\uc5b4\uc57c \ud568)\nsudo mariadb -u root -e \"SHOW STATUS LIKE 'wsrep_cluster_size';\"\n</code></pre>"},{"location":"db/ha/galera-cluster/#6-validation","title":"6. \uac80\uc99d (Validation)","text":"<ol> <li> <p>Node 1\uc5d0\uc11c DB \uc0dd\uc131:</p> <pre><code>sudo mariadb -u root -e \"CREATE DATABASE galera_test_db;\"\n</code></pre> </li> <li> <p>Node 3\uc5d0\uc11c \ud655\uc778:</p> <pre><code>sudo mariadb -u root -e \"SHOW DATABASES;\"\n</code></pre> <ul> <li><code>galera_test_db</code>\uac00 \ubcf4\uc774\uba74 3\uc911\ud654 \uc131\uacf5\uc785\ub2c8\ub2e4.</li> </ul> </li> <li> <p>K8s \ub178\ub4dc\uc640 \uc5f0\uacb0\ud558\uae30</p> </li> </ol> <p>\ub9cc\uc57d, \ub2e4\ub978 \ub178\ub4dc\uc5d0 \uc788\ub294 K8s\uac00 \uc811\uc18d\ud574\uc57c \ud55c\ub2e4\uba74 IP \ud5c8\uc6a9 \uaddc\uce59\uc744 \ucd94\uac00\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>-- K8s \ud30c\ub4dc\ub4e4\uc774 \uc0ac\uc6a9\ud560 \uacc4\uc815 \uc0dd\uc131\n-- '20.%'\ub294 20.\uc73c\ub85c \uc2dc\uc791\ud558\ub294 \ubaa8\ub4e0 IP \ud5c8\uc6a9\nCREATE USER 'k8s_app_user'@'20.%' IDENTIFIED BY 'K8s_Passw0rd!';\nGRANT ALL PRIVILEGES ON *.* TO 'k8s_app_user'@'20.%';\nFLUSH PRIVILEGES;\n</code></pre> <p>\ud14c\uc2a4\ud2b8 \ud639\uc740 \uac1c\ubc1c \ud658\uacbd\uc774\ub77c\uba74 \ud3b8\uc758\ub97c \uc704\ud574 <code>root</code> \uacc4\uc815\uc744 \uc5f4\uc5b4\ub3c4 \uad1c\ucc2e\uc9c0\ub9cc \ube44\uad8c\uc7a5 \uc0ac\ud56d\uc785\ub2c8\ub2e4.</p> <pre><code>-- 1. root \uacc4\uc815\uc744 20.x.x.x \ub300\uc5ed\uc5d0\uc11c \uc811\uc18d \ud5c8\uc6a9\n-- IDENTIFIED BY \ub4a4\uc5d0 '\ube44\ubc00\ubc88\ud638'\ub97c \uaf2d \uc9c0\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'20.%' IDENTIFIED BY '\uc124\uc815\ud560_\ube44\ubc00\ubc88\ud638' WITH GRANT OPTION;\n\n-- 2. \uc801\uc6a9\nFLUSH PRIVILEGES;\n</code></pre> <p>\uc801\uc6a9\ub418\uc5c8\ub294\uc9c0\ub294 \uc784\uc2dc \ud30c\ub4dc\ub97c \ub9cc\ub4e4\uc5b4\uc11c \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>kubectl run tmp-shell --rm -it \\\n  --image=docker.io/library/busybox:latest \\\n  --image-pull-policy=Never \\\n  --restart=Never -- sh\n</code></pre> <pre><code>telnet &lt;IP_1&gt; 3306\n\n# \uc544\ub798\ucc98\ub7fc Connected\uc640 \uae68\uc9c4 \ubb38\uc790\uc5f4\uc774 \ub098\uc624\uba74 \uc5f0\uacb0\ub41c \uac83\uc785\ub2c8\ub2e4.\nConnected to 20.0.0.140\nZ\n5.5.5-10.11.14-MariaDBI5j;$CcK\ufffd+4cuF:1'nv)cmysql_native_password\n</code></pre>"},{"location":"db/install/ready-mariadb-air-gapped-install/","title":"MariaDB \ud3d0\uc1c4\ub9dd \uc124\uce58\uc6a9 \ud30c\uc77c \ub9cc\ub4e4\uae30","text":"<ul> <li>\uc0ac\uc6a9\ud558\uace0\uc790 \ud558\ub294 \ud658\uacbd\uacfc \ub3d9\uc77c\ud55c \uc11c\ubc84\uc5d0\uc11c \uc791\uc5c5\ud574\uc57c \ud569\ub2c8\ub2e4.</li> <li>\uc774 \ubb38\uc11c\ub294 Rocky 9.6 \ubc84\uc804\uc744 \uae30\uc900\uc73c\ub85c \ub9cc\ub4e4\uc5b4\uc84c\uc2b5\ub2c8\ub2e4.</li> </ul>"},{"location":"db/install/ready-mariadb-air-gapped-install/#1","title":"\ud83d\udccc 1\ub2e8\uacc4: \uc791\uc5c5 \ud658\uacbd \uc900\ube44 (\uc678\ubd80\ub9dd \uc11c\ubc84)","text":"<p>\uac00\uc838\uac08 \ud30c\uc77c\ub4e4\uc744 \ubaa8\uc744 \ub514\ub809\ud1a0\ub9ac\ub97c \ub9cc\ub4ed\ub2c8\ub2e4.</p> <pre><code># \uc791\uc5c5 \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131\nmkdir -p ~/offline-dist-db/rpms\ncd ~/offline-dist-db\n\n# \uc678\ubd80\ub9dd \uc11c\ubc84 \uc790\uccb4\ub97c \uc704\ud55c \ub3c4\uad6c \uc124\uce58 (\uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc\uc6a9)\nsudo dnf install -y yum-utils\n</code></pre>"},{"location":"db/install/ready-mariadb-air-gapped-install/#2","title":"\ud83d\udccc 2\ub2e8\uacc4: \ub808\ud3ec\uc9c0\ud1a0\ub9ac \ub4f1\ub85d (\uc18c\uc2a4 \ud655\ubcf4)","text":"<p>Rocky 9.6 \uae30\ubcf8 \ub808\ud3ec\uc9c0\ud1a0\ub9ac \uc678\uc5d0 \uc6b0\ub9ac\uac00 \ud544\uc694\ud55c MariaDB \uacf5\uc2dd \uc800\uc7a5\uc18c\ub97c \ub4f1\ub85d\ud569\ub2c8\ub2e4.</p> <pre><code># MariaDB 10.11 Repo (\uc2dc\ub9ac\uc988 \uc804\uccb4 \uc9c0\uc815)\ncat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/mariadb.repo\n[mariadb]\nname = MariaDB\nbaseurl = https://rpm.mariadb.org/10.11/rhel/\\$releasever/\\$basearch\ngpgkey=https://rpm.mariadb.org/RPM-GPG-KEY-MariaDB\ngpgcheck=1\nEOF\n\n# \ub808\ud3ec\uc9c0\ud1a0\ub9ac \uc815\ubcf4 \uac31\uc2e0\nsudo dnf makecache\n</code></pre>"},{"location":"db/install/ready-mariadb-air-gapped-install/#3-rpm","title":"\ud83d\udccc 3\ub2e8\uacc4: RPM \ud328\ud0a4\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc (\ud575\uc2ec)","text":"<p><code>--resolve --alldeps</code> \uc635\uc158\uc73c\ub85c \uc758\uc874\uc131 \ub77c\uc774\ube0c\ub7ec\ub9ac\uae4c\uc9c0 \uc2f9 \uae01\uc5b4\uc635\ub2c8\ub2e4. \uc5ec\uae30\uac00 \uc81c\uc77c \uc911\uc694\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \uc2dc\uc2a4\ud15c \uae30\ubcf8 \ub3c4\uad6c \ubc0f HA(\uace0\uac00\uc6a9\uc131) \ub3c4\uad6c\n# createrepo_c: \ud3d0\uc1c4\ub9dd \ub0b4\ubd80\uc5d0\uc11c repo \ub9cc\ub4e4 \ub54c \ud544\uc218! (\uc808\ub300 \ub204\ub77d \uae08\uc9c0)\n# haproxy, keepalived: Master/DB 3\uc911\ud654 \ud544\uc218\ndnf download --resolve --alldeps --arch=x86_64 --destdir=./rpms \\\n    vim net-tools telnet wget curl git jq tar unzip \\\n    conntrack-tools socat ipvsadm ipset \\\n    keepalived haproxy \\\n    chrony policycoreutils-python-utils \\\n    createrepo_c modulemd-tools\n</code></pre> <pre><code># 2. MariaDB 10.11 &amp; Galera Cluster\n# \uc704\uc5d0\uc11c 10.11 repo\ub97c \ub4f1\ub85d\ud588\uc73c\ubbc0\ub85c, \uc774 \uba85\ub839\uc5b4\uac00 10.11.14 \ubc84\uc804\uc744 \ubc1b\uc544\uc635\ub2c8\ub2e4.\ndnf download --resolve --alldeps --arch=x86_64 --destdir=./rpms \\\n    MariaDB-server-10.11.14 \\\n    MariaDB-client-10.11.14 \\\n    MariaDB-common-10.11.14 \\\n    MariaDB-shared-10.11.14 \\\n    MariaDB-backup-10.11.14 \\\n    galera-4 rsync\n</code></pre>"},{"location":"db/install/ready-mariadb-air-gapped-install/#4","title":"\ud83d\udccc 4\ub2e8\uacc4: \ucd5c\uc885 \ud3ec\uc7a5 (\uc555\ucd95)","text":"<p>\uc774\uc81c \ubaa8\ub4e0 \ud30c\uc77c\uc774 <code>~/offline-dist</code>\uc5d0 \ubaa8\uc600\uc2b5\ub2c8\ub2e4. \uc774\uac78 \ud558\ub098\ub85c \ubb36\uc5b4\uc11c USB\ub098 \ub9dd\uc5f0\uacc4 \uc194\ub8e8\uc158\uc744 \ud1b5\ud574 \ub118\uae30\uc2dc\uba74 \ub429\ub2c8\ub2e4.</p> <pre><code>cd ~\ntar -zcvf offline-dist-rocky9.6-k8s1.30.tar.gz offline-dist/\n</code></pre>"},{"location":"git/cheatsheet/","title":"\ud83d\ude80 DevOps Git Cheat Sheet (Oh-My-Zsh Edition)","text":""},{"location":"git/cheatsheet/#1-the-one-pick","title":"1. \ud83c\udf1f The One Pick (\uac00\uc7a5 \ucd94\ucc9c\ud558\ub294 \uba85\ub839\uc5b4)","text":"<p>\ud300\uc758 \ucee4\ubc0b \ud788\uc2a4\ud1a0\ub9ac\ub97c \uae54\ub054\ud558\uac8c \uc720\uc9c0\ud558\ub294 \ube44\uacb0\uc785\ub2c8\ub2e4.</p> Alias \uc2e4\uc81c \uba85\ub839\uc5b4 \ud6a8\uacfc <code>gup</code> <code>git pull --rebase</code> \uc77c\ubc18 <code>pull</code>\uacfc \ub2ec\ub9ac, \ubd88\ud544\uc694\ud55c Merge \ucee4\ubc0b\uc744 \ub9cc\ub4e4\uc9c0 \uc54a\uace0 \ub0b4 \ucee4\ubc0b\uc744 \ucd5c\uc2e0 \ucf54\ub4dc \ub4a4\uc5d0 \uae54\ub054\ud558\uac8c \uc774\uc5b4 \ubd99\uc785\ub2c8\ub2e4."},{"location":"git/cheatsheet/#2","title":"2. \ud544\uc218 \uc124\uc815 &amp; \ud2b8\ub7ec\ube14\uc288\ud305","text":"<p>\ud658\uacbd \uc138\ud305\uacfc <code>.gitignore</code> \ubb38\uc81c \ud574\uacb0\uc6a9\uc785\ub2c8\ub2e4.</p> \uc0c1\ud669 \uba85\ub839\uc5b4 / \uc124\uba85 \uc720\uc800 \uc124\uc815 <code>git config --global user.name \"\ub0b4\uc774\ub984\"</code><code>git config --global user.email \"\uc774\uba54\uc77c\"</code> .gitignore\ubbf8\uc801\uc6a9 \ud574\uacb0 (\uce90\uc2dc \uc0ad\uc81c \ud6c4 \uc7ac\ucee4\ubc0b)1. <code>git rm -r --cached .</code>2. <code>git add .</code>3. <code>git commit -m \"Fix .gitignore\"</code>"},{"location":"git/cheatsheet/#3-alias","title":"3. \uc2e4\uc804 \ud575\uc2ec Alias (\ub2e8\ucd95\ud0a4)","text":"<p>\uc790\uc8fc \uc4f0\ub294 \uc21c\uc11c\ub300\ub85c \uc815\ub9ac\ud588\uc2b5\ub2c8\ub2e4.</p>"},{"location":"git/cheatsheet/#a-basic","title":"A. \uc791\uc5c5 \uc2dc\uc791 &amp; \uc800\uc7a5 (Basic)","text":"Alias \uc2e4\uc81c \uba85\ub839\uc5b4 \uc124\uba85 <code>gst</code> <code>git status</code> [\uc2b5\uad00] \ud604\uc7ac \ud30c\uc77c \uc0c1\ud0dc \ud655\uc778 (\uc218\uc2dc\ub85c \uc785\ub825) <code>gaa</code> <code>git add --all</code> \ubcc0\uacbd\ub41c \ubaa8\ub4e0 \ud30c\uc77c\uc744 \uc2a4\ud14c\uc774\uc9d5 <code>gcmsg</code> <code>git commit -m</code> \uba54\uc2dc\uc9c0\uc640 \ud568\uaed8 \ucee4\ubc0b (<code>gcmsg \"\uba54\uc2dc\uc9c0\"</code>) <code>gc!</code> <code>git commit --amend</code> [\uc218\uc815] \ubc29\uae08 \uc62c\ub9b0 \ucee4\ubc0b \ub0b4\uc6a9/\uba54\uc2dc\uc9c0 \uace0\uce58\uae30 <code>gd</code> <code>git diff</code> \ucf54\ub4dc \ubcc0\uacbd\uc810 \ud655\uc778 (<code>add</code> \ud558\uae30 \uc804)"},{"location":"git/cheatsheet/#b-sync","title":"B. \uc5c5\ub85c\ub4dc &amp; \ub3d9\uae30\ud654 (Sync)","text":"Alias \uc2e4\uc81c \uba85\ub839\uc5b4 \uc124\uba85 <code>gp</code> <code>git push</code> \uc6d0\uaca9 \uc800\uc7a5\uc18c\ub85c \uc5c5\ub85c\ub4dc <code>gl</code> <code>git pull</code> \uc6d0\uaca9 \uc800\uc7a5\uc18c \ub0b4\uc6a9 \uac00\uc838\uc624\uae30 (\uc77c\ubc18) <code>gup</code> <code>git pull --rebase</code> [\u2b50\ucd94\ucc9c] \uae54\ub054\ud558\uac8c \ub2f9\uaca8\uc624\uae30 (Merge bubble \ubc29\uc9c0)"},{"location":"git/cheatsheet/#c-branch","title":"C. \ube0c\ub79c\uce58 \uad00\ub9ac (Branch)","text":"Alias \uc2e4\uc81c \uba85\ub839\uc5b4 \uc124\uba85 <code>gsw</code> <code>git switch</code> \ube0c\ub79c\uce58 \uc774\ub3d9 (<code>gsw [\ube0c\ub79c\uce58\uba85]</code>) <code>gswc</code> <code>git switch -c</code> \uc0c8 \ube0c\ub79c\uce58 \uc0dd\uc131 \ud6c4 \uc774\ub3d9 (<code>gswc [\uc0c8\ube0c\ub79c\uce58\uba85]</code>) <code>gb</code> <code>git branch</code> \ub85c\uceec \ube0c\ub79c\uce58 \ubaa9\ub85d \ubcf4\uae30 <code>gbD</code> <code>git branch -D</code> \ube0c\ub79c\uce58 \uac15\uc81c \uc0ad\uc81c <code>gm</code> <code>git merge</code> \ube0c\ub79c\uce58 \ud569\uce58\uae30"},{"location":"git/cheatsheet/#d-stash","title":"D. \uc784\uc2dc \uc800\uc7a5 (Stash)","text":"<p>\uc791\uc5c5 \uc911 \uae09\ud558\uac8c \ub2e4\ub978 \uc77c\uc744 \ud574\uc57c \ud560 \ub54c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> Alias \uc2e4\uc81c \uba85\ub839\uc5b4 \uc124\uba85 <code>gsta</code> <code>git stash push</code> \uc791\uc5c5 \ucf54\ub4dc \uc784\uc2dc \ubcf4\uad00\ud568\uc5d0 \uc228\uae30\uae30 <code>gstp</code> <code>git stash pop</code> \uc228\uaca8\ub454 \ucf54\ub4dc \ub2e4\uc2dc \uaebc\ub0b4\uc624\uae30 <code>gstl</code> <code>git stash list</code> \ubcf4\uad00\ub41c \ubaa9\ub85d \ud655\uc778"},{"location":"git/cheatsheet/#e-undoreset","title":"E. \ub418\ub3cc\ub9ac\uae30 (Undo/Reset)","text":"<p>\u26a0\ufe0f \uc8fc\uc758\ud574\uc11c \uc0ac\uc6a9\ud558\uc138\uc694.</p> Alias \uc2e4\uc81c \uba85\ub839\uc5b4 \uc124\uba85 <code>grh</code> <code>git reset --hard</code> \ud2b9\uc815 \uc2dc\uc810\uc73c\ub85c \uc644\uc804 \ucd08\uae30\ud654 (\ubcf5\uad6c \ubd88\uac00) <code>grs</code> <code>git reset --soft</code> \ucee4\ubc0b\ub9cc \ucde8\uc18c\ud558\uace0, \ud30c\uc77c \ubcc0\uacbd\ubd84\uc740 \ub0a8\uae40"},{"location":"git/cheatsheet/#f-log","title":"F. \uc774\ub825 \uc870\ud68c (Log)","text":"Alias \uc2e4\uc81c \uba85\ub839\uc5b4 \uc124\uba85 <code>glo</code> <code>git log --oneline --graph</code> \ucee4\ubc0b \ud788\uc2a4\ud1a0\ub9ac\ub97c \uadf8\ub798\ud504\ub85c \uae54\ub054\ud558\uac8c \ubcf4\uae30"},{"location":"ide/vscode_shortcut/","title":"\ud83d\ude80 VS Code \ud575\uc2ec \ub2e8\ucd95\ud0a4","text":""},{"location":"ide/vscode_shortcut/#_1","title":"\ud83d\udda5\ufe0f \ud658\uacbd \uc124\uc815 \ubc0f \uae30\ubcf8 \uc2e4\ud589","text":"\uae30\ub2a5 Windows macOS \uc124\uba85 \ud604\uc7ac \ud3f4\ub354 \uc5f4\uae30 <code>code .</code> <code>code .</code> \ud130\ubbf8\ub110\uc5d0\uc11c \ud604\uc7ac \ub514\ub809\ud1a0\ub9ac\ub97c VS Code\ub85c \uc5f4\uae30 (\ub2e8\ucd95\ud0a4 \uc544\ub2d8) \uc561\uc158 \uac80\uc0c9 (Command Palette) Ctrl + Shift + P Cmd + Shift + P \ubaa8\ub4e0 VS Code \uba85\ub839 \uc2e4\ud589 (\uac00\uc7a5 \uc911\uc694) \ud30c\uc77c \ucc3e\uae30 (Go to File) Ctrl + P Cmd + P \ud504\ub85c\uc81d\ud2b8 \ub0b4 \ud30c\uc77c \uc774\ub984\uc744 \uac80\uc0c9\ud558\uc5ec \uc5f4\uae30 \ud1b5\ud569 \ud130\ubbf8\ub110 \ud1a0\uae00 Ctrl + ` Ctrl + ` \ub0b4\uc7a5 \ud130\ubbf8\ub110 \uc5f4\uae30/\ub2eb\uae30"},{"location":"ide/vscode_shortcut/#editing-multi-cursor","title":"\u270f\ufe0f \ud3b8\uc9d1 \ubc0f \ub2e4\uc911 \ucee4\uc11c (Editing &amp; Multi-Cursor)","text":"\uae30\ub2a5 Windows macOS \uc124\uba85 \ub2e4\uc74c \ub3d9\uc77c \ub2e8\uc5b4 \uc120\ud0dd Ctrl + D Cmd + D \uc120\ud0dd\ud55c \ub2e8\uc5b4\uc758 \ub2e4\uc74c \uc77c\uce58 \ud56d\ubaa9\uc5d0 \ucee4\uc11c \ud558\ub098 \ucd94\uac00 \ubaa8\ub4e0 \ub3d9\uc77c \ub2e8\uc5b4 \uc120\ud0dd Ctrl + Shift + L Cmd + Shift + L \ud30c\uc77c \ub0b4 \ubaa8\ub4e0 \uc77c\uce58 \ud56d\ubaa9\uc5d0 \ubaa8\ub4e0 \ucee4\uc11c \ucd94\uac00 \uc717\uc904/\uc544\ub7ab\uc904\uc5d0 \ucee4\uc11c \ucd94\uac00 Ctrl + Alt + Up/Down Option + Cmd + Up/Down \ubc29\ud5a5\ud0a4\ub97c \uc774\uc6a9\ud55c \ucee4\uc11c \ubcf5\uc81c \uc904 \uc774\ub3d9 (\uc704/\uc544\ub798) Alt + Up/Down Option + Up/Down \ud604\uc7ac \uc904 \uc804\uccb4\ub97c \uc704/\uc544\ub798\ub85c \uc774\ub3d9 \uc904 \ubcf5\uc0ac (\uc704/\uc544\ub798) Shift + Alt + Up/Down Shift + Option + Up/Down \ud604\uc7ac \uc904\uc744 \ubcf5\uc0ac\ud558\uc5ec \ucd94\uac00 \uc904 \uc0ad\uc81c Ctrl + Shift + K Cmd + Shift + K \ud604\uc7ac \uc904 \uc804\uccb4 \uc0ad\uc81c \uc8fc\uc11d \ucc98\ub9ac/\ud574\uc81c Ctrl + / Cmd + / \ud604\uc7ac \uc904\uc744 \uc8fc\uc11d\uc73c\ub85c \ucc98\ub9ac/\ud574\uc81c \ucf54\ub4dc \ud3ec\ub9f7\ud305 Shift + Alt + F Shift + Option + F \ubb38\uc11c \uc804\uccb4\uc758 \ucf54\ub4dc \uc2a4\ud0c0\uc77c \uc815\ub9ac"},{"location":"ide/vscode_shortcut/#navigation-analysis","title":"\ud83d\udee0\ufe0f \ud0d0\uc0c9 \ubc0f \ucf54\ub4dc \ubd84\uc11d (Navigation &amp; Analysis)","text":"\uae30\ub2a5 Windows macOS \uc124\uba85 \uc120\uc5b8\uc73c\ub85c \uc774\ub3d9 F12 F12 \ud568\uc218/\ubcc0\uc218\uc758 \uc815\uc758\ub41c \uc704\uce58\ub85c \uc774\ub3d9 \uc815\uc758 \ucc38\uc870 \ucc3e\uae30 Shift + F12 Shift + F12 \ud574\ub2f9 \uae30\ud638\uac00 \uc0ac\uc6a9\ub41c \ubaa8\ub4e0 \uc704\uce58\ub97c \ud655\uc778 \uc2ec\ubcfc \uc774\ub984 \ubcc0\uacbd (Rename) F2 F2 \ubcc0\uc218/\ud568\uc218 \ub4f1\uc758 \uc774\ub984\uc744 \ud504\ub85c\uc81d\ud2b8 \uc804\uccb4\uc5d0\uc11c \uc548\uc804\ud558\uac8c \ubcc0\uacbd \uc774\uc804 \ucee4\uc11c \uc704\uce58\ub85c Alt + Left Ctrl + - \ucee4\uc11c\uc758 \uc774\uc804 \uc791\uc5c5 \uc704\uce58\ub85c \ub418\ub3cc\uc544\uac00\uae30 \ud30c\uc77c \ub0b4 \uae30\ud638 \ucc3e\uae30 Ctrl + Shift + O Cmd + Shift + O \ud604\uc7ac \ud30c\uc77c \ub0b4 \uae30\ud638(\ud568\uc218, \ud074\ub798\uc2a4) \ubaa9\ub85d \uac80\uc0c9"},{"location":"ide/vscode_shortcut/#git-source-control","title":"\ud83d\udcc2 Git \ubc0f \uc18c\uc2a4 \uc81c\uc5b4 (Source Control)","text":"\uae30\ub2a5 Windows macOS \uc124\uba85 \uc18c\uc2a4 \uc81c\uc5b4 \uc5f4\uae30 Ctrl + Shift + G Ctrl + Shift + G \uc18c\uc2a4 \uc81c\uc5b4(Git) \uc0ac\uc774\ub4dc\ubc14 \uc5f4\uae30 \ub2e4\uc74c \ubcc0\uacbd \uc0ac\ud56d F7 F7 \ud30c\uc77c \ub0b4\uc5d0\uc11c \ub2e4\uc74c Diff(\ubcc0\uacbd\ub41c \ub0b4\uc6a9)\ub85c \uc774\ub3d9 \uc774\uc804 \ubcc0\uacbd \uc0ac\ud56d Shift + F7 Shift + F7 \ud30c\uc77c \ub0b4\uc5d0\uc11c \uc774\uc804 Diff(\ubcc0\uacbd\ub41c \ub0b4\uc6a9)\ub85c \uc774\ub3d9 \uc2a4\ud14c\uc774\uc9d5\ub41c \ud30c\uc77c \ucee4\ubc0b (\ubcc4\ub3c4 \uc124\uc815) (\ubcc4\ub3c4 \uc124\uc815) \uc18c\uc2a4 \uc81c\uc5b4 \uc0ac\uc774\ub4dc\ubc14\uc5d0\uc11c \ucee4\ubc0b \uba54\uc2dc\uc9c0 \uc785\ub825 \ud6c4 Ctrl + Enter\ub85c \ucee4\ubc0b"},{"location":"ide/vscode_shortcut/#debugging","title":"\ud83d\udc1e \ub514\ubc84\uae45 (Debugging)","text":"\uae30\ub2a5 Windows macOS \uc124\uba85 \ub514\ubc84\uae45 \uc2dc\uc791/\uacc4\uc18d F5 F5 \ub514\ubc84\uae45 \uc2dc\uc791 \ub610\ub294 \uc911\ub2e8\uc810\uc5d0\uc11c \uacc4\uc18d \uc9c4\ud589 \uc911\ub2e8\uc810 \uc124\uc815/\ud574\uc81c F9 F9 \ud604\uc7ac \uc904\uc5d0 \uc911\ub2e8\uc810(Breakpoint) \uc124\uc815/\ud574\uc81c \ud55c \ub2e8\uacc4\uc529 \uc2e4\ud589 (Step Over) F10 F10 \ud568\uc218 \ub0b4\ubd80\ub85c \uc9c4\uc785\ud558\uc9c0 \uc54a\uace0 \ub2e4\uc74c \uc904\ub85c \uc774\ub3d9 \ud568\uc218 \ub0b4\ubd80\ub85c \uc9c4\uc785 (Step Into) F11 F11 \ud568\uc218 \ud638\ucd9c \ub0b4\ubd80\ub85c \uc9c4\uc785"},{"location":"k8s/cheatsheet/","title":"\u2638\ufe0f Kubernetes Cheat Sheet","text":""},{"location":"k8s/cheatsheet/#1-shell-autocomplete","title":"\ud83d\ude80 1. \uc258 \uc790\ub3d9\uc644\uc131 \uc124\uc815 (Shell Autocomplete)","text":"<p>\uac00\uc7a5 \uba3c\uc800 \uc124\uc815\ud574\uc57c \ud560 \ud544\uc218 \uae30\ub2a5\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/cheatsheet/#bash","title":"bash","text":"<pre><code>source &lt;(kubectl completion bash) # \ud604\uc7ac \uc138\uc158\uc5d0 \uc801\uc6a9\necho \"source &lt;(kubectl completion bash)\" &gt;&gt; ~/.bashrc # \uc601\uad6c \uc801\uc6a9\nalias k=kubectl # 'k' \ub2e8\ucd95\ud0a4 \uc124\uc815\ncomplete -o default -F __start_kubectl k # 'k' \ub2e8\ucd95\ud0a4\uc5d0\ub3c4 \uc790\ub3d9\uc644\uc131 \uc801\uc6a9\n</code></pre>"},{"location":"k8s/cheatsheet/#zsh","title":"zsh","text":"<pre><code>source &lt;(kubectl completion zsh)  # set up autocomplete in zsh into the current shell\necho '[[ $commands[kubectl] ]] &amp;&amp; source &lt;(kubectl completion zsh)' &gt;&gt; ~/.zshrc # add autocomplete permanently to your zsh shell\nalias k=kubectl\ncomplete -o default -F __start_kubectl k\n</code></pre>"},{"location":"k8s/cheatsheet/#2-config-context","title":"\ud83d\udcc2 2. \ud074\ub7ec\uc2a4\ud130 \ubc0f \ucee8\ud14d\uc2a4\ud2b8 \uad00\ub9ac (Config &amp; Context)","text":"<p>\uc5ec\ub7ec \ud074\ub7ec\uc2a4\ud130\uc640 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\ub97c \uad00\ub9ac\ud560 \ub54c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code>kubectl config view                        # \uc804\uccb4 kubeconfig \uc124\uc815 \ud655\uc778\nkubectl config get-contexts                # \ucee8\ud14d\uc2a4\ud2b8 \ubaa9\ub85d \ud655\uc778\nkubectl config current-context             # \ud604\uc7ac \ucee8\ud14d\uc2a4\ud2b8 \ud655\uc778\nkubectl config use-context &lt;name&gt;          # \ucee8\ud14d\uc2a4\ud2b8 \ubcc0\uacbd\nkubectl config set-context --current --namespace=&lt;ns&gt;  # \uae30\ubcf8 \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \ubcc0\uacbd (\ub9e4\ubc88 -n \uc785\ub825 \uc0dd\ub7b5)\nkubectl api-resources                      # \uc0ac\uc6a9 \uac00\ub2a5\ud55c \ub9ac\uc18c\uc2a4 \uc885\ub958 \ubc0f \ub2e8\ucd95\uc5b4(Shortnames) \ud655\uc778\nkubectl api-versions                       # \uc0ac\uc6a9 \uac00\ub2a5\ud55c API \uadf8\ub8f9 \ubc84\uc804 \ud655\uc778\n</code></pre>"},{"location":"k8s/cheatsheet/#3-create-dry-run","title":"\ud83d\udee0 3. \ub9ac\uc18c\uc2a4 \uc0dd\uc131 (Create &amp; Dry Run)","text":"<p>Best Practice: YAML \ud30c\uc77c\uc744 \uc9c1\uc811 \uc9dc\uc9c0 \ub9d0\uace0, \uba85\ub839\uc5b4\ub85c \ubf08\ub300\ub97c \ub9cc\ub4e0 \ud6c4 \uc218\uc815\ud558\uc138\uc694. (<code>--dry-run=client -o yaml</code>)</p> \ub9ac\uc18c\uc2a4 \uba85\ub839\uc5b4 \ud15c\ud50c\ub9bf Pod <code>k run nginx --image=nginx --restart=Never --dry-run=client -o yaml &gt; pod.yaml</code> Deployment <code>k create deploy web --image=nginx --replicas=3 --dry-run=client -o yaml &gt; deploy.yaml</code> Service <code>k expose deploy web --port=80 --target-port=8080 --type=NodePort --dry-run=client -o yaml &gt; svc.yaml</code> CronJob <code>k create cronjob my-job --image=busybox --schedule=\"*/1 * * * *\" --dry-run=client -o yaml &gt; cron.yaml</code> Job <code>k create job my-job --image=busybox --dry-run=client -o yaml &gt; job.yaml</code> Secret <code>k create secret generic my-pass --from-literal=pwd=123 --dry-run=client -o yaml &gt; sec.yaml</code> ConfigMap <code>k create cm my-config --from-file=config.txt --dry-run=client -o yaml &gt; cm.yaml</code>"},{"location":"k8s/cheatsheet/#4-get-inspect","title":"\ud83d\udd0d 4. \uc870\ud68c \ubc0f \ud544\ud130\ub9c1 (Get &amp; Inspect)","text":""},{"location":"k8s/cheatsheet/#_1","title":"\uae30\ubcf8 \uc870\ud68c","text":"<pre><code>kubectl get all -n &lt;namespace&gt;   # \ud2b9\uc815 \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc804\uccb4 \ub9ac\uc18c\uc2a4 \uc870\ud68c\nkubectl get po,svc,deploy        # \uc8fc\uc694 \ub9ac\uc18c\uc2a4\ub9cc \uace8\ub77c\uc11c \uc870\ud68c\nkubectl get po -A                # \ubaa8\ub4e0 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc758 Pod \uc870\ud68c\nkubectl get nodes -o wide        # \ub178\ub4dc OS, \ucee4\ub110 \ubc84\uc804, \ub0b4\ubd80 IP \ud655\uc778\nkubectl get events --sort-by=.metadata.creationTimestamp # \uc2dc\uac04\uc21c \uc774\ubca4\ud2b8 \uc870\ud68c (\ub514\ubc84\uae45\uc6a9)\n</code></pre>"},{"location":"k8s/cheatsheet/#formatting","title":"\ucd9c\ub825 \ud615\uc2dd (Formatting) &amp; \uc815\ub82c","text":"<pre><code>kubectl get po -o wide                       # IP, Node \uc815\ubcf4 \ud3ec\ud568\nkubectl get po --show-labels                 # \ub77c\ubca8 \uc815\ubcf4 \ud3ec\ud568\nkubectl get po -l app=nginx                  # \ud2b9\uc815 \ub77c\ubca8 \ud544\ud130\ub9c1\nkubectl get po --sort-by=.status.startTime   # \uc2e4\ud589 \uc2dc\uac04\uc21c \uc815\ub82c\nkubectl get po -o yaml &gt; backup.yaml         # YAML\ub85c \uc804\uccb4 \uc2a4\ud399 \ucd94\ucd9c\n</code></pre>"},{"location":"k8s/cheatsheet/#jsonpath","title":"JSONPath (\ub370\uc774\ud130 \ucd94\ucd9c)","text":"<pre><code># \ubaa8\ub4e0 \ub178\ub4dc\uc758 \uc774\ub984\ub9cc \ucd94\ucd9c\nkubectl get nodes -o jsonpath='{.items[*].metadata.name}'\n# \ud2b9\uc815 Pod\uc758 \ud658\uacbd\ubcc0\uc218 \ud655\uc778\nkubectl get po &lt;pod&gt; -o jsonpath='{.spec.containers[0].env}'\n</code></pre>"},{"location":"k8s/cheatsheet/#5-troubleshoot-logs","title":"\ud83e\ude7a 5. \ub514\ubc84\uae45 \ubc0f \ub85c\uadf8 (Troubleshoot &amp; Logs)","text":""},{"location":"k8s/cheatsheet/#_2","title":"\ub85c\uadf8 \ubd84\uc11d","text":"<pre><code>kubectl logs &lt;pod&gt;                           # \ub85c\uadf8 \ud655\uc778\nkubectl logs -f &lt;pod&gt;                        # \uc2e4\uc2dc\uac04 \ub85c\uadf8 (tail -f)\nkubectl logs &lt;pod&gt; -c &lt;container&gt;            # \ud2b9\uc815 \ucee8\ud14c\uc774\ub108 \ub85c\uadf8 (Multi-container)\nkubectl logs &lt;pod&gt; --previous                # \uc774\uc804 \ucee8\ud14c\uc774\ub108(Crash\ub09c \uc9c1\ud6c4) \ub85c\uadf8 \ud655\uc778\nkubectl logs -l app=backend --all-containers=true # \ud574\ub2f9 \ub77c\ubca8\uc744 \uac00\uc9c4 \ubaa8\ub4e0 Pod \ub85c\uadf8\n</code></pre>"},{"location":"k8s/cheatsheet/#_3","title":"\uc0c1\ud0dc \uc9c4\ub2e8","text":"<pre><code>kubectl describe pod &lt;pod&gt;                   # Pod \uc0c1\uc138 \uc0c1\ud0dc \ubc0f \uc774\ubca4\ud2b8(Events) \ud655\uc778 (\u2605\ud544\uc218)\nkubectl describe node &lt;node&gt;                 # \ub178\ub4dc \ub9ac\uc18c\uc2a4 \ubd80\uc871/\uc0c1\ud0dc \ud655\uc778\nkubectl top pods                             # Pod\ubcc4 CPU/Memory \uc0ac\uc6a9\ub7c9 (Metrics Server \ud544\uc694)\nkubectl top nodes                            # \ub178\ub4dc\ubcc4 \ub9ac\uc18c\uc2a4 \uc0ac\uc6a9\ub7c9\n</code></pre>"},{"location":"k8s/cheatsheet/#_4","title":"\uc811\uc18d \ubc0f \uc2e4\ud589","text":"<pre><code>kubectl exec -it &lt;pod&gt; -- /bin/bash          # \ucee8\ud14c\uc774\ub108 \uc258 \uc811\uc18d\nkubectl exec -it &lt;pod&gt; -- ls -F /app         # \uc811\uc18d \uc5c6\uc774 \uba85\ub839\uc5b4\ub9cc \uc2e4\ud589\nkubectl cp &lt;pod&gt;:/path/file ./local_file     # \ud30c\uc77c \ubcf5\uc0ac (Pod -&gt; Local)\nkubectl cp ./local_file &lt;pod&gt;:/path/file     # \ud30c\uc77c \ubcf5\uc0ac (Local -&gt; Pod)\n</code></pre>"},{"location":"k8s/cheatsheet/#pod","title":"\uc784\uc2dc \ub514\ubc84\uae45 Pod \uc2e4\ud589","text":"<pre><code># \ub124\ud2b8\uc6cc\ud06c \ud14c\uc2a4\ud2b8\uc6a9(curl, nslookup \ub4f1) \uc784\uc2dc Pod \uc2e4\ud589 \ud6c4 \uc0ad\uc81c\nkubectl run -it --rm debug --image=busybox --restart=Never -- sh\n</code></pre>"},{"location":"k8s/cheatsheet/#6-deploy-scale","title":"\ud83d\udd04 6. \uc571 \uad00\ub9ac \ubc0f \uc2a4\ucf00\uc77c\ub9c1 (Deploy &amp; Scale)","text":""},{"location":"k8s/cheatsheet/#_5","title":"\uc5c5\ub370\uc774\ud2b8 \ubc0f \ub864\ubc31","text":"<pre><code>kubectl set image deploy/&lt;name&gt; nginx=nginx:1.19 # \uc774\ubbf8\uc9c0 \ubc84\uc804 \uc5c5\ub370\uc774\ud2b8 (\ub864\ub9c1 \uc5c5\ub370\uc774\ud2b8)\nkubectl rollout status deploy/&lt;name&gt;         # \ubc30\ud3ec \uc9c4\ud589 \uc0c1\ud0dc \ud655\uc778\nkubectl rollout history deploy/&lt;name&gt;        # \ubc30\ud3ec \uc774\ub825(Revision) \ud655\uc778\nkubectl rollout undo deploy/&lt;name&gt;           # \ubc14\ub85c \uc774\uc804 \ubc84\uc804\uc73c\ub85c \ub864\ubc31\nkubectl rollout undo deploy/&lt;name&gt; --to-revision=2 # \ud2b9\uc815 \ubc84\uc804\uc73c\ub85c \ub864\ubc31\nkubectl rollout pause deploy/&lt;name&gt;          # \ubc30\ud3ec \uc77c\uc2dc \uc815\uc9c0\nkubectl rollout resume deploy/&lt;name&gt;         # \ubc30\ud3ec \uc7ac\uac1c\n</code></pre>"},{"location":"k8s/cheatsheet/#scaling","title":"\uc2a4\ucf00\uc77c\ub9c1 (Scaling)","text":"<pre><code>kubectl scale deploy/&lt;name&gt; --replicas=5     # \uc218\ub3d9 \uc2a4\ucf00\uc77c\ub9c1\nkubectl autoscale deploy/&lt;name&gt; --min=2 --max=10 --cpu-percent=80 # HPA(Auto Scaling) \uc124\uc815\n</code></pre>"},{"location":"k8s/cheatsheet/#7-networking","title":"\ud83c\udf10 7. \ub124\ud2b8\uc6cc\ud06c (Networking)","text":"<pre><code>kubectl get svc -o wide                      # \uc11c\ube44\uc2a4 ClusterIP, Selector \ud655\uc778\nkubectl get ing                              # \uc778\uadf8\ub808\uc2a4(Ingress) \uc8fc\uc18c \ud655\uc778\nkubectl get endpoints &lt;svc-name&gt;             # \uc11c\ube44\uc2a4\uc640 \uc5f0\uacb0\ub41c \uc2e4\uc81c Pod IP(Endpoint) \ud655\uc778\nkubectl port-forward &lt;pod&gt; 8080:80           # \ub85c\uceec \ud3ec\ud2b8 \ud3ec\uc6cc\ub529 (Pod)\nkubectl port-forward svc/&lt;name&gt; 8080:80      # \ub85c\uceec \ud3ec\ud2b8 \ud3ec\uc6cc\ub529 (Service)\n</code></pre>"},{"location":"k8s/cheatsheet/#8-delete-clean-up","title":"\ud83d\uddd1 8. \uc0ad\uc81c \ubc0f \uc815\ub9ac (Delete &amp; Clean up)","text":"<pre><code>kubectl delete -f filename.yaml              # \ud30c\uc77c \uae30\uc900 \uc0ad\uc81c\nkubectl delete po &lt;pod&gt;                      # Pod \uc0ad\uc81c\nkubectl delete po -l app=nginx               # \ub77c\ubca8 \uae30\uc900 \uc77c\uad04 \uc0ad\uc81c\nkubectl delete ns &lt;name&gt;                     # \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc0ad\uc81c (\ub0b4\ubd80 \ub9ac\uc18c\uc2a4 \uc804\uccb4 \uc0ad\uc81c\ub428)\n# [\uac15\uc81c \uc0ad\uc81c] \uc885\ub8cc(Terminating) \uc0c1\ud0dc\uc5d0\uc11c \uba48\ucd98 Pod \uc0ad\uc81c\nkubectl delete pod &lt;pod&gt; --grace-period=0 --force\n</code></pre>"},{"location":"k8s/cheatsheet/#9-node-maintenance-","title":"\ud83c\udfd7 9. \ub178\ub4dc \uc720\uc9c0\ubcf4\uc218 (Node Maintenance) - \uad00\ub9ac\uc790\uc6a9","text":"<pre><code>kubectl cordon &lt;node&gt;                        # \uc2a4\ucf00\uc904\ub9c1 \uc911\ub2e8 (\uc2e0\uaddc Pod \ubc30\uce58 \uae08\uc9c0)\nkubectl uncordon &lt;node&gt;                      # \uc2a4\ucf00\uc904\ub9c1 \uc7ac\uac1c\nkubectl drain &lt;node&gt; --ignore-daemonsets     # \ub178\ub4dc \ube44\uc6b0\uae30 (\uae30\uc874 Pod\ub97c \ub2e4\ub978 \ub178\ub4dc\ub85c \uc774\ub3d9)\nkubectl taint nodes &lt;node&gt; key=value:NoSchedule # \ud14c\uc778\ud2b8 \uc124\uc815 (\ud2b9\uc815 Pod\ub9cc \uc624\uac8c \ud568)\n</code></pre>"},{"location":"k8s/cheatsheet/#10-security-auth-tokens","title":"\ud83d\udd10 10. \ubcf4\uc548, \uad8c\ud55c \ubc0f \ud1a0\ud070 \uad00\ub9ac (Security, Auth &amp; Tokens)","text":"<p>\ub0b4\ubd80 \uad8c\ud55c \ud655\uc778(RBAC)\uacfc \ub9cc\ub8cc\ub41c \ud074\ub77c\uc6b0\ub4dc(CSP) \uc778\uc99d \ud1a0\ud070\uc744 \uac31\uc2e0\ud558\ub294 \ud544\uc218 \uba85\ub839\uc5b4\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/cheatsheet/#_6","title":"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 \uc5ed\ud560 \ud655\uc778","text":"<pre><code>kubectl get serviceaccounts                  # \uc11c\ube44\uc2a4 \uc5b4\uce74\uc6b4\ud2b8 \ubaa9\ub85d\nkubectl get clusterroles                     # \ud074\ub7ec\uc2a4\ud130 \uad8c\ud55c \ubaa9\ub85d\n</code></pre>"},{"location":"k8s/cheatsheet/#csp-token-expired","title":"\u2601\ufe0f \ud074\ub77c\uc6b0\ub4dc(CSP) \uc778\uc99d \ud1a0\ud070 \uac31\uc2e0 (Token Expired \ud574\uacb0)","text":"<p>\"You must be logged in to the server\" \uc5d0\ub7ec\uac00 \ub730 \ub54c, \uac01 \ud074\ub77c\uc6b0\ub4dc CLI\ub85c <code>kubeconfig</code>\ub97c \uac31\uc2e0\ud569\ub2c8\ub2e4.</p> <pre><code># AWS EKS (Amazon)\naws eks update-kubeconfig --name &lt;cluster-name&gt; --region &lt;region&gt;\n\n# GCP GKE (Google)\ngcloud container clusters get-credentials &lt;cluster-name&gt; --region &lt;region&gt;\n\n# Azure AKS (Microsoft)\naz aks get-credentials --resource-group &lt;rg-name&gt; --name &lt;cluster-name&gt;\n</code></pre>"},{"location":"k8s/cheatsheet/#service-account","title":"\ud83d\udd11 \uc11c\ube44\uc2a4 \uc5b4\uce74\uc6b4\ud2b8 \ud1a0\ud070 \uad00\ub9ac (Service Account)","text":"<p>CI/CD \uc5f0\ub3d9\uc774\ub098 \ub300\uc2dc\ubcf4\ub4dc \ub85c\uadf8\uc778\uc6a9 \ud1a0\ud070\uc744 \ubc1c\uae09\ud569\ub2c8\ub2e4. (K8s v1.24+ \ud544\uc218)</p> <pre><code># [Modern] \ud1a0\ud070 \uc989\uc2dc \ubc1c\uae09 (\uc720\ud6a8\uae30\uac04 \uc124\uc815 \uac00\ub2a5)\nkubectl create token &lt;service-account-name&gt; --duration=24h\n\n# [Legacy] \uae30\uc874 Secret \uae30\ubc18 \ud1a0\ud070 \ucd94\ucd9c (Base64 \ub514\ucf54\ub529)\nkubectl get secret &lt;secret-name&gt; -o jsonpath='{.data.token}' | base64 --decode\n</code></pre>"},{"location":"k8s/cheatsheet/#rbac-check","title":"\ud83d\udee1\ufe0f \uad8c\ud55c \ud655\uc778 (RBAC Check)","text":"<p>\ud604\uc7ac \uc0ac\uc6a9\uc790\ub098 \ud2b9\uc815 \uacc4\uc815\uc774 \uc791\uc5c5\uc744 \uc218\ud589\ud560 \uad8c\ud55c\uc774 \uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code># \"\ub0b4\uac00 \ubc30\ud3ec(Deployment)\ub97c \ub9cc\ub4e4 \uc218 \uc788\ub098?\" (Yes/No \ubc18\ud658)\nkubectl auth can-i create deployments\n\n# \ud2b9\uc815 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0\uc11c \uad8c\ud55c \ud655\uc778\nkubectl auth can-i delete pods -n &lt;namespace&gt;\n\n# [\uad00\ub9ac\uc790\uc6a9] \ud2b9\uc815 \uc11c\ube44\uc2a4 \uc5b4\uce74\uc6b4\ud2b8(sa)\uac00 \uad8c\ud55c\uc774 \uc788\ub294\uc9c0 \ud655\uc778 (impersonate)\nkubectl auth can-i get nodes --as=system:serviceaccount:&lt;ns&gt;:&lt;sa-name&gt;\n</code></pre>"},{"location":"k8s/cheatsheet/#kubeadm","title":"\ud83c\udfab \ud074\ub7ec\uc2a4\ud130 \uc870\uc778 \ud1a0\ud070 (Kubeadm \uc804\uc6a9)","text":"<p>\uc628\ud504\ub808\ubbf8\uc2a4(On-premise) \ud658\uacbd\uc5d0\uc11c \ub178\ub4dc\ub97c \ucd94\uac00\ud560 \ub54c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code># \uc720\ud6a8\ud55c \uc870\uc778 \ud1a0\ud070 \ubaa9\ub85d \ud655\uc778\nkubeadm token list\n\n# \ud1a0\ud070\uc774 \ub9cc\ub8cc\ub418\uc5c8\uc744 \ub54c \uc7ac\uc0dd\uc131 (\uc870\uc778 \uba85\ub839\uc5b4 \uc804\uccb4 \ucd9c\ub825)\nkubeadm token create --print-join-command\n</code></pre>"},{"location":"k8s/cheatsheet/#tips","title":"\ud83d\udca1 \ud301 (Tips)","text":"<ul> <li>\ub9ac\uc18c\uc2a4\uac00 \uc548 \uc9c0\uc6cc\uc9c8 \ub54c: <code>finalizers</code> \uc124\uc815 \ub54c\ubb38\uc77c \uc218 \uc788\uc2b5\ub2c8\ub2e4. <code>kubectl edit</code>\uc73c\ub85c <code>finalizers</code> \ud56d\ubaa9\uc744 \uc9c0\uc6b0\uba74 \uc0ad\uc81c\ub429\ub2c8\ub2e4.</li> <li>YAML \ucd94\ucd9c \uc2b5\uad00: \uc6b4\uc601 \uc911\uc778 \ub9ac\uc18c\uc2a4\ub97c \uc218\uc815\ud558\uae30 \uc804\uc5d0 \ubc18\ub4dc\uc2dc <code>kubectl get &lt;resource&gt; -o yaml &gt; backup.yaml</code>\ub85c \ubc31\uc5c5\ud558\uc138\uc694.</li> <li>Watch \ubaa8\ub4dc: \ubc30\ud3ec \ud6c4 <code>kubectl get pods -w</code>\ub97c \ucf1c\ub450\uba74 \uc0c1\ud0dc \ubcc0\ud654\ub97c \uc2e4\uc2dc\uac04\uc73c\ub85c \ubcfc \uc218 \uc788\uc5b4 \ub2f5\ub2f5\ud568\uc774 \uc904\uc5b4\ub4ed\ub2c8\ub2e4.</li> </ul>"},{"location":"k8s/cheatsheet/#helm-essential-cheat-sheet-bonus","title":"\u2693 Helm Essential Cheat Sheet (Bonus)","text":"<p>Kubernetes\uc758 <code>apt</code>\ub098 <code>yum</code> \uac19\uc740 \ud328\ud0a4\uc9c0 \ub9e4\ub2c8\uc800, Helm\uc758 \ud544\uc218 \uba85\ub839\uc5b4\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/cheatsheet/#1-repo","title":"1. \uc800\uc7a5\uc18c(Repo) \uad00\ub9ac","text":"<p>\ucc28\ud2b8(\ud328\ud0a4\uc9c0)\ub97c \ub2e4\uc6b4\ub85c\ub4dc\ud560 \uc800\uc7a5\uc18c\ub97c \uad00\ub9ac\ud569\ub2c8\ub2e4.</p> <pre><code>helm repo add &lt;name&gt; &lt;url&gt;       # \uc800\uc7a5\uc18c \ucd94\uac00 (\uc608: bitnami https://charts.bitnami.com/bitnami)\nhelm repo update                 # \uc800\uc7a5\uc18c \ucd5c\uc2e0 \uc815\ubcf4 \uac31\uc2e0 (apt update\uc640 \ub3d9\uc77c)\nhelm repo list                   # \ub4f1\ub85d\ub41c \uc800\uc7a5\uc18c \ubaa9\ub85d \ud655\uc778\nhelm search repo &lt;keyword&gt;       # \ucc28\ud2b8 \uac80\uc0c9 (\uc608: helm search repo nginx)\n</code></pre>"},{"location":"k8s/cheatsheet/#2-install-manage","title":"2. \uc124\uce58 \ubc0f \uad00\ub9ac (Install &amp; Manage)","text":"<p>\uc560\ud50c\ub9ac\ucf00\uc774\uc158(Release)\uc744 \uc124\uce58\ud558\uace0 \uc5c5\uadf8\ub808\uc774\ub4dc\ud569\ub2c8\ub2e4.</p> <pre><code># \ucc28\ud2b8 \uc124\uce58 (\uae30\ubcf8)\nhelm install &lt;release-name&gt; &lt;repo/chart&gt;\n# \uc608: helm install my-nginx bitnami/nginx\n\n# \ud2b9\uc815 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \uc124\uce58\ud558\uba70 \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc790\ub3d9 \uc0dd\uc131\nhelm install &lt;release-name&gt; &lt;repo/chart&gt; -n &lt;ns&gt; --create-namespace\n\n# \uc124\uc815 \uac12(values.yaml)\uc744 \ubcc0\uacbd\ud558\uba70 \uc124\uce58\nhelm install &lt;release-name&gt; &lt;repo/chart&gt; --set replicaCount=3\n\n# \uc0ac\uc6a9\uc790 \uc815\uc758 values \ud30c\uc77c\ub85c \uc124\uce58\nhelm install &lt;release-name&gt; &lt;repo/chart&gt; -f values.yaml\n\n# \ubc30\ud3ec\ub41c \uc571 \ubaa9\ub85d \ud655\uc778\nhelm list -A  # \ubaa8\ub4e0 \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc870\ud68c\n</code></pre>"},{"location":"k8s/cheatsheet/#3-upgrade-uninstall","title":"3. \uc5c5\uadf8\ub808\uc774\ub4dc \ubc0f \uc0ad\uc81c (Upgrade &amp; Uninstall)","text":"<pre><code># \ucc28\ud2b8 \ubc84\uc804 \uc5c5\uadf8\ub808\uc774\ub4dc \ub610\ub294 \uc124\uc815 \ubcc0\uacbd\nhelm upgrade &lt;release-name&gt; &lt;repo/chart&gt; -f new-values.yaml\n\n# \ubc30\ud3ec\ub41c \uc571 \uc0ad\uc81c\nhelm uninstall &lt;release-name&gt;\n</code></pre>"},{"location":"k8s/cheatsheet/#4-debug-verify","title":"4. \ub514\ubc84\uae45 \ubc0f \uac80\uc99d (Debug &amp; Verify)","text":"<p>Pro Tip: <code>helm template</code>\uc740 \uc2e4\uc81c\ub85c \ud074\ub7ec\uc2a4\ud130\uc5d0 \uc124\uce58\ud558\uc9c0 \uc54a\uace0, \uc0dd\uc131\ub420 YAML \ud30c\uc77c\ub9cc \ubbf8\ub9ac \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. (<code>--dry-run</code>\uacfc \uc720\uc0ac)</p> <pre><code># \ub80c\ub354\ub9c1\ub420 YAML \ubbf8\ub9ac\ubcf4\uae30 (\uc124\uce58 \uc804 \uac80\uc99d \ud544\uc218 \ub2e8\uacc4)\nhelm template &lt;release-name&gt; &lt;repo/chart&gt; -f values.yaml &gt; result.yaml\n\n# \ud604\uc7ac \uc2e4\ud589 \uc911\uc778 \ub9b4\ub9ac\uc988\uc758 \uc801\uc6a9\ub41c values \uac12 \ud655\uc778\nhelm get values &lt;release-name&gt;\n\n# \ud604\uc7ac \uc2e4\ud589 \uc911\uc778 \ub9b4\ub9ac\uc988\uc758 \uc804\uccb4 Manifest \ud655\uc778\nhelm get manifest &lt;release-name&gt;\n\n# \ub9b4\ub9ac\uc988\uc758 \ubc30\ud3ec \uc774\ub825 \ubc0f \uc0c1\ud0dc \ud655\uc778\nhelm status &lt;release-name&gt;\n</code></pre>"},{"location":"k8s/gateway-api/001-envoy-install/","title":"\ud83d\ude80 Envoy \uc124\uce58","text":"<p>2026\ub144 3\uc6d4\ubd80\ud130 <code>Ingress Nginx</code> \uc5d0 \ub300\ud55c \uacf5\uc2dd \uc9c0\uc6d0\uc774 \uc885\ub8cc\ub429\ub2c8\ub2e4. \uc774\uc5d0 \ub530\ub77c Kubernetes\uc758 <code>Gateway API</code> \uc640 <code>Envoy</code> \ub97c \uc0ac\uc6a9\ud558\uc5ec \ud569\ub2c8\ub2e4.</p> <p>\uc774 \ubb38\uc11c\ub294 \ud3d0\uc1c4\ub9dd\uc744 \uae30\uc900\uc73c\ub85c \ud569\ub2c8\ub2e4. \uc124\uce58 \ud30c\uc77c \uc758 <code>envoy-1.36.3</code> \ud3f4\ub354\ub97c \ubc1b\uc544\uc8fc\uc138\uc694.</p>"},{"location":"k8s/gateway-api/001-envoy-install/#0-standard-architecture","title":"0. \uc544\ud0a4\ud14d\ucc98 \uac1c\uc694 (Standard Architecture)","text":"<p>\ucfe0\ubc84\ub124\ud2f0\uc2a4 \ubcf4\uc548 \ubc0f \ub124\ud2b8\uc6cc\ud06c \ud45c\uc900\uc744 \uc900\uc218\ud558\ub294 \uad6c\uc131\uc785\ub2c8\ub2e4.</p> <ul> <li>Network: <code>hostNetwork: false</code> (Pod\ub294 K8s \ub0b4\ubd80\ub9dd \uc0ac\uc6a9, \ub178\ub4dc \ub124\ud2b8\uc6cc\ud06c\uc640 \uaca9\ub9ac)</li> <li>Service: <code>type: LoadBalancer</code> (\uc678\ubd80 \ud2b8\ub798\ud53d \uc9c4\uc785\uc810)</li> <li>Traffic Flow: <code>Client</code> -&gt; <code>External IP (LB)</code> -&gt; <code>Service (80/443)</code> -&gt; <code>Envoy Pod (10080/10443)</code> -&gt; <code>Backend Pod</code></li> </ul>"},{"location":"k8s/gateway-api/001-envoy-install/#1","title":"1. \uc124\uce58","text":""},{"location":"k8s/gateway-api/001-envoy-install/#10","title":"1.0 \uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc","text":"<p>[\uc2e4\ud589 \uc704\uce58: Master 1, Worker 1~3 \uc804\uccb4]</p> <p>\uc804\uccb4 \ub178\ub4dc\uc5d0 <code>envoy</code> \uc774\ubbf8\uc9c0\ub4e4\uc744 \ub85c\ub4dc\ud569\ub2c8\ub2e4.</p> <pre><code>cd ./envoy-1.36.3\nsudo bash ./images/upload_images.sh\n</code></pre>"},{"location":"k8s/gateway-api/001-envoy-install/#11-tls","title":"1.1 \uc0ac\uc804 \uad6c\uc131(TLS \ubc0f \uba40\ud2f0 \ud14c\ub10c\ud2b8 \uc124\uc815)","text":"<p>[\uc2e4\ud589 \uc704\uce58: Master 1]</p> <p>Helm \ubc30\ud3ec \uc804, HTTPS \uc778\uc99d\uc11c\uc640 \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uaca9\ub9ac \ud574\uc81c \uc124\uc815\uc744 \ubbf8\ub9ac \uc801\uc6a9\ud569\ub2c8\ub2e4.</p> <ol> <li> <p>TLS Secret \uc0dd\uc131</p> <ul> <li>Gateway\uac00 \uc0ac\uc6a9\ud560 \uc778\uc99d\uc11c(cert.pem, key.pem)\uc744 \uc774\uc6a9\ud574 Gateway \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc640 \ub3d9\uc77c\ud55c \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 Secret\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4.</li> <li>\uc0ac\uc6a9\ud560 \uc778\uc99d\uc11c\ub294 \ubaa8\ub450 Secret\uc73c\ub85c \uc0dd\uc131\ud569\ub2c8\ub2e4.</li> </ul> <pre><code># \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc0dd\uc131 (\uc544\uc9c1 \uc5c6\ub2e4\uba74)\nkubectl create ns envoy-gateway-system --dry-run=client -o yaml | kubectl apply -f -\n\n# Secret \uc0dd\uc131\nkubectl create secret tls strato-tls \\\n  --cert=cert.pem \\\n  --key=key.pem \\\n  --namespace envoy-gateway-system\n</code></pre> </li> <li> <p>Gateway \ud30c\uc77c \uc218\uc815</p> <ul> <li>\ucd94\uac00\ub41c <code>strato-tls</code> \uc678\uc5d0 \ucd94\uac00\ub41c tls\ub294 <code>template/main.yaml</code> \uc5d0 \uc9c1\uc811 \ucd94\uac00\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul> <pre><code># main.yaml\n...\nspec:\n  gatewayClassName: eg-cluster-entry\n  listeners:\n  - name: http\n    protocol: HTTP\n    port: 80 # \uc11c\ube44\uc2a4\uac00 \uc678\ubd80\ub85c \ub178\ucd9c\ud560 \ud3ec\ud2b8\n    allowedRoutes:\n      namespaces:\n        from: All\n  - name: https\n    protocol: HTTPS\n    port: 443\n    tls:\n      mode: Terminate\n      certificateRefs:\n      - name: {{ .Values.gateway.tls.name }}\n        kind: Secret\n    allowedRoutes:\n      namespaces:\n        from: All\n  # \u25bc\u25bc\u25bc [\uc0c8\ub85c \ucd94\uac00\ub41c \ubd80\ubd84] \u25bc\u25bc\u25bc\n  - name: admin-https # Listener \uc774\ub984\n    port: 443\n    protocol: HTTPS\n    hostname: \"admin.cmp.test.com\"  # \ud574\ub2f9 Listener\ub97c \uc801\uc6a9\ud560 \ub3c4\uba54\uc778\n    tls:\n      mode: Terminate\n      certificateRefs:\n      - name: admin-tls-secret      # \uc801\uc6a9\ud560 tls\uc758 Secret \uc774\ub984\n        kind: Secret\n    allowedRoutes:\n      namespaces:\n        from: All\n</code></pre> </li> <li> <p>HTTP\ub9cc \uc0ac\uc6a9\ud560 \uacbd\uc6b0</p> <ul> <li>\ub9cc\uc57d HTTP\ub9cc \uc0ac\uc6a9\ud55c\ub2e4\uba74 <code>values.yaml</code> \uacfc <code>template/main.yaml</code> \uc5d0\uc11c \ud574\ub2f9 \uc124\uc815\uc744 \uc81c\uac70\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul> <pre><code># main.yaml\nspec:\n  gatewayClassName: eg-cluster-entry\n  listeners:\n  - name: http\n    protocol: HTTP\n    port: 80 # \uc11c\ube44\uc2a4\uac00 \uc678\ubd80\ub85c \ub178\ucd9c\ud560 \ud3ec\ud2b8\n    allowedRoutes:\n      namespaces:\n        from: All\n# \ubc11\uc5d0 HTTPS \uad00\ub828 \ubd80\ubd84 \ubaa8\ub450 \uc0ad\uc81c\n</code></pre> <pre><code># values.yaml\ngateway:\n  name: \"cmp-gateway\" # \uae30\ubcf8\uac12 (\uc2a4\ud06c\ub9bd\ud2b8\uc5d0\uc11c \ub36e\uc5b4\uc4f8 \uc608\uc815)\n  # tls \ubd80\ubd84 \uc0ad\uc81c\n  # tls:\n    # name: \"strato-tls\"\n</code></pre> </li> </ol>"},{"location":"k8s/gateway-api/001-envoy-install/#12","title":"1.2 \uc2a4\ud06c\ub9bd\ud2b8 \uc2e4\ud589","text":"<p>[\uc2e4\ud589 \uc704\uce58: Master 1]</p> <p><code>install_envoy-gateway.sh</code> \uc2a4\ud06c\ub9bd\ud2b8\uc5d0\uc11c \uc544\ub798 \ubcc0\uc218\ub97c \ud658\uacbd\uc5d0 \ub9de\uac8c \ubcc0\uacbd\ud569\ub2c8\ub2e4. (\uae30\ubcf8\uac12\uc744 \uc0ac\uc6a9\ud574\ub3c4 \uad1c\ucc2e\uc2b5\ub2c8\ub2e4.)</p> <ul> <li><code>NAMESPACE:</code> Gateway Namespace</li> <li><code>CONTROLLER_CHART:</code> Controller Chart(\uae30\ubcf8\uac12 \uace0\uc815)</li> <li><code>INFRA_CHART:</code> Infra Chart(\uae30\ubcf8\uac12 \uace0\uc815)</li> <li><code>GW_NAME:</code> Gateway Name</li> <li><code>IMG_GATEWAY:</code> Gateway \uc774\ubbf8\uc9c0(\uae30\ubcf8\uac12 \uace0\uc815)</li> <li><code>IMG_PROXY:</code> Proxy \uc774\ubbf8\uc9c0(\uae30\ubcf8\uac12 \uace0\uc815)</li> <li><code>GW_CLASS_NAME:</code> \ud074\ub7ec\uc2a4\ud130 \ub808\ubca8 \ub9ac\uc18c\uc2a4 \uc774\ub984</li> <li><code>GLOBAL_POLICY_FILE:</code> \uc804\uc5ed \uc124\uc815 \ud30c\uc77c \uc774\ub984(\uae30\ubcf8\uac12 \uace0\uc815)</li> </ul> <p>\uc774\ub54c <code>NAMESPACE</code> \ub098 <code>GW_NAME</code> \ub97c \ubcc0\uacbd\ud588\ub2e4\uba74, <code>HTTPRoute</code> \ud30c\uc77c\uc5d0\ub3c4 \ubcc0\uacbd\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <p>\uc218\uc815\uc774 \ub05d\ub098\uba74 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code>sudo bash install_envoy-gateway.sh\n</code></pre>"},{"location":"k8s/gateway-api/001-envoy-install/#2","title":"2. \ubc30\ud3ec \ud6c4 \uc0c1\ud0dc \ud655\uc778 \ubc0f \ub124\ud2b8\uc6cc\ud06c \uad6c\uc131","text":"<p>\ubc30\ud3ec\uac00 \uc644\ub8cc\ub418\uba74, \uc124\uce58 \uc2dc \uc120\ud0dd\ud55c \ubaa8\ub4dc\uc5d0 \ub530\ub77c \uc544\ub798 Case \uc911 \ubcf8\uc778\uc758 \ud658\uacbd\uc5d0 \ub9de\ub294 \ub0b4\uc6a9\uc744 \ud655\uc778\ud558\uc138\uc694.</p>"},{"location":"k8s/gateway-api/001-envoy-install/#case-a-loadbalancer","title":"\u2705 Case A: LoadBalancer \ubaa8\ub4dc (\uc790\ub3d9 \ud560\ub2f9 \uc644\ub8cc)","text":"<p>\uc2a4\ud06c\ub9bd\ud2b8\uc5d0\uc11c [1] LoadBalancer\ub97c \uc120\ud0dd\ud588\uace0, \ud074\ub77c\uc6b0\ub4dc(AWS/GKE) \ud658\uacbd\uc774\uac70\ub098 MetalLB\uac00 \uad6c\uc131\ub41c \uacbd\uc6b0\uc785\ub2c8\ub2e4.</p> <ul> <li>\ud655\uc778: kubectl get svc -n envoy-gateway-system</li> <li>\uc0c1\ud0dc: EXTERNAL-IP \ud544\ub4dc\uc5d0 IP \uc8fc\uc18c\ub098 \ub3c4\uba54\uc778\uc774 \ud45c\uc2dc\ub429\ub2c8\ub2e4.</li> <li>\uc870\uce58: \ubcc4\ub3c4 \uc870\uce58 \ubd88\ud544\uc694. \ud45c\uc2dc\ub41c IP\ub85c \uc811\uc18d\ud558\uba74 \ub429\ub2c8\ub2e4.</li> </ul>"},{"location":"k8s/gateway-api/001-envoy-install/#case-b-loadbalancer","title":"\u26a0\ufe0f Case B: LoadBalancer \ubaa8\ub4dc (\uc218\ub3d9 \ud560\ub2f9 \ud544\uc694)","text":"<p>\uc2a4\ud06c\ub9bd\ud2b8\uc5d0\uc11c [1] LoadBalancer\ub97c \uc120\ud0dd\ud588\uc73c\ub098, IP\ub97c \ud560\ub2f9\ud574 \uc904 \ucee8\ud2b8\ub864\ub7ec(MetalLB \ub4f1)\uac00 \uc5c6\ub294 \uc628\ud504\ub808\ubbf8 \ud658\uacbd\uc785\ub2c8\ub2e4.</p> <ul> <li>\ud655\uc778: kubectl get svc -n envoy-gateway-system</li> <li>\uc0c1\ud0dc: EXTERNAL-IP\uac00 <code>&lt;pending&gt;</code> \uc0c1\ud0dc\ub85c \uba48\ucdb0 \uc788\uc2b5\ub2c8\ub2e4.</li> <li>\uc870\uce58: \ud2b9\uc815 \ub178\ub4dc\uc758 IP\ub97c VIP\ucc98\ub7fc \uc0ac\uc6a9\ud558\ub3c4\ub85d \uc218\ub3d9\uc73c\ub85c IP\ub97c \ubc14\uc778\ub529\ud574\uc57c \ud569\ub2c8\ub2e4. (\uc544\ub798 \uba85\ub839\uc5b4\uc758 1.1.1.213 \ubd80\ubd84\uc744 \uc2e4\uc81c \uc0ac\uc6a9\ud560 \ub178\ub4dc IP\ub85c \ubcc0\uacbd\ud558\uc5ec \uc2e4\ud589\ud558\uc138\uc694.)</li> </ul> <pre><code># 1. \ub300\uc0c1 \uc11c\ube44\uc2a4 \uc774\ub984 \ucd94\ucd9c\nSVC_NAME=$(kubectl get svc -n envoy-gateway-system -o jsonpath='{.items[?(@.spec.type==\"LoadBalancer\")].metadata.name}')\n\n# 2. External IP \uc218\ub3d9 \ud328\uce58 (\uc0ac\uc6a9\ud560 \ub178\ub4dc IP\ub85c \uc218\uc815 \ud544\uc218!)\nkubectl patch svc -n envoy-gateway-system $SVC_NAME \\\n  --type merge \\\n  -p '{\"spec\":{\"externalIPs\":[\"1.1.1.213\"]}}'\n\necho \"\u2705 \uc11c\ube44\uc2a4($SVC_NAME)\uc5d0 \uc678\ubd80 IP\uac00 \uc218\ub3d9 \ud560\ub2f9\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\"\n</code></pre> <ul> <li>\ub9cc\uc57d 1\ubd84\uc774 \uc9c0\ub098\ub3c4 <code>Gateway</code> \uac00 false \uc0c1\ud0dc\ub77c\uba74 \uc544\ub798 \uba85\ub839\uc5b4\ub85c \uc218\ub3d9 \ubc14\uc778\ub529\ud569\ub2c8\ub2e4.</li> </ul> <pre><code># Gateway IP \uc218\ub3d9 \ud560\ub2f9\nkubectl patch gateway cmp-gateway -n envoy-gateway-system \\\n  --type='merge' \\\n  -p '{\"spec\":{\"addresses\":[{\"type\":\"IPAddress\",\"value\":\"1.1.1.213\"}]}}'\n</code></pre>"},{"location":"k8s/gateway-api/001-envoy-install/#case-c-nodeport","title":"\u2699\ufe0f Case C: NodePort \ubaa8\ub4dc (\ud3ec\ud2b8 \uace0\uc815)","text":"<p>\uc2a4\ud06c\ub9bd\ud2b8\uc5d0\uc11c [2] NodePort\ub97c \uc120\ud0dd\ud55c \uacbd\uc6b0\uc785\ub2c8\ub2e4. \uc124\uce58 \uc2a4\ud06c\ub9bd\ud2b8\uc5d0 \uc758\ud574 \uc11c\ube44\uc2a4 \ud3ec\ud2b8\uac00 HTTP(30080), HTTPS(30443)\uc73c\ub85c \uc790\ub3d9 \uace0\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4.</p> <ol> <li> <p>\ud3ec\ud2b8 \ud655\uc778</p> <pre><code>kubectl get svc -n envoy-gateway-system\n# \ucd9c\ub825 \ud655\uc778: 80:30080/TCP, 443:30443/TCP\n</code></pre> </li> <li> <p>\ud658\uacbd\ubcc4 \uc811\uc18d \uac00\uc774\ub4dc</p> <ul> <li>[C-1] \uc678\ubd80 L4 \uc2a4\uc704\uce58(Hardware LB) \uc5f0\ub3d9 \uc2dc:</li> <li>\ub124\ud2b8\uc6cc\ud06c \ub2f4\ub2f9\uc790\uc5d0\uac8c \"\ucfe0\ubc84\ub124\ud2f0\uc2a4 \ub178\ub4dc\ub4e4\uc758 IP\uc640 \uace0\uc815 \ud3ec\ud2b8(30080, 30443)\"\ub97c   L4 \uc7a5\ube44\uc758 \uba64\ubc84(Real Server)\ub85c \ub4f1\ub85d \uc694\uccad\ud569\ub2c8\ub2e4.</li> <li>\uc0ac\uc6a9\uc790\ub294 L4 \uc7a5\ube44\uc758 VIP(80/443)\ub85c \uc811\uc18d\ud569\ub2c8\ub2e4.</li> <li>[C-2] L4 \uc7a5\ube44\uac00 \uc5c6\ub294 \uacbd\uc6b0 (\ub85c\uceec/\ud3d0\uc1c4\ub9dd \uc9c1\uc811 \uc811\uc18d):</li> <li>\ubcc4\ub3c4\uc758 \uc7a5\ube44 \uc5c6\uc774 PC\uc5d0\uc11c \uc9c1\uc811 \uc811\uc18d\ud569\ub2c8\ub2e4.</li> <li>\uc811\uc18d \uc8fc\uc18c:<ul> <li>HTTP: http://:30080 <li>HTTPS: https://:30443 <li>\uc8fc\uc758: \ubc29\ud654\ubcbd\uc5d0\uc11c \ud574\ub2f9 \ud3ec\ud2b8(30080, 30443)\uac00 \ud5c8\uc6a9\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li>"},{"location":"k8s/gateway-api/001-envoy-install/#3-httproute","title":"3. \ub77c\uc6b0\ud305(HTTPRoute) \uc124\uc815 \ubc0f \uac80\uc99d","text":"<p>Gateway\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \ub5b4\ub2e4\uba74, \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uc5f0\uacb0 \uaddc\uce59(<code>HTTPRoute</code>)\uc744 \uc810\uac80\ud569\ub2c8\ub2e4. \uc774 \uac80\uc99d\uc740 \uc11c\ube44\uc2a4\uc5d0 \uc811\uadfc\ud558\uc9c0 \ubabb\ud560 \ub54c \uc9c4\ud589\ud574\ub3c4 \ub429\ub2c8\ub2e4.</p>"},{"location":"k8s/gateway-api/001-envoy-install/#1-connection-refused","title":"\u2705 \uccb4\ud06c\ub9ac\uc2a4\ud2b8 1: \ubc31\uc5d4\ub4dc \ud3ec\ud2b8 (Connection Refused)","text":"<p>Envoy\ub294 \uc11c\ube44\uc2a4(ClusterIP) \ud3ec\ud2b8\uac00 \uc544\ub2cc \ud30c\ub4dc(Pod)\uc758 \uc2e4\uc81c \ucee8\ud14c\uc774\ub108 \ud3ec\ud2b8\ub85c \uc811\uc18d\uc744 \uc2dc\ub3c4\ud569\ub2c8\ub2e4.</p> <ul> <li>\uc99d\uc0c1: 503 Service Unavailable \ub610\ub294 Connection Refused</li> <li>\ud655\uc778 \ubc29\ubc95: \uc2e4\uc81c \ud30c\ub4dc\uac00 \uba87 \ubc88 \ud3ec\ud2b8\ub97c \uc5f4\uace0 \uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</li> </ul> <pre><code># 1. \ubc31\uc5d4\ub4dc \uc571\uc758 \ud30c\ub4dc \uc774\ub984 \ud655\uc778\nkubectl get pods -n &lt;NAMESPACE&gt;\n\n# 2. \ud30c\ub4dc \uc124\uc815\uc5d0\uc11c 'containerPort' \ud655\uc778 (\uc608: my-app-pod-xyz)\nkubectl get pod &lt;POD_NAME&gt; -n &lt;NAMESPACE&gt; -o yaml | grep containerPort\n# \ucd9c\ub825 \uc608\uc2dc: \n# - containerPort: 8080  &lt;-- \uc774 \ubc88\ud638\uac00 \uc815\ub2f5\uc785\ub2c8\ub2e4.\n</code></pre> <ul> <li>\ud574\uacb0: \uc704\uc5d0\uc11c \ud655\uc778\ud55c \uc2e4\uc81c \ud3ec\ud2b8(\uc608: 8080) \ub97c <code>HTTPRoute</code>\uc758 <code>backendRefs</code> \ud3ec\ud2b8\ub85c \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul> <pre><code># \ud3ec\ud2b8\ub97c 80 -&gt; 8080\uc73c\ub85c \ubcc0\uacbd\ud558\ub294 \uc608\uc2dc\nkubectl patch httproute &lt;ROUTE_NAME&gt; -n &lt;NAMESPACE&gt; --type='json' \\\n  -p='[{\"op\": \"replace\", \"path\": \"/spec/rules/0/backendRefs/0/port\", \"value\": 8080}]'\n</code></pre>"},{"location":"k8s/gateway-api/001-envoy-install/#2-url-rewrite","title":"\u2705 \uccb4\ud06c\ub9ac\uc2a4\ud2b8 2: \uacbd\ub85c \uc7ac\uc791\uc131 (URL Rewrite)","text":"<p>\uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc774 \ud558\uc704 \uacbd\ub85c(Context Path)\ub97c \uc778\uc2dd\ud558\uc9c0 \ubabb\ud574 404\uac00 \ubc1c\uc0dd\ud560 \uacbd\uc6b0 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <ul> <li>\uc0c1\ud669: <code>/oauth2/login</code> \ud638\ucd9c \uc2dc \uc571\uc774 <code>/oauth2</code>\ub97c \uacbd\ub85c\ub85c \uc778\uc2dd\ud558\uc5ec \uc624\ub958 \ubc1c\uc0dd.</li> <li>\ud574\uacb0: <code>URLRewrite</code> \ud544\ud130 \uc801\uc6a9.</li> </ul> <pre><code>filters:\n- type: URLRewrite\n  urlRewrite:\n    path:\n      type: ReplacePrefixMatch\n      replacePrefixMatch: /\n</code></pre>"},{"location":"k8s/gateway-api/001-envoy-install/#4","title":"4. \uc6b4\uc601 \ubc0f \ub85c\uadf8 \ud655\uc778","text":"<p>Envoy Gateway\ub294 \ub3d9\uc801\uc73c\ub85c \ub9ac\uc18c\uc2a4\ub97c \uad00\ub9ac\ud558\ubbc0\ub85c \ud30c\ub4dc \uc774\ub984\uc774 \ubcc0\uacbd\ub429\ub2c8\ub2e4. Label Selector(<code>-l</code>)\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub85c\uadf8\ub97c \ud655\uc778\ud558\ub294 \uac83\uc774 \ud45c\uc900\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/gateway-api/001-envoy-install/#data-plane","title":"\ud83d\udccb \ud504\ub85d\uc2dc(Data Plane) \ub85c\uadf8","text":"<p>\uc2e4\uc81c \ud2b8\ub798\ud53d \ucc98\ub9ac, \uc811\uc18d \uc624\ub958 \ud655\uc778 \uc2dc \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code># Envoy Proxy \ub85c\uadf8 \uc2e4\uc2dc\uac04 \ud655\uc778\nkubectl logs -n envoy-gateway-system -f -l gateway.envoyproxy.io/owning-gateway-name=cmp-gateway\n</code></pre>"},{"location":"k8s/gateway-api/001-envoy-install/#control-plane","title":"\ud83e\udde0 \ucee8\ud2b8\ub864\ub7ec(Control Plane) \ub85c\uadf8","text":"<p>Gateway \uc124\uc815 \ubcc0\ud658, \ubc30\ud3ec \uc2e4\ud328 \uc6d0\uc778 \ubd84\uc11d \uc2dc \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code># Gateway Controller \ub85c\uadf8 \ud655\uc778\nkubectl logs -n envoy-gateway-system -f -l app.kubernetes.io/name=envoy-gateway\n</code></pre>"},{"location":"k8s/gateway-api/001-envoy-install/#gateway","title":"[\ubcc4\ucca8] Gateway \uc5f0\uacb0 \uc0c1\ud0dc \ubc0f \ub77c\uc6b0\ud2b8 \uac80\uc99d \uac00\uc774\ub4dc","text":"<p>Gateway \ub9ac\uc18c\uc2a4\uc640 HTTPRoute \ub9ac\uc18c\uc2a4\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \uc5f0\uacb0(Binding)\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud558\ub294 \ubc29\ubc95\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/gateway-api/001-envoy-install/#1-gateway","title":"1. Gateway \uad00\uc810: \uc5f0\uacb0\ub41c \ub77c\uc6b0\ud2b8 \uc218 \ud655\uc778","text":"<p>Gateway \ub9ac\uc18c\uc2a4\uc758 \uc0c1\ud0dc(Status)\ub97c \uc870\ud68c\ud558\uc5ec \uba87 \uac1c\uc758 \ub77c\uc6b0\ud2b8\uac00 \uc5f0\uacb0\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code># Gateway \uc0c1\ud0dc \uc0c1\uc138 \uc870\ud68c\nkubectl get gateway cmp-gateway -n envoy-gateway-system -o yaml\n</code></pre> <p>\ud655\uc778 \ud3ec\uc778\ud2b8 (status.listeners \uc139\uc158):</p> <ul> <li><code>attachedRoutes:</code> \uc5f0\uacb0\ub41c HTTPRoute\uc758 \uac1c\uc218\uc785\ub2c8\ub2e4. \uc774 \uc22b\uc790\uac00 0\uc774\uba74 \uc5f0\uacb0\ub41c \ub77c\uc6b0\ud2b8\uac00 \uc5c6\ub294 \uac83\uc785\ub2c8\ub2e4.</li> <li><code>conditions:</code> Programmed \uc0c1\ud0dc\uac00 True\uc5ec\uc57c \uc815\uc0c1 \uc791\ub3d9 \uc911\uc785\ub2c8\ub2e4.</li> </ul> <pre><code>status:\n  listeners:\n  - name: http\n    attachedRoutes: 1  # &lt;-- \ud604\uc7ac \uc5f0\uacb0\ub41c \ub77c\uc6b0\ud2b8 \uac1c\uc218\n</code></pre>"},{"location":"k8s/gateway-api/001-envoy-install/#2-httproute-gateway","title":"2. HTTPRoute \uad00\uc810: \ubd80\ubaa8 Gateway \uc5f0\uacb0 \ud655\uc778","text":"<p>\uac1c\ubcc4 <code>HTTPRoute</code> \uac00 Gateway\ub97c \ucc3e\uc558\ub294\uc9c0, \uac70\uc808\ub2f9\ud558\uc9c0\ub294 \uc54a\uc558\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code># \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \ub0b4\uc758 \ubaa8\ub4e0 HTTPRoute \uc0c1\ud0dc \uc694\uc57d \ud655\uc778\nkubectl get httproute -A\n</code></pre> <p>\ud655\uc778 \ud3ec\uc778\ud2b8:</p> <ul> <li>PARENTS: \uc5f0\uacb0\ub41c Gateway \uc774\ub984\uc774 \ud45c\uc2dc\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> <li>STATUS: True \ub610\ub294 Accepted \uc0c1\ud0dc\uc5ec\uc57c \ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"k8s/gateway-api/001-envoy-install/#_1","title":"\uc0c1\uc138 \ub514\ubc84\uae45 (\uc5f0\uacb0 \uc2e4\ud328 \uc2dc)","text":"<p>\ub9cc\uc57d \uc5f0\uacb0\uc774 \uc548 \ub41c\ub2e4\uba74 describe \uba85\ub839\uc5b4\ub85c \uc0c1\uc138 \uc6d0\uc778\uc744 \ud30c\uc545\ud569\ub2c8\ub2e4.</p> <pre><code>kubectl describe httproute &lt;ROUTE_NAME&gt; -n &lt;NAMESPACE&gt;\n</code></pre> <p>\uc8fc\uc694 \uc2e4\ud328 \uc6d0\uc778:</p> <ul> <li>Gateway \uc774\ub984 \ubd88\uc77c\uce58: parentRefs\uc758 name\uc774 \uc2e4\uc81c Gateway \uc774\ub984(cmp-gateway)\uacfc \ub2e4\ub984.</li> <li>Namespace \ubd88\uc77c\uce58: Gateway\uac00 \ub2e4\ub978 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc758 \ub77c\uc6b0\ud2b8\ub97c \ud5c8\uc6a9\ud558\uc9c0 \uc54a\uc74c (Gateway Listener \uc124\uc815\uc758 allowedRoutes \ud655\uc778 \ud544\uc694)</li> </ul>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/","title":"\ud83d\udcd8 HTTPRoute \uae30\ubcf8 \uae30\ub2a5 \ubc0f Ingress to Gateway API (Envoy) \ub9c8\uc774\uadf8\ub808\uc774\uc158 \uac00\uc774\ub4dc","text":"<p>\ubcf8 \ubb38\uc11c\ub294 <code>HTTPRoute</code> \uae30\ubcf8 \uae30\ub2a5 \ubc0f \uae30\uc874 NGINX <code>Ingress</code> \ub9ac\uc18c\uc2a4 \ubcc0\ud658 \uac00\uc774\ub4dc\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#1","title":"1. \ubcc0\ud658 \uc804 \ud544\uc218 \uc810\uac80 \uc0ac\ud56d","text":"<ol> <li>Gateway \uc774\ub984: \ubaa8\ub4e0 Route\ub294 <code>cmp-gateway</code> (Namespace: <code>envoy-gateway-system</code> )\ub97c \ubc14\ub77c\ubd10\uc57c \ud569\ub2c8\ub2e4.</li> <li>\uc704 \uc774\ub984\uc740 \uc900\ube44\ub41c \uc124\uce58 \ud30c\uc77c\uc758 \uae30\ubcf8\uac12\uc785\ub2c8\ub2e4.</li> <li>Gateway \uc774\ub984 \ubc0f Namespace\ub294 \uc124\uc815\ud55c \uac12\uc5d0 \ub530\ub77c \ub2e4\ub97c \uc218 \uc788\uc2b5\ub2c8\ub2e4.</li> <li>Target Port \uc0ac\uc6a9: <code>backendRefs</code>\uc758 \ud3ec\ud2b8\ub294 Service Port(80) \ub300\uc2e0 Pod Container Port(\uc608: 8080, 3000)\ub97c \uc0ac\uc6a9\ud558\ub294 \uac83\uc774 \uc548\uc804\ud569\ub2c8\ub2e4.</li> <li>Namespace: <code>HTTPRoute</code> \ub9ac\uc18c\uc2a4\ub294 \ubc18\ub4dc\uc2dc \uc5f0\uacb0\ud558\ub824\ub294 Service\uc640 \ub3d9\uc77c\ud55c \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \uc0dd\uc131\ud574\uc57c \ud569\ub2c8\ub2e4.</li> <li>Deployment\uc758 containerPort: <code>Envoy</code> \ub4f1 Service Mesh\ub97c \uc0ac\uc6a9\ud558\uae30\uc5d0, Deployment\uc758 <code>containerPort</code> \ud56d\ubaa9\uc740 \ud544\uc218\ub85c \uc791\uc131\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> </ol>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#2-gateway-api","title":"2. Gateway API \uae30\ubcf8 \uae30\ub2a5","text":"<p>Gateway API\uc5d0\uc11c \uc81c\uacf5\ud558\ub294 \uae30\ub2a5 \uc911 \uae30\ubcf8 \uae30\ub2a5\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#1-matching-rules","title":"1\ufe0f\u20e3 \ub9e4\uce6d \uc870\uac74 (Matching Rules)","text":"<p>\uacbd\ub85c\ubfd0\ub9cc \uc544\ub2c8\ub77c \ud5e4\ub354, \ucffc\ub9ac \ud30c\ub77c\ubbf8\ud130, HTTP \uba54\uc11c\ub4dc\ub85c\ub3c4 \ubd84\uae30\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code>rules:\n  - matches:\n    # 1. \uacbd\ub85c \ub9e4\uce6d (Prefix vs Exact)\n    - path:\n        type: PathPrefix # /api\ub85c \uc2dc\uc791\ud558\ub294 \ubaa8\ub4e0 \uc694\uccad\n        value: /api\n\n    # 2. \ud5e4\ub354 \ub9e4\uce6d (\uc608: \ub514\ubc84\uadf8 \ubaa8\ub4dc)\n    - headers:\n      - name: x-debug-mode\n        value: \"true\"\n\n    # 3. \uba54\uc11c\ub4dc \ub9e4\uce6d (GET \uc694\uccad\ub9cc \ud5c8\uc6a9)\n    - method: GET\n\n    backendRefs:\n    - name: my-service\n      port: 8080\n</code></pre>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#2-canary-release","title":"2\ufe0f\u20e3 \ud2b8\ub798\ud53d \ubd84\ud560 (Canary Release)","text":"<p>\ubcc4\ub3c4\uc758 \uc11c\ube44\uc2a4 \uba54\uc2dc(Istio \ub4f1) \uc5c6\uc774\ub3c4 \uac00\uc911\uce58(Weight) \uae30\ubc18\uc758 \uce74\ub098\ub9ac \ubc30\ud3ec\uac00 \uac00\ub2a5\ud569\ub2c8\ub2e4.</p> <pre><code>rules:\n  - matches:\n    - path:\n        type: PathPrefix\n        value: /v1\n    backendRefs:\n    # \uae30\uc874 \ubc84\uc804 (90% \ud2b8\ub798\ud53d)\n    - name: app-v1-svc\n      port: 8080\n      weight: 90\n    # \uc2e0\uaddc \ubc84\uc804 (10% \ud2b8\ub798\ud53d)\n    - name: app-v2-svc\n      port: 8080\n      weight: 10\n</code></pre>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#3-redirect","title":"3\ufe0f\u20e3 \ub9ac\ub2e4\uc774\ub809\ud2b8 (Redirect)","text":"<p>\uad6c\ud615 URL\uc744 \uc2e0\uaddc URL\ub85c \ub118\uae30\uac70\ub098, HTTP\ub97c HTTPS\ub85c \uac15\uc81c\ud560 \ub54c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code>rules:\n  - matches:\n    - path:\n        type: PathPrefix\n        value: /old-path\n    filters:\n    - type: RequestRedirect\n      requestRedirect:\n        scheme: https        # \ud504\ub85c\ud1a0\ucf5c \ubcc0\uacbd (\uc635\uc158)\n        hostname: new.com    # \ud638\uc2a4\ud2b8 \ubcc0\uacbd (\uc635\uc158)\n        path:\n          type: ReplaceFullPath\n          replaceFullPath: /new-path # \uacbd\ub85c \ubcc0\uacbd\n        statusCode: 301      # \uc0c1\ud0dc \ucf54\ub4dc (301/302)\n</code></pre>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#4-header-modification","title":"4\ufe0f\u20e3 \ud5e4\ub354 \uc870\uc791 (Header Modification)","text":"<p>\ubc31\uc5d4\ub4dc \uc11c\ubc84\ub85c \uc694\uccad\uc744 \ubcf4\ub0b4\uae30 \uc804(Request)\uc774\ub098, \ud074\ub77c\uc774\uc5b8\ud2b8\ub85c \uc751\ub2f5\uc744 \uc8fc\uae30 \uc804(Response)\uc5d0 \ud5e4\ub354\ub97c \ucd94\uac00/\uc0ad\uc81c\ud569\ub2c8\ub2e4.</p> <pre><code>filters:\n  # \uc694\uccad \ud5e4\ub354 \uc870\uc791 (\ubc31\uc5d4\ub4dc\uac00 \ubc1b\uc744 \ud5e4\ub354)\n  - type: RequestHeaderModifier\n    requestHeaderModifier:\n      add:\n      - name: \"X-Envoy-Gateway\"\n        value: \"true\"\n      remove: [\"X-Internal-Secret\"]\n\n  # \uc751\ub2f5 \ud5e4\ub354 \uc870\uc791 (\ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \ubc1b\uc744 \ud5e4\ub354)\n  - type: ResponseHeaderModifier\n    responseHeaderModifier:\n      set:\n      - name: \"Cache-Control\"\n        value: \"no-cache\"\n</code></pre>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#5-traffic-mirroring","title":"5\ufe0f\u20e3 \ubbf8\ub7ec\ub9c1 (Traffic Mirroring)","text":"<p>\uc6b4\uc601 \ud658\uacbd\uc758 \ud2b8\ub798\ud53d\uc744 \ubcf5\uc81c\ud558\uc5ec \uc0ac\uc6a9\uc790\uc5d0\uac8c \uc601\ud5a5 \uc5c6\uc774 \ud14c\uc2a4\ud2b8 \uc11c\ubc84\ub85c \ub611\uac19\uc774 \ubcf4\ub0b4\ubd05\ub2c8\ub2e4. (Shadowing)</p> <pre><code>rules:\n  - matches:\n    - path:\n        type: PathPrefix\n        value: /payment\n\n    # \uc2e4\uc81c \ud2b8\ub798\ud53d \ucc98\ub9ac\n    backendRefs:\n    - name: payment-prod-svc\n      port: 8080\n\n    # \ud2b8\ub798\ud53d \ubcf5\uc81c (\uc751\ub2f5\uc740 \ubb34\uc2dc\ub428)\n    filters:\n    - type: RequestMirror\n      requestMirror:\n        backendRef:\n          name: payment-test-svc\n          port: 8080\n</code></pre>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#3-case-study","title":"3. \uc2e4\uc804 \ubcc0\ud658 \ucf00\uc774\uc2a4 (Case Study)","text":""},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#case-a-grafana-rewrite-sub-path","title":"\ud83d\udcc2 Case A: \ubaa8\ub2c8\ud130\ub9c1 (Grafana) - Rewrite &amp; Sub-path","text":"<p>Grafana\uc640 \uac19\uc774 <code>/grafana</code> \uacbd\ub85c\ub85c \ub4e4\uc5b4\uc624\uc9c0\ub9cc \uc571\uc740 <code>/</code>\ub85c \uc778\uc2dd\ud574\uc57c \ud558\ub294 \uacbd\uc6b0\uc785\ub2c8\ub2e4.</p> <p>\ud83d\udd34 Before (Ingress)</p> <pre><code>metadata:\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /$2  # \uacbd\ub85c \uc7ac\uc791\uc131\nspec:\n  rules:\n  - http:\n      paths:\n      - path: /grafana(/|$)(.*)\n        backend:\n          service:\n            name: grafana-svc\n            port: { number: 3000 }\n</code></pre> <p>\ud83d\udfe2 After (HTTPRoute)</p> <pre><code>apiVersion: gateway.networking.k8s.io/v1\nkind: HTTPRoute\nmetadata:\n  name: strato-monitoring-route\n  namespace: {{ .Values.monitoringOss.namespace }} # \uc11c\ube44\uc2a4\uc640 \ub3d9\uc77c\ud55c \ub124\uc784\uc2a4\ud398\uc774\uc2a4\n  labels:\n    app: grafana\nspec:\n  parentRefs:\n  - name: cmp-gateway  # Gateway \uc774\ub984\n    namespace: envoy-gateway-system  # Gateway Namespace\n\n  hostnames:\n  - {{ .Values.productIngress.host | quote }}\n\n  rules:\n  # --------------------------------------------------------\n  # Grafana \uacbd\ub85c (/grafana -&gt; /)\n  # --------------------------------------------------------\n  - matches:\n    - path:\n        type: PathPrefix\n        value: /grafana\n\n    filters:\n    # [\ud575\uc2ec] URL Rewrite (/grafana/xxx -&gt; /xxx)\n    - type: URLRewrite\n      urlRewrite:\n        path:\n          type: ReplacePrefixMatch\n          replacePrefixMatch: /\n\n    backendRefs:\n    - name: grafana-svc\n      port: 3000 # \uc2e4\uc81c \ucee8\ud14c\uc774\ub108 \ud3ec\ud2b8 \uad8c\uc7a5\n</code></pre>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#case-b-api-gateway-cors-body-size","title":"\ud83d\udcc2 Case B: API Gateway - CORS &amp; Body Size","text":"<p>API \ud638\ucd9c\uc744 \uc704\ud55c Gateway\ub85c, CORS \uc124\uc815\uacfc \ub300\uc6a9\ub7c9 \ud30c\uc77c \uc5c5\ub85c\ub4dc(20MB) \uc124\uc815\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.</p> <p>\ud83d\udd34 Before (Ingress)</p> <pre><code>metadata:\n  annotations:\n    nginx.ingress.kubernetes.io/proxy-body-size: \"20M\"\n    nginx.ingress.kubernetes.io/cors-allow-origin: \"*\"\n    ...\n</code></pre> <p>\ud83d\udfe2 After (HTTPRoute + EnvoyPatchPolicy)</p> <ol> <li> <p>\ub77c\uc6b0\ud2b8 \uc124\uc815 (CORS &amp; Rewrite)</p> <pre><code>apiVersion: gateway.networking.k8s.io/v1\nkind: HTTPRoute\nmetadata:\nname: api-gateway-route\nnamespace: {{ .Values.common.namespace }}\nspec:\nparentRefs:\n- name: cmp-gateway\n    namespace: envoy-gateway-system\nhostnames:\n- {{ .Values.gatewayIngress.host | quote }}\nrules:\n- matches:\n    - path:\n        type: PathPrefix\n        value: /gw\n    filters:\n    # 1. \uacbd\ub85c \uc7ac\uc791\uc131 (/gw \uc81c\uac70)\n    - type: URLRewrite\n    urlRewrite:\n        path:\n        type: ReplacePrefixMatch\n        replacePrefixMatch: /\n\n    # 2. CORS \ud5e4\ub354 \uc124\uc815\n    - type: ResponseHeaderModifier\n    responseHeaderModifier:\n        set:\n        - name: \"Access-Control-Allow-Origin\"\n        value: \"*\"\n        - name: \"Access-Control-Allow-Methods\"\n        value: \"PUT, GET, POST, DELETE, OPTIONS, PATCH\"\n        - name: \"Access-Control-Allow-Headers\"\n        value: \"*\"\n        - name: \"Access-Control-Allow-Credentials\"\n        value: \"true\"\n\n    backendRefs:\n    - name: api-gateway-svc\n    port: {{ .Values.gateway.ports.internal }}\n</code></pre> </li> <li> <p>Body Size \uc124\uc815 (\uc804\uc5ed \uc124\uc815)</p> <p>Ingress\uc758 <code>proxy-body-size</code>\ub294 <code>HTTPRoute</code>\uc5d0 \uc5c6\uace0 <code>EnvoyPatchPolicy</code> \ub85c Envoy \uc124\uc815\uc744 \uc9c1\uc811 \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>apiVersion: gateway.envoyproxy.io/v1alpha1\nkind: EnvoyPatchPolicy\nmetadata:\nname: increase-body-limit-20m\nnamespace: envoy-gateway-system  # [\uc911\uc694] Gateway\uc640 \uac19\uc740 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\nspec:\ntargetRef:\n    group: gateway.networking.k8s.io\n    kind: Gateway\n    name: cmp-gateway            # \ub300\uc0c1 Gateway \uc774\ub984\ntype: JSONPatch\njsonPatches:\n- type: \"type.googleapis.com/envoy.config.listener.v3.Listener\"\n    # [\uc911\uc694] \ub9ac\uc2a4\ub108 \uc774\ub984 \uaddc\uce59: &lt;namespace&gt;/&lt;gateway&gt;/&lt;listener_name&gt;\n    name: \"envoy-gateway-system/cmp-gateway/http\" \n    operation:\n    op: add\n    # HTTP Connection Manager(HCM) \uc124\uc815\uc5d0 max_request_bytes \uc8fc\uc785\n    path: \"/filter_chains/0/filters/0/typed_config/max_request_bytes\"\n    value: 20971520 # 20MB (Byte \ub2e8\uc704)\n</code></pre> </li> </ol>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#case-c-multi-path-routing","title":"\ud83d\udcc2 Case C: \uba54\uc778 \ud3ec\ud138 (Multi-path Routing)","text":"<p>\ud558\ub098\uc758 \ud638\uc2a4\ud2b8\uc5d0\uc11c <code>/oauth2</code>\uc640 <code>/</code> (\ub8e8\ud2b8) \uacbd\ub85c\ub97c \uc11c\ub85c \ub2e4\ub978 \uc11c\ube44\uc2a4\ub85c \ubd84\uae30\ud569\ub2c8\ub2e4.</p> <p>\ud83d\udd34 Before (Ingress)</p> <pre><code>spec:\n  rules:\n    - path: /\n      backend: strato-portal-frontend-svc\n    - path: /oauth2\n      backend: strato-auth-svc\n</code></pre> <p>\ud83d\udfe2 After (HTTPRoute)</p> <pre><code>apiVersion: gateway.networking.k8s.io/v1\nkind: HTTPRoute\nmetadata:\n  name: strato-product-route\n  namespace: {{ .Values.common.namespace }}\nspec:\n  parentRefs:\n  - name: cmp-gateway  # Gateway \uc774\ub984\n    namespace: envoy-gateway-system  # Gateway Namespace\n  hostnames:\n  - {{ .Values.productIngress.host | quote }}\n  rules:\n  # --------------------------------------------------------\n  # \uaddc\uce59 1: /oauth2 (\uc778\uc99d \uc11c\ube44\uc2a4) - \uad6c\uccb4\uc801\uc778 \uacbd\ub85c\uac00 \uc6b0\uc120 \ub9e4\uce6d\ub428\n  # --------------------------------------------------------\n  - matches:\n    - path:\n        type: PathPrefix\n        value: /oauth2\n    backendRefs:\n    - name: strato-auth-svc\n      port: 5555\n\n  # --------------------------------------------------------\n  # \uaddc\uce59 2: / (\uba54\uc778 \ud3ec\ud138) - \ub098\uba38\uc9c0 \ubaa8\ub4e0 \uc694\uccad \ucc98\ub9ac\n  # --------------------------------------------------------\n  - matches:\n    - path:\n        type: PathPrefix\n        value: /\n    backendRefs:\n    - name: strato-portal-frontend-svc\n      port: 80\n</code></pre>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#case-d-helm-portal-frontend","title":"\ud83d\udcc2 Case D: Helm \ud15c\ud50c\ub9bf \uc801\uc6a9 (Portal Frontend)","text":"<p>Helm \ucc28\ud2b8(<code>values.yaml</code>)\ub97c \uc0ac\uc6a9\ud558\ub294 \ub3d9\uc801 \uc0dd\uc131 \uc608\uc2dc\uc785\ub2c8\ub2e4.</p> <p>\ud83d\udfe2 After (HTTPRoute with Helm)</p> <pre><code>apiVersion: gateway.networking.k8s.io/v1\nkind: HTTPRoute\nmetadata:\n  name: strato-portal-frontend-route\n  namespace: {{ default .Release.Namespace .Values.namespace }}\n  labels:\n    app.kubernetes.io/name: strato-portal-frontend\nspec:\n  parentRefs:\n  - name: cmp-gateway\n    namespace: envoy-gateway-system\n\n  hostnames:\n  - {{ .Values.ingress.domain | quote }}\n\n  rules:\n  # --------------------------------------------------------\n  # 1. \uc778\uc99d \uc11c\ube44\uc2a4 (/oauth2)\n  # --------------------------------------------------------\n  - matches:\n    - path:\n        type: PathPrefix\n        value: /oauth2\n    backendRefs:\n    - name: {{ .Values.ingress.oauth2.serviceName }} # strato-auth-svc\n      port: {{ .Values.ingress.oauth2.servicePort }} # 5555\n\n  # --------------------------------------------------------\n  # 2. \uba54\uc778 \ud3ec\ud138 (/)\n  # --------------------------------------------------------\n  - matches:\n    - path:\n        type: PathPrefix\n        value: /\n    backendRefs:\n    - name: strato-portal-frontend-svc\n      port: {{ .Values.service.port }}   # 80\n</code></pre>"},{"location":"k8s/gateway-api/002-convert_ingress_to_httproute/#4","title":"4. \uc694\uc57d \ubc0f \uc8fc\uc758\uc0ac\ud56d","text":"<ol> <li>Rewrite Target: <code>annotation</code> \ub300\uc2e0 <code>filters.urlRewrite</code>\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</li> <li>CORS: <code>annotation</code> \ub300\uc2e0 <code>filters.responseHeaderModifier</code>\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</li> <li>Body Size: <code>HTTPRoute</code>\uac00 \uc544\ub2cc <code>EnvoyPatchPolicy</code>\ub85c \uc804\uc5ed \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4. (Byte \ub2e8\uc704 \uc8fc\uc758)</li> <li>\uc6b0\uc120\uc21c\uc704: <code>rules</code> \ub9ac\uc2a4\ud2b8\uc758 \uc21c\uc11c\ub294 \uc0c1\uad00\uc5c6\uc73c\ub098, \uac00\uc7a5 \uae34 \uacbd\ub85c(More Specific Path)\uac00 \uc790\ub3d9\uc73c\ub85c \uc6b0\uc120\uc21c\uc704\ub97c \uac16\uc2b5\ub2c8\ub2e4. (\uc608: <code>/oauth2</code>\uac00 <code>/</code>\ubcf4\ub2e4 \uc6b0\uc120)</li> </ol>"},{"location":"k8s/gateway-api/envoy-gateway-network-config/","title":"\ud83c\udf10 Envoy Gateway \ub124\ud2b8\uc6cc\ud06c \uad6c\uc131 \uc120\ud0dd \uac00\uc774\ub4dc","text":"<p>\ud604\uc7ac \uc0c1\ud669(On-Premise, \uc678\ubd80 LB \uc720\ubb34, IP \ud544\uc694 \uc5ec\ubd80)\uc5d0 \ub530\ub77c \ucd5c\uc801\uc758 \ubc29\uc2dd\uc744 \uc120\ud0dd\ud558\uc138\uc694.</p>"},{"location":"k8s/gateway-api/envoy-gateway-network-config/#option-1","title":"[Option 1] \uace0\uac00\uc6a9\uc131 \ucd5c\uc6b0\uc120 (\ucd94\ucc9c \u2b50)","text":"<p>\"\ub178\ub4dc\uac00 \uc8fd\uc5b4\ub3c4 \uc11c\ube44\uc2a4\ub294 \uc0b4\uc544\uc57c \ud558\uace0, \uad6c\uc131\uc774 \uc81c\uc77c \uac04\ub2e8\ud574\uc57c \ud55c\ub2e4.\"</p> <ul> <li>\uad6c\uc131: <code>NodePort</code> + <code>externalTrafficPolicy: Cluster</code> + <code>Deployment</code></li> <li>\uc678\ubd80 LB: \ud558\ub4dc\uc6e8\uc5b4 LB (L4)\uac00 \uc55e\ub2e8\uc5d0 \uc874\uc7ac.</li> <li>\ub3d9\uc791: \uc5b4\ub290 \ub178\ub4dc\ub85c \ub4e4\uc5b4\uc624\ub4e0 K8s\uac00 \ub0b4\ubd80\uc5d0\uc11c \ud30c\ub4dc\uac00 \uc788\ub294 \uacf3\uc73c\ub85c \ubc30\ub2ec\ud574 \uc90d\ub2c8\ub2e4.</li> <li>\uc7a5\uc810:</li> <li>\ud30c\ub4dc\ub97c \ub178\ub4dc \uac1c\uc218\ub9cc\ud07c \ub744\uc6b8 \ud544\uc694\uac00 \uc5c6\uc74c (\ub9ac\uc18c\uc2a4 \uc808\uc57d).</li> <li> <p>\uc124\uc815\uc774 \uac00\uc7a5 \uc27d\uace0 \uc7a5\uc560 \ub300\uc751\uc774 \uc720\uc5f0\ud568.</p> </li> <li> <p>\ub2e8\uc810: Envoy\uac00 \ud074\ub77c\uc774\uc5b8\ud2b8\uc758 \uc9c4\uc9dc IP\ub97c \ubaa8\ub984 (Node IP\ub85c \ubcf4\uc784).</p> </li> <li>(\ud574\uacb0\ucc45: \uc678\ubd80 LB\uc5d0\uc11c Proxy Protocol \ud65c\uc131\ud654)</li> </ul>"},{"location":"k8s/gateway-api/envoy-gateway-network-config/#option-2-ip-performance-logging","title":"[Option 2] \ud074\ub77c\uc774\uc5b8\ud2b8 IP \ubcf4\uc874 \ud544\uc218 (Performance &amp; Logging)","text":"<p>\"\uc0ac\uc6a9\uc790 IP \ub85c\uadf8\ub97c \uaf2d \ub0a8\uaca8\uc57c \ud558\uac70\ub098, \ub124\ud2b8\uc6cc\ud06c \ud649(Hop)\uc744 \uc904\uc5ec \uc18d\ub3c4\ub97c \ub192\uc5ec\uc57c \ud55c\ub2e4.\"</p> <ul> <li>\uad6c\uc131: <code>NodePort</code> + <code>externalTrafficPolicy: Local</code> + <code>DaemonSet</code> (\ud544\uc218)</li> <li>\uc678\ubd80 LB: \ud558\ub4dc\uc6e8\uc5b4 LB (L4)\uac00 \uc55e\ub2e8\uc5d0 \uc874\uc7ac.</li> <li>\ub3d9\uc791: \ud2b8\ub798\ud53d\uc744 \ubc1b\uc740 \ub178\ub4dc\uac00 \uc9c1\uc811 \ucc98\ub9ac\ud569\ub2c8\ub2e4. (\ub0a8\uc758 \ub178\ub4dc\ub85c \ud1a0\uc2a4 \uc548 \ud568)</li> <li>\uc7a5\uc810:</li> <li>\ud074\ub77c\uc774\uc5b8\ud2b8 IP\uac00 \uadf8\ub300\ub85c \ubcf4\uc874\ub428.</li> <li> <p>\ubd88\ud544\uc694\ud55c \ub0b4\ubd80 \ub124\ud2b8\uc6cc\ud06c \ud0c0\uae30(SNAT)\uac00 \uc5c6\uc5b4 \uc131\ub2a5\uc774 \ubbf8\uc138\ud558\uac8c \ub354 \uc88b\uc74c.</p> </li> <li> <p>\ub2e8\uc810:</p> </li> <li>\ub9ac\uc18c\uc2a4 \ub0ad\ube44: \ud2b8\ub798\ud53d\uc774 \uc801\uc5b4\ub3c4 \ubaa8\ub4e0 \ub178\ub4dc\uc5d0 Envoy \ud30c\ub4dc\ub97c \ub744\uc6cc\uc57c \ud568.</li> <li>\uc5c5\ub370\uc774\ud2b8 \uc2dc \ub864\ub9c1 \ubc30\ud3ec \uad00\ub9ac\uac00 \uc870\uae08 \ub354 \uae4c\ub2e4\ub85c\uc6c0.</li> </ul>"},{"location":"k8s/gateway-api/envoy-gateway-network-config/#option-3-sw-lb","title":"[Option 3] \uc678\ubd80 \uc7a5\ube44 \uc5c6\uc74c (S/W LB)","text":"<p>\"\ube44\uc2fc L4 \uc2a4\uc704\uce58\uac00 \uc5c6\ub2e4. \ub9e8\ub545\uc5d0 \ud5e4\ub529\ud574\uc57c \ud55c\ub2e4.\"</p> <ul> <li>\uad6c\uc131: <code>LoadBalancer</code> (MetalLB) + <code>externalTrafficPolicy: Cluster</code></li> <li>\uc678\ubd80 LB: \uc5c6\uc74c (MetalLB\uac00 \uadf8 \uc5ed\ud560\uc744 \ud568).</li> <li>\ub3d9\uc791: \ud2b9\uc815 \ub178\ub4dc\uac00 VIP\ub97c \ub4e4\uace0 \uc788\ub2e4\uac00, \uc8fd\uc73c\uba74 \ub2e4\ub978 \ub178\ub4dc\uac00 \uc774\uc5b4\ubc1b\uc2b5\ub2c8\ub2e4.</li> <li>\uc7a5\uc810: \ucd94\uac00 \uc7a5\ube44 \ube44\uc6a9 0\uc6d0.</li> <li>\ub2e8\uc810: L2 \ubaa8\ub4dc \uc0ac\uc6a9 \uc2dc Failover\uc5d0 \uc218 \ucd08~\uc218\uc2ed \ucd08 \ub51c\ub808\uc774\uac00 \ubc1c\uc0dd\ud560 \uc218 \uc788\uc74c.</li> </ul>"},{"location":"k8s/gateway-api/envoy-gateway-network-config/#_1","title":"\ud83d\udcca \ud55c\ub208\uc5d0 \ubcf4\ub294 \ube44\uad50\ud45c","text":"\uad6c\ubd84 Option 1 (\ud604\uc7ac \uc9c4\ud589 \uc911) Option 2 (IP \uc911\uc694) Option 3 (\uc7a5\ube44 \uc5c6\uc74c) \ubc29\uc2dd NodePort (Cluster) NodePort (Local) MetalLB \ud544\uc218 \ub9ac\uc18c\uc2a4 Deployment (\uae30\ubcf8) DaemonSet Deployment \uc678\ubd80 LB \uc7a5\ube44 \ud544\uc218 \ud544\uc218 \ubd88\ud544\uc694 \ud074\ub77c\uc774\uc5b8\ud2b8 IP \u274c (\ubcc4\ub3c4 \uc124\uc815 \ud544\uc694) \u2705 \ubcf4\uc874\ub428 \u274c \ub9ac\uc18c\uc2a4 \ud6a8\uc728 \uc88b\uc74c (\ud544\uc694\ud55c \ub9cc\ud07c\ub9cc \ub738) \ub098\uc068 (\ubaa8\ub4e0 \ub178\ub4dc\uc5d0 \ub738) \uc88b\uc74c \ub178\ub4dc \ub2e4\uc6b4 \uc2dc \ubb34\uc911\ub2e8 (\ub2e4\ub978 \ub178\ub4dc\uac00 \ucc98\ub9ac) \ubb34\uc911\ub2e8 (LB\uac00 \ud5ec\uc2a4\uccb4\ud06c\ub85c \ube8c) \uc7a0\uae50 \ub04a\uae40 \ud6c4 \ubcf5\uad6c \ucd94\ucc9c \uc0c1\ud669 \uc77c\ubc18\uc801\uc778 \uae30\uc5c5 \ud658\uacbd \uc811\uc18d \ub85c\uadf8/\ubcf4\uc548 \uac10\uc0ac \ud544\uc218 \ud14c\uc2a4\ud2b8/\uc18c\uaddc\ubaa8"},{"location":"k8s/gateway-api/missed-containerport/","title":"\ud83d\udcdd [Troubleshooting] Envoy \ud658\uacbd\uc5d0\uc11c Service Endpoint\uac00 \uc788\ub294\ub370\ub3c4 Connection Refused \ubc1c\uc0dd\ud558\ub294 \ud604\uc0c1","text":""},{"location":"k8s/gateway-api/missed-containerport/#1-summary","title":"1. \uac1c\uc694 (Summary)","text":"<ul> <li>\ud604\uc0c1: \ub9c8\uc774\ud06c\ub85c\uc11c\ube44\uc2a4 \ud638\ucd9c \uc2dc <code>500 Server Error</code> \ubc0f <code>Connection refused</code> \ubc1c\uc0dd.</li> <li>\ud2b9\uc774\uc0ac\ud56d: <code>kubectl get endpoints</code> \uc870\ud68c \uc2dc Pod IP\uc640 Port\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \uc7a1\ud600\uc788\uc74c\uc5d0\ub3c4 \ud1b5\uc2e0 \ubd88\uac00.</li> <li>\uc6d0\uc778: Deployment YAML\uc5d0 <code>containerPort</code> \uc120\uc5b8\uc774 \ub204\ub77d\ub428.</li> <li>\ud658\uacbd: Kubernetes + Envoy (Istio \ub4f1 Service Mesh)</li> </ul>"},{"location":"k8s/gateway-api/missed-containerport/#2-symptom","title":"2. \uc99d\uc0c1 (Symptom)","text":"<p>Caller(\ud638\ucd9c\ud558\ub294 \ucabd) \uc11c\ube44\uc2a4 \ub85c\uadf8\uc5d0\uc11c \uc544\ub798\uc640 \uac19\uc740 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uba70 \ud1b5\uc2e0 \uc2e4\ud328.</p> <pre><code>io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: &lt;SERVICE_DOMAIN&gt;/&lt;POD_IP&gt;:8080\n</code></pre> <p>\ud558\uc9c0\ub9cc, K8s \ub9ac\uc18c\uc2a4 \uc0c1\ud0dc\ub97c \ud655\uc778\ud574 \ubcf4\uba74 \ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0 \uc815\ubcf4(Endpoints)\ub294 \uc815\uc0c1\uc73c\ub85c \ubcf4\uc784 (\uc774\uac83 \ub54c\ubb38\uc5d0 \ud63c\ub780 \ubc1c\uc0dd).</p> <pre><code># Service Endpoints \uc815\uc0c1 (IP\uac00 \uc7a1\ud600\uc788\uc74c!)\n$ kubectl get endpoints strato-imp-svc -n strato-product\nNAME             ENDPOINTS            AGE\nstrato-imp-svc   192.168.104.23:8080  3d\n</code></pre>"},{"location":"k8s/gateway-api/missed-containerport/#3-root-cause","title":"3. \uc6d0\uc778 \ubd84\uc11d (Root Cause)","text":""},{"location":"k8s/gateway-api/missed-containerport/#k8s-vs-envoy","title":"\uc77c\ubc18 K8s vs Envoy \ud658\uacbd\uc758 \ucc28\uc774","text":"<ul> <li>\uc77c\ubc18 K8s: <code>containerPort</code>\ub294 \ub2e8\uc21c \uc815\ubcf4 \uc81c\uacf5\uc6a9(Informational)\uc5d0 \uac00\uae5d\uc2b5\ub2c8\ub2e4. \uc2e4\uc81c \ud504\ub85c\uc138\uc2a4\uac00 \ud3ec\ud2b8\ub97c \uc5f4\uace0 \uc788\uc73c\uba74, YAML\uc5d0 \uc548 \uc801\uc5b4\ub3c4 \ud1b5\uc2e0\uc774 \ub418\ub294 \uacbd\uc6b0\uac00 \ub9ce\uc2b5\ub2c8\ub2e4.</li> <li>Envoy (Service Mesh) \ud658\uacbd: <code>containerPort</code> \uc120\uc5b8\uc774 \ud544\uc218(Mandatory)\uc785\ub2c8\ub2e4.</li> </ul>"},{"location":"k8s/gateway-api/missed-containerport/#_1","title":"\uc0c1\uc138 \uba54\ucee4\ub2c8\uc998","text":"<ol> <li>Envoy \uc0ac\uc774\ub4dc\uce74(Sidecar)\ub294 Pod \ub0b4\uc758 \ub124\ud2b8\uc6cc\ud06c \ud2b8\ub798\ud53d\uc744 \uac00\ub85c\ucc44\uc11c(Interception) \ucc98\ub9ac\ud569\ub2c8\ub2e4.</li> <li>\uc774\ub54c Envoy\ub294 Deployment YAML\uc5d0 \uba85\uc2dc\ub41c  <code>containerPort</code> \ubaa9\ub85d\uc744 \ubcf4\uace0 \"\uc544, \uc774 \ud3ec\ud2b8\ub85c \ub4e4\uc5b4\uc624\ub294 \ud2b8\ub798\ud53d\uc744 \uc571\uc5d0\uac8c \ub118\uaca8\uc918\uc57c \ud558\ub294\uad6c\ub098\"\ub77c\uace0 Listener(\uc218\uc2e0 \uaddc\uce59)\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</li> <li>\uc124\uc815\uc774 \ub204\ub77d\ub418\uba74:<ul> <li>K8s Service\ub294 Pod IP\ub97c \ucc3e\uc544\uc11c Endpoints\ub97c \uc5f0\uacb0\ud574 \uc90d\ub2c8\ub2e4. (\uadf8\ub798\uc11c <code>get endpoints</code>\uc5d0\ub294 \ub098\uc634)</li> <li>\ud558\uc9c0\ub9cc \ud2b8\ub798\ud53d\uc774 Pod \ub0b4\ubd80\uc758 Envoy\uc5d0 \ub3c4\ucc29\ud588\uc744 \ub54c, Envoy\uac00 \ud574\ub2f9 \ud3ec\ud2b8\ub97c \ucc98\ub9ac\ud560 \uaddc\uce59\uc774 \uc5c6\uc5b4\uc11c \ud2b8\ub798\ud53d\uc744 \ucc28\ub2e8(Refuse)\ud569\ub2c8\ub2e4.</li> </ul> </li> </ol>"},{"location":"k8s/gateway-api/missed-containerport/#4-solution","title":"4. \ud574\uacb0 \ubc29\ubc95 (Solution)","text":"<p>Deployment Manifest(YAML)\uc5d0 <code>containerPort</code>\ub97c \uba85\uc2dc\uc801\uc73c\ub85c \ucd94\uac00\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <p>\u274c \uc218\uc815 \uc804 (AS-IS): \ud3ec\ud2b8 \uc815\ubcf4 \uc5c6\uc74c</p> <pre><code>spec:\n  containers:\n  - name: my-app\n    image: my-image:v1\n    # ports \uc139\uc158 \ub204\ub77d\ub428\n</code></pre> <p>\u2705 \uc218\uc815 \ud6c4 (TO-BE): \ud3ec\ud2b8 \uc815\ubcf4 \ucd94\uac00</p> <pre><code>spec:\n  containers:\n  - name: my-app\n    image: my-image:v1\n    ports:              # &lt;--- \ubc18\ub4dc\uc2dc \ucd94\uac00\n    - containerPort: 8080\n      protocol: TCP\n      name: http        # (\uc120\ud0dd\uc0ac\ud56d)\n</code></pre>"},{"location":"k8s/gateway-api/missed-containerport/#5-takeaway","title":"5. \uacb0\ub860 \ubc0f \uad50\ud6c8 (Takeaway)","text":"<p>\"Service Mesh(Envoy) \ud658\uacbd\uc5d0\uc11c\ub294 Endpoints\uac00 \ubcf4\uc778\ub2e4\uace0 \uc548\uc2ec\ud558\uc9c0 \ub9d0 \uac83.\"</p> <ul> <li><code>kubectl get endpoints</code>\ub294 K8s \ucee8\ud2b8\ub864\ub7ec\uac00 \"IP\ub97c \ucc3e\uc558\ub2e4\"\ub294 \ub73b\uc77c \ubfd0, \"\ud1b5\uc2e0\uc774 \ub41c\ub2e4\"\ub294 \ubcf4\uc7a5\uc740 \uc544\ub2d9\ub2c8\ub2e4.</li> <li>\uc0ac\uc774\ub4dc\uce74 \ud328\ud134\uc744 \uc0ac\uc6a9\ud560 \ub54c\ub294 \ubc18\ub4dc\uc2dc \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc774 \uc0ac\uc6a9\ud558\ub294 \ud3ec\ud2b8\ub97c YAML\uc5d0 \uba85\uc2dc\ud574\uc57c Envoy\uac00 \uae38\uc744 \uc5f4\uc5b4\uc90d\ub2c8\ub2e4.</li> </ul>"},{"location":"k8s/offline-install/001-ready-k8s-air-gapped-install/","title":"1. Kubernetes &amp; MariaDB \ud3d0\uc1c4\ub9dd \uc124\uce58\uc6a9 \ud30c\uc77c \ub9cc\ub4e4\uae30","text":"<ul> <li>\uc774 \ubb38\uc11c\ub294 Rocky 9.6 \ubc84\uc804\uc744 \uae30\uc900\uc73c\ub85c \ub9cc\ub4e4\uc5b4\uc84c\uc2b5\ub2c8\ub2e4.</li> <li>\uc0ac\uc6a9\ud558\uace0\uc790 \ud558\ub294 \ud658\uacbd\uacfc \ub3d9\uc77c\ud55c \uc11c\ubc84\uc5d0\uc11c \uc791\uc5c5\ud574\uc57c \ud569\ub2c8\ub2e4.</li> <li>K8s, MariaDB \uc678\uc5d0\ub3c4 Harbor \ub4f1\uc758 \uc124\uce58 \ud30c\uc77c\ub3c4 \uc0dd\uc131\ud558\ub2c8 \ud655\uc778\ud558\uace0 \ud544\uc694\ud55c \uc11c\ube44\uc2a4\ub9cc \ubc1b\uc544\uc57c \ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"k8s/offline-install/001-ready-k8s-air-gapped-install/#1","title":"\ud83d\udccc 1\ub2e8\uacc4: \uc791\uc5c5 \ud658\uacbd \uc900\ube44 (\uc678\ubd80\ub9dd \uc11c\ubc84)","text":"<p>\uac00\uc838\uac08 \ud30c\uc77c\ub4e4\uc744 \ubaa8\uc744 \ub514\ub809\ud1a0\ub9ac\ub97c \ub9cc\ub4ed\ub2c8\ub2e4.</p> <pre><code># \uc791\uc5c5 \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131\nmkdir -p ~/offline-dist-split\nBASE_DIR=~/offline-dist-split\nmkdir -p $BASE_DIR/{common,db,k8s}\nmkdir -p $BASE_DIR/k8s/{rpms,images,charts,binaries,utils}\nmkdir -p $BASE_DIR/db/rpms\nmkdir -p $BASE_DIR/common/rpms\n\n# \uc678\ubd80\ub9dd \uc11c\ubc84 \uc790\uccb4\ub97c \uc704\ud55c \ub3c4\uad6c \uc124\uce58 (\uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc\uc6a9)\nsudo dnf install -y yum-utils device-mapper-persistent-data lvm2\n</code></pre> <pre><code># 1. Docker \uc124\uce58 (\uc778\ud130\ub137\uc5d0\uc11c \ubc14\ub85c \uc124\uce58)\nsudo dnf install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# 2. Docker \uc2e4\ud589 \ubc0f \uc790\ub3d9 \uc2dc\uc791 \uc124\uc815\nsudo systemctl enable --now docker\n\n# 3. \uad8c\ud55c \uc124\uc815 (sudo \uc5c6\uc774 docker \uba85\ub839\uc5b4 \uc4f0\uae30 \uc704\ud568)\nsudo usermod -aG docker $USER\n\n# 4. \uadf8\ub8f9 \uad8c\ud55c \uc989\uc2dc \uc801\uc6a9 (\ub85c\uadf8\uc544\uc6c3 \uc548 \ud574\ub3c4 \ub428)\nnewgrp docker\n\n# 5. \ud655\uc778 (\uc798 \ub418\uba74 \ubc84\uc804 \uc815\ubcf4\uac00 \ub739\ub2c8\ub2e4)\ndocker version\n</code></pre>"},{"location":"k8s/offline-install/001-ready-k8s-air-gapped-install/#2","title":"\ud83d\udccc 2\ub2e8\uacc4: \ub808\ud3ec\uc9c0\ud1a0\ub9ac \ub4f1\ub85d (\uc18c\uc2a4 \ud655\ubcf4)","text":"<p>Rocky 9.6 \uae30\ubcf8 \ub808\ud3ec\uc9c0\ud1a0\ub9ac \uc678\uc5d0 \uc6b0\ub9ac\uac00 \ud544\uc694\ud55c Docker, K8s, MariaDB \uacf5\uc2dd \uc800\uc7a5\uc18c\ub97c \ub4f1\ub85d\ud569\ub2c8\ub2e4.</p> <pre><code># Docker Repo (K8s \ub178\ub4dc\uc5d0 \uae54 'containerd.io' \ud655\ubcf4\ub97c \uc704\ud574 \ud544\uc218!)\nsudo dnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n\n# Kubernetes v1.30 Repo\ncat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https://pkgs.k8s.io/core:/stable:/v1.30/rpm/\nenabled=1\ngpgcheck=1\ngpgkey=https://pkgs.k8s.io/core:/stable:/v1.30/rpm/repodata/repomd.xml.key\nEOF\n\n# MariaDB 10.11 Repo (\uc2dc\ub9ac\uc988 \uc804\uccb4 \uc9c0\uc815)\ncat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/mariadb.repo\n[mariadb]\nname = MariaDB\nbaseurl = https://rpm.mariadb.org/10.11/rhel/\\$releasever/\\$basearch\ngpgkey=https://rpm.mariadb.org/RPM-GPG-KEY-MariaDB\ngpgcheck=1\nEOF\n\n# \ub808\ud3ec\uc9c0\ud1a0\ub9ac \uc815\ubcf4 \uac31\uc2e0\nsudo dnf makecache\n</code></pre>"},{"location":"k8s/offline-install/001-ready-k8s-air-gapped-install/#3-rpm","title":"\ud83d\udccc 3\ub2e8\uacc4: RPM \ud328\ud0a4\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc (\ud575\uc2ec)","text":"<p><code>--resolve --alldeps</code> \uc635\uc158\uc73c\ub85c \uc758\uc874\uc131 \ub77c\uc774\ube0c\ub7ec\ub9ac\uae4c\uc9c0 \uc2f9 \uae01\uc5b4\uc635\ub2c8\ub2e4. \uc5ec\uae30\uac00 \uc81c\uc77c \uc911\uc694\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \uc2dc\uc2a4\ud15c \uae30\ubcf8 \ub3c4\uad6c \ubc0f HA(\uace0\uac00\uc6a9\uc131) \ub3c4\uad6c\n# createrepo_c: \ud3d0\uc1c4\ub9dd \ub0b4\ubd80\uc5d0\uc11c repo \ub9cc\ub4e4 \ub54c \ud544\uc218! (\uc808\ub300 \ub204\ub77d \uae08\uc9c0)\n# haproxy, keepalived: Master/DB 3\uc911\ud654 \ud544\uc218\ndnf download --resolve --alldeps --arch=x86_64 --destdir=./common/rpms \\\n    vim net-tools telnet wget curl git jq tar unzip \\\n    conntrack-tools socat ipvsadm ipset \\\n    keepalived haproxy \\\n    chrony \\\n    createrepo_c\n</code></pre> <p><code>--arch</code> \uc635\uc158\uc5d0 \uc124\uce58 \ud658\uacbd\uc5d0 \ub9de\ub294 CPU \ud0c0\uc785\uc744 \uc785\ub825\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># 2. Container Runtime (K8s\uc6a9)\n# Docker \uc804\uccb4\uac00 \uc544\ub2c8\ub77c 'containerd.io'\uac00 \ud575\uc2ec\uc785\ub2c8\ub2e4.\n# \ub2e4\ub9cc, \ub098\uc911\uc5d0 \ub514\ubc84\uae45\uc6a9\uc73c\ub85c CLI \ub3c4\uad6c\uac00 \uc788\uc73c\uba74 \ud3b8\ud558\ubbc0\ub85c docker-ce-cli\ub3c4 \uac19\uc774 \ubc1b\uc2b5\ub2c8\ub2e4.\ndnf download --resolve --alldeps --arch=x86_64 --destdir=./k8s/rpms \\\n    containerd.io docker-ce-cli\n</code></pre> <pre><code># 3. Kubernetes (v1.30.x)\ndnf download --resolve --alldeps --arch=x86_64 --destdir=./k8s/rpms \\\n    kubelet-1.30.* kubeadm-1.30.* kubectl-1.30.* \\\n    containerd.io docker-ce-cli\n</code></pre> <pre><code># 4. MariaDB 10.11 &amp; Galera Cluster\n# \uc704\uc5d0\uc11c 10.11 repo\ub97c \ub4f1\ub85d\ud588\uc73c\ubbc0\ub85c, \uc774 \uba85\ub839\uc5b4\uac00 10.11.14 \ubc84\uc804\uc744 \ubc1b\uc544\uc635\ub2c8\ub2e4.\ndnf download --resolve --alldeps --arch=x86_64 --destdir=./db/rpms \\\n    MariaDB-server-10.11.14 \\\n    MariaDB-client-10.11.14 \\\n    MariaDB-common-10.11.14 \\\n    MariaDB-shared-10.11.14 \\\n    MariaDB-backup-10.11.14 \\\n    galera-4 rsync\n</code></pre>"},{"location":"k8s/offline-install/001-ready-k8s-air-gapped-install/#4","title":"\ud83d\udccc 4\ub2e8\uacc4: \ubc14\uc774\ub108\ub9ac \ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc","text":"<p>RPM\uc73c\ub85c \uc124\uce58 \uc548 \ub418\ub294 \uc2e4\ud589 \ud30c\uc77c\ub4e4\uc785\ub2c8\ub2e4.</p> <pre><code># Helm v3 (K8s\uc5d0 Harbor \ubc30\ud3ec \uc2dc \ud544\uc218)\nwget https://get.helm.sh/helm-v3.14.0-linux-amd64.tar.gz -P ./k8s/binaries/\n\n# cri-dockerd (containerd\ub9cc \uc4f4\ub2e4\uba74 \ud544\uc694 \uc5c6\uc9c0\ub9cc, \ube44\uc0c1\uc6a9\uc73c\ub85c \ubc1b\uc544\ub460)\nwget https://github.com/Mirantis/cri-dockerd/releases/download/v0.3.10/cri-dockerd-0.3.10.amd64.tgz -P ./k8s/binaries/\n\n# Calico YAML \ub2e4\uc6b4\ub85c\ub4dc\ncurl -O https://raw.githubusercontent.com/projectcalico/calico/v3.27.0/manifests/calico.yaml\n\n# Ingress nginx \ub2e4\uc6b4\ub85c\ub4dc\nwget https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.10.0/deploy/static/provider/baremetal/deploy.yaml -O ingress-nginx.yaml\n\n# Local path storage \ub2e4\uc6b4\ub85c\ub4dc\nwget https://raw.githubusercontent.com/rancher/local-path-provisioner/master/deploy/local-path-storage.yaml -O local-path-storage.yaml\n\n# Yaml file \uc774\ub3d9\nmv calico.yaml ingress-nginx.yaml local-path-storage.yaml ./k8s/utils/\n</code></pre> <p>Helm\uc744 \uc124\uce58\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \ubc29\uae08 \ubc1b\uc740 Helm \uc555\ucd95 \ud30c\uc77c \ud480\uae30\ntar -zxvf ./k8s/binaries/helm-v3.14.0-linux-amd64.tar.gz\nsudo mv linux-amd64/helm /usr/local/bin/helm\nrm -rf linux-amd64\n\n# 2. \uc798 \uc124\uce58\ub410\ub294\uc9c0 \ud655\uc778\nhelm version\n\n# 3. Harbor Helm Chart \ub2e4\uc6b4\ub85c\ub4dc\n# Helm \ub808\ud3ec \ucd94\uac00\nhelm repo add harbor https://helm.goharbor.io\nhelm repo update\nhelm pull harbor/harbor --destination ./k8s/charts/\n</code></pre>"},{"location":"k8s/offline-install/001-ready-k8s-air-gapped-install/#5","title":"\ud83d\udccc 5\ub2e8\uacc4: \ucee8\ud14c\uc774\ub108 \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc (\uc2a4\ud06c\ub9bd\ud2b8 \uc2e4\ud589)","text":"<p>K8s\uc640 \ub124\ud2b8\uc6cc\ud06c \ud50c\ub7ec\uadf8\uc778(Calico) \uc774\ubbf8\uc9c0\ub97c \ubc1b\uc544 <code>.tar</code>\ub85c \uc800\uc7a5\ud569\ub2c8\ub2e4. \uc544\ub798 \uba85\ub839\uc5b4\ub97c \ud55c \ubc88\uc5d0 \uc2e4\ud589\uc2dc\ucf1c\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># \uc774\ubbf8\uc9c0 \ub9ac\uc2a4\ud2b8 \uc815\uc758\nK8S_IMAGES=(\n    \"registry.k8s.io/kube-apiserver:v1.30.0\"\n    \"registry.k8s.io/kube-controller-manager:v1.30.0\"\n    \"registry.k8s.io/kube-scheduler:v1.30.0\"\n    \"registry.k8s.io/kube-proxy:v1.30.0\"\n    \"registry.k8s.io/pause:3.9\"\n    \"registry.k8s.io/etcd:3.5.15-0\"\n    \"registry.k8s.io/coredns/coredns:v1.11.3\"\n)\nCALICO_IMAGES=(\n    \"docker.io/calico/cni:v3.27.0\"\n    \"docker.io/calico/node:v3.27.0\"\n    \"docker.io/calico/kube-controllers:v3.27.0\"\n)\nHARBOR_IMAGES=(\n    \"goharbor/harbor-core:v2.10.0\"\n    \"goharbor/harbor-db:v2.10.0\"\n    \"goharbor/harbor-jobservice:v2.10.0\"\n    \"goharbor/harbor-portal:v2.10.0\"\n    \"goharbor/harbor-registryctl:v2.10.0\"\n    \"goharbor/registry-photon:v2.10.0\"\n    \"goharbor/harbor-exporter:v2.10.0\"\n    \"goharbor/redis-photon:v2.10.0\"\n    \"goharbor/trivy-adapter-photon:v2.10.0\"\n)\nADDON_IMAGES=(\n    \"registry.k8s.io/ingress-nginx/controller:v1.10.0\"\n    \"registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.4.0\"\n    \"rancher/local-path-provisioner:v0.0.26\"\n    \"busybox:latest\"\n)\n\nALL_IMAGES=(\"${K8S_IMAGES[@]}\" \"${CALICO_IMAGES[@]}\" \"${HARBOR_IMAGES[@]}\" \"${ADDON_IMAGES[@]}\")\n\n# \uc800\uc7a5 \ub8e8\ud504\nfor img in \"${ALL_IMAGES[@]}\"; do\n    echo \"Processing $img ...\"\n    docker pull $img\n    filename=$(echo $img | sed 's/\\//_/g' | sed 's/:/_/g').tar\n    docker save $img -o ./k8s/images/$filename\ndone\n</code></pre>"},{"location":"k8s/offline-install/001-ready-k8s-air-gapped-install/#6","title":"\ud83d\udccc 6\ub2e8\uacc4: \ucd5c\uc885 \ud3ec\uc7a5 (\uc555\ucd95)","text":"<p>\uc774\uc81c \ubaa8\ub4e0 \ud30c\uc77c\uc774 <code>~/offline-dist</code>\uc5d0 \ubaa8\uc600\uc2b5\ub2c8\ub2e4. \uc774\uac78 \ud558\ub098\ub85c \ubb36\uc5b4\uc11c USB\ub098 \ub9dd\uc5f0\uacc4 \uc194\ub8e8\uc158\uc744 \ud1b5\ud574 \ub118\uae30\uc2dc\uba74 \ub429\ub2c8\ub2e4.</p> <pre><code>cd ~\n\n# 1. DB \ub178\ub4dc\uc6a9 \ubc88\ub4e4 (Common + DB) -&gt; \uc6a9\ub7c9 \ub9e4\uc6b0 \uc791\uc74c (\uc218\ubc31 MB)\n# DB \ub178\ub4dc\uc5d0\ub294 \uc774\uac83\ub9cc \uac00\uc838\uac00\uba74 \ub429\ub2c8\ub2e4.\ntar -zcvf dist-for-db-nodes.tar.gz offline-dist-split/common offline-dist-split/db\n\n# 2. K8s \ub178\ub4dc\uc6a9 \ubc88\ub4e4 (Common + K8s + Images) -&gt; \uc6a9\ub7c9 \ud07c (\uc218 GB)\n# K8s Master/Worker \ub178\ub4dc\uc5d0\ub294 \uc774\uac83\ub9cc \uac00\uc838\uac00\uba74 \ub429\ub2c8\ub2e4.\ntar -zcvf dist-for-k8s-nodes.tar.gz offline-dist-split/common offline-dist-split/k8s\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/","title":"2. \ud3d0\uc1c4\ub9dd\uc5d0\uc11c Kubernetes\uc640 Helm \uc124\uce58","text":"<ul> <li>\uac00\uc774\ub4dc \ud658\uacbd</li> <li>OS: Rocky 9.6</li> <li>kubelet: 1.30.14</li> <li>\ud3d0\uc1c4\ub9dd\uc6a9 K8s \uc124\uce58 \ud30c\uc77c\uc774 \uc900\ube44\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> <li>\uc124\uce58 \ud30c\uc77c \uc704\uce58</li> </ul> <p>\ub9cc\uc57d \ud3d0\uc1c4\ub9dd\uc6a9 \ud658\uacbd\uc744 \ub9cc\ub4e0\ub2e4\uba74, \uac01 \ub178\ub4dc\ub4e4\uac04\uc758 \ud1b5\uc2e0\uacfc <code>169.254.169.254/32</code> 80\ud3ec\ud2b8\uc758 \uc544\uc6c3\ubc14\uc6b4\ub4dc \uaddc\uce59\uc740 \ud5c8\uc6a9\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4. <code>169.254.169.254/32</code> \ub294 cloud-init\uc774 \uba54\ud0c0\ub370\uc774\ud130\ub97c \ubc1b\uc544\uc624\ub294 ip\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#phase-0-master-workers","title":"\ud83d\udce6 Phase 0: \ud30c\uc77c \ubc30\ud3ec (Master -&gt; Workers)","text":"<p>\ud604\uc7ac \ub9c8\uc2a4\ud130 \ub178\ub4dc(<code>Master</code>)\uc5d0 <code>k8s-1.30.tar.gz</code> \ud30c\uc77c\uc774 \uc788\ub2e4\uace0 \uac00\uc815\ud569\ub2c8\ub2e4. \uc124\uce58\ub97c \uc704\ud574 \uc6cc\ucee4 \ub178\ub4dc 3\ub300\uc5d0\ub3c4 \uc774 \ud30c\uc77c\uc774 \ub611\uac19\uc774 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: K8s-Master-Node]</p> <pre><code># \uc6cc\ucee4 \ub178\ub4dc IP \ub9ac\uc2a4\ud2b8 (\ud658\uacbd\uc5d0 \ub9de\uac8c \uc218\uc815\ud558\uc138\uc694)\nWORKER_IPS=(\"10.10.10.73\" \"10.10.10.74\" \"10.10.10.75\")\n\n# \ubc18\ubcf5\ubb38\uc73c\ub85c \ud30c\uc77c \uc804\uc1a1\nfor IP in \"${WORKER_IPS[@]}\"; do\n    echo \"Sending file to $IP...\"\n    scp ~/k8s-1.30.tar.gz rocky@$IP:~/\ndone\n</code></pre> <p>Note: \uc804\uc1a1\uc774 \ub05d\ub098\uba74, **\ubaa8\ub4e0 \ub178\ub4dc(Master 1\ub300, Worker 3\ub300)**\uc5d0\uc11c \uc555\ucd95\uc744 \ud480\uc5b4\uc8fc\uc138\uc694.</p> <pre><code>tar -zxvf ~/k8s-1.30.tar.gz\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#phase-1-os","title":"\ud83d\ude80 Phase 1: \ub85c\uceec \ud328\ud0a4\uc9c0 \uc124\uce58 &amp; OS \uc124\uc815 (\uc804\uccb4 \ub178\ub4dc)","text":"<p>[\uc2e4\ud589 \uc704\uce58: Master 1, Worker 1~3 \uc804\uccb4]</p> <p>Repo \uc124\uc815(<code>yum.repos.d</code>)\uc744 \uac74\ub4dc\ub9ac\uc9c0 \uc54a\uace0, <code>dnf</code> \uba85\ub839\uc5b4\ub85c \ub2e4\uc6b4\ubc1b\uc740 RPM \ud30c\uc77c\ub4e4\uc744 \uc9c1\uc811 \uc124\uce58\ud569\ub2c8\ub2e4.</p>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#1-rpm-local-install","title":"1. RPM \ud30c\uc77c \uc124\uce58 (Local Install)","text":"<pre><code># \uc555\ucd95 \ud47c \ub514\ub809\ud1a0\ub9ac\ub85c \uc774\ub3d9\ncd ~/k8s-1.30\n\n# 1. \uae30\uc874 Repo \ube44\ud65c\uc131\ud654 \ud6c4 \ub85c\uceec RPM \uc77c\uad04 \uc124\uce58\n# -Uvh: Upgrade (\uc124\uce58 \ub610\ub294 \uc5c5\uadf8\ub808\uc774\ub4dc) + Verbose (\uc0c1\uc138\ud45c\uc2dc) + Hash (\uc9c4\ud589\ubc14)\n# --force: \uc774\ubbf8 \uc124\uce58\ub41c \ud328\ud0a4\uc9c0\ub77c\ub3c4 \uac15\uc81c\ub85c \ub36e\uc5b4\uc4f0\uae30\n# --nodeps: \uc21c\ud658 \uc758\uc874\uc131 \uc624\ub958 \ubb34\uc2dc (\uc77c\ub2e8 \ub2e4 \uc124\uce58\ud574\ub77c)\nsudo rpm -Uvh --force --nodeps common/rpms/*.rpm k8s/rpms/*.rpm\n\n# 2. \uc124\uce58 \ud655\uc778\nrpm -qa | grep -E \"kubelet|containerd|haproxy\"\n# \uacb0\uacfc\uc5d0 \ud328\ud0a4\uc9c0 \uc774\ub984\ub4e4\uc774 \ub728\uba74 \uc131\uacf5\uc785\ub2c8\ub2e4.\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#2-os","title":"2. \ud544\uc218 OS \uc124\uc815 (\ub9e4\uc6b0 \uc911\uc694)","text":"<pre><code># 1. Swap \ube44\ud65c\uc131\ud654\nsudo swapoff -a\nsudo sed -i '/swap/d' /etc/fstab\n\n# 2. SELinux Permissive \ubaa8\ub4dc\nsudo setenforce 0\nsudo sed -i 's/^SELINUX=enforcing$/SELINUX=permissive/' /etc/selinux/config\n\n# 3. \ucee4\ub110 \ubaa8\ub4c8 \ub85c\ub4dc\ncat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf\noverlay\nbr_netfilter\nEOF\nsudo modprobe overlay\nsudo modprobe br_netfilter\n\n# 4. \ucee4\ub110 \ud30c\ub77c\ubbf8\ud130 \uc801\uc6a9\ncat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf\nnet.bridge.bridge-nf-call-iptables  = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.ipv4.ip_forward                 = 1\nEOF\nsudo sysctl --system\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#3-containerd","title":"3. Containerd \uc124\uc815 \ubc0f \uc2e4\ud589","text":"<pre><code># 1. \uae30\ubcf8 \uc124\uc815 \uc0dd\uc131\nsudo mkdir -p /etc/containerd\ncontainerd config default | sudo tee /etc/containerd/config.toml &gt; /dev/null\n\n# 2. SystemdCgroup \ud65c\uc131\ud654 (\ud544\uc218!)\nsudo sed -i 's/SystemdCgroup = false/SystemdCgroup = true/' /etc/containerd/config.toml\n\n# 3. pause \ubc84\uc804 \ubcc0\uacbd(\uc774\uc804 \uc124\uce58 \ud30c\uc77c\uc5d0\uc11c 3.9 \ubc84\uc804\uc73c\ub85c \uc900\ube44)\nsudo sed -i 's/pause:3.10.1/pause:3.9/g' /etc/containerd/config.toml\n\n# 4. harbor \uc124\uc815\uc744 \uc704\ud55c \uc635\uc158\uac12 \uc218\uc815\nsudo sed -i \"s|config_path = '/etc/containerd/certs.d:/etc/docker/certs.d'|config_path = '/etc/containerd/certs.d'|g\" /etc/containerd/config.toml \n\n# 5. \uc11c\ube44\uc2a4 \uc2dc\uc791\nsudo systemctl enable --now containerd\nsudo systemctl enable --now kubelet\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#kubernete","title":"Kubernete\uac00 \uc7a0\uae50 \ub3d9\uc791\ud558\ub2e4\uac00 \uc624\ub958\uac00 \ub098\ub294 \uacbd\uc6b0","text":"<p>\uc544\ub798 \uba85\ub839\uc5b4\ub85c <code>SystemdCgroup = true</code> \uac00 \ucd9c\ub825\ub418\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>cat /etc/containerd/config.toml | grep SystemdCgroup\n</code></pre> <p>\ub9cc\uc57d \uc5c6\ub2e4\uba74 \uc9c1\uc811 \ucd94\uac00\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>          [plugins.'io.containerd.cri.v1.runtime'.containerd.runtimes.runc.options]\n            BinaryName = ''\n            CriuImagePath = ''\n            CriuWorkPath = ''\n            IoGid = 0\n            IoUid = 0\n            NoNewKeyring = false\n            Root = ''\n            ShimCgroup = ''\n            SystemdCgroup = true # \uc5ec\uae30 \ucd94\uac00!\n</code></pre> <p>\ucd94\uac00\ud55c \ud6c4, <code>containerd</code> \uc640 <code>kubelet</code> \uc744 \uc7ac\uc2dc\uc791 \ud569\ub2c8\ub2e4.</p> <pre><code>sudo systemctl restart containerd\nsudo systemctl restart kubelet\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#_1","title":"\ucee8\ud14c\uc774\ub108 \uc774\ubbf8\uc9c0 \uc800\uc7a5 \uc704\uce58 \ubcc0\uacbd \uc2dc","text":"<p>\ub9cc\uc57d \ucee8\ud14c\uc774\ub108 \uc774\ubbf8\uc9c0\ub3c4 <code>/app</code> \ud3f4\ub354 \uc548\uc73c\ub85c \uc774\ub3d9\ud574\uc57c \ud55c\ub2e4\uba74 \ud30c\uc77c \ub9c1\ud06c\ub97c \uac78\uc5b4\uc90d\ub2c8\ub2e4.</p> <pre><code># \ub9cc\uc57d \uc2e4\ud589 \uc911\uc774\ub77c\uba74\n# \uc2e4\ud589 \uc911\uc778 \ucee8\ud14c\uc774\ub108 \ub7f0\ud0c0\uc784 \uc911\uc9c0\nsudo systemctl stop containerd\nsudo systemctl stop kubelet\n</code></pre> <pre><code># 1. \uc2e4\uc81c \ub370\uc774\ud130\ub97c \uc800\uc7a5\ud560 \ud3f4\ub354 \uc0dd\uc131\nsudo mkdir -p /app/containerd_data\n\n# 2. (\ub9cc\uc57d \uc774\ubbf8 \ub370\uc774\ud130\uac00 \uc788\uc5c8\ub2e4\uba74) \uae30\uc874 \ub370\uc774\ud130 \uc774\ub3d9\n# \ucc98\uc74c \uc124\uce58\ub77c\uba74 \uc0dd\ub7b5 \uac00\ub2a5\ud558\uc9c0\ub9cc, \uc548\uc804\uc744 \uc704\ud574 \ud655\uc778\nif [ -d \"/var/lib/containerd\" ]; then\n    sudo mv /var/lib/containerd/* /app/containerd_data/\n    sudo rmdir /var/lib/containerd\nfi\n\n# 3. \ub9c1\ud06c \uc0dd\uc131: /var/lib/containerd -&gt; /app/containerd_data\nsudo ln -s /app/containerd_data /var/lib/containerd\n\n# 4. \ud655\uc778 (\ud654\uc0b4\ud45c\uac00 \ubcf4\uc5ec\uc57c \ud568)\nls -ld /var/lib/containerd\n# \uacb0\uacfc \uc608\uc2dc: lrwxrwxrwx ... /var/lib/containerd -&gt; /app/containerd_data\n</code></pre> <pre><code># \uc11c\ube44\uc2a4 \uc7ac\uc2dc\uc791\nsudo systemctl start containerd\nsudo systemctl start kubelet\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#4-hosts","title":"4. hosts \ud30c\uc77c \uc124\uc815","text":"<pre><code>sudo vi /etc/hosts\n\n&lt;master node ip&gt; &lt;master node hostname&gt;\n&lt;worker1 node ip&gt; &lt;worker1 node hostname&gt;\n&lt;worker2 node ip&gt; &lt;worker2 node hostname&gt;\n&lt;worker3 node ip&gt; &lt;worker3 node hostname&gt;\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#phase-2","title":"\ud83d\ude80 Phase 2: \uc774\ubbf8\uc9c0 \ub85c\ub4dc (\uc804\uccb4 \ub178\ub4dc)","text":"<p>Repo\uac00 \uc5c6\uc73c\ub2c8 <code>docker pull</code>\uc740 \ubd88\uac00\ub2a5\ud569\ub2c8\ub2e4. \uac00\uc838\uc628 <code>.tar</code> \ud30c\uc77c\uc744 <code>containerd</code>\uc5d0 \uc9c1\uc811 \uc9d1\uc5b4\ub123\uc2b5\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: Master 1, Worker 1\\~3 \uc804\uccb4]</p> <pre><code># \uc774\ubbf8\uc9c0 \ud3f4\ub354\ub85c \uc774\ub3d9\ncd ~/k8s-1.30/k8s/images\n\n# \ubc18\ubcf5\ubb38\uc73c\ub85c \ub85c\ub4dc (\uc2dc\uac04 \uc18c\uc694\ub428)\n# k8s.io \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \uc774\ubbf8\uc9c0\ub97c \ub4f1\ub85d\ud569\ub2c8\ub2e4.\nfor img in *.tar; do\n    echo \"Loading $img...\"\n    sudo ctr -n k8s.io images import \"$img\"\ndone\n\n# \ud655\uc778\nsudo ctr -n k8s.io images list | grep kube-apiserver\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#phase-3-lb-master-1-phase-4","title":"\ud83d\ude80 Phase 3: \ub85c\ub4dc\ubc38\ub7f0\uc11c(LB) \uad6c\uc131 (Master\uac00 1\ub300\ub77c\uba74 Phase 4\ub85c \ub118\uc5b4\uac11\ub2c8\ub2e4)","text":"<p>Master 1\ub300\uba74 Phasre 4\ub85c \ub118\uc5b4\uac00\uc2dc\uba74 \ub429\ub2c8\ub2e4.</p> <p>Master \ub178\ub4dc 3\ub300(<code>10.10.10.70</code>, <code>71</code>, <code>72</code>)\uc640 \uac00\uc0c1 IP(VIP, <code>10.10.10.200</code>) \ub97c \ud658\uacbd\uc744 \uac00\uc815\ud588\uc2b5\ub2c8\ub2e4.</p> <p>\ud604\uc7ac K8s-Master-Node-1\uc5d0\uc11c \uc774 \uc791\uc5c5\uc744 \uc218\ud589\ud558\uc2dc\uba74 \ub429\ub2c8\ub2e4.</p> <p>\uc774 \uc124\uc815\uc740 K8s API Server(6443 \ud3ec\ud2b8) \uc55e\ub2e8\uc5d0 VIP\ub97c \ub450\uc5b4, \ub9c8\uc2a4\ud130 \ub178\ub4dc\uac00 \uc8fd\uc5b4\ub3c4 API \ud1b5\uc2e0\uc774 \ub04a\uae30\uc9c0 \uc54a\uac8c \ud569\ub2c8\ub2e4.</p>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#1","title":"1. \uc0ac\uc804 \ucee4\ub110 \uc124\uc815 (\ud544\uc218)","text":"<p>\uac00\uc0c1 IP(VIP)\uac00 \ub0b4 \uc778\ud130\ud398\uc774\uc2a4\uc5d0 \uc5c6\uc5b4\ub3c4 \ubc14\uc778\ub529\ud560 \uc218 \uc788\ub3c4\ub85d \ucee4\ub110 \ud30c\ub77c\ubbf8\ud130\ub97c \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4. \uc774 \uc791\uc5c5\uc744 \uc218\ud589\ud558\uc9c0 \uc54a\uc73c\uba74 HAProxy\uac00 \uc2dc\uc791 \uc2e4\ud328\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code>cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/haproxy.conf\nnet.ipv4.ip_nonlocal_bind = 1\nEOF\n\nsudo sysctl --system\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#2-haproxy-load-balancer","title":"2. HAProxy \uc124\uc815 (Load Balancer)","text":"<p>\uc2e4\uc81c \ub9c8\uc2a4\ud130 \ub178\ub4dc 3\ub300\ub85c \ud2b8\ub798\ud53d\uc744 \ubd84\uc0b0\uc2dc\ud0a4\ub294 \uc124\uc815\uc785\ub2c8\ub2e4.</p> <ul> <li>\ud30c\uc77c: <code>/etc/haproxy/haproxy.cfg</code></li> <li>\uc218\uc815: \uae30\uc874 \ub0b4\uc6a9\uc744 \ubc31\uc5c5\ud558\uace0 \uc544\ub798 \ub0b4\uc6a9\uc73c\ub85c \ub36e\uc5b4\uc4f0\uc138\uc694.</li> <li>\uc8fc\uc758: <code>server</code> \uc139\uc158\uc758 IP\ub4e4\uc740 \uc0ac\uc6a9\uc790 \ud658\uacbd\uc758 \uc2e4\uc81c \ub9c8\uc2a4\ud130 IP\ub85c \ub9de\ucdb0\uc8fc\uc138\uc694.</li> </ul> <pre><code># \uae30\uc874 \ud30c\uc77c \ubc31\uc5c5\nsudo cp /etc/haproxy/haproxy.cfg /etc/haproxy/haproxy.cfg.bak\n\n# \uc124\uc815 \ud30c\uc77c \uc791\uc131\ncat &lt;&lt;EOF | sudo tee /etc/haproxy/haproxy.cfg\nglobal\n    log         127.0.0.1 local2\n    chroot      /var/lib/haproxy\n    pidfile     /var/run/haproxy.pid\n    maxconn     4000\n    user        haproxy\n    group       haproxy\n    daemon\n\ndefaults\n    mode                    tcp\n    log                     global\n    option                  tcplog\n    option                  dontlognull\n    option                  redispatch\n    retries                 3\n    timeout queue           1m\n    timeout connect         10s\n    timeout client          1m\n    timeout server          1m\n    timeout check           10s\n    maxconn                 3000\n\n# ---------------------------------------------------------------------\n# Kubernetes API Server LB\n# ---------------------------------------------------------------------\nfrontend k8s-api\n    bind *:6443\n    mode tcp\n    option tcplog\n    default_backend k8s-masters\n\nbackend k8s-masters\n    mode tcp\n    balance roundrobin\n    option tcp-check\n\n    # 3\ub300 \ub178\ub4dc \ub4f1\ub85d (\ud604\uc7ac 1\ub300\ub9cc \ucf1c\uc838 \uc788\uc5b4\ub3c4 \uc124\uc815\uc740 \ub2e4 \ub123\uc5b4\ub461\ub2c8\ub2e4)\n    server master1 10.10.10.70:6443 check fall 3 rise 2\n    server master2 10.10.10.71:6443 check fall 3 rise 2\n    server master3 10.10.10.72:6443 check fall 3 rise 2\nEOF\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#3-keepalived-vip","title":"3. Keepalived \uc124\uc815 (VIP \uad00\ub9ac)","text":"<p>VIP(<code>10.10.10.200</code>)\ub97c \ub744\uc6b0\ub294 \uc124\uc815\uc785\ub2c8\ub2e4.</p> <ul> <li>\ud30c\uc77c: <code>/etc/keepalived/keepalived.conf</code></li> <li>\ud655\uc778\ud560 \uac83: <code>interface</code> \ubd80\ubd84\uc774 <code>eth0</code>\uc778\uc9c0 <code>ens3</code>\uc778\uc9c0 <code>ip addr</code> \uba85\ub839\uc5b4\ub85c \uaf2d \ud655\uc778\ud558\uace0 \uc218\uc815\ud558\uc138\uc694!</li> </ul> <pre><code># \uc124\uc815 \ud30c\uc77c \uc791\uc131\ncat &lt;&lt;EOF | sudo tee /etc/keepalived/keepalived.conf\nglobal_defs {\n    router_id LVS_DEVEL\n}\n\nvrrp_script check_haproxy {\n    script \"/usr/bin/killall -0 haproxy\"\n    interval 3\n    weight -2\n    fall 10\n    rise 2\n}\n\nvrrp_instance VI_1 {\n    state MASTER            # Master-1\uc740 MASTER, \ub098\uba38\uc9c0\ub294 BACKUP\n    interface eth0          # &lt;--- \ubcf8\uc778 \ub124\ud2b8\uc6cc\ud06c \uc778\ud130\ud398\uc774\uc2a4\uba85\uc73c\ub85c \ubcc0\uacbd \ud544\uc218! (\uc608: ens3)\n    virtual_router_id 51\n    priority 101            # Master-1\uc740 101, \ub098\uba38\uc9c0\ub294 100\n    advert_int 1\n\n    authentication {\n        auth_type PASS\n        auth_pass 42        # \uc554\ud638\ub294 \uc544\ubb34\uac70\ub098 (\ubaa8\ub4e0 \ub178\ub4dc \ub3d9\uc77c\ud558\uac8c)\n    }\n\n    virtual_ipaddress {\n        10.10.10.200        # \uc0ac\uc6a9\ud560 VIP (\uac00\uc0c1 IP)\n    }\n\n    track_script {\n        check_haproxy\n    }\n}\nEOF\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#4","title":"4. \uc11c\ube44\uc2a4 \uc2dc\uc791 \ubc0f \uac80\uc99d","text":"<p>\uc774\uc81c \ub450 \uc11c\ube44\uc2a4\ub97c \uc2dc\uc791\ud569\ub2c8\ub2e4.</p> <pre><code># \uc11c\ube44\uc2a4 \uc2dc\uc791\nsudo systemctl enable --now haproxy\nsudo systemctl enable --now keepalived\n\n# \uc0c1\ud0dc \ud655\uc778\nsystemctl status haproxy keepalived\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#_2","title":"\u2705 \uc131\uacf5 \ud655\uc778 \ubc29\ubc95 (\ub9e4\uc6b0 \uc911\uc694)","text":"<p>VIP\uac00 \uc81c\ub300\ub85c \ub5b4\ub294\uc9c0 \ud655\uc778\ud574\ubd05\ub2c8\ub2e4.</p> <pre><code>ip addr show eth0  # (\ub610\ub294 \uc124\uc815\ud55c \uc778\ud130\ud398\uc774\uc2a4)\n</code></pre> <p>\ucd9c\ub825 \uacb0\uacfc\uc5d0 <code>inet 10.10.10.200/32 ... secondary</code> \ucc98\ub7fc VIP\uac00 \ubcf4\uc774\uba74 \uc131\uacf5\uc785\ub2c8\ub2e4!</p> <p>Tip: \ud604\uc7ac Master 2, 3\ubc88\uc740 \uaebc\uc838 \uc788\uac70\ub098 K8s\uac00 \uc548 \ub3cc\uace0 \uc788\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c <code>HAProxy</code> \ub85c\uadf8\ub97c \ubcf4\uba74 master2, master3\ub294 <code>DOWN</code> \uc0c1\ud0dc\ub77c\uace0 \ub098\uc62c \uac81\ub2c8\ub2e4. \uc815\uc0c1\uc774\ub2c8 \ubb34\uc2dc\ud558\uace0 Master 1\uc774 UP \uc0c1\ud0dc\uc774\uace0 VIP\uac00 \ud551\uc774 \ub418\ub294\uc9c0\ub9cc \ud655\uc778\ud558\uc138\uc694.</p> <p>3\uc911\ud654 \uc791\uc5c5\uc744 \ud588\ub2e4\uba74 \uc774\ud6c4\ubd80\ud134 \ucd08\uae30\ud654\ud560 \ub54c \uc774 \ud560\ub2f9\ud55c VIP(\uc608\uc2dc\uc5d0\uc120 10.10.10.200)\ub97c \uc368\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#phase-4-master-1-only","title":"\ud83d\ude80 Phase 4: \ub9c8\uc2a4\ud130 \ucd08\uae30\ud654 (Master-1 Only)","text":"<p>[\uc2e4\ud589 \uc704\uce58: K8s-Master-Node-1]</p> <p>\uc0c1\ud669\uc5d0 \ub9de\ub294 \uc635\uc158 \ud558\ub098\ub97c \uc120\ud0dd\ud574\uc11c \uc2e4\ud589\ud558\uc138\uc694. \uc774\ub54c <code>join</code> \uba85\ub839\uc5b4\ub97c \uaf2d \uc800\uc7a5\ud574\ub450\uc138\uc694.</p> <pre><code># 2. (\uc911\uc694) Join \uba85\ub839\uc5b4 \uc800\uc7a5\n# \ud654\uba74 \ub9e8 \uc544\ub798\uc5d0 \ucd9c\ub825\ub41c \ud1a0\ud070 \uc815\ubcf4\ub97c \ubcf5\uc0ac\ud574\uc11c \uba54\ubaa8\uc7a5\uc5d0 \uc800\uc7a5\ud574\ub450\uc138\uc694.\n# HA \uad6c\uc131(\uc635\uc158 A)\uc744 \ud588\ub2e4\uba74 \uba85\ub839\uc5b4\ub77c \ub450 \uc885\ub958\uac00 \ub098\uc635\ub2c8\ub2e4.\n# 1) Master Node Join\uc6a9 (certificate-key \ud3ec\ud568\ub428)\n# 2) Worker Node Join\uc6a9 (token, hash\ub9cc \uc788\uc74c)\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#a-ha3-vip","title":"\ud83c\udd70\ufe0f \uc635\uc158 A: [\ucd94\ucc9c] HA(3\uc911\ud654) \ud655\uc7a5 \ub300\ube44 \uad6c\uc131 (VIP \uc0ac\uc6a9)","text":"<ul> <li>\uc870\uac74: Phase 3\uc5d0\uc11c HAProxy\uc640 VIP(<code>10.10.10.200</code>) \uc124\uc815\uc744 \ub9c8\uce5c \uacbd\uc6b0.</li> <li>\uc7a5\uc810: \uc9c0\uae08\uc740 \ub9c8\uc2a4\ud130\uac00 1\ub300\uc5ec\ub3c4, \ub098\uc911\uc5d0 \uba85\ub839\uc5b4 \ud55c \uc904\ub85c \ub9c8\uc2a4\ud130 2, 3\ubc88\uc744 \ucd94\uac00\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</li> <li>\ud575\uc2ec: <code>--control-plane-endpoint</code>\uc5d0 VIP\ub97c \uc801\uace0, <code>--upload-certs</code>\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4.</li> </ul> <pre><code># 1. \ucd08\uae30\ud654 \uc2e4\ud589 (HA \ubaa8\ub4dc)\n# --upload-certs: \uc778\uc99d\uc11c\ub97c K8s Secret\uc5d0 \uc62c\ub824\uc11c \ub2e4\ub978 \ub9c8\uc2a4\ud130\uac00 \uc27d\uac8c \uc870\uc778\ud558\uac8c \ud568\n# service-cidr, pod-network-cidr, host network\uac00 \uacb9\uce58\uc9c0 \uc54a\ub3c4\ub85d \uc870\uc815 \ud544\uc694\nsudo kubeadm init \\\n  --control-plane-endpoint \"10.10.10.200:6443\" \\\n  --upload-certs \\\n  --pod-network-cidr=192.168.0.0/16 \\\n  --service-cidr=10.96.0.0/12 \\\n  --kubernetes-version v1.30.0\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#b-1-ip","title":"\ud83c\udd71\ufe0f \uc635\uc158 B: \ub2e8\uc21c 1\ub300 \uad6c\uc131 (IP \uc9c1\uc811 \uc0ac\uc6a9)","text":"<ul> <li>\uc870\uac74: \ub85c\ub4dc\ubc38\ub7f0\uc11c \uc5c6\uc774 \uadf8\ub0e5 \ud63c\uc790 \uc4f8 \uacbd\uc6b0.</li> <li>\ub2e8\uc810: \ub098\uc911\uc5d0 \ub9c8\uc2a4\ud130\ub97c \ub298\ub9ac\ub824\uba74 \uc778\uc99d\uc11c\ub97c \ub2e4\uc2dc \uc0dd\uc131\ud558\uace0 \uc124\uc815\uc744 \ub72f\uc5b4\uace0\uccd0\uc57c \ud574\uc11c \ub9e4\uc6b0 \ubcf5\uc7a1\ud569\ub2c8\ub2e4.</li> </ul> <pre><code># 1. \ucd08\uae30\ud654 \uc2e4\ud589 (\ub2e8\uc77c \ubaa8\ub4dc)\n# \uc5d4\ub4dc\ud3ec\uc778\ud2b8\uc5d0 \ubcf8\uc778 IP(10.10.10.70)\ub97c \ub123\uac70\ub098 \uc544\uc608 \uc0dd\ub7b5 \uac00\ub2a5\n# service-cidr, pod-network-cidr, host network\uac00 \uacb9\uce58\uc9c0 \uc54a\ub3c4\ub85d \uc870\uc815 \ud544\uc694\nsudo kubeadm init \\\n  --control-plane-endpoint \"10.10.10.70:6443\" \\\n  --service-cidr=10.96.0.0/12 \\\n  --pod-network-cidr=192.168.0.0/16 \\\n  --kubernetes-version v1.30.0\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#cidr","title":"CIDR\uac00 \uc798 \uc124\uc815\ub418\uc5c8\ub294\uc9c0 \ud655\uc778 \ubc29\ubc95","text":"<p><code>kube-controller-manager</code> \uc744 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>kubectl get pod -n kube-system po &lt;kube-controller-manager pod name&gt; -o yaml | grep cluster\n</code></pre> <p>\uc774\ub54c <code>--cluster-cidr</code> \uac12\uc774 \uc124\uc815\ud55c pod \ub300\uc5ed\uc73c\ub85c, <code>--service-cluster-ip-range</code> \uac00 \uc124\uc815\ud55c service \ub300\uc5ed\uc73c\ub85c \ub098\uc640\uc57c \ud569\ub2c8\ub2e4.</p> <p>calico\uc758 IP Pool\ub3c4 \ud655\uc778\ud558\uc5ec pod\uc758 ip\uc640 \ub3d9\uc77c\ud55c \ub300\uc5ed\uc73c\ub85c \uc124\uc815\ub418\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>kubectl get ippools -o yaml\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#_3","title":"\uc624\ub958 \ubc1c\uc0dd\uc73c\ub85c \uc7ac\uc124\uce58 \uc2dc","text":""},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#1-kubeadm-reset","title":"\ud83e\uddf9 1\ub2e8\uacc4: Kubeadm Reset \uc2e4\ud589 (\uac00\uc7a5 \uc911\uc694)","text":"<p>\uba3c\uc800 <code>kubeadm</code>\uc774 \uc0dd\uc131\ud55c \ub9ac\uc18c\uc2a4\ub4e4\uc744 \uacf5\uc2dd \uba85\ub839\uc5b4\ub85c \ub418\ub3cc\ub824\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># -f \uc635\uc158\uc740 \ud655\uc778 \uc9c8\ubb38 \uc5c6\uc774 \uac15\uc81c\ub85c \uc9c4\ud589\ud569\ub2c8\ub2e4.\nsudo kubeadm reset -f\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#2","title":"\ud83e\uddfd 2\ub2e8\uacc4: \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \ubc0f \uc794\uc5ec \ud30c\uc77c \uc81c\uac70 (\ud544\uc218)","text":"<p><code>reset</code> \uba85\ub839\uc5b4\uac00 \uc9c0\uc6b0\uc9c0 \uc54a\ub294 CNI \uc124\uc815\uacfc \uc0ac\uc6a9\uc790 \uc124\uc815 \ud30c\uc77c\uc744 \uc218\ub3d9\uc73c\ub85c \uc9c0\uc6cc\uc57c \uaf2c\uc774\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ud2b9\ud788 <code>--pod-network-cidr</code> \uc635\uc158\uc744 \ubc14\uafb8\uac70\ub098 \ub2e4\uc2dc \uc124\uc815\ud560 \ub54c \uc774 \uacfc\uc815\uc774 \uc5c6\uc73c\uba74 \ubb38\uc81c\uac00 \uc0dd\uae41\ub2c8\ub2e4.</p> <pre><code># CNI \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \ud30c\uc77c \uc0ad\uc81c (\uc774\uc804 \uc124\uc815\uc774 \ub0a8\uc544 \ucda9\ub3cc \ubc29\uc9c0)\nsudo rm -rf /etc/cni/net.d\n\n# root \ub610\ub294 \ud604\uc7ac \uc0ac\uc6a9\uc790\uc758 kube \uc124\uc815 \ud3f4\ub354 \uc0ad\uc81c\nrm -rf $HOME/.kube\nsudo rm -rf /root/.kube\n\n# (\uc120\ud0dd) \uc774\uc804 \ub370\uc774\ud130\uac00 \ub0a8\uc544\uc788\uc744 \uc218 \uc788\ub294 etcd \ub4f1 \ud3f4\ub354 \uc0ad\uc81c\n# kubeadm reset\uc774 \ub300\ubd80\ubd84 \ucc98\ub9ac\ud558\uc9c0\ub9cc \ud655\uc2e4\ud558\uac8c \ud558\uae30 \uc704\ud568\nsudo rm -rf /var/lib/etcd\nsudo rm -rf /var/lib/kubelet\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#3-iptables","title":"\ud83d\udd04 3\ub2e8\uacc4: IPtables \uaddc\uce59 \ucd08\uae30\ud654 \ubc0f \ub7f0\ud0c0\uc784 \uc7ac\uc2dc\uc791","text":"<p>\ub124\ud2b8\uc6cc\ud06c \ub77c\uc6b0\ud305 \uaddc\uce59(iptables)\uc774 \uba54\ubaa8\ub9ac\uc5d0 \ub0a8\uc544 \uc788\uc73c\uba74, \uc7ac\uc124\uce58 \ud6c4 \ud30c\ub4dc(Pod) \ud1b5\uc2e0\uc774 \uc548 \ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774 \uacfc\uc815\uc740 \ub9e4\uc6b0 \uc911\uc694\ud569\ub2c8\ub2e4.</p> <pre><code># iptables \uaddc\uce59 \ucd08\uae30\ud654\nsudo iptables -F &amp;&amp; sudo iptables -t nat -F &amp;&amp; sudo iptables -t mangle -F &amp;&amp; sudo iptables -X\n\n# \ucee8\ud14c\uc774\ub108 \ub7f0\ud0c0\uc784 \uc7ac\uc2dc\uc791 (\ubcf4\ud1b5 containerd\ub97c \uc0ac\uc6a9\ud558\uc2e4 \uac81\ub2c8\ub2e4)\nsudo systemctl restart containerd\n# \ub9cc\uc57d docker\ub97c \uc4f4\ub2e4\uba74: sudo systemctl restart docker\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#4_1","title":"\u25b6\ufe0f 4\ub2e8\uacc4: \ub2e4\uc2dc \uc2e4\ud589","text":"<p>\uc774\uc81c \uc2dc\uc2a4\ud15c\uc774 \uae68\ub057\ud574\uc84c\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud558\uae30 \uc804\uc5d0 Swap \uba54\ubaa8\ub9ac\uac00 \uaebc\uc838 \uc788\ub294\uc9c0 \ud55c \ubc88 \ub354 \ud655\uc778\ud558\uc138\uc694. (\uc7ac\ubd80\ud305\ud588\ub2e4\uba74 \ub2e4\uc2dc \ucf1c\uc84c\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4.)</p> <pre><code># Swap \ube44\ud65c\uc131\ud654 \ud655\uc778\nsudo swapoff -a\n\n# \ucd08\uae30\ud654 \uba85\ub839\uc5b4 \ub2e4\uc2dc \uc2e4\ud589\nsudo kubeadm init \\\n  --control-plane-endpoint \"10.10.10.200:6443\" \\\n  --upload-certs \\\n  --pod-network-cidr=192.168.0.0/16 \\\n  --service-cidr=10.96.0.0/12 \\\n  --kubernetes-version v1.30.0\n</code></pre> <p>Tip: \ub9cc\uc57d <code>10.10.10.200</code> IP\uac00 \ud604\uc7ac \uc11c\ubc84\uc758 IP\uac00 \uc544\ub2c8\ub77c \ub85c\ub4dc\ubc38\ub7f0\uc11c VIP\ub77c\uba74, \ud574\ub2f9 IP\ub85c \ud1b5\uc2e0\uc774 \uac00\ub2a5\ud55c \uc0c1\ud0dc\uc778\uc9c0 \uba3c\uc800 \ud655\uc778\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4. \ub2e8\uc77c \ub9c8\uc2a4\ud130 \ub178\ub4dc\ub77c\uba74 \ud604\uc7ac \uc11c\ubc84 IP\ub97c \uc785\ub825\ud574\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#_4","title":"\ud83d\udccb \uacf5\ud1b5 \ud6c4\uc18d \uc791\uc5c5 (\ucd08\uae30\ud654 \uc131\uacf5 \ud6c4)","text":"<p>\ucd08\uae30\ud654\uac00 \uc131\uacf5\uc801\uc73c\ub85c \ub05d\ub098\uba74 <code>Your Kubernetes control-plane has initialized successfully!</code> \uac00 \ub739\ub2c8\ub2e4. \uadf8 \ud6c4 \uc544\ub798 \uc791\uc5c5\uc744 \uc218\ud589\ud558\uc138\uc694.</p> <pre><code>mkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#phase-5-cni-calico","title":"\ud83d\ude80 Phase 5: CNI (Calico) \uc124\uce58","text":"<p>CNI \uc124\uce58\ub294 \ub2e8\uc77c/\ub2e4\uc911 \ub9c8\uc2a4\ud130 \uc5ec\ubd80\uc640 \uc0c1\uad00\uc5c6\uc774 \ub3d9\uc77c\ud569\ub2c8\ub2e4. \ub9c8\uc2a4\ud130 \ub178\ub4dc\uac00 <code>NotReady</code> \uc0c1\ud0dc\uc5d0\uc11c <code>Ready</code> \uc0c1\ud0dc\ub85c \ubc14\ub00c\uac8c \ud574\uc90d\ub2c8\ub2e4.</p> <p>\uc774\ub54c <code>calico.yaml</code> \ud30c\uc77c \ub0b4\ubd80\uc5d0 \uc788\ub294 <code>CALICO_IPV4POOL_CIDR</code> \uac12\uacfc k8s\uc758 <code>pod-network-cidr</code> \uac12\uc774 \ub3d9\uc77c\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: K8s-Master-Node-1]</p> <pre><code># 1. Calico \ub9e4\ub2c8\ud398\uc2a4\ud2b8 \uc704\uce58\ub85c \uc774\ub3d9\ncd ~/k8s-1.30/k8s/utils\n\n# 2. Calico \uc124\uce58\nkubectl apply -f calico.yaml\n\n# 3. \uc124\uce58 \ud655\uc778 (Watch \ubaa8\ub4dc)\n# \ucc98\uc74c\uc5d4 NotReady\uc600\ub2e4\uac00, calico-node \ud30c\ub4dc\uac00 \ub728\uba74 Ready\ub85c \ubc14\ub01d\ub2c8\ub2e4.\nwatch kubectl get nodes\n</code></pre> <p>\ub9cc\uc57d <code>calico</code> \uac00 \ubc30\ud3ec\ub418\uc9c0 \uc54a\ub294\ub2e4\uba74 kubelet\uc5d0\uc11c \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc744 \ud655\ub960\uc774 \ub192\uc2b5\ub2c8\ub2e4. \uc774\ub54c\ub294 \uc544\ub798 \ubc29\ubc95\uc73c\ub85c \ucd08\uae30\ud654 \ud6c4, <code>kubeadm init</code> \uba85\ub839\uc5b4\ub97c \uc7ac\uc2e4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \uae30\uc874\uc5d0 \ud558\ub2e4 \ub9cc \uc124\uc815 \uc2f9 \uc9c0\uc6b0\uae30\nsudo kubeadm reset -f\n\n# 2. CNI \uc124\uc815 \ud30c\uc77c \ubc0f \uae30\uc874 \uc778\uc99d\uc11c \uc794\uc5ec\ubb3c \uc0ad\uc81c (\ucda9\ub3cc \ubc29\uc9c0)\nsudo rm -rf /etc/cni/net.d\nrm -rf $HOME/.kube/config\nrm -rf /var/lib/etcd/\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#phase-6-worker-13-only","title":"\ud83d\ude80 Phase 6: \uc6cc\ucee4 \ub178\ub4dc \uc870\uc778 (Worker 1~3 Only)","text":"<p>[\uc2e4\ud589 \uc704\uce58: Worker 1, 2, 3]</p> <p>\uc544\uae4c \ubcf5\uc0ac\ud574 \ub454 <code>kubeadm join</code> \uba85\ub839\uc5b4\ub97c \ubd99\uc5ec\ub123\uc73c\uc138\uc694.</p> <pre><code># \uc608\uc2dc\nsudo kubeadm join 10.10.10.70:6443 --token &lt;\ud1a0\ud070&gt; \\\n    --discovery-token-ca-cert-hash sha256:&lt;\ud574\uc2dc\uac12&gt;\n</code></pre> <p>\ub9cc\uc57d <code>[WARNING Hostname]: hostname \"k8s-worker-node-1.novalocal\" could not be reached</code>\uc640 \uac19\uc740 \uc624\ub958\uac00 \ubc1c\uc0dd\ud55c\ub2e4\uba74 <code>hosts</code> \ud30c\uc77c\uc5d0 \ud574\ub2f9 \uc774\ub984\uc744 \ucd94\uac00\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>20.0.0.22 k8s-master-node\n20.0.0.203 k8s-worker-node-1 k8s-worker-node-1.novalocal\n20.0.0.222 k8s-worker-node-2 k8s-worker-node-2.novalocal\n20.0.0.153 k8s-worker-node-3 k8s-worker-node-3.novalocal\n</code></pre>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#worker-node-join","title":"\ud83d\udca1 (\ucc38\uace0) Worker Node Join \ubc29\ubc95 \ucc28\uc774","text":"<p>\ub098\uc911\uc5d0 \uc6cc\ucee4 \ub178\ub4dc\ub97c \ubd99\uc77c \ub54c(<code>Phase 6</code>)\ub3c4 \uad6c\uc131\uc5d0 \ub530\ub77c \uba85\ub839\uc5b4\uac00 \uc57d\uac04 \ub2e4\ub985\ub2c8\ub2e4. \ubbf8\ub9ac \ucc38\uace0\ud558\uc138\uc694.</p> <ul> <li> <p>HA \uad6c\uc131(\uc635\uc158 A) \uc2dc: \uc6cc\ucee4 \ub178\ub4dc\ub294 VIP(10.10.10.200)\ub97c \ubc14\ub77c\ubcf4\uace0 Join \ud569\ub2c8\ub2e4.</p> <pre><code>kubeadm join 10.10.10.200:6443 --token &lt;\ud1a0\ud070&gt; ...\n</code></pre> </li> <li> <p>\ub2e8\uc77c \uad6c\uc131(\uc635\uc158 B) \uc2dc: \uc6cc\ucee4 \ub178\ub4dc\ub294 Master IP(10.10.10.70)\ub97c \ubc14\ub77c\ubcf4\uace0 Join \ud569\ub2c8\ub2e4.</p> <pre><code>kubeadm join 10.10.10.70:6443 --token &lt;\ud1a0\ud070&gt; ...\n</code></pre> </li> </ul> <p>\uc5ec\uae30\uae4c\uc9c0 \uc644\ub8cc\ub418\uba74 <code>kubectl get nodes</code> \uba85\ub839\uc5b4\ub85c Master \ub178\ub4dc\uac00 Ready \uc0c1\ud0dc\uc778\uc9c0 \ud655\uc778\ud574 \uc8fc\uc138\uc694.</p>"},{"location":"k8s/offline-install/002-k8s-air-gapped-install/#_5","title":"\u2705 \uc644\ub8cc \ud655\uc778","text":"<p>\ub2e4\uc2dc \ub9c8\uc2a4\ud130 \ub178\ub4dc\uc5d0\uc11c:</p> <pre><code>kubectl get nodes\n</code></pre> <p>\ubaa8\ub450 <code>Ready</code> \uc0c1\ud0dc\ub77c\uba74 K8s\uac00 \uc815\uc0c1 \uc124\uce58\ub41c \uac83\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/offline-install/003-necessary_infra_install/","title":"3. \ud3d0\uc1c4\ub9dd\uc5d0\uc11c Helm, Harbor, Envoy(Ingress\ub294 \ube44\uad8c\uc7a5) \uc124\uce58","text":"<ul> <li>\uac00\uc774\ub4dc \ud658\uacbd</li> <li>OS: Rocky 9.6</li> <li>kubelet: 1.30.14</li> <li>\ud3d0\uc1c4\ub9dd\uc6a9 K8s \uc124\uce58 \ud30c\uc77c\uc774 \uc900\ube44\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> <li>\uc124\uce58 \ud30c\uc77c \uc704\uce58</li> </ul>"},{"location":"k8s/offline-install/003-necessary_infra_install/#phase-1-helm-master-1-only","title":"\ud83d\ude80 Phase 1: Helm \uc124\uce58 (Master-1 Only)","text":"<p>Helm\uc740 \ub9c8\uc2a4\ud130 \ub178\ub4dc\uc5d0\uc11c \uba85\ub839\uc5b4\ub97c \ub0b4\ub9ac\ub294 \ub3c4\uad6c\uc774\ubbc0\ub85c, \ub9c8\uc2a4\ud130 \ub178\ub4dc 1\ub300\uc5d0\ub9cc \uc124\uce58\ud558\uba74 \ub429\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: K8s-Master-Node-1]</p> <pre><code># 1. \ubc14\uc774\ub108\ub9ac \ud3f4\ub354\ub85c \uc774\ub3d9\ncd ~/k8s-1.30/k8s/binaries\n\n# 2. \uc555\ucd95 \ud574\uc81c (\uc774\ubbf8 \ud588\ub2e4\uba74 \uc0dd\ub7b5 \uac00\ub2a5)\ntar -zxvf helm-v3.14.0-linux-amd64.tar.gz\n\n# 3. \uc2e4\ud589 \ud30c\uc77c\uc744 \uc2dc\uc2a4\ud15c \uacbd\ub85c\ub85c \uc774\ub3d9\nsudo mv linux-amd64/helm /usr/local/bin/helm\n\n# 4. \uc124\uce58 \ud655\uc778\nhelm version\n# \uacb0\uacfc: version.BuildInfo{Version:\"v3.14.0\", ...} \ub728\uba74 \uc131\uacf5\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#phase-2-envoy","title":"\ud83d\ude80 Phase 2: Envoy \uc124\uce58","text":"<p>2026\ub144 3\uc6d4\ubd80\ud130 <code>Ingress Nginx</code> \uc5d0 \ub300\ud55c \uacf5\uc2dd \uc9c0\uc6d0\uc774 \uc885\ub8cc\ub429\ub2c8\ub2e4. \uc774\uc5d0 \ub530\ub77c Kubernetes\uc758 <code>Gateway API</code> \uc640 <code>Envoy</code> \ub97c \uc0ac\uc6a9\ud558\uc5ec \ud569\ub2c8\ub2e4.</p>"},{"location":"k8s/offline-install/003-necessary_infra_install/#0-standard-architecture","title":"0. \uc544\ud0a4\ud14d\ucc98 \uac1c\uc694 (Standard Architecture)","text":"<p>\ucfe0\ubc84\ub124\ud2f0\uc2a4 \ubcf4\uc548 \ubc0f \ub124\ud2b8\uc6cc\ud06c \ud45c\uc900\uc744 \uc900\uc218\ud558\ub294 \uad6c\uc131\uc785\ub2c8\ub2e4.</p> <ul> <li>Network: <code>hostNetwork: false</code> (Pod\ub294 K8s \ub0b4\ubd80\ub9dd \uc0ac\uc6a9, \ub178\ub4dc \ub124\ud2b8\uc6cc\ud06c\uc640 \uaca9\ub9ac)</li> <li>Service: <code>type: LoadBalancer</code> (\uc678\ubd80 \ud2b8\ub798\ud53d \uc9c4\uc785\uc810)</li> <li>Traffic Flow: <code>Client</code> -&gt; <code>External IP (LB)</code> -&gt; <code>Service (80/443)</code> -&gt; <code>Envoy Pod (10080/10443)</code> -&gt; <code>Backend Pod</code></li> </ul>"},{"location":"k8s/offline-install/003-necessary_infra_install/#1","title":"1. \uc774\ubbf8\uc9c0 \ub85c\ub4dc (\uc804\uccb4 \ub178\ub4dc)","text":"<p>[\uc2e4\ud589 \uc704\uce58: Master 1, Worker 1~3 \uc804\uccb4]</p> <p>\uc804\uccb4 \ub178\ub4dc\uc5d0 <code>envoy</code> \uc774\ubbf8\uc9c0\ub4e4\uc744 \ub85c\ub4dc\ud569\ub2c8\ub2e4.</p> <pre><code>cd ./envoy-1.36.3\nsudo bash ./images/upload_images.sh\n</code></pre> <p>[\uc2e4\ud589 \uc704\uce58: Master 1]</p> <p>\ub9c8\uc2a4\ud130 \ub178\ub4dc\ub85c \ub3cc\uc544\uc640 \uc124\uce58 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code>sudo bash install_envoy-gateway.sh\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#2-ip","title":"2. \ubc30\ud3ec \ud6c4 \uc0c1\ud0dc \ud655\uc778 \ubc0f IP \ud560\ub2f9","text":"<p>\ubc30\ud3ec\uac00 \uc644\ub8cc\ub418\uba74 \uac00\uc7a5 \uba3c\uc800 Gateway Service\uc758 External IP \ud560\ub2f9 \uc0c1\ud0dc\ub97c \ud655\uc778\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># Envoy Gateway\uac00 \uc0dd\uc131\ud55c LoadBalancer \uc11c\ube44\uc2a4 \ud655\uc778\nkubectl get svc -n envoy-gateway-system | grep -i load\n</code></pre> <p>\uc704 \uba85\ub839 \uc2e4\ud589 \uacb0\uacfc(<code>EXTERNAL-IP</code>)\uc5d0 \ub530\ub77c \uc870\uce58 \ubc29\ubc95\uc774 \ub2e4\ub985\ub2c8\ub2e4.</p> <ol> <li>Case A: \ud074\ub77c\uc6b0\ub4dc (AWS EKS, GKE, AKS \ub4f1)</li> <li> <p><code>EXTERNAL-IP</code>\uc5d0 \uc790\ub3d9\uc73c\ub85c IP \ub610\ub294 \ub3c4\uba54\uc778\uc774 \ud560\ub2f9\ub429\ub2c8\ub2e4. (\ubcc4\ub3c4 \uc870\uce58 \ubd88\ud544\uc694)</p> </li> <li> <p>Case B: \uc628\ud504\ub808\ubbf8 (MetalLB\uac00 \uc788\ub294 \uacbd\uc6b0)</p> <ul> <li>\uc124\uc815\ub41c IP Pool\uc5d0\uc11c \uc790\ub3d9\uc73c\ub85c IP\uac00 \ud560\ub2f9\ub429\ub2c8\ub2e4. (\ubcc4\ub3c4 \uc870\uce58 \ubd88\ud544\uc694)</li> </ul> </li> <li> <p>Case C: \uc628\ud504\ub808\ubbf8 (MetalLB\uac00 \uc5c6\ub294 \uacbd\uc6b0) - <code>&lt;pending&gt;</code> \uc0c1\ud0dc</p> <ul> <li>IP\ub97c \ud560\ub2f9\ud574 \uc904 \ucee8\ud2b8\ub864\ub7ec\uac00 \uc5c6\uc73c\ubbc0\ub85c \uc218\ub3d9\uc73c\ub85c VIP(Node IP)\ub97c \ubc14\uc778\ub529\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul> </li> </ol>"},{"location":"k8s/offline-install/003-necessary_infra_install/#case-c-ip","title":"\ud83d\udee0\ufe0f [Case C] \uc218\ub3d9 IP \ud560\ub2f9 \uba85\ub839\uc5b4","text":"<p>\uc11c\ube44\uc2a4\uac00 <code>&lt;pending&gt;</code> \uc0c1\ud0dc\ub85c \uba48\ucdb0 \uc788\uc744 \ub54c\ub9cc \uc2e4\ud589\ud569\ub2c8\ub2e4. <code>externalIPs</code> \uc5d0 \uc788\ub294 <code>1.1.1.213</code> \ubd80\ubd84\uc740 \uc2e4\uc81c \uc0ac\uc6a9\ud560 \ub178\ub4dc IP\ub85c \ub300\uccb4\ud569\ub2c8\ub2e4.</p> <pre><code># 1. IP\uac00 \ud560\ub2f9\ub418\uc9c0 \uc54a\uc740 \uc11c\ube44\uc2a4 \uc774\ub984 \ud655\uc778\nSVC_NAME=$(kubectl get svc -n envoy-gateway-system -o jsonpath='{.items[?(@.spec.type==\"LoadBalancer\")].metadata.name}')\n\n# 2. \uc2e4\uc81c \uc0ac\uc6a9\ud560 \ub178\ub4dc IP\ub85c \ud328\uce58 (IP \ubd80\ubd84 \uc218\uc815 \ud544\uc218)\nkubectl patch svc -n envoy-gateway-system $SVC_NAME \\\n  --type merge \\\n  -p '{\"spec\":{\"externalIPs\":[\"1.1.1.213\"]}}'\n\necho \"\u2705 \uc11c\ube44\uc2a4($SVC_NAME)\uc5d0 \uc678\ubd80 IP(1.1.1.213)\uac00 \ud560\ub2f9\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\"\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#3-httproute","title":"3. \ub77c\uc6b0\ud305(HTTPRoute) \uc124\uc815 \ubc0f \uac80\uc99d","text":"<p>Gateway\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \ub5b4\ub2e4\uba74, \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uc5f0\uacb0 \uaddc\uce59(<code>HTTPRoute</code>)\uc744 \uc810\uac80\ud569\ub2c8\ub2e4. \uc774 \uac80\uc99d\uc740 \uc11c\ube44\uc2a4\uc5d0 \uc811\uadfc\ud558\uc9c0 \ubabb\ud560 \ub54c \uc9c4\ud589\ud574\ub3c4 \ub429\ub2c8\ub2e4.</p> <p>\uc11c\ube44\uc2a4\ubcf4\ub2e4 \uba3c\uc800 envoy\ub97c \uc124\uce58\ud558\uae30 \ub54c\ubb38\uc5d0 \ud604\uc7ac\ub294 \uc0dd\uc131\ub41c HTTPRoute \uc790\uc6d0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.</p>"},{"location":"k8s/offline-install/003-necessary_infra_install/#1-gateway","title":"\u2705 \uccb4\ud06c\ub9ac\uc2a4\ud2b8 1: Gateway \uc774\ub984 \uc77c\uce58 \uc5ec\ubd80","text":"<p><code>HTTPRoute</code> \ub9ac\uc18c\uc2a4\uac00 \ud604\uc7ac \uc2e4\ud589 \uc911\uc778 Gateway(<code>cmp-gateway</code>)\ub97c \uc815\ud655\ud788 \uac00\ub9ac\ud0a4\uace0 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># parentRefs\uac00 'cmp-gateway'\uc778\uc9c0 \ud655\uc778\nkubectl get httproute -A\n</code></pre> <p>\uc218\uc815 \ubc29\ubc95:</p> <pre><code>kubectl patch httproute &lt;ROUTE_NAME&gt; -n &lt;NAMESPACE&gt; --type='json' \\\n  -p='[{\"op\": \"replace\", \"path\": \"/spec/parentRefs/0/name\", \"value\": \"cmp-gateway\"}]'\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#2-connection-refused","title":"\u2705 \uccb4\ud06c\ub9ac\uc2a4\ud2b8 2: \ubc31\uc5d4\ub4dc \ud3ec\ud2b8 (Connection Refused)","text":"<p>Envoy\ub294 \uc11c\ube44\uc2a4(ClusterIP) \ud3ec\ud2b8\uac00 \uc544\ub2cc \ud30c\ub4dc(Pod)\uc758 \uc2e4\uc81c \ucee8\ud14c\uc774\ub108 \ud3ec\ud2b8\ub85c \uc811\uc18d\uc744 \uc2dc\ub3c4\ud569\ub2c8\ub2e4.</p> <ul> <li>\uc99d\uc0c1: 503 Service Unavailable \ub610\ub294 Connection Refused</li> <li>\ud574\uacb0: <code>HTTPRoute</code>\uc758 <code>backendRefs</code> \ud3ec\ud2b8\ub97c TargetPort(\uc2e4\uc81c \uc571 \ud3ec\ud2b8, \uc608: 8080) \ub85c \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul> <pre><code># \ud3ec\ud2b8\ub97c 80 -&gt; 8080\uc73c\ub85c \ubcc0\uacbd\ud558\ub294 \uc608\uc2dc\nkubectl patch httproute &lt;ROUTE_NAME&gt; -n &lt;NAMESPACE&gt; --type='json' \\\n  -p='[{\"op\": \"replace\", \"path\": \"/spec/rules/0/backendRefs/0/port\", \"value\": 8080}]'\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#3-url-rewrite","title":"\u2705 \uccb4\ud06c\ub9ac\uc2a4\ud2b8 3: \uacbd\ub85c \uc7ac\uc791\uc131 (URL Rewrite)","text":"<p>\uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc774 \ud558\uc704 \uacbd\ub85c(Context Path)\ub97c \uc778\uc2dd\ud558\uc9c0 \ubabb\ud574 404\uac00 \ubc1c\uc0dd\ud560 \uacbd\uc6b0 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <ul> <li>\uc0c1\ud669: <code>/oauth2/login</code> \ud638\ucd9c \uc2dc \uc571\uc774 <code>/oauth2</code>\ub97c \uacbd\ub85c\ub85c \uc778\uc2dd\ud558\uc5ec \uc624\ub958 \ubc1c\uc0dd.</li> <li>\ud574\uacb0: <code>URLRewrite</code> \ud544\ud130 \uc801\uc6a9.</li> </ul> <pre><code>filters:\n- type: URLRewrite\n  urlRewrite:\n    path:\n      type: ReplacePrefixMatch\n      replacePrefixMatch: /\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#4","title":"4. \uc6b4\uc601 \ubc0f \ub85c\uadf8 \ud655\uc778","text":"<p>Envoy Gateway\ub294 \ub3d9\uc801\uc73c\ub85c \ub9ac\uc18c\uc2a4\ub97c \uad00\ub9ac\ud558\ubbc0\ub85c \ud30c\ub4dc \uc774\ub984\uc774 \ubcc0\uacbd\ub429\ub2c8\ub2e4. Label Selector(<code>-l</code>)\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub85c\uadf8\ub97c \ud655\uc778\ud558\ub294 \uac83\uc774 \ud45c\uc900\uc785\ub2c8\ub2e4.</p>"},{"location":"k8s/offline-install/003-necessary_infra_install/#data-plane","title":"\ud83d\udccb \ud504\ub85d\uc2dc(Data Plane) \ub85c\uadf8","text":"<p>\uc2e4\uc81c \ud2b8\ub798\ud53d \ucc98\ub9ac, \uc811\uc18d \uc624\ub958 \ud655\uc778 \uc2dc \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code># Envoy Proxy \ub85c\uadf8 \uc2e4\uc2dc\uac04 \ud655\uc778\nkubectl logs -n envoy-gateway-system -f -l gateway.envoyproxy.io/owning-gateway-name=cmp-gateway\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#control-plane","title":"\ud83e\udde0 \ucee8\ud2b8\ub864\ub7ec(Control Plane) \ub85c\uadf8","text":"<p>Gateway \uc124\uc815 \ubcc0\ud658, \ubc30\ud3ec \uc2e4\ud328 \uc6d0\uc778 \ubd84\uc11d \uc2dc \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code># Gateway Controller \ub85c\uadf8 \ud655\uc778\nkubectl logs -n envoy-gateway-system -f -l app.kubernetes.io/name=envoy-gateway\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#ingress-nginx","title":"(\uc608\uc804)Ingress Nginx","text":"<p>2026\ub144 3\uc6d4\ubd80\ud130 Ingress Nginx\uc5d0 \ub300\ud55c \uc9c0\uc6d0\uc774 \uc885\ub8cc\ub429\ub2c8\ub2e4. \uc774\uc5d0 \ub530\ub77c Ingress Nginx \ub300\uc2e0 \uc704\uc5d0 \uc788\ub294 Gateway API + Envoy\ub97c \uc0ac\uc6a9\uc744 \uc801\uadf9 \uad8c\uc7a5\ud569\ub2c8\ub2e4.</p> <p>\uc544\ub798 \uba85\ub839\uc744 \uc2e4\ud589\ud558\uc5ec, worker \ub178\ub4dc \uc911 \ud558\ub098\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4.</p> <pre><code>kubectl get node\n</code></pre> <p>Ingress Controller\uac00 \ub3d9\uc791\ud558\ub294 \ub178\ub4dc\ub97c \uace0\uc815\ud569\ub2c8\ub2e4.</p> <pre><code>kubectl label node &lt;NODE_NAME&gt; ingress-ready=true\n</code></pre> <p><code>ingress-nginx.yaml</code> \ud30c\uc77c\uc744 \uc5f4\uc5b4 <code>spec &gt; template &gt; spec</code> \uc544\ub798 <code>nodeSelector</code> \ubd80\ubd84\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4.</p> <pre><code>vi ingress-nginx.yaml\n\nkind: Deployment\n...\n  spec:\n    # ... (\uc0dd\ub7b5)\n    template:\n      spec:\n        ...\n        nodeSelector:\n          ingress-ready: \"true\"\n        ...\n</code></pre> <pre><code># 1. \uc124\uce58\nkubectl apply -f ingress-nginx.yaml\n\n# 2. \ud655\uc778\n# ingress-nginx-controller \ud30c\ub4dc\uac00 Running \uc0c1\ud0dc\uac00 \ub420 \ub54c\uae4c\uc9c0 \uae30\ub2e4\ub9ac\uc138\uc694.\nwatch kubectl get pods -n ingress-nginx\n</code></pre> <p>\ub9cc\uc57d LB\uac00 \uc5c6\uc5b4\uc11c \ub178\ub4dc\uc5d0 \uc9c1\uc811 \ubd99\uc5b4\uc57c \ud558\ub294 \uc0c1\ud669\uc774\ub77c\uba74 ingress-nginx.yaml \ud30c\uc77c\uc5d0 hostNetwork \uc635\uc158\uc744 \ucd94\uac00\ud574\uc8fc\uc138\uc694.</p> <pre><code>spec:\n  template:\n    spec:\n      hostNetwork: true  # &lt;--- \uc774 \uc904\uc744 \ucd94\uac00\ud558\uc138\uc694! (dnsPolicy \uadfc\ucc98\uc5d0 \ub450\uba74 \ub429\ub2c8\ub2e4)\n      dnsPolicy: ClusterFirst\n      containers:\n      - name: controller\n        ...\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#phase-3-harbor","title":"\ud83d\ude80 Phase 3: Harbor \uc124\uce58","text":""},{"location":"k8s/offline-install/003-necessary_infra_install/#0-local-path-provisioner","title":"0. Local Path Provisioner (\uc800\uc7a5\uc18c, \uc120\ud0dd)","text":"<p>[\uc2e4\ud589 \uc704\uce58: K8s-Master-Node-1]</p> <p>\ud3d0\uc1c4\ub9dd\uc5d0\uc11c \uac00\uc7a5 \uc26c\uc6b4 \uc2a4\ud1a0\ub9ac\uc9c0 \ud574\uacb0\ucc45\uc785\ub2c8\ub2e4. \ub85c\uceec \ub514\uc2a4\ud06c \uacbd\ub85c\ub97c PV\ub85c \uc501\ub2c8\ub2e4. <code>Storage Class</code> \ub97c \uc124\uce58\ud558\uc9c0 \uc54a\uace0 <code>manual</code> \ub85c \uc815\uc758\ud574\ub3c4 \uad1c\ucc2e\uc2b5\ub2c8\ub2e4.</p> <pre><code>cd ~/k8s-1.30/k8s/utils\n\n# 1. \uc124\uce58\nkubectl apply -f local-path-storage.yaml\n\n# 2. (\uc911\uc694) \uae30\ubcf8 \uc2a4\ud1a0\ub9ac\uc9c0 \ud074\ub798\uc2a4\ub85c \uc9c0\uc815\n# \uc774\uac78 \ud574\uc57c Harbor\uac00 \"\ub098 \uc6a9\ub7c9 \uc918\" \ud560 \ub54c \uc790\ub3d9\uc73c\ub85c \uc5f0\uacb0\ud574\uc90d\ub2c8\ub2e4.\nkubectl patch storageclass local-path -p '{\"metadata\": {\"annotations\":{\"storageclass.kubernetes.io/is-default-class\":\"true\"}}}'\n\n# 3. \ud655\uc778 (local-path \uc606\uc5d0 (default)\ub77c\uace0 \ub5a0\uc57c \ud568)\nkubectl get sc\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#2-harbor","title":"2. Harbor \uc124\uce58","text":"<p><code>./harbor-1.14.3/harbor-iamges-upload</code> \ud3f4\ub354\ub97c \uc124\uce58\ud558\uace0\uc790 \ud558\ub294 \ub178\ub4dc\ub85c \uc62e\uae41\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: Harbor\ub97c \ub744\uc6b8 \uc6cc\ucee4 \ub178\ub4dc 1\uac1c]</p> <pre><code>cd harbor-iamges-upload/\nsudo bash upload_images.sh\n</code></pre> <p>hostPath\ub85c \uc0ac\uc6a9\ud560 \ub514\ub809\ud1a0\ub9ac\ub3c4 \uc0dd\uc131\ud569\ub2c8\ub2e4. \uc774\ub54c \uacbd\ub85c\ub294 \ubcc0\uacbd\ud574\ub3c4 \ub429\ub2c8\ub2e4.</p> <pre><code>sudo mkdir -p /data/harbor\nsudo chmod -R 777 /data/harbor\n</code></pre> <p>\uc5c5\ub85c\ub4dc\uac00 \ub05d\ub098\uba74 \ub9c8\uc2a4\ud130 \ub178\ub4dc\ub85c \ub3cc\uc544\uc635\ub2c8\ub2e4.</p> <p>[\uc2e4\ud589 \uc704\uce58: K8s-Master-Node-1]</p> <pre><code>cd harbor-1.14.3/\nvi harbor_install_offline.sh\n</code></pre> <p>\uc704 \uc124\uc815 \uc815\ubcf4\ub97c \ud574\ub2f9 \ud658\uacbd\uc5d0 \ub9de\uac8c \ubcc0\uacbd\ud569\ub2c8\ub2e4.</p> <ul> <li><code>EXTERNAL_HOSTNAME</code> : Harbor\ub97c \ub744\uc6b8 \uc6cc\ucee4 \ub178\ub4dc IP</li> <li><code>SAVE_PATH</code> : \ud638\uc2a4\ud2b8 \ud328\uc2a4 \uc2e4\uc81c \uc704\uce58(\uc6cc\ucee4 \ub178\ub4dc\uc5d0 \uc0dd\uc131\ud55c \ub514\ub809\ud1a0\ub9ac\uc640 \ub3d9\uc77c\ud574\uc57c \ud568)</li> <li><code>NODE_NAME</code> : Harbor\ub97c \ub744\uc6b8 \uc6cc\ucee4 \ub178\ub4dc \uc774\ub984</li> <li><code>STORAGE_SIZE</code> : Harbor \uc800\uc7a5\uc18c \ud06c\uae30</li> </ul> <p>\uc124\uc815\uc774 \ub05d\ub098\uba74 \uc800\uc7a5 \ud6c4, \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code>sudo bash harbor_install_offline.sh\n</code></pre> <p>\ud574\uacb0\ucc45 (\ud544\uc218 \uc801\uc6a9):</p> <ol> <li> <p>Calico MTU \uac15\uc81c \ucd95\uc18c:</p> </li> <li> <p><code>kubectl edit configmap -n kube-system calico-config</code></p> </li> <li><code>veth_mtu: \"0\"</code> (\uc790\ub3d9) \u2192 <code>veth_mtu: \"1350\"</code> (\uc218\ub3d9 \uace0\uc815)</li> </ol> <p>2.\ud130\ub110\ub9c1 \ubaa8\ub4dc \ubcc0\uacbd (IPIP \u2192 VXLAN):</p> <ul> <li><code>kubectl edit ippool default-ipv4-ippool</code></li> <li><code>ipipMode: Never</code>, <code>vxlanMode: Always</code> \ub85c \ubcc0\uacbd.</li> </ul> <p>3.\ubc29\ud654\ubcbd \ud574\uc81c: \uc6cc\ucee4 \ub178\ub4dc <code>firewalld</code> \ube44\ud65c\uc131\ud654 \ud655\uc778.</p>"},{"location":"k8s/offline-install/003-necessary_infra_install/#2-harbor-pull-https","title":"2. Harbor \uc774\ubbf8\uc9c0 Pull \uc2dc, https\ub85c \uac00\uc838\uc62c \ub54c","text":"<p>Http\ub97c \uc124\uc815\ud588\ub294\ub370, Https\ub97c \ud638\ucd9c\ud55c\ub2e4\uba74 containerd \uc124\uc815\uc744 \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4. \ubaa8\ub4e0 \uc6cc\ucee4 \ub178\ub4dc\uc5d0\uc11c \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>grep \"config_path\" /etc/containerd/config.toml\n\n# \uacb0\uacfc\n    config_path = '/etc/containerd/certs.d:/etc/docker/certs.d'\n  plugin_config_path = '/etc/nri/conf.d'\n  config_path = ''\n</code></pre> <p>\uc704\uc640 \uac19\uc774 <code>config_path</code> \uc5d0 \ube48\uac12\uc774 \uc788\uac70\ub098, <code>:</code> \uc73c\ub85c \ub098\ub258\uc5b4 \uc788\ub2e4\uba74 \ubaa8\ub450 \uc81c\uac70\ud569\ub2c8\ub2e4.</p> <pre><code>sudo vi /etc/containerd/config.toml\n</code></pre> <pre><code>...\n# \ube48 \uac12\uc774 \ub4e4\uc5b4\uac04 config_path\uac00 \uc788\ub2e4\uba74 \uc81c\uac70\n    config_path = '' \n...\n\ngrep \uba85\ub839\uc5b4\ub97c \ub2e4\uc2dc \ucd9c\ub825 \uc2dc, \uc544\ub798\uc640 \uac19\uc774 \ub098\uc640\uc57c \ud569\ub2c8\ub2e4.\n\n```bash\ngrep \"config_path\" /etc/containerd/config.toml\n\n      config_path = '/etc/containerd/certs.d'\n    plugin_config_path = '/etc/nri/conf.d'\n</code></pre> <p>\uadf8 \ud6c4, tls \uc635\uc158\uc744 \ub044\ub294 \uc124\uc815\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4.</p> <pre><code># \uc2e4\uc81c \ud558\ubc84 \ub3c4\uba54\uc778 \uc785\ub825 \ud544\uc694\nsudo mkdir -p /etc/containerd/certs.d/20.0.0.127:30002/\n\n# \uc124\uc815 \ucd94\uac00\ncat &lt;&lt;EOF | sudo tee /etc/containerd/certs.d/20.0.0.127:30002/hosts.toml\nserver = \"http://20.0.0.127:30002\"\n\n[host.\"http://20.0.0.127:30002\"]\n  capabilities = [\"pull\", \"resolve\"]\n  skip_verify = true\nEOF\n</code></pre> <p>\uc11c\ube44\uc2a4\ub97c \uc7ac\uc2dc\uc791\ud569\ub2c8\ub2e4.</p> <pre><code>sudo systemctl restart containerd\n</code></pre>"},{"location":"k8s/offline-install/003-necessary_infra_install/#3-https","title":"3. HTTPS \uc124\uc815 \uc2dc, \ud0a4 \ud30c\uc77c \uc801\uc6a9","text":""},{"location":"k8s/offline-install/003-necessary_infra_install/#ubuntu-debian","title":"Ubuntu / Debian \uacc4\uc5f4","text":"<ol> <li>.crt \ud30c\uc77c\ub4e4\uc744 <code>/usr/local/share/ca-certificates/</code> \uacbd\ub85c\ub85c \ubcf5\uc0ac\ud569\ub2c8\ub2e4.</li> <li><code>sudo update-ca-certificates</code> \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4.</li> <li><code>sudo systemctl restart containerd</code> \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4.</li> </ol>"},{"location":"k8s/offline-install/003-necessary_infra_install/#centos-rhel","title":"CentOS / RHEL \uacc4\uc5f4","text":"<ol> <li>.crt \ud30c\uc77c\ub4e4\uc744 <code>/etc/pki/ca-trust/source/anchors/</code> \uacbd\ub85c\ub85c \ubcf5\uc0ac\ud569\ub2c8\ub2e4.</li> <li><code>sudo update-ca-trust</code> \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4.</li> <li><code>sudo systemctl restart containerd</code> \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4.</li> </ol>"},{"location":"k8s/offline-install/003-necessary_infra_install/#phase-4-pc","title":"\ud83d\ude80 Phase 4: \uc811\uc18d \ud14c\uc2a4\ud2b8 (PC \uc124\uc815)","text":"<p>Harbor\ub294 \ub3c4\uba54\uc778 \uae30\ubc18\uc73c\ub85c \ub3d9\uc791\ud558\ubbc0\ub85c, \uc811\uc18d\ud558\ub824\ub294 **\ub0b4 PC(\ub610\ub294 Bastion)**\uc758 <code>hosts</code> \ud30c\uc77c\uc744 \uc218\uc815\ud574\uc57c \ub4e4\uc5b4\uac08 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <ol> <li> <p>Ingress \uc811\uc18d IP \ud655\uc778:</p> <pre><code>kubectl get ing -n harbor\n</code></pre> <ul> <li><code>ADDRESS</code> \ub780\uc5d0 IP\uac00 \ub098\uc624\uba74 \uadf8 IP\uc785\ub2c8\ub2e4.</li> <li>\ub9cc\uc57d IP\uac00 \uc548 \ub098\uc624\uba74, \uc6cc\ucee4 \ub178\ub4dc \uc911 **\uc544\ubb34 \ub178\ub4dc\uc758 IP(\uc608: 20.0.0.73)**\ub97c \uc4f0\uba74 \ub429\ub2c8\ub2e4.</li> <li>\ub178\ub4dc\uc5d0 Floating IP\uac00 \uc801\uc6a9\ub418\uc5b4\uc788\ub2e4\uba74 \ud574\ub2f9 Floating IP\ub97c \uc0ac\uc6a9\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul> </li> <li> <p>\ub0b4 PC\uc758 <code>/etc/hosts</code> (\ub610\ub294 \uc708\ub3c4\uc6b0 <code>C:\\Windows\\System32\\drivers\\etc\\hosts</code>) \uc218\uc815:</p> <pre><code># \uc608\uc2dc (\uc6cc\ucee4 \ub178\ub4dc IP\uac00 20.0.0.73 \uc774\ub77c\uace0 \uac00\uc815)\n20.0.0.73  harbor.my.domain\n</code></pre> </li> <li> <p>\uc6f9 \ube0c\ub77c\uc6b0\uc800 \uc811\uc18d:</p> <ul> <li>\uc8fc\uc18c: <code>http://harbor.my.domain</code> (\ub3c4\uba54\uc778\uc744 \ubcc0\uacbd\ud588\ub2e4\uba74 \ubcc0\uacbd\ud55c \ub3c4\uba54\uc778\uc73c\ub85c \uc811\uc18d\ud574\uc57c \ud569\ub2c8\ub2e4.)</li> <li>\uae30\ubcf8 \uacc4\uc815: <code>admin</code></li> <li>\uae30\ubcf8 \ube44\ubc88: <code>Harbor12345</code></li> </ul> </li> <li> <p>\uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc \ubc0f \ub2e4\uc6b4\ub85c\ub4dc</p> <pre><code># \ucee8\ud14c\uc774\ub108\ub514\uc5d0 \uc774\ubbf8\uc9c0 \ub4f1\ub85d\nsudo ctr -n k8s.io images import &lt;IMAGE&gt;\n\n# \ub4f1\ub85d\ub41c \uc774\ubbf8\uc9c0 \uba85 \ud655\uc778\nsudo ctr -n k8s.io images list | grep &lt;IMAGE_NAME&gt;\n\n# harbor \uacbd\ub85c\uc5d0 \ub9de\ucdb0 \uc774\ubbf8\uc9c0 \uc774\ub984 \uc218\uc815\nsudo ctr -n k8s.io images tag &lt;CTR_IMAGE_NAME&gt; harbor.my.domain/&lt;HARBOR_PROJECT&gt;/&lt;IMAGE_NAMAE&gt;\n\n# harbor\uc5d0 \ub4f1\ub85d\n# \ud604\uc7ac http \ubc29\uc2dd\uc73c\ub85c \ub744\uc5c8\uc73c\ubbc0\ub85c \uc778\uc99d\uc11c \ubd88\ud544\uc694\nsudo ctr -n k8s.io images push --plain-http -u admin:Harbor12345 harbor.my.domain/&lt;HARBOR_PROJECT&gt;/&lt;IMAGE_NAME&gt;\n\n# local \uc774\ubbf8\uc9c0 \uc0ad\uc81c\nsudo ctr -n k8s.io images remove harbor.my.domain/&lt;HARBOR_PROJECT&gt;/&lt;IMAGE_NAME&gt;\n\n# harbor \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc\nsudo ctr -n k8s.io images pull \\\n--plain-http \\\n-u admin:Harbor12345 \\\nharbor.my.domain/&lt;HARBOR_PROJECT&gt;/&lt;IMAGE_NAME&gt;\n\n# \uc774\ubbf8\uc9c0 \ud655\uc778\nsudo ctr -n k8s.io images list | grep &lt;IMAGE_NAME&gt;\n</code></pre> </li> </ol>"},{"location":"network/tip/check-domain-ip/","title":"\ub3c4\uba54\uc778(FQDN) \uc2e4\uc81c IP \ud655\uc778 \ubc29\ubc95","text":"<p>\uc0ac\ub0b4 \uc11c\ubc84 \ub3c4\uba54\uc778(URL)\uc774 \ud604\uc7ac \uc5b4\ub5a4 IP \uc8fc\uc18c\ub85c \uc5f0\uacb0(Resolve)\ub418\ub294\uc9c0 \ud655\uc778\ud558\ub294 \uc808\ucc28\uc785\ub2c8\ub2e4.</p>"},{"location":"network/tip/check-domain-ip/#a-nslookup-dns","title":"\ubc29\ubc95 A: <code>nslookup</code> (DNS \uc11c\ubc84 \uc870\ud68c)","text":"<p>DNS \uc11c\ubc84\uc5d0 \ub4f1\ub85d\ub41c \uacf5\uc2dd\uc801\uc778 IP\ub97c \ud655\uc778\ud560 \ub54c \uac00\uc7a5 \uc815\ud655\ud55c \ubc29\ubc95\uc785\ub2c8\ub2e4.</p> <pre><code># \uc0ac\uc6a9\ubc95: nslookup [\ub3c4\uba54\uc778\uc8fc\uc18c]\nnslookup harbor.internal.company.com\n\n# \ucd9c\ub825 \uc608\uc2dc\n# Address: 10.20.30.40  &lt;-- \uc774 \ubd80\ubd84\uc774 \uc2e4\uc81c IP\uc785\ub2c8\ub2e4.\n</code></pre>"},{"location":"network/tip/check-domain-ip/#b-ping","title":"\ubc29\ubc95 B: <code>ping</code> (\uac04\ub2e8 \ud655\uc778)","text":"<p>\uc5f0\uacb0 \uc0c1\ud0dc\ub97c \ud655\uc778\ud568\uacfc \ub3d9\uc2dc\uc5d0, \ud604\uc7ac \ub0b4 \uc11c\ubc84\uac00 \uc778\uc2dd\ud558\ub294 IP\ub97c \ube60\ub974\uac8c \ubcfc \ub54c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code># \uc0ac\uc6a9\ubc95: ping [\ub3c4\uba54\uc778\uc8fc\uc18c]\nping harbor.internal.company.com\n\n# \ucd9c\ub825 \uc608\uc2dc\n# PING harbor.internal.company.com (10.20.30.40) ... &lt;-- \uad04\ud638 \uc548 \uc22b\uc790\uac00 IP\n</code></pre> <p>\ucc38\uace0: \ubc29\ud654\ubcbd\uc73c\ub85c \uc778\ud574 Ping \uc751\ub2f5\uc774 \uc5c6\ub354\ub77c\ub3c4(Request timeout), \uccab \uc904\uc5d0 IP\uac00 \ub5b4\ub2e4\uba74 \ub3c4\uba54\uc778 \ud574\uc11d\uc740 \uc131\uacf5\ud55c \uac83\uc785\ub2c8\ub2e4.</p>"},{"location":"network/tip/check-domain-ip/#check-point","title":"\u2705 Check Point (\uc8fc\uc758\uc0ac\ud56d)","text":""},{"location":"network/tip/check-domain-ip/#1","title":"1. \uc0ac\ub0b4\ub9dd \uc5f0\uacb0 \ud544\uc218","text":"<ul> <li><code>internal</code> \ub4f1\uc774 \ud3ec\ud568\ub41c \uc0ac\ub0b4 \ub3c4\uba54\uc778\uc740 \uc0ac\ub0b4\ub9dd(VPN \ub4f1)\uc5d0 \uc5f0\uacb0\ub41c \uc0c1\ud0dc\uc5d0\uc11c\ub9cc \uc870\ud68c\uac00 \uac00\ub2a5\ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"network/tip/check-domain-ip/#2-l4l7-ip","title":"2. \ub85c\ub4dc \ubc38\ub7f0\uc11c(L4/L7) IP \uac00\ub2a5\uc131","text":"<ul> <li>\uc870\ud68c\ub41c IP\uac00 \uc2e4\uc81c \uc11c\ubc84\uc758 \ubb3c\ub9ac IP\uac00 \uc544\ub2c8\ub77c, \uc55e\ub2e8\uc5d0 \uc788\ub294 \ubd80\ud558 \ubd84\uc0b0 \uc7a5\ube44(VIP)\uc77c \uc218 \uc788\uc2b5\ub2c8\ub2e4.</li> <li>\ubc29\ud654\ubcbd \uc2e0\uccad \uc2dc: \ubcf4\ud1b5 \uc774 \uc870\ud68c\ub41c IP(VIP)\ub97c \ubaa9\uc801\uc9c0\ub85c \uc801\uc5b4\ub0b4\uba74 \ub429\ub2c8\ub2e4.</li> </ul>"},{"location":"network/tip/check-domain-ip/#3-etchosts","title":"3. <code>/etc/hosts</code> \ud30c\uc77c \uc6b0\uc120\uc21c\uc704 (\uc911\uc694 \u26a0\ufe0f)","text":"<ul> <li>\ub9ac\ub205\uc2a4\ub294 DNS \uc11c\ubc84\ubcf4\ub2e4 \ub0b4\ubd80 \uc124\uc815 \ud30c\uc77c(<code>/etc/hosts</code>)\uc744 \uba3c\uc800 \ucc38\uc870\ud569\ub2c8\ub2e4.</li> <li>\ub9cc\uc57d <code>nslookup</code> \uacb0\uacfc\uc640 <code>ping</code> \uacb0\uacfc\uc758 IP\uac00 \ub2e4\ub974\ub2e4\uba74, <code>/etc/hosts</code> \ud30c\uc77c\uc5d0 \uc608\uc804 IP\uac00 \ud558\ub4dc\ucf54\ub529(\uac15\uc81c \uace0\uc815)\ub418\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul> <pre><code># \ub85c\uceec \uac15\uc81c \uc124\uc815 \ud655\uc778\ncat /etc/hosts | grep harbor.internal.company.com\n</code></pre>"},{"location":"network/tip/check-network-subnet/","title":"\ud83c\udf10 \uc11c\ubc84 \ub124\ud2b8\uc6cc\ud06c \uc815\ubcf4 \ud655\uc778 \ubc0f \uac80\uc99d \uac00\uc774\ub4dc","text":""},{"location":"network/tip/check-network-subnet/#1-software-config","title":"1. \ud604\uc7ac \ub124\ud2b8\uc6cc\ud06c \uc815\ubcf4 \ud655\uc778 (Software Config)","text":""},{"location":"network/tip/check-network-subnet/#1-1-ip-subnet-mask","title":"1-1. IP \ubc0f Subnet Mask \ud655\uc778","text":"<p>\uc778\ud130\ud398\uc774\uc2a4 \uc774\ub984(\uc608: <code>eno1</code>)\uc744 \uc54c\uace0 \uc788\uc744 \ub54c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code># \uba85\ub839\uc5b4\nip -4 addr show eno1\n\n# \ucd9c\ub825 \uc608\uc2dc\n# 2: eno1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 ...\n#     inet 10.10.10.60/24 brd 10.10.10.255 scope global eno1\n</code></pre> <ul> <li>\ubd84\uc11d: <code>inet</code> \ub4a4\uc5d0 \uc788\ub294 <code>/24</code>\uac00 \uc11c\ube0c\ub137 \ub9c8\uc2a4\ud06c(CIDR)\uc785\ub2c8\ub2e4.</li> <li>\ud574\uc11d: <code>/24</code>\ub294 <code>255.255.255.0</code>\uc744 \uc758\ubbf8\ud569\ub2c8\ub2e4. (\uc544\ub798 4\ubc88 \ucc38\uc870\ud45c \ud655\uc778)</li> </ul>"},{"location":"network/tip/check-network-subnet/#1-2-gateway","title":"1-2. Gateway \ud655\uc778","text":"<p>\uc678\ubd80 \ub124\ud2b8\uc6cc\ud06c\uc640 \ud1b5\uc2e0\ud558\uae30 \uc704\ud55c \uad00\ubb38(Gateway) \uc8fc\uc18c\ub97c \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code># \uba85\ub839\uc5b4\nip route | grep default\n\n# \ucd9c\ub825 \uc608\uc2dc\n# default via 10.10.10.1 dev eno1 proto static\n</code></pre> <ul> <li>\ubd84\uc11d: <code>default via</code> \ub4a4\uc5d0 \uc624\ub294 IP(<code>10.10.10.1</code>)\uac00 \uac8c\uc774\ud2b8\uc6e8\uc774 \uc8fc\uc18c\uc785\ub2c8\ub2e4.</li> </ul>"},{"location":"network/tip/check-network-subnet/#2-physical-layer","title":"2. \ubb3c\ub9ac \ud3ec\ud2b8 \uc0c1\ud0dc \ubc0f \uc5f0\uacb0 \ud655\uc778 (Physical Layer)","text":"<p>\uc18c\ud504\ud2b8\uc6e8\uc5b4 \uc124\uc815\uc774 \ub9de\uc544\ub3c4, \uc2e4\uc81c \ub79c\uc120\uc774 \uaf42\ud600\uc788\ub294\uc9c0(Link UP) \ud655\uc778\ud574\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"network/tip/check-network-subnet/#2-1","title":"2-1. \ubb3c\ub9ac \ud3ec\ud2b8 \uc704\uce58 \ud655\uc778","text":"<p>\uc6d0\ud558\ub294 \uc778\ud130\ud398\uc774\uc2a4 \uc774\ub984\uc744 \ub123\uace0 \uc2e4\ud589\ud558\uba74 \uc2e4\uc81c \uc11c\ubc84\uc5d0\uc11c \uc810\ub4f1\ub429\ub2c8\ub2e4.</p> <pre><code># \ubb34\ud55c\uc815 \uae5c\ube61\uc774\uae30 (\uba48\ucd94\ub824\uba74 Ctrl+C)\nsudo ethtool -p eno1\n\n# 20\ucd08 \ub3d9\uc548\ub9cc \uae5c\ube61\uc774\uae30 (\ud63c\uc790 \uc791\uc5c5\ud560 \ub54c \uc720\uc6a9)\nsudo ethtool -p eno1 20\n</code></pre>"},{"location":"network/tip/check-network-subnet/#2-2-ip-link","title":"2-2. \ud3ec\ud2b8 \uc0ac\uc6a9 \uc5ec\ubd80 \ud310\ubcc4 (<code>ip link</code>)","text":"<p>\ub79c\uc120\uc774 \uaf42\ud600\uc11c \uc2e0\ud638\uac00 \ub4e4\uc5b4\uc624\ub294\uc9c0, \ube44\uc5b4\uc788\ub294 \ud3ec\ud2b8\uc778\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code># \uba85\ub839\uc5b4\nip link show eno1\n\n# [\uc0c1\ud669 A] \uc5f0\uacb0\ub428 (\uc0ac\uc6a9 \uc911)\n# &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; ...\n</code></pre> <ul> <li><code>UP</code>: OS\uc5d0\uc11c \uc7a5\uce58\ub97c \ucf30\ub2e4\ub294 \ub73b (\uc18c\ud504\ud2b8\uc6e8\uc5b4 \uc0c1\ud0dc).</li> <li><code>LOWER_UP</code>: \ub79c\uc120\uc774 \ubb3c\ub9ac\uc801\uc73c\ub85c \uc5f0\uacb0\ub418\uc5b4 \uc2e0\ud638\uac00 \uc7a1\ud798 (\ud575\uc2ec).</li> </ul> <pre><code># [\uc0c1\ud669 B] \uc5f0\uacb0 \uc548 \ub428 (\ube44\uc5b4 \uc788\uc74c)\n# &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; ... state DOWN ...\n</code></pre> <ul> <li><code>NO-CARRIER</code>: \ub79c\uc120\uc774 \ubf51\ud600 \uc788\uac70\ub098, \ubc18\ub300\ud3b8 \uc2a4\uc704\uce58\uac00 \uaebc\uc838 \uc788\uc74c.</li> <li>\ud65c\uc6a9: \ube44\uc5b4\uc788\ub294 \ud3ec\ud2b8\ub97c \ucc3e\uc73c\ub824\uba74 <code>NO-CARRIER</code> \uc0c1\ud0dc\uc778 \uc778\ud130\ud398\uc774\uc2a4\ub97c \ucc3e\uc73c\uc138\uc694.</li> </ul>"},{"location":"network/tip/check-network-subnet/#2-3-ethtool","title":"2-3. \ud558\ub4dc\uc6e8\uc5b4 \uc2a4\ud399 \uc0c1\uc138 \ud655\uc778 (<code>ethtool</code>)","text":"<p>\ud3ec\ud2b8 \uc18d\ub3c4(1G/10G)\uc640 \ubb3c\ub9ac\uc801 \ub9c1\ud06c \uac10\uc9c0 \uc5ec\ubd80\ub97c \uc815\ubc00\ud558\uac8c \ubd05\ub2c8\ub2e4.</p> <pre><code># \uba85\ub839\uc5b4\nsudo ethtool eno1 | grep -E \"Speed|Link detected\"\n\n# \ucd9c\ub825 \uc608\uc2dc\n# Speed: 1000Mb/s         &lt;-- 1\uae30\uac00 \ud3ec\ud2b8\n# Link detected: yes      &lt;-- \ubb3c\ub9ac \uc5f0\uacb0\ub428 (no\ub77c\uba74 \uc120 \ube60\uc9d0)\n</code></pre>"},{"location":"network/tip/check-network-subnet/#3-connectivity-check","title":"3. \uc5f0\uacb0 \uc0c1\ud0dc \ucd5c\uc885 \uac80\uc99d (Connectivity Check)","text":"<p>\uc124\uc815\uacfc \ubb3c\ub9ac \uc5f0\uacb0\uc774 \ubaa8\ub450 \uc815\uc0c1\uc774\ub77c\uba74, \uc2e4\uc81c\ub85c \ud1b5\uc2e0\uc774 \ub418\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"network/tip/check-network-subnet/#3-1-gateway","title":"3-1. Gateway \ud1b5\uc2e0 \ud655\uc778 (\ub0b4\ubd80\ub9dd)","text":"<p>\ub0b4 \uc11c\ubc84\uac00 \uac8c\uc774\ud2b8\uc6e8\uc774\uae4c\uc9c0 \ub3c4\ub2ec\ud558\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>ping -c 3 10.10.10.1\n</code></pre> <ul> <li>\uc131\uacf5: <code>0% packet loss</code></li> </ul>"},{"location":"network/tip/check-network-subnet/#3-2","title":"3-2. \uc678\ubd80 \uc778\ud130\ub137 \uc5f0\uacb0 \ud655\uc778","text":"<p>\uc678\ubd80\ub9dd \ud1b5\uc2e0\uc774 \ud544\uc694\ud55c \uacbd\uc6b0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>ping -c 3 8.8.8.8\n</code></pre>"},{"location":"network/tip/check-network-subnet/#3-3-dns","title":"3-3. DNS \uc124\uc815 \ud655\uc778","text":"<p>\uc778\ud130\ub137\uc740 \ub418\ub294\ub370 \ub3c4\uba54\uc778(<code>google.com</code>)\uc73c\ub85c \uc811\uc18d\uc774 \uc548 \ub420 \ub54c \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>resolvectl status | grep \"DNS Servers\"\n# \ub610\ub294\ncat /etc/resolv.conf\n</code></pre>"},{"location":"network/tip/check-network-subnet/#4-cidr-subnet-mask-reference","title":"4. [\ucc38\uace0] CIDR \ud45c\uae30\ubc95 \ub300\uc870\ud45c (Subnet Mask Reference)","text":"<p><code>ipmitool</code> \uc785\ub825 \uc2dc <code>/24</code> \uac19\uc740 \ub2e8\ucd95 \ud45c\ud604 \ub300\uc2e0 <code>255.255.255.0</code> \ud615\uc2dd\uc774 \ud544\uc694\ud560 \ub54c \ucc38\uace0\ud569\ub2c8\ub2e4.</p> CIDR (Prefix) Subnet Mask (Dotted Decimal) \ube44\uace0 /8 <code>255.0.0.0</code> A Class /16 <code>255.255.0.0</code> B Class /24 <code>255.255.255.0</code> \ud45c\uc900 (\uac00\uc7a5 \ud754\ud568) /25 <code>255.255.255.128</code> IP 128\uac1c \ucabc\uac1c\uae30 /26 <code>255.255.255.192</code> IP 64\uac1c \ucabc\uac1c\uae30 /27 <code>255.255.255.224</code> IP 32\uac1c \ucabc\uac1c\uae30 /28 <code>255.255.255.240</code> IP 16\uac1c \ucabc\uac1c\uae30 /29 <code>255.255.255.248</code> IP 8\uac1c (\uc18c\uaddc\ubaa8) /30 <code>255.255.255.252</code> P2P \uc5f0\uacb0\uc6a9 (IP 4\uac1c) /32 <code>255.255.255.255</code> \ub2e8\uc77c \ud638\uc2a4\ud2b8 (IP 1\uac1c)"},{"location":"openstack/cheatsheet/","title":"\ud83d\udcd8 OpenStack CLI \uce58\ud2b8\uc2dc\ud2b8 (Cheat Sheet)","text":"<p>OpenStack \uc6b4\uc601 \ubc0f \uad00\ub9ac\ub97c \uc704\ud55c \ud544\uc218 \uba85\ub839\uc5b4 \ubaa8\uc74c\uc785\ub2c8\ub2e4.</p> <p>\ubc94\ub840:</p> <ul> <li><code>&lt;\uac12&gt;</code> : \ud544\uc218 \uc785\ub825 \uac12 (\uc608: ID, \uc774\ub984)</li> <li><code>[\uc635\uc158]</code> : \uc120\ud0dd \uc785\ub825 \uac12</li> </ul>"},{"location":"openstack/cheatsheet/#0","title":"0. \ud658\uacbd \uc124\uc815 (\ud544\uc218)","text":"<p>\uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud558\uae30 \uc804, \ubc18\ub4dc\uc2dc \uc778\uc99d \uc815\ubcf4\ub97c \ub85c\ub4dc\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># \uc778\uc99d \ud30c\uc77c \ub85c\ub4dc\nsource admin-openrc.sh\n\n# \ud1a0\ud070 \uc798 \ubc1b\uc544\uc84c\ub294\uc9c0 \ud655\uc778\nopenstack token issue\n</code></pre>"},{"location":"openstack/cheatsheet/#1-server","title":"1. \uc778\uc2a4\ud134\uc2a4 (Server) \uad00\ub9ac","text":"<p>\uac00\uc0c1\uba38\uc2e0(VM)\uc758 \uc0dd\uba85\uc8fc\uae30\ub97c \uad00\ub9ac\ud569\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \uc124\uba85 \ubaa9\ub85d \uc870\ud68c <code>openstack server list --all-projects</code> \ubaa8\ub4e0 \ud504\ub85c\uc81d\ud2b8\uc758 VM \ubaa9\ub85d \uc870\ud68c \uc0c1\uc138 \uc870\ud68c <code>openstack server show &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt;</code> \ud2b9\uc815 VM\uc758 \uc0c1\uc138 \uc815\ubcf4(IP, \ud638\uc2a4\ud2b8, \uc0c1\ud0dc) \uc870\ud68c \ub85c\uadf8 \ud655\uc778 <code>openstack console log show &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt;</code> \ubd80\ud305 \ub85c\uadf8(Console Log) \ud655\uc778 (\ub514\ubc84\uae45\uc6a9) \ucf58\uc194 URL <code>openstack console url show &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt;</code> \uc6f9 VNC \uc811\uc18d \uc8fc\uc18c \ud655\uc778 \uc0dd\uc131 <code>openstack server create --image &lt;\uc774\ubbf8\uc9c0&gt; --flavor &lt;\ud50c\ub808\uc774\ubc84&gt; --network &lt;\ub124\ud2b8\uc6cc\ud06c&gt; &lt;VM\uc774\ub984&gt;</code> \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 \uc0ad\uc81c <code>openstack server delete &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt;</code> \uc778\uc2a4\ud134\uc2a4 \uc0ad\uc81c"},{"location":"openstack/cheatsheet/#_1","title":"\u26a1 \uc804\uc6d0 \uad00\ub9ac (\uc911\uc694)","text":"<pre><code># \ubd80\ub4dc\ub7ec\uc6b4 \uc7ac\ubd80\ud305 (OS \ub808\ubca8 \uc7ac\ubd80\ud305)\nopenstack server reboot &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt;\n\n# \uac15\uc81c \uc7ac\ubd80\ud305 (\uc804\uc6d0 \uaed0\ub2e4 \ucf1c\uae30 - GPU \uc624\ub958 \uc2dc \ud544\uc218)\nopenstack server reboot --hard &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt;\n\n# \uc778\uc2a4\ud134\uc2a4 \uc77c\uc2dc \uc815\uc9c0 \ud574\uc81c (Paused \uc0c1\ud0dc \ud480\uae30)\nopenstack server unpause &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt;\n</code></pre>"},{"location":"openstack/cheatsheet/#2-image","title":"2. \uc774\ubbf8\uc9c0 (Image) \uad00\ub9ac","text":"<p>Glance \uc11c\ube44\uc2a4 \uad00\ub828 \uba85\ub839\uc5b4\uc785\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \ubaa9\ub85d \uc870\ud68c <code>openstack image list</code> \uc0c1\uc138 \uc870\ud68c <code>openstack image show &lt;\uc774\ubbf8\uc9c0_ID&gt;</code> \uc774\ubbf8\uc9c0 \ub4f1\ub85d <code>openstack image create \"&lt;\uc774\ub984&gt;\" --file &lt;\ud30c\uc77c\uacbd\ub85c&gt; --disk-format qcow2 --container-format bare --public</code> \uc18d\uc131 \uc218\uc815 <code>openstack image set --property &lt;\ud0a4&gt;=&lt;\uac12&gt; &lt;\uc774\ubbf8\uc9c0_ID&gt;</code> \uc0ad\uc81c <code>openstack image delete &lt;\uc774\ubbf8\uc9c0_ID&gt;</code>"},{"location":"openstack/cheatsheet/#gpu","title":"\ud83d\udd27 GPU/\uac00\uc0c1\ud654 \uad00\ub828 \uc18d\uc131 \uc124\uc815 (\ud544\uc218)","text":"<pre><code># \uba38\uc2e0 \ud0c0\uc785 Q35 \uc124\uc815 (PCIe Passthrough \ud544\uc218)\nopenstack image set --property hw_machine_type=q35 &lt;\uc774\ubbf8\uc9c0_ID&gt;\n\n# \ud558\uc774\ud37c\ubc14\uc774\uc800 \uc228\uae30\uae30 (RTX \uacc4\uc5f4 \ud544\uc218)\nopenstack image set --property hw:kvm_hidden=true &lt;\uc774\ubbf8\uc9c0_ID&gt;\n\n# Guest Agent \ud65c\uc131\ud654 (IP \ud655\uc778\uc6a9)\nopenstack image set --property hw_qemu_guest_agent=yes &lt;\uc774\ubbf8\uc9c0_ID&gt;\n</code></pre>"},{"location":"openstack/cheatsheet/#3-flavor","title":"3. \ud50c\ub808\uc774\ubc84 (Flavor) \uad00\ub9ac","text":"<p>\uc778\uc2a4\ud134\uc2a4\uc758 \uc0ac\uc591(CPU, RAM, Disk)\uc744 \uc815\uc758\ud569\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \ubaa9\ub85d \uc870\ud68c <code>openstack flavor list</code> \uc0dd\uc131 <code>openstack flavor create --ram &lt;MB&gt; --disk &lt;GB&gt; --vcpus &lt;\uac1c\uc218&gt; &lt;\ud50c\ub808\uc774\ubc84_\uc774\ub984&gt;</code> \uc0ad\uc81c <code>openstack flavor delete &lt;\ud50c\ub808\uc774\ubc84_ID&gt;</code>"},{"location":"openstack/cheatsheet/#extra-specs","title":"\ud83d\udd27 \ud50c\ub808\uc774\ubc84 \uc18d\uc131 (Extra Specs)","text":"<pre><code># \uc18d\uc131 \uc124\uc815 (GPU\uc6a9)\nopenstack flavor set --property hw:pci_numa_affinity_policy=required &lt;\ud50c\ub808\uc774\ubc84_ID&gt;\n\n# \uc18d\uc131 \ud655\uc778\nopenstack flavor show &lt;\ud50c\ub808\uc774\ubc84_ID&gt;\n</code></pre>"},{"location":"openstack/cheatsheet/#4-network","title":"4. \ub124\ud2b8\uc6cc\ud06c (Network) \uad00\ub9ac","text":"<p>Neutron \uc11c\ube44\uc2a4 \uad00\ub828 \uba85\ub839\uc5b4\uc785\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \uc124\uba85 \ub124\ud2b8\uc6cc\ud06c \ubaa9\ub85d <code>openstack network list</code> \ub0b4\ubd80/\uc678\ubd80 \ub124\ud2b8\uc6cc\ud06c \ubaa9\ub85d \uc11c\ube0c\ub137 \ubaa9\ub85d <code>openstack subnet list</code> IP \ub300\uc5ed \ud655\uc778 \ubcf4\uc548\uadf8\ub8f9 \ubaa9\ub85d <code>openstack security group list</code> \ubc29\ud654\ubcbd \uadf8\ub8f9 \ud655\uc778 \uaddc\uce59 \ucd94\uac00 <code>openstack security group rule create --proto tcp --dst-port &lt;\ud3ec\ud2b8&gt; &lt;\uadf8\ub8f9ID&gt;</code> \ud3ec\ud2b8 \uac1c\ubc29 (\uc608: 22, 80)"},{"location":"openstack/cheatsheet/#floating-ip-ip","title":"\ud83c\udf10 Floating IP (\uacf5\uc778 IP)","text":"<pre><code># Floating IP \ubaa9\ub85d \uc870\ud68c\nopenstack floating ip list\n\n# \uc0c8 IP \uc0dd\uc131 (\ud560\ub2f9)\nopenstack floating ip create &lt;\uc678\ubd80_\ub124\ud2b8\uc6cc\ud06c_\uc774\ub984&gt;\n\n# \uc778\uc2a4\ud134\uc2a4\uc5d0 \uc5f0\uacb0\nopenstack server add floating ip &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt; &lt;IP\uc8fc\uc18c&gt;\n</code></pre>"},{"location":"openstack/cheatsheet/#5-admin","title":"5. \uc2dc\uc2a4\ud15c \ubc0f \ud558\uc774\ud37c\ubc14\uc774\uc800 \uad00\ub9ac (Admin \uc804\uc6a9)","text":"<p>\uc6b4\uc601\uc790(Operator)\uac00 \ud074\ub7ec\uc2a4\ud130 \uc0c1\ud0dc\ub97c \uc810\uac80\ud560 \ub54c \uc501\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \uc124\uba85 \ud558\uc774\ud37c\ubc14\uc774\uc800 \uc0c1\ud0dc <code>openstack hypervisor list</code> \uac01 \ub178\ub4dc\uc758 UP/DOWN \uc0c1\ud0dc \ud655\uc778 \ucef4\ud4e8\ud2b8 \uc11c\ube44\uc2a4 <code>openstack compute service list</code> nova-compute \uc11c\ube44\uc2a4 \uc0c1\ud0dc \ud655\uc778 \uc790\uc6d0 \uc0ac\uc6a9\ub7c9 <code>openstack hypervisor stats show</code> \uc804\uccb4 \ud074\ub7ec\uc2a4\ud130 \uc790\uc6d0 \ud1b5\uacc4 \ub178\ub4dc \uc0c1\uc138 \uc815\ubcf4 <code>openstack hypervisor show &lt;\ud638\uc2a4\ud2b8\uba85&gt;</code> \ud2b9\uc815 \ub178\ub4dc\uc758 CPU/RAM \uc0c1\uc138 \uc2a4\ud399"},{"location":"openstack/cheatsheet/#6-volume","title":"6. \ubcfc\ub968 (Volume) \uad00\ub9ac","text":"<p>Cinder \uc11c\ube44\uc2a4 \uad00\ub828 \uba85\ub839\uc5b4\uc785\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \ubaa9\ub85d \uc870\ud68c <code>openstack volume list</code> \uc0dd\uc131 <code>openstack volume create --size &lt;GB&gt; &lt;\ubcfc\ub968\uc774\ub984&gt;</code> \uc5f0\uacb0 <code>openstack server add volume &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt; &lt;\ubcfc\ub968_ID&gt;</code> \ud574\uc81c <code>openstack server remove volume &lt;\uc778\uc2a4\ud134\uc2a4_ID&gt; &lt;\ubcfc\ub968_ID&gt;</code>"},{"location":"openstack/cheatsheet/#7-placement-resource","title":"7. Placement (Resource) \uad00\ub9ac","text":"<p>Placement \uc11c\ube44\uc2a4 \uad00\ub828 \uba85\ub839\uc5b4\ub85c, \ubb3c\ub9ac \ub178\ub4dc \ubc0f GPU \uac19\uc740 \ud2b9\uc218 \uc790\uc6d0\uc758 \uc7ac\uace0(Inventory)\uc640 \ud560\ub2f9(Allocation) \uc0c1\ud0dc\ub97c \ud655\uc778\ud569\ub2c8\ub2e4.</p> \uc791\uc5c5 \uba85\ub839\uc5b4 \uc124\uba85 RP \ubaa9\ub85d \uc870\ud68c <code>openstack resource provider list</code> \ub4f1\ub85d\ub41c \ubaa8\ub4e0 \uc790\uc6d0 \uc81c\uacf5\uc790(Compute Node, GPU \ub4f1) \ubaa9\ub85d \uc7ac\uace0(Inventory) \ud655\uc778 <code>openstack resource provider inventory list &lt;RP_UUID&gt;</code> \ud2b9\uc815 \ub178\ub4dc\uc758 CPU, RAM, GPU \ucd1d\ub7c9 \ubc0f \uc5ec\uc720\ubd84 \uc870\ud68c \uc0ac\uc6a9\ub7c9(Usage) \ud655\uc778 <code>openstack resource provider usage show &lt;RP_UUID&gt;</code> \ud2b9\uc815 \ub178\ub4dc\uc758 \uc790\uc6d0\ubcc4 \uc2e4\uc81c \uc0ac\uc6a9\ub7c9 \uc870\ud68c \ud560\ub2f9(Allocation) \ud655\uc778 <code>openstack resource provider allocation show &lt;RP_UUID&gt;</code> \uc5b4\ub5a4 \uc778\uc2a4\ud134\uc2a4\uac00 \uc774 \ub178\ub4dc\uc758 \uc790\uc6d0\uc744 \uc810\uc720 \uc911\uc778\uc9c0 \ud655\uc778 \ud2b8\ub808\uc774\ud2b8(Trait) \uc870\ud68c <code>openstack resource provider trait list &lt;RP_UUID&gt;</code> \ub178\ub4dc\uc758 \ud2b9\uc131 \ud0dc\uadf8(\uc608: <code>HW_CPU_X86_AVX512</code>) \uc870\ud68c \uc774\ub984 \ubcc0\uacbd <code>openstack resource provider set --name &lt;\uc0c8\uc774\ub984&gt; &lt;RP_UUID&gt;</code> \ub9ac\uc18c\uc2a4 \ud504\ub85c\ubc14\uc774\ub354 \uc774\ub984 \ubcc0\uacbd RP \uc0ad\uc81c <code>openstack resource provider delete &lt;RP_UUID&gt;</code> (\uc8fc\uc758) \uc790\uc6d0 \uc81c\uacf5\uc790 \uc0ad\uc81c (\uc880\ube44 \ub808\ucf54\ub4dc \uc815\ub9ac \uc2dc \uc0ac\uc6a9)"},{"location":"openstack/cheatsheet/#allocation-candidates","title":"\ud83d\udd0d \uc790\uc6d0 \uc2a4\ucf00\uc904\ub9c1 \ub514\ubc84\uae45 (Allocation Candidates)","text":"<p>\"\ub0b4 VM\uc774 \uc65c \uc0dd\uc131\uc774 \uc548 \ub418\uc9c0? (No Valid Host)\" \uc5d0\ub7ec\uac00 \ub0a0 \ub54c, \uc2a4\ucf00\uc904\ub7ec \uc785\uc7a5\uc5d0\uc11c **\"\ubc30\ud3ec \uac00\ub2a5\ud55c \ud6c4\ubcf4\uc9c0\"**\uac00 \uc788\ub294\uc9c0 \ubbf8\ub9ac \uc870\ud68c\ud574\ubcf4\ub294 \uba85\ub839\uc5b4\uc785\ub2c8\ub2e4.</p> <pre><code># \uc2a4\ud399\uc5d0 \ub9de\ub294 \ud6c4\ubcf4 \ud638\uc2a4\ud2b8 \uc870\ud68c (\uc608: CPU 1\uac1c, \uba54\ubaa8\ub9ac 512MB)\nopenstack allocation candidate list --resource VCPU=1 --resource MEMORY_MB=512\n\n# GPU\uac00 \ud3ec\ud568\ub41c \ud6c4\ubcf4 \ud638\uc2a4\ud2b8 \uc870\ud68c (\uc608: GPU 1\uac1c \ud544\uc694)\n# (\uc0ac\uc6a9\uc790 \ud658\uacbd\uc5d0 \ub530\ub77c \ud074\ub798\uc2a4 \uc774\ub984\uc774 VGPU \ub610\ub294 PCI_DEVICE \ub4f1\uc73c\ub85c \ub2e4\ub97c \uc218 \uc788\uc74c)\nopenstack allocation candidate list --resource VCPU=4 --resource CUSTOM_GPU_RTX3060=1\n</code></pre>"},{"location":"openstack/cheatsheet/#resource-class","title":"\ud83d\udca1 Resource Class (\uc790\uc6d0 \ud074\ub798\uc2a4) \ucc38\uace0","text":"<p>\uba85\ub839\uc5b4 \uc0ac\uc6a9 \uc2dc \uc790\uc8fc \ubcf4\uc774\ub294 \uc790\uc6d0 \uc774\ub984(Class)\ub4e4\uc785\ub2c8\ub2e4.</p> <ul> <li><code>VCPU</code>: \uac00\uc0c1 CPU \ucf54\uc5b4 \uc218</li> <li><code>MEMORY_MB</code>: \uba54\ubaa8\ub9ac \uc6a9\ub7c9 (MB)</li> <li><code>DISK_GB</code>: \ub85c\uceec \ub514\uc2a4\ud06c \uc6a9\ub7c9 (GB)</li> <li><code>PCI_DEVICE</code> \ub610\ub294 <code>CUSTOM_...</code>: GPU \uac19\uc740 \ud2b9\uc218 \uc7a5\uce58</li> </ul> <p>\uc608\uc2dc: \ud2b9\uc815 \ucef4\ud4e8\ud2b8 \ub178\ub4dc(<code>openstack22</code>)\uc758 GPU \uc7ac\uace0 \ud655\uc778\ud558\uae30</p> <pre><code># 1. \ubaa9\ub85d\uc5d0\uc11c openstack22\uc758 UUID \ucc3e\uae30\nopenstack resource provider list --name openstack22\n\n# 2. \ud574\ub2f9 UUID\ub85c \uc7ac\uace0 \ud655\uc778 (GPU \uac1c\uc218 \ud655\uc778\uc6a9)\nopenstack resource provider inventory list &lt;openstack22_UUID&gt;\n</code></pre>"},{"location":"openstack/cheatsheet/#_2","title":"\ud83d\udca1 \ud301: \ucd9c\ub825 \ud3ec\ub9f7 \uc608\uc058\uac8c \ubcf4\uae30","text":"<p>\uba85\ub839\uc5b4 \ub4a4\uc5d0 <code>-c</code> (\uceec\ub7fc \uc120\ud0dd)\uc640 <code>-f</code> (\ud3ec\ub9f7) \uc635\uc158\uc744 \uc4f0\uba74 \ud544\uc694\ud55c \uc815\ubcf4\ub9cc \uae54\ub054\ud558\uac8c \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code># ID\uc640 \uc774\ub984, \uc0c1\ud0dc\ub9cc \ubcf4\uace0 \uc2f6\uc744 \ub54c (\ud14c\uc774\ube14 \ud615\uc2dd)\nopenstack server list -c ID -c Name -c Status\n\n# \uac12\ub9cc \ubf51\uc544\uc11c \uc2a4\ud06c\ub9bd\ud2b8\uc5d0 \uc4f0\uace0 \uc2f6\uc744 \ub54c (Value \ud615\uc2dd)\nopenstack server show &lt;ID&gt; -c status -f value\n</code></pre>"},{"location":"openstack/base/api/","title":"Openstack API Basic","text":""},{"location":"openstack/base/api/#1-url","title":"1. \ubca0\uc774\uc2a4 URL \ud655\uc778 (\uc804\uc81c \uc870\uac74)","text":"<p>\uba3c\uc800 \uac01 \uc11c\ube44\uc2a4\uc758 \ud3ec\ud2b8\uc640 \uc8fc\uc18c\ub97c \uc54c\uc544\uc57c \ud569\ub2c8\ub2e4. (\ubcf4\ud1b5 <code>cstation</code> \ub178\ub4dc IP)</p> <ul> <li>Keystone (Identity): <code>http://&lt;IP&gt;:5000/v3</code></li> <li>Neutron (Network): <code>http://&lt;IP&gt;:9696</code></li> <li>Nova (Compute): <code>http://&lt;IP&gt;:8774/v2.1</code></li> <li>Glance (Image): <code>http://&lt;IP&gt;:9292</code></li> <li>Placement: <code>http://&lt;IP&gt;:8778</code></li> </ul>"},{"location":"openstack/base/api/#2-api","title":"2. \ud575\uc2ec \uc11c\ube44\uc2a4 \uc870\ud68c API \ubaa9\ub85d","text":""},{"location":"openstack/base/api/#neutron-vpc-subnet","title":"\ud83c\udf10 \ub124\ud2b8\uc6cc\ud06c (Neutron) - VPC, Subnet \uad00\ub828","text":"<p>\uac00\uc7a5 \uad81\uae08\ud574\ud558\uc2dc\ub294 \ubd80\ubd84\uc785\ub2c8\ub2e4. \ubca0\uc774\uc2a4 URL(<code>:9696</code>) \ub4a4\uc5d0 \ubd99\uc2b5\ub2c8\ub2e4.</p> \ub9ac\uc18c\uc2a4 API \uacbd\ub85c (URI) \uc124\uba85 (AWS \ub300\uc751) Network <code>GET /v2.0/networks</code> VPC \uc804\uccb4 \ubaa9\ub85d \uc870\ud68c Subnet <code>GET /v2.0/subnets</code> \uc11c\ube0c\ub137 \uc804\uccb4 \ubaa9\ub85d \uc870\ud68c Router <code>GET /v2.0/routers</code> \ub77c\uc6b0\ud130(Gateway) \ubaa9\ub85d \uc870\ud68c Port <code>GET /v2.0/ports</code> \uc778\ud130\ud398\uc774\uc2a4(ENI) \ubaa9\ub85d \uc870\ud68c Sec Group <code>GET /v2.0/security-groups</code> \ubcf4\uc548 \uadf8\ub8f9 \ubaa9\ub85d \uc870\ud68c Floating IP <code>GET /v2.0/floatingips</code> \uacf5\uc778 IP \ubaa9\ub85d \uc870\ud68c"},{"location":"openstack/base/api/#nova-","title":"\ud83d\udcbb \ucef4\ud4e8\ud2b8 (Nova) - \uc778\uc2a4\ud134\uc2a4, \ud558\uc774\ud37c\ubc14\uc774\uc800","text":"<p>\ubca0\uc774\uc2a4 URL(<code>:8774/v2.1</code>) \ub4a4\uc5d0 \ubd99\uc2b5\ub2c8\ub2e4.</p> \ub9ac\uc18c\uc2a4 API \uacbd\ub85c (URI) \uc124\uba85 Server <code>GET /servers/detail</code> \uc778\uc2a4\ud134\uc2a4(VM) \uc804\uccb4 \uc0c1\uc138 \uc870\ud68c Flavor <code>GET /flavors/detail</code> \uc778\uc2a4\ud134\uc2a4 \ud0c0\uc785(\uc2a4\ud399) \uc870\ud68c Hypervisor <code>GET /os-hypervisors/detail</code> \ubb3c\ub9ac \ub178\ub4dc(Compute Node) \uc0c1\ud0dc \uc870\ud68c Usage <code>GET /os-simple-tenant-usage</code> \ud504\ub85c\uc81d\ud2b8\ubcc4 \uc790\uc6d0 \uc0ac\uc6a9\ub7c9 \uc870\ud68c"},{"location":"openstack/base/api/#glance","title":"\ud83d\udcbf \uc774\ubbf8\uc9c0 (Glance)","text":"<p>\ubca0\uc774\uc2a4 URL(<code>:9292</code>) \ub4a4\uc5d0 \ubd99\uc2b5\ub2c8\ub2e4.</p> \ub9ac\uc18c\uc2a4 API \uacbd\ub85c (URI) \uc124\uba85 Image <code>GET /v2/images</code> \uc774\ubbf8\uc9c0(AMI) \ubaa9\ub85d \uc870\ud68c"},{"location":"openstack/base/api/#placement-gpu","title":"\ud83d\udd11 \uc790\uc6d0 \uad00\ub9ac (Placement) - GPU \ub514\ubc84\uae45\uc6a9","text":"<p>\ubca0\uc774\uc2a4 URL(<code>:8778</code>) \ub4a4\uc5d0 \ubd99\uc2b5\ub2c8\ub2e4.</p> \ub9ac\uc18c\uc2a4 API \uacbd\ub85c (URI) \uc124\uba85 Res Provider <code>GET /resource_providers</code> \uc790\uc6d0 \uc81c\uacf5\uc790(Compute Node) \ubaa9\ub85d Inventory <code>GET /resource_providers/{uuid}/inventories</code> \ud2b9\uc815 \ub178\ub4dc\uc758 \uc790\uc6d0(GPU, vCPU) \uc7ac\uace0 Usage <code>GET /resource_providers/{uuid}/usages</code> \ud2b9\uc815 \ub178\ub4dc\uc758 \uc790\uc6d0 \uc0ac\uc6a9\ub7c9"},{"location":"openstack/base/api/#curl","title":"\ud83d\ude80 <code>curl</code>\ub85c \uc870\ud68c\ud558\uae30 (\uc608\uc2dc)","text":"<p>CLI\uc5d0\uc11c \ud1a0\ud070\uc744 \ubf51\uc544\uc11c \ubc14\ub85c <code>curl</code>\ub85c \ub0a0\ub9ac\ub294 \uc2a4\ud06c\ub9bd\ud2b8\uc785\ub2c8\ub2e4.</p> <p>1. \ud658\uacbd\ubcc0\uc218 \uc138\ud305 (Controller Node\uc5d0\uc11c):</p> <pre><code># \uad00\ub9ac\uc790 \ud1a0\ud070 \ucd94\ucd9c\nexport OS_TOKEN=$(openstack token issue -f value -c id)\n\n# Neutron(\ub124\ud2b8\uc6cc\ud06c) URL \ucd94\ucd9c\nexport NET_URL=$(openstack endpoint list --service network --interface public -f value -c URL)\n</code></pre> <p>2. API \ud638\ucd9c \ud14c\uc2a4\ud2b8:</p> <pre><code># 1. VPC (Network) \uc804\uccb4 \uc870\ud68c\ncurl -s -X GET \"$NET_URL/v2.0/networks\" -H \"X-Auth-Token: $OS_TOKEN\" | python3 -m json.tool\n\n# 2. Subnet \uc804\uccb4 \uc870\ud68c\ncurl -s -X GET \"$NET_URL/v2.0/subnets\" -H \"X-Auth-Token: $OS_TOKEN\" | python3 -m json.tool\n\n# 3. Router \uc804\uccb4 \uc870\ud68c\ncurl -s -X GET \"$NET_URL/v2.0/routers\" -H \"X-Auth-Token: $OS_TOKEN\" | python3 -m json.tool\n</code></pre> <p>\uc774 \uc8fc\uc18c\ub4e4\ub85c \ud638\ucd9c\ud588\uc744 \ub54c \uc751\ub2f5\uc774 \uc798 \uc624\uba74 \ubc31\uc5d4\ub4dc\ub294 \uac74\uac15\ud55c \uac83\uc785\ub2c8\ub2e4. Horizon \uc5d0\ub7ec\ub294 \uc544\uae4c \uc870\uce58(Memoized Patch)\ub85c \ud574\uacb0\ub418\uc5c8\uc744 \ud14c\ub2c8, API\ub3c4 \uc815\uc0c1\uc801\uc73c\ub85c \ub098\uc62c \uac81\ub2c8\ub2e4.</p>"},{"location":"openstack/base/install/","title":"\ud83d\ude80 OpenStack Flamingo (2025.2) \ud1b5\ud569 \uc124\uce58 \uac00\uc774\ub4dc","text":""},{"location":"openstack/base/install/#0-os","title":"\u2699\ufe0f 0. OS \uc0ac\uc804 \uc900\ube44","text":""},{"location":"openstack/base/install/#00","title":"\ud83d\udcdd 0.0 \uc635\uc158: \uae30\uc874 \uc124\uc815 \ubc31\uc5c5","text":"<p>\ub9cc\uc57d \uae30\uc874 \ud658\uacbd\uc744 \uc5c5\uadf8\ub808\uc774\ub4dc \ud55c\ub2e4\uba74 \uc544\ub798 \ub0b4\uc6a9\uc740 \ubc31\uc5c5\ud574\ub450\uba74 \uc88b\uc2b5\ub2c8\ub2e4.</p> <pre><code>echo \"=== HOSTNAME ===\" &gt; server_info.txt\nhostname &gt;&gt; server_info.txt\n\necho -e \"\\n=== IP &amp; MAC ===\" &gt;&gt; server_info.txt\nip -c addr &gt;&gt; server_info.txt\n\necho -e \"\\n=== ROUTE ===\" &gt;&gt; server_info.txt\nip route &gt;&gt; server_info.txt\n\necho -e \"\\n=== DISK INFO (Serial Check) ===\" &gt;&gt; server_info.txt\nlsblk -o NAME,MODEL,SERIAL,SIZE,TYPE,FSTYPE &gt;&gt; server_info.txt\n\necho -e \"\\n=== LVM INFO ===\" &gt;&gt; server_info.txt\nsudo vgs &gt;&gt; server_info.txt\n\necho -e \"\\n=== PCI (GPU) ===\" &gt;&gt; server_info.txt\nlspci -nn | grep NVIDIA &gt;&gt; server_info.txt\n\necho -e \"\\n=== KERNEL BOOT PARAM ===\" &gt;&gt; server_info.txt\ncat /proc/cmdline &gt;&gt; server_info.txt\n\necho \"Done. Check server_info.txt\"\n</code></pre>"},{"location":"openstack/base/install/#01-cinder","title":"\ud83d\udcbe 0.1 Cinder \uad00\ub828 \ubcfc\ub968 \uc124\uc815","text":"<p><code>multinode</code> \uc5d0\uc11c <code>[Storage]</code> \ud56d\ubaa9\uc5d0 \uc788\ub294 \ub178\ub4dc\ub4e4\uc740 \uc544\ub798 \uc791\uc5c5\uc744 \uc218\ud589\ud574\uc57c \ud569\ub2c8\ub2e4. \ub9cc\uc57d <code>/dev/sdb</code> \ub97c cinder\ub85c \uc0ac\uc6a9\ud55c\ub2e4\uba74 os \uc124\uce58 \uc2dc <code>/dev/sdb</code> \ub294 Leave unformatted \uc0c1\ud0dc\ub85c \ub0a8\uc544\uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># 1. \ubb3c\ub9ac \ubcfc\ub968(PV) \uc0dd\uc131\n# \uc8fc\uc758: /dev/sdb\uc758 \ubaa8\ub4e0 \ub370\uc774\ud130\uac00 \ub0a0\uc544\uac11\ub2c8\ub2e4.\nsudo pvcreate /dev/sdb\n\n# 2. \ubcfc\ub968 \uadf8\ub8f9(VG) \uc0dd\uc131 \u2605\uc774\ub984 \uc911\uc694\u2605\n# globals.yml\uc5d0 \uc801\uc740 \uc774\ub984(cinder-volumes)\uacfc \ucca0\uc790 \ud558\ub098\ub77c\ub3c4 \ud2c0\ub9ac\uba74 \uc548 \ub429\ub2c8\ub2e4.\nsudo vgcreate cinder-volumes /dev/sdb\n\n# 3. \ud655\uc778\nsudo vgs\n# \uacb0\uacfc\uc5d0 cinder-volumes\uac00 \ubcf4\uc774\uace0 Free \uc0ac\uc774\uc988\uac00 \ub109\ub109\ud558\uba74 \uc131\uacf5!\n</code></pre>"},{"location":"openstack/base/install/#02","title":"\ud83c\udf10 0.2 \ub124\ud2b8\uc6cc\ud06c \uad00\ub828 \uc124\uc815","text":"<pre><code># /etc/netplan/00-installer-config.yaml\nnetwork:\n  version: 2\n  ethernets:\n    eno1:  # \uad00\ub9ac\ub9dd (Management &amp; VXLAN Tunnel)\n      dhcp4: false\n      addresses:\n        - 10.10.10.XX/24  # &lt;--- [\uc911\uc694] \uac01 \uc11c\ubc84\uc758 \uc6d0\ub798 IP\ub85c \ubcc0\uacbd (\uc608: 60, 62 \ub4f1)\n      routes:\n        - to: default\n          via: 10.10.10.1 # &lt;--- [\uc911\uc694] ip \ub300\uc5ed\ubcf4\uace0 \ubcc0\uacbd \ud544\uc694(172.16.11.243 \uc11c\ubc84\ub294 172.16.11.1\ub85c \uc124\uc815)\n      nameservers:\n        addresses: [8.8.8.8] # \ub610\ub294 \uc0ac\ub0b4 DNS\n    eno2:  # \uc678\ubd80\ub9dd (Provider Network)\n      dhcp4: false\n      # IP\ub97c \ub123\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. OpenStack(OVS)\uc774 \ube0c\ub9ac\uc9c0\ub85c \uac00\uc838\uac00\uc11c \uc4f8 \uac83\uc785\ub2c8\ub2e4.\n      # \ub9c1\ud06c\ub9cc Up \uc0c1\ud0dc\ub85c \ub9cc\ub4ed\ub2c8\ub2e4.\n      optional: true\n</code></pre> <pre><code>sudo netplan apply\nip addr  # IP\uac00 \uc81c\ub300\ub85c \ub4e4\uc5b4\uc654\ub294\uc9c0 \ud655\uc778\n</code></pre>"},{"location":"openstack/base/install/#03","title":"\ud83d\udd5b 0.3 \uc11c\ubc84 \uc2dc\uac04 \uc124\uc815","text":"<p>\ud55c\uad6d \ud45c\uc900\uc2dc(KST) \uc124\uc815\uc740 \ubaa8\ub4e0 \ub178\ub4dc\uc5d0\uc11c \uc218\ud589\ud569\ub2c8\ub2e4.</p> <pre><code># \ud55c\uad6d \uc2dc\uac04\uc73c\ub85c \ubcc0\uacbd\nsudo timedatectl set-timezone Asia/Seoul\n</code></pre>"},{"location":"openstack/base/install/#rocky-linux-selinux","title":"\ud83d\udfe0 [Rocky Linux] \ud544\uc218 \uc124\uc815 (SELinux \ud574\uc81c)","text":"<p>RedHat \uacc4\uc5f4\uc740 SELinux\uac00 \ucf1c\uc838 \uc788\uc73c\uba74 Kolla \ubc30\ud3ec \uc2dc \uad8c\ud55c \ubb38\uc81c\ub85c \uc2e4\ud328\ud569\ub2c8\ub2e4.</p> <p>\ubcf4\uc548 \uc815\ucc45 \uc0c1 SELinux \ube44\ud65c\uc131\ud654\uac00 \ubd88\uac00\ub2a5\ud55c \ud658\uacbd\uc5d0\uc11c\ub294, Kolla-Ansible SELinux \ub300\uc751 \uac00\uc774\ub4dc\ub97c \ubcc4\ub3c4\ub85c \ucc38\uace0\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># 1. SELinux\ub97c Permissive \ubaa8\ub4dc\ub85c \ubcc0\uacbd (\uc77c\uc2dc\uc801)\nsudo setenforce 0\n\n# 2. \uc601\uad6c \uc124\uc815 (\uc7ac\ubd80\ud305 \ud6c4\uc5d0\ub3c4 \uc720\uc9c0\ub418\ub3c4\ub85d)\nsudo sed -i 's/^SELINUX=.*/SELINUX=disabled/g' /etc/selinux/config\n\n# 3. EPEL \uc800\uc7a5\uc18c \ucd94\uac00 (\ud544\uc218 \ud328\ud0a4\uc9c0 \uc124\uce58\uc6a9)\nsudo dnf install -y epel-release\nsudo dnf update -y\n</code></pre>"},{"location":"openstack/base/install/#ubuntu","title":"\ud83d\udfe3 [Ubuntu] \ud544\uc218 \uc124\uc815","text":"<p>Ubuntu\ub294 \ud328\ud0a4\uc9c0 \uc5c5\ub370\uc774\ud2b8\ub9cc \ud558\uba74 \ub429\ub2c8\ub2e4.</p> <pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\n</code></pre>"},{"location":"openstack/base/install/#1-install-dependencies","title":"\ud83d\udee0\ufe0f 1. \uc758\uc874\uc131 \ud328\ud0a4\uc9c0 \uc124\uce58 (Install Dependencies)","text":"<p>Python \uac00\uc0c1\ud658\uacbd\uc744 \ub9cc\ub4e4\uae30 \uc704\ud55c \uae30\ucd08 \ub3c4\uad6c\ub4e4\uc744 \uc124\uce58\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/base/install/#rocky-linux","title":"\ud83d\udfe0 [Rocky Linux]","text":"<pre><code># \uac1c\ubc1c \ub3c4\uad6c \ubc0f \ud30c\uc774\uc36c \ub77c\uc774\ube0c\ub7ec\ub9ac \uc124\uce58\nsudo dnf install -y git python3-devel libffi-devel gcc openssl-devel python3-libselinux python3-pip python3-libselinux-devel\n</code></pre>"},{"location":"openstack/base/install/#ubuntu_1","title":"\ud83d\udfe3 [Ubuntu]","text":"<pre><code># \uac1c\ubc1c \ub3c4\uad6c \ubc0f \ud30c\uc774\uc36c \ub77c\uc774\ube0c\ub7ec\ub9ac \uc124\uce58\nsudo apt install -y git python3-dev libffi-dev gcc libssl-dev python3-venv libdbus-glib-1-dev python3-dbus\n</code></pre>"},{"location":"openstack/base/install/#2-virtual-environment-","title":"\ud83d\udc0d 2. \uac00\uc0c1\ud658\uacbd \uad6c\uc131 (Virtual Environment) - [\uacf5\ud1b5]","text":"<p>\uc5ec\uae30\uc11c\ubd80\ud130\ub294 OS \uc0c1\uad00\uc5c6\uc774 \ub3d9\uc77c\ud569\ub2c8\ub2e4. \uc2dc\uc2a4\ud15c \ud30c\uc774\uc36c\uc744 \ub354\ub7fd\ud788\uc9c0 \uc54a\uae30 \uc704\ud574 \uac00\uc0c1\ud658\uacbd \uc0ac\uc6a9\uc774 \ud544\uc218\uc785\ub2c8\ub2e4.</p> <pre><code># 1. \uac00\uc0c1\ud658\uacbd \uc0dd\uc131 (\ud648 \ub514\ub809\ud130\ub9ac\uc5d0 venv \uc0dd\uc131)\npython3 -m venv ~/venv\n\n# 2. \uac00\uc0c1\ud658\uacbd \ud65c\uc131\ud654 \u2605(\uc791\uc5c5\ud560 \ub54c\ub9c8\ub2e4 \ub9e4\ubc88 \uc2e4\ud589 \ud544\uc218)\u2605\nsource ~/venv/bin/activate\n\n# (\ud504\ub86c\ud504\ud2b8 \uc55e\uc5d0 (venv)\uac00 \ub5b4\ub294\uc9c0 \ud655\uc778\ud558\uc138\uc694)\n\n# 3. pip \ucd5c\uc2e0\ud654 (\uc624\ub958 \ubc29\uc9c0)\npip install -U pip\n</code></pre>"},{"location":"openstack/base/install/#3-kolla-ansible-install-","title":"\ud83d\udce6 3. Kolla-Ansible \uc124\uce58 (Install) - [\uacf5\ud1b5]","text":"<pre><code># 1. Kolla-Ansible Flamingo \ubc84\uc804 \uc124\uce58 (master \ube0c\ub79c\uce58)\npip install git+https://opendev.org/openstack/kolla-ansible@master\n\n# \ubc84\uc804 \uc9c0\uc815\npip install git+https://opendev.org/openstack/kolla-ansible@stable/2025.2\n\n# 2. \uc124\uc815 \ub514\ub809\ud130\ub9ac \uc0dd\uc131 \ubc0f \uad8c\ud55c \ubd80\uc5ec\nsudo mkdir -p /etc/kolla\nsudo chown $USER:$USER /etc/kolla\n\n# 3. \uc124\uc815 \ud30c\uc77c \ubcf5\uc0ac (globals.yml, passwords.yml)\ncp -r ~/venv/share/kolla-ansible/etc_examples/kolla/* /etc/kolla/\n\n# 4. \uc778\ubca4\ud1a0\ub9ac \ud30c\uc77c \ubcf5\uc0ac (\uba40\ud2f0\ub178\ub4dc\uc6a9)\ncp ~/venv/share/kolla-ansible/ansible/inventory/multinode .\n</code></pre>"},{"location":"openstack/base/install/#4-globalsyml-os","title":"\u2699\ufe0f 4. \uc124\uc815 \ud30c\uc77c \uc218\uc815 (<code>globals.yml</code>) - [OS\ubcc4 \ucc28\uc774\uc810]","text":"<p><code>vi /etc/kolla/globals.yml</code>\uc744 \uc5f4\uc5b4\uc11c \uc218\uc815\ud569\ub2c8\ub2e4. OS\uc5d0 \ub530\ub77c <code>kolla_base_distro</code> \uac12\uc744 \ub2e4\ub974\uac8c \uc918\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>---\n# [\uc911\uc694] OS\uc5d0 \ub530\ub77c \uc120\ud0dd\ud558\uc138\uc694\n# Ubuntu \uc0ac\uc6a9 \uc2dc:\nkolla_base_distro: \"ubuntu\"\n# Rocky Linux \uc0ac\uc6a9 \uc2dc:\n# kolla_base_distro: \"rocky\"\n\n# [\uacf5\ud1b5] \uc624\ud508\uc2a4\ud0dd \ubc84\uc804 (Flamingo \ub300\uc751)\n# openstack_release: \"master\"  &lt;-- \uc8fc\uc11d \uadf8\ub300\ub85c \ub450\uac70\ub098, Docker \ud0dc\uadf8 \uba85\uc2dc\n\n# [\uacf5\ud1b5] \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 (\uc0ac\uc6a9\uc790 \ud658\uacbd\uc5d0 \ub9de\ucdb0\uc11c \uc218\uc815\ud560 \uac83)\n# eno2\uc5d0\ub294 IP\ub97c \uc124\uc815\ud558\uc9c0 \ub9d0\uace0, \uc2a4\uc704\uce58\uc5d0 \uc678\ubd80\ub9dd VLAN/Untaged \uc5f0\uacb0 \ud544\uc218\nnetwork_interface: \"eno1\"           # \uad00\ub9ac\ub9dd (IP 10.10.10.60)\nneutron_external_interface: \"eno2\"  # \uc678\ubd80\ub9dd (IP \uc5c6\uc74c)\n\n# [\uacf5\ud1b5] MTU \uc124\uc815 \ubcc0\uacbd\n# \uc2a4\uc704\uce58\ub97c Jumbo Frame(9000)\uc73c\ub85c \ubc14\uafc0 \uc218 \uc788\ub2e4\uba74 9000\uc73c\ub85c \uc124\uc815\n# \uc2a4\uc704\uce58\uc640 \uc11c\ubc84 \ubaa8\ub450 9000\uc73c\ub85c \ub9de\ucdb0\uc57c \uc815\uc0c1 \ub3d9\uc791\nnetwork_mtu: 1450 # VXLAN \ud5e4\ub354 \ud06c\uae30\uc778 50 byte \uc790\ub9ac \ud655\ubcf4\n\n# [\uacf5\ud1b5] VIP \uc8fc\uc18c (\uad00\ub9ac\ub9dd \ub300\uc5ed \ub0b4 \ubbf8\uc0ac\uc6a9 IP, \uac19\uc740 IP \uc0ac\uc6a9 \uc2dc HAProxy \ucda9\ub3cc \ubc1c\uc0dd \uac00\ub2a5\uc131 \ub192\uc74c)\nkolla_internal_vip_address: \"10.10.10.60\"  # HAProxy\ub97c \uc0ac\uc6a9\ud560 \uacbd\uc6b0, \ube48 IP \ud560\ub2f9 \ud544\uc694\n\n# [\uacf5\ud1b5] \uc8fc\uc694 \uc11c\ube44\uc2a4 \ud65c\uc131\ud654\nenable_cinder: \"yes\"\nenable_cinder_backend_lvm: \"yes\"\ncinder_volume_group: \"cinder-volumes\" # Cinder volume group \uc774\ub984 \ud655\uc778 \ud544\uc694\nenable_heat: \"yes\"\nenable_horizon: \"yes\"\n# enable_prometheus: \"yes\" # \ubaa8\ub2c8\ud130\ub9c1 \ud544\uc694 \uc2dc\n</code></pre> <p>\uc704 \uc124\uc815\uc740 <code>vip_address</code> \ub294 \uae30\ubcf8\uc801\uc73c\ub85c \ud604\uc7ac ip\uc640 \ub2e4\ub978 ip\ub97c \uc0ac\uc6a9\ud558\ub294 \uac83\uc774 \uc815\uc11d\uc774\uc9c0\ub9cc, \ube48 ip\uac00 \uc5c6\uac70\ub098 \ub3d9\uc77c\ud55c ip\ub97c \uc0ac\uc6a9\ud574\uc57c \ud55c\ub2e4\uba74 <code>haproxy</code> , <code>keepalived</code> \uc640 <code>tls</code> \uc124\uc815\uc744 \uaebc\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>kolla_internal_vip_address: \"10.10.10.60\"  # Control \ub178\ub4dc\uc758 \uc2e4\uc81c IP\nenable_haproxy: \"no\"                       # HAProxy \ub054\nenable_keepalived: \"no\"                    # Keepalived \ub054\n\nkolla_enable_tls_internal: \"no\" \nkolla_enable_tls_external: \"no\"\n</code></pre>"},{"location":"openstack/base/install/#mtu","title":"MTU \uad00\ub828 \uc18d\ub3c4 \uc9c0\uc5f0\uc774 \uc0dd\uae30\ub294 \uc774\uc720","text":"<p>1) \uae30\ubcf8 \ud328\ud0b7 \ud06c\uae30 \uc81c\ud55c\uc774 1500 byte, \uc624\ud508\uc2a4\ud0dd \ub0b4\ubd80\uc5d0\uc11c\ub294 \ud328\ud0b7\uc5d0 \uc624\ubc84\ud5e4\ub4dc(VXLAN, UDP, IP, Ethernet \ud5e4\ub354 -&gt; \ucd1d 50 byte)\ub97c \ubd99\uc5ec\uc11c \ud3ec\uc7a5 \ud6c4 \uc804\uc1a1 2) \ub530\ub77c\uc11c vm\uc774 1500 byte \ub370\uc774\ud130\ub97c \uc804\uc1a1 \uc2dc, vm\uc5d0\uc11c 50 byte\ucd94\uac00\ub418\uc5b4 1550 byte \uc804\uc1a1 \uc694\uccad 3) \ubb3c\ub9ac \ub79c\uce74\ub4dc\uc5d0\uc11c \ud328\ud0b7 \ud06c\uae30 \ucd08\uacfc \uc778\uc9c0 -&gt; \ud328\ud0b7 \ud3d0\uae30 \ub610\ub294 \ucabc\uac1c\uae30 4) \ud328\ud0b7 \uc190\uc2e4 \ud639\uc740 \uc7ac\uc804\uc1a1\uc774 \ubc1c\uc0dd\ud558\uba70 \ub124\ud2b8\uc6cc\ud06c \uc18d\ub3c4 \uc800\ud558(\ud2b9\ud788 HTTPS \uc811\uc18d\uc774\ub098 \ub300\uc6a9\ub7c9 \ub2e4\uc6b4\ub85c\ub4dc \uc2dc)  </p>"},{"location":"openstack/base/install/#5-","title":"\ud83d\udcdd 5. \uc778\ubca4\ud1a0\ub9ac \ubc0f \ube44\ubc00\ubc88\ud638 \uc124\uc815 - [\uacf5\ud1b5]","text":""},{"location":"openstack/base/install/#51","title":"5.1 \ube44\ubc00\ubc88\ud638 \uc0dd\uc131","text":"<pre><code>kolla-genpwd\n# \uc0dd\uc131 \ud6c4 Horizon Admin \ube44\ubc00\ubc88\ud638 \ud655\uc778\ud574\ub450\uae30\ngrep keystone_admin_password /etc/kolla/passwords.yml\n</code></pre>"},{"location":"openstack/base/install/#52-ssh","title":"5.2 SSH \uc811\uc18d \ud5c8\uc6a9","text":"<p>Master \ub178\ub4dc\uc5d0\uc11c Compute \ub178\ub4dc \ub4f1\uc73c\ub85c \ube44\ubc00\ubc88\ud638 \uc5c6\uc774 SSH \uc811\uc18d\uc774 \uac00\ub2a5\ud558\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4.</p> <pre><code># 1. SSH \uacf5\uac1c \ud0a4\ub97c \ubc30\ud3ec \ub300\uc0c1 \uc11c\ubc84\uc5d0 \ubcf5\uc0ac (\uac01 \ub178\ub4dc IP\ubcc4\ub85c \ubc18\ubcf5 \uc218\ud589)\nssh-copy-id -i ~/.ssh/id_rsa.pub &lt;USER_ID&gt;@&lt;TARGET_NODE_IP&gt;\n\n# 2. \uc811\uc18d \ud14c\uc2a4\ud2b8 (\uc554\ud638 \uc5c6\uc774 \ub85c\uadf8\uc778 \ub418\uba74 \uc131\uacf5)\nssh &lt;USER_ID&gt;@&lt;TARGET_NODE_IP&gt;\n</code></pre>"},{"location":"openstack/base/install/#53-vi-multinode","title":"5.3 \uc778\ubca4\ud1a0\ub9ac \uc218\uc815 (<code>vi multinode</code>)","text":"<p><code>multinode</code> \ud30c\uc77c\uc744 \uc5f4\uc5b4 \ubc30\ud3ec \ub300\uc0c1 \uc11c\ubc84 \uc815\ubcf4\ub97c \uc785\ub825\ud569\ub2c8\ub2e4.</p> <pre><code># 3. \uc778\ubca4\ud1a0\ub9ac \uc218\uc815\nsudo vi multinode\n</code></pre> <p>\ud30c\uc77c \ub0b4\uc6a9 \uc218\uc815 \uc608\uc2dc:</p> <pre><code>[control]\n&lt;MASTER_IP&gt;\n\n[network]\n&lt;MASTER_IP&gt;\n\n[compute]\n# Compute \ub178\ub4dc IP\uc640 \uacc4\uc815 \uc815\ubcf4\ub97c \uae30\uc785\n&lt;TARGET_NODE_IP&gt; ansible_user=&lt;USER_ID&gt; ansible_become=true\n</code></pre> <p>\ud0c0\ucf13 IP\uc5d0 \uc785\ub825\ud55c ID\ub85c \uc811\uc18d\ud558\uc5ec sudo \uad8c\ud55c\uc744 \uc5bb\uaca0\ub2e4\ub294 \uc758\ubbf8\uc785\ub2c8\ub2e4.</p>"},{"location":"openstack/base/install/#54","title":"5.4 \ud1b5\uc2e0 \ud655\uc778","text":"<pre><code># 4. Ansible Ping \ud14c\uc2a4\ud2b8\nansible -i multinode all -m ping\n</code></pre>"},{"location":"openstack/base/install/#55-ansible","title":"5.5 Ansible \uc758\uc874\uc131 \uc124\uce58 (\ud544\uc218)","text":"<pre><code>kolla-ansible install-deps\n</code></pre>"},{"location":"openstack/base/install/#56","title":"5.6 \uadf8 \uc678","text":"<pre><code># \ud0c0\uc784\uc2f1\ud06c \ud655\uc778\ntimedatectl\n\n# \ud638\uc2a4\ud2b8\uba85 \ud655\uc778\nhostname\n\n# /etc/hosts\uc5d0 \ubaa8\ub4e0 \ub178\ub4dc \ub4f1\ub85d \uad8c\uc7a5\nvi /etc/hosts\n</code></pre>"},{"location":"openstack/base/install/#6-deploy-","title":"\ud83d\ude80 6. \ubc30\ud3ec \uc2e4\ud589 (Deploy) - [\uacf5\ud1b5]","text":"<p>\uc774\uc81c \uc2e4\uc81c \uc124\uce58\ub97c \uc9c4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code># 1. Bootstrap (\uae30\ucd08 \uacf5\uc0ac: Docker \uc124\uce58 \ub4f1)\nkolla-ansible bootstrap-servers -i ./multinode\n\n# 2. Prechecks (\uc0ac\uc804 \uac80\uc0ac: \uc124\uc815 \uc624\ub958 \ud655\uc778)\nkolla-ansible prechecks -i ./multinode\n# -&gt; \uc5ec\uae30\uc11c \"SUCCESS\"\uac00 \ub5a0\uc57c\ub9cc \ub2e4\uc74c\uc73c\ub85c \ub118\uc5b4\uac11\ub2c8\ub2e4.\n\n# 3. Deploy (\ubcf8 \uac8c\uc784: \ucee8\ud14c\uc774\ub108 \ubc30\ud3ec)\nkolla-ansible deploy -i ./multinode\n</code></pre>"},{"location":"openstack/base/install/#7-post-deploy-","title":"\u2705 7. \ud074\ub77c\uc774\uc5b8\ud2b8 \uc124\uc815 (Post-Deploy) - [\uacf5\ud1b5]","text":"<p>\ubc30\ud3ec\uac00 \ub05d\ub098\uba74 OpenStack \uba85\ub839\uc5b4\ub97c \uc4f0\uae30 \uc704\ud55c \ub3c4\uad6c\ub97c \uc138\ud305\ud569\ub2c8\ub2e4.</p> <pre><code># 1. OpenStack \ud074\ub77c\uc774\uc5b8\ud2b8 \uc124\uce58\npip install python-openstackclient\n\n# 2. \uad00\ub9ac\uc790 \uc778\uc99d \ud30c\uc77c \uc0dd\uc131 (admin-openrc.sh)\nkolla-ansible post-deploy -i multinode\n\n# 3. \uc778\uc99d \ub85c\ub4dc \ubc0f \ud14c\uc2a4\ud2b8\nsource /etc/kolla/admin-openrc.sh\nopenstack service list\n\n# 4. Nova\uc640 Compute \ub4f1\ub85d \ud655\uc778\nopenstack hypervisor list\nopenstack compute service list\n</code></pre>"},{"location":"openstack/base/install/#8","title":"\ud83c\udf10 8. \ub124\ud2b8\uc6cc\ud06c \uc0dd\uc131","text":""},{"location":"openstack/base/install/#init-runonce","title":"<code>init-runonce</code> \uc0ac\uc6a9(\uc790\ub3d9)","text":"<p>\uc544\ub798 \ud56d\ubaa9\uc744 \uc218\uc815 \ud6c4, \ubc30\ud3ec\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \ud30c\uc77c \uc5f4\uae30\nvi ~/venv/share/kolla-ansible/init-runonce\n\n# 2. \uc544\ub798 \ubcc0\uc218\ub4e4\uc744 \ucc3e\uc544 \uc0ac\ub0b4\ub9dd \ud658\uacbd\uc5d0 \ub9de\uac8c \uc218\uc815\nEXT_NET_CIDR='10.10.10.0/24'       # \uc678\ubd80\ub9dd \uc804\uccb4 \ub300\uc5ed (\uc608\uc2dc)\nEXT_NET_RANGE='start=10.10.10.100,end=10.10.10.200' # Floating IP\ub85c \uc4f8 \ubc94\uc704\nEXT_NET_GATEWAY='10.10.10.1'       # \uc678\ubd80\ub9dd \uac8c\uc774\ud2b8\uc6e8\uc774\n</code></pre> <p>\ubc30\ud3ec\uac00 \ub05d\ub098\uba74 \ud574\ub2f9 \ud30c\uc77c\uc744 \uc2e4\ud589\ud558\uc5ec \ub124\ud2b8\uc6cc\ud06c\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <pre><code># home \ud3f4\ub354 \uae30\uc900\n./venv/share/kolla-ansible/init-runonce\n</code></pre>"},{"location":"openstack/base/install/#cli","title":"<code>CLI</code> \uc0ac\uc6a9(\uc218\ub3d9)","text":"<p>\ub124\ud2b8\uc6cc\ud06c \uc0dd\uc131\uc740 \uc544\ub798\uc640 \uac19\uc774 \uc9c4\ud589\ud569\ub2c8\ub2e4. IP \ub300\uc5ed \ub4f1\uc740 \uc2e4\uc81c \ud658\uacbd\uc5d0 \ub9de\ucdb0 \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/base/install/#_1","title":"\ub0b4\ubd80\ub9dd \uc0dd\uc131","text":"<pre><code># 1. \ub0b4\ubd80\ub9dd \uc0dd\uc131\nopenstack network create --provider-network-type vxlan internal\n\n# 2. \ub0b4\ubd80\ub9dd \uc11c\ube0c\ub137 \uc0dd\uc131\nopenstack subnet create --network internal \\\n  --subnet-range 1.1.1.0/24 \\\n  --gateway 1.1.1.1 \\\n  --dns-nameserver 8.8.8.8 \\\n  --dhcp \\\n  internal_subnet\n</code></pre>"},{"location":"openstack/base/install/#_2","title":"\uc678\ubd80\ub9dd \uc0dd\uc131","text":"<pre><code># 1. \uc678\ubd80\ub9dd(provider network) \uc0dd\uc131\n# \uc774\ub984: external (\uc0ac\uc9c4\uacfc \uc77c\uce58)\nopenstack network create --external \\\n  --provider-physical-network physnet1 \\\n  --provider-network-type flat \\\n  external\n\n# 2. \uc11c\ube0c\ub137 \uc0dd\uc131\n# \ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0: external (\uc704\uc5d0\uc11c \ub9cc\ub4e0 \ub124\ud2b8\uc6cc\ud06c)\n# DHCP: \ub044\uae30 (\uc0ac\uc9c4\uacfc \uc77c\uce58)\nopenstack subnet create --network external \\\n  --allocation-pool start=10.10.10.70,end=10.10.10.108 \\\n  --dns-nameserver 8.8.8.8 \\\n  --gateway 10.10.10.1 \\\n  --subnet-range 10.10.10.0/24 \\\n  --no-dhcp \\\n  external_subnet\n</code></pre>"},{"location":"openstack/base/install/#_3","title":"\ub77c\uc6b0\ud130 \uc0dd\uc131","text":"<pre><code># 1. \ub77c\uc6b0\ud130 \uc774\ub984: route\nopenstack router create route\n\n# 2. \uc678\ubd80\ub9dd \uc5f0\uacb0\nopenstack router set --external-gateway external --enable-snat route\n\n# 3. \ub0b4\ubd80\ub9dd \uc5f0\uacb0\nopenstack router add subnet route internal_subnet\n</code></pre>"},{"location":"openstack/base/install/#octavia","title":"Octavia \ub85c\ub4dc\ubc38\ub7f0\uc11c \uad00\ub9ac\ub9dd \uc0dd\uc131 \ubc0f \uc5f0\uacb0","text":"<pre><code># 1. \ub124\ud2b8\uc6cc\ud06c \uc0dd\uc131\nopenstack network create lb-mgmt-net\n\n# 2. \uc11c\ube0c\ub137 \uc0dd\uc131 (20.0.0.0/24 \ub300\uc5ed, \uac8c\uc774\ud2b8\uc6e8\uc774 20.0.0.1)\n# globals.yml \uc124\uc815\uacfc 100% \uc77c\uce58\uc2dc\ud0b4\nopenstack subnet create --network lb-mgmt-net \\\n  --subnet-range 20.0.0.0/24 \\\n  --gateway 20.0.0.1 \\\n  --dns-nameserver 8.8.8.8 \\\n  --dhcp \\\n  lb-mgmt-subnet\n\n# 3. \ub77c\uc6b0\ud130\uc5d0 \uc5f0\uacb0 (\uc774\uac78 \uc218\ud589\ud558\uba74 \uc0ac\uc9c4\ucc98\ub7fc 20.0.0.1 \ud3ec\ud2b8\uac00 \uc0dd\uae41\ub2c8\ub2e4)\nopenstack router add subnet route lb-mgmt-subnet\n</code></pre>"},{"location":"openstack/base/install/#devops-ubuntu-vs-rocky","title":"\ud83d\udca1 DevOps \uc5d4\uc9c0\ub2c8\uc5b4\uc758 \uc870\uc5b8: Ubuntu vs Rocky \uc120\ud0dd \uac00\uc774\ub4dc","text":"<ul> <li>Ubuntu 24.04:</li> <li>\uc7a5\uc810: OpenStack \ucee4\ubba4\ub2c8\ud2f0\uc758 \ud45c\uc900(De-facto) \uc785\ub2c8\ub2e4. \ud2b8\ub7ec\ube14\uc288\ud305 \uc790\ub8cc\uac00 \uc81c\uc77c \ub9ce\uace0, <code>apt</code>\uac00 \ube60\ub985\ub2c8\ub2e4.</li> <li>\ucd94\ucc9c: \ud2b9\ubcc4\ud55c \uc774\uc720\uac00 \uc5c6\ub2e4\uba74 Ubuntu\ub85c \uac00\uc138\uc694.</li> <li>Rocky Linux 9/10:</li> <li>\uc7a5\uc810: RHEL(RedHat) \uae30\ubc18\uc774\ub77c \uc5d4\ud130\ud504\ub77c\uc774\uc988 \ud658\uacbd\uc5d0\uc11c \uc120\ud638\ub429\ub2c8\ub2e4. \uc548\uc815\uc131\uc774 \ub192\uc2b5\ub2c8\ub2e4.</li> <li>\ub2e8\uc810: SELinux \ub54c\ubb38\uc5d0 \ucd08\uae30 \uc124\uc815\uc774 \uadc0\ucc2e\uace0, \ud328\ud0a4\uc9c0 \uc774\ub984\uc774 Ubuntu\ub791 \ub2ec\ub77c\uc11c \uac00\ub054 \ud5f7\uac08\ub9bd\ub2c8\ub2e4.</li> <li>\ucd94\ucc9c: \uc0ac\ub0b4 \uc815\ucc45\uc0c1 RHEL \uacc4\uc5f4\uc744 \uc368\uc57c\ub9cc \ud560 \ub54c \uc120\ud0dd\ud558\uc138\uc694.</li> </ul>"},{"location":"openstack/base/reference/","title":"\ud83d\uddfa\ufe0f OpenStack Master Reference Map","text":"<p>\uc774 \ubb38\uc11c\ub294 Kolla-Ansible \uae30\ubc18 OpenStack \ud658\uacbd\uc758 \uc11c\ube44\uc2a4 \ubaa9\ub85d\uacfc \ud2b8\ub7ec\ube14 \uc288\ud305 \ud3ec\uc778\ud2b8\ub97c \uc815\ub9ac\ud55c \uac83\uc785\ub2c8\ub2e4.</p>"},{"location":"openstack/base/reference/#1-infrastructure-backbone","title":"1. \ud83c\udfd7\ufe0f \uae30\ubc18 \uc778\ud504\ub77c (Infrastructure Backbone)","text":"<p>\uc774 \uc11c\ube44\uc2a4\ub4e4\uc774 \uc8fd\uc73c\uba74 OpenStack \uc804\uccb4\uac00 \ub9c8\ube44\ub429\ub2c8\ub2e4. \uc7a5\uc560 \uc2dc \uac00\uc7a5 \uba3c\uc800 \uccb4\ud06c\ud574\uc57c \ud560 0\uc21c\uc704 \ub300\uc0c1\uc785\ub2c8\ub2e4.</p> \uc11c\ube44\uc2a4 \ucee8\ud14c\uc774\ub108\uba85 (\ud0a4\uc6cc\ub4dc) \uc5ed\ud560 \ud83d\ude91 \ud2b8\ub7ec\ube14 \uc288\ud305 \ud3ec\uc778\ud2b8 RabbitMQ <code>rabbitmq</code> \uba54\uc2dc\uc9c0 \ubc84\uc2a4. \ubaa8\ub4e0 \uc11c\ube44\uc2a4 \uac04\uc758 \ud1b5\uc2e0 \ub2f4\ub2f9. \u2022 \uc99d\uc0c1: \ubaa8\ub4e0 API\uac00 \ub290\ub9ac\uac70\ub098 \ud0c0\uc784\uc544\uc6c3, \ub85c\uadf8\uc5d0 <code>RPC timeout</code> \ubc1c\uc0dd.\u2022 \uc870\uce58: \ud074\ub7ec\uc2a4\ud130 \uc0c1\ud0dc \ud655\uc778, \ud30c\ud2f0\uc158 \ubd84\ub9ac \uc5ec\ubd80 \ud655\uc778. MariaDB <code>mariadb</code> \ud1b5\ud569 DB. \ubaa8\ub4e0 \ub9ac\uc18c\uc2a4\uc758 \uc0c1\ud0dc \uc815\ubcf4 \uc800\uc7a5. \u2022 \uc99d\uc0c1: <code>DB Connection Error</code>, \uc11c\ube44\uc2a4 \uc2dc\uc791 \ubd88\uac00.\u2022 \uc870\uce58: Max connection \ucd08\uacfc \uc5ec\ubd80, Galera \ud074\ub7ec\uc2a4\ud130 \ub3d9\uae30\ud654 \uc0c1\ud0dc \ud655\uc778. Memcached <code>memcached</code> \uce90\uc2dc. \uc778\uc99d \ud1a0\ud070, \ucf58\uc194 \uc138\uc158 \uce90\uc2f1. \u2022 \uc99d\uc0c1: \ub85c\uadf8\uc778 \ub290\ub9bc, \ucf58\uc194 \uc811\uc18d \uc2e4\ud328.\u2022 \uc870\uce58: \uc11c\ube44\uc2a4 \uc7ac\uc2dc\uc791 (\ub370\uc774\ud130 \ub0a0\uc544\uac00\ub3c4 \ubb34\ubc29). Valkey <code>valkey-*</code> KVS. (\uad6c Redis) \ubd84\uc0b0 \ub77d \uad00\ub9ac \ub4f1. \u2022 \uc99d\uc0c1: \ud2b9\uc815 \uc791\uc5c5(Consoleauth \ub4f1) \uc2e4\ud328."},{"location":"openstack/base/reference/#2-compute-control","title":"2. \ud83e\udde0 \ucef4\ud4e8\ud2b8 \ubc0f \uc81c\uc5b4 (Compute &amp; Control)","text":"<p>\uac00\uc0c1\uba38\uc2e0(VM)\uc758 \uc0dd\uc560 \uc8fc\uae30\ub97c \uad00\ub9ac\ud569\ub2c8\ub2e4. \"VM\uc774 \uc548 \ub9cc\ub4e4\uc5b4\uc838\uc694\" \ud560 \ub54c \ubcf4\ub294 \uacf3\uc785\ub2c8\ub2e4.</p> \uc11c\ube44\uc2a4 \ucee8\ud14c\uc774\ub108\uba85 (\ud0a4\uc6cc\ub4dc) \uc5ed\ud560 \ud83d\ude91 \ud2b8\ub7ec\ube14 \uc288\ud305 \ud3ec\uc778\ud2b8 Nova API <code>nova-api</code> \uba85\ub839 \uc218\uc2e0. \uc0ac\uc6a9\uc790 \uc694\uccad\uc744 \ubc1b\uc74c. \u2022 \uc99d\uc0c1: <code>openstack server create</code> \uba85\ub839 \uc2e4\ud328 (500 Error). Nova Conductor <code>nova-conductor</code> \uc911\uc7ac\uc790. DB \uc811\uadfc \ubc0f \ubcf5\uc7a1\ud55c \ub85c\uc9c1 \ucc98\ub9ac. \u2022 \uc99d\uc0c1: VM \uc0c1\ud0dc\uac00 <code>Build</code>\uc5d0\uc11c \uba48\ucd94\uac70\ub098 <code>Error</code>\ub85c \ube60\uc9d0. Nova Scheduler <code>nova-scheduler</code> \ubc30\uce58. VM\uc744 \uc5b4\ub290 \uc11c\ubc84\uc5d0 \ub744\uc6b8\uc9c0 \uacb0\uc815. \u2022 \uc99d\uc0c1: <code>No valid host was found</code> \uc5d0\ub7ec \ubc1c\uc0dd (\ub9ac\uc18c\uc2a4 \ubd80\uc871). Placement <code>placement-api</code> \uc790\uc6d0 \uad00\ub9ac. CPU/RAM \uc7ac\uace0 \ud30c\uc545. \u2022 \uc99d\uc0c1: \uc2a4\ucf00\uc904\ub7ec \uc5d0\ub7ec\uc640 \ub3d9\ubc18\ub428. \ub9ac\uc18c\uc2a4 \uac31\uc2e0 \uc548\ub428. Ironic (Optional) <code>ironic-*</code> \ubca0\uc5b4\uba54\ud0c8. \ubb3c\ub9ac \uc11c\ubc84 \uc81c\uc5b4. \u2022 \uc99d\uc0c1: \ubca0\uc5b4\uba54\ud0c8 \ub178\ub4dc \ubc30\ud3ec \uc2e4\ud328, PXE \ubd80\ud305 \uc2e4\ud328. Zun (Optional) <code>zun-*</code> \ucee8\ud14c\uc774\ub108. VM \ub300\uc2e0 \ucee8\ud14c\uc774\ub108 \uc9c1\uc811 \ubc30\ud3ec. \u2022 \uc99d\uc0c1: \ucee8\ud14c\uc774\ub108 \uc0dd\uc131 \uc2e4\ud328."},{"location":"openstack/base/reference/#3-networking","title":"3. \ud83d\udd0c \ub124\ud2b8\uc6cc\ud0b9 (Networking)","text":"<p>\"VM\uc740 \ub5b4\ub294\ub370 \uc778\ud130\ub137\uc774 \uc548 \ub3fc\uc694\" \ub610\ub294 \"IP\uac00 \uc548 \ubc1b\uc544\uc838\uc694\" \ud560 \ub54c \ubcf4\ub294 \uacf3\uc785\ub2c8\ub2e4.</p> \uc11c\ube44\uc2a4 \ucee8\ud14c\uc774\ub108\uba85 (\ud0a4\uc6cc\ub4dc) \uc5ed\ud560 \ud83d\ude91 \ud2b8\ub7ec\ube14 \uc288\ud305 \ud3ec\uc778\ud2b8 Neutron Server <code>neutron-server</code> API \uc11c\ubc84. \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \uad00\ub9ac. \u2022 \uc99d\uc0c1: \ub124\ud2b8\uc6cc\ud06c \uc0dd\uc131 \uc2e4\ud328, \ud3ec\ud2b8 \ud560\ub2f9 \uc2e4\ud328. Octavia <code>octavia-*</code> \ub85c\ub4dc \ubc38\ub7f0\uc11c(LB). L4/L7 \ubd80\ud558 \ubd84\uc0b0. \u2022 \uc99d\uc0c1: LB \uc0dd\uc131 \uc911 <code>Error</code>, Amphora(LB VM) \ud1b5\uc2e0 \ubd88\uac00. Designate (Optional) <code>designate-*</code> DNS. \ub3c4\uba54\uc778 \uad00\ub9ac. \u2022 \uc99d\uc0c1: DNS \ub808\ucf54\ub4dc \uc804\ud30c \uc548\ub428. OVS / LinuxBridge (Agent) \ud328\ud0b7 \ucc98\ub9ac. \uc2e4\uc81c \ud1b5\uc2e0 \ub2f4\ub2f9. \u2022 \uc99d\uc0c1: VM \ud1b5\uc2e0 \ub2e8\uc808. (\uc774\uac74 \ucee8\ud14c\uc774\ub108\ubcf4\ub2e4 \ud638\uc2a4\ud2b8 \ub124\ud2b8\uc6cc\ud06c \ud655\uc778 \ud544\uc694)"},{"location":"openstack/base/reference/#4-storage","title":"4. \ud83d\udcbe \uc2a4\ud1a0\ub9ac\uc9c0 (Storage)","text":"<p>\ub370\uc774\ud130 \uc800\uc7a5\uc18c\uc785\ub2c8\ub2e4. \"\ub514\uc2a4\ud06c \uc5f0\uacb0 \uc5d0\ub7ec\" \ud639\uc740 \"\uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc \uc2e4\ud328\" \uc2dc \ud655\uc778\ud569\ub2c8\ub2e4.</p> \uc11c\ube44\uc2a4 \ucee8\ud14c\uc774\ub108\uba85 (\ud0a4\uc6cc\ub4dc) \uc5ed\ud560 \ud83d\ude91 \ud2b8\ub7ec\ube14 \uc288\ud305 \ud3ec\uc778\ud2b8 Cinder <code>cinder-*</code> \ube14\ub85d \uc2a4\ud1a0\ub9ac\uc9c0. VM\uc6a9 \uc678\uc7a5 \ub514\uc2a4\ud06c. \u2022 \uc99d\uc0c1: \ubcfc\ub968 \uc0dd\uc131 \ud6c4 <code>Error</code>, Attach \uc2e4\ud328 (iSCSI/Ceph \uc5f0\uacb0 \ubb38\uc81c). Glance <code>glance-api</code> \uc774\ubbf8\uc9c0. OS ISO/Image \uc800\uc7a5. \u2022 \uc99d\uc0c1: \uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc \uc911\ub2e8, VM \uc0dd\uc131 \uc2dc <code>Image not found</code>. Manila <code>manila-*</code> \ud30c\uc77c \uacf5\uc720. NAS (NFS/CIFS). \u2022 \uc99d\uc0c1: \uacf5\uc720 \ud3f4\ub354 \uc0dd\uc131 \uc2e4\ud328, \ub9c8\uc6b4\ud2b8 \ud0c0\uc784\uc544\uc6c3. Swift (Optional) <code>swift-*</code> \uc624\ube0c\uc81d\ud2b8. S3 \ud638\ud658 \uc800\uc7a5\uc18c. \u2022 \uc99d\uc0c1: \ud30c\uc77c \uc5c5\ub85c\ub4dc/\ub2e4\uc6b4\ub85c\ub4dc \uc2e4\ud328, \ubcf5\uc81c(Replication) \uc9c0\uc5f0. Ceph (Backend) <code>ceph-*</code> \ud1b5\ud569 \uc2a4\ud1a0\ub9ac\uc9c0 \ubc31\uc5d4\ub4dc. \u2022 \uc99d\uc0c1: \uc804\uccb4 \uc2a4\ud1a0\ub9ac\uc9c0 \uc11c\ube44\uc2a4(Cinder, Glance, Swift) \ub3d9\uc2dc \uc7a5\uc560."},{"location":"openstack/base/reference/#5-security-auth","title":"5. \ud83d\udee1\ufe0f \ubcf4\uc548 \ubc0f \uc778\uc99d (Security &amp; Auth)","text":"<p>\"\ub85c\uadf8\uc778\uc774 \uc548 \ub3fc\uc694\" \ub610\ub294 \"\uad8c\ud55c\uc774 \uc5c6\ub300\uc694\" \ud560 \ub54c \ubd05\ub2c8\ub2e4.</p> \uc11c\ube44\uc2a4 \ucee8\ud14c\uc774\ub108\uba85 (\ud0a4\uc6cc\ub4dc) \uc5ed\ud560 \ud83d\ude91 \ud2b8\ub7ec\ube14 \uc288\ud305 \ud3ec\uc778\ud2b8 Keystone <code>keystone</code> \uc778\uc99d. ID/PW \ud655\uc778 \ubc0f \ud1a0\ud070 \ubc1c\uae09. \u2022 \uc99d\uc0c1: \ubaa8\ub4e0 CLI \uba85\ub839 \uc2dc <code>401 Unauthorized</code>. Barbican (Optional) <code>barbican-*</code> \ud0a4 \uad00\ub9ac. \uc554\ud638\ud654 \ud0a4 \uc800\uc7a5. \u2022 \uc99d\uc0c1: \uc554\ud638\ud654\ub41c \ubcfc\ub968 \uc0dd\uc131 \uc2e4\ud328."},{"location":"openstack/base/reference/#6-operations","title":"6. \ud83d\udcca \uc6b4\uc601 \ubc0f \uad00\ub9ac (Operations)","text":"<p>\uc2dc\uc2a4\ud15c \uc0c1\ud0dc\ub97c \ubcf4\uace0 \uc790\ub3d9\ud654\ud558\ub294 \ub3c4\uad6c\ub4e4\uc785\ub2c8\ub2e4.</p> \uc11c\ube44\uc2a4 \ucee8\ud14c\uc774\ub108\uba85 (\ud0a4\uc6cc\ub4dc) \uc5ed\ud560 \ud83d\ude91 \ud2b8\ub7ec\ube14 \uc288\ud305 \ud3ec\uc778\ud2b8 Horizon <code>horizon</code> \uc6f9 \ub300\uc2dc\ubcf4\ub4dc. \u2022 \uc99d\uc0c1: \uc6f9 \ud398\uc774\uc9c0 504 Gateway Time-out (\uc8fc\ub85c \ubc31\uc5d4\ub4dc API \ubb38\uc81c). Heat <code>heat-*</code> \uc624\ucf00\uc2a4\ud2b8\ub808\uc774\uc158(IaC). \uc2a4\ud0dd \uc790\ub3d9 \ubc30\ud3ec. \u2022 \uc99d\uc0c1: \uc2a4\ud0dd \uc0dd\uc131 \uc2e4\ud328 (\uc0c1\uc138 \ub85c\uadf8 \ud655\uc778 \ud544\uc218). Ceilometer (Optional) <code>ceilometer-*</code> \ub370\uc774\ud130 \uc218\uc9d1. \ubbf8\ud130\ub9c1. \u2022 \uc99d\uc0c1: \uc0ac\uc6a9\ub7c9 \ub370\uc774\ud130 \ub204\ub77d."},{"location":"openstack/base/reference/#cheat-sheet","title":"\ud83d\udd27 \ube60\ub978 \ud2b8\ub7ec\ube14 \uc288\ud305 \ud750\ub984\ub3c4 (Cheat Sheet)","text":"<p>\uc7a5\uc560 \ubc1c\uc0dd \uc2dc \ub2e4\uc74c \uc21c\uc11c\ub85c \ub85c\uadf8\ub97c \ud655\uc778\ud558\uc2ed\uc2dc\uc624.</p> <ol> <li>\uc804\uccb4 \uc2dc\uc2a4\ud15c\uc774 \ub290\ub9ac\uac70\ub098 \uc774\uc0c1\ud558\ub2e4?<ul> <li>\ud83d\udc49 <code>RabbitMQ</code>, <code>MariaDB</code> \uc0c1\ud0dc \uba3c\uc800 \ud655\uc778 (\uac00\uc7a5 \ud754\ud55c \uc6d0\uc778)</li> </ul> </li> <li>CLI \uba85\ub839\uc5b4 \uc790\uccb4\uac00 \uc548 \uba39\ud78c\ub2e4?<ul> <li>\ud83d\udc49 <code>Keystone</code> \ub85c\uadf8 \ud655\uc778 (<code>/var/log/kolla/keystone/keystone.log</code>)</li> </ul> </li> <li>VM \uc0dd\uc131(<code>server create</code>) \uba85\ub839\uc744 \ucce4\ub294\ub370 \uc5d0\ub7ec\uac00 \ub09c\ub2e4?<ul> <li>\ud83d\udc49 <code>Nova-API</code> \ub85c\uadf8 \ud655\uc778</li> </ul> </li> <li>VM \uc0c1\ud0dc\uac00 <code>Build</code> \u2192 <code>Error</code>\ub85c \ubc14\ub010\ub2e4?<ul> <li>\ud83d\udc49 <code>Nova-Conductor</code> (\ub85c\uc9c1 \uc5d0\ub7ec) \ub610\ub294 <code>Nova-Compute</code> (\ud558\uc774\ud37c\ubc14\uc774\uc800 \uc5d0\ub7ec) \ud655\uc778</li> <li>\ud83d\udc49 <code>No valid host found</code> \uc5d0\ub7ec\ub77c\uba74 <code>Placement</code> \ub610\ub294 <code>Nova-Scheduler</code> \ud655\uc778</li> </ul> </li> <li>VM\uc740 \ub5b4\ub294\ub370 \uc811\uc18d\uc774 \uc548 \ub41c\ub2e4?<ul> <li>\ud83d\udc49 <code>Neutron-Server</code> \ub85c\uadf8 \ubc0f \ubcf4\uc548 \uadf8\ub8f9(Security Group) \ud655\uc778</li> </ul> </li> </ol>"},{"location":"openstack/gpu/init-gpu-node/","title":"\ud83d\udda5\ufe0f GPU Passthrough\ub97c \uc704\ud55c OS \uc0ac\uc804 \uc124\uc815 \uac00\uc774\ub4dc","text":"<p>\uc774 \uac00\uc774\ub4dc\ub294 OpenStack Compute \ub178\ub4dc\uc5d0\uc11c GPU\ub97c \uac00\uc0c1 \uba38\uc2e0(VM)\uc5d0 \uc9c1\uc811 \ud560\ub2f9(Passthrough)\ud558\uae30 \uc704\ud574 \ud544\uc694\ud55c \ucee4\ub110 \ubc0f \ub4dc\ub77c\uc774\ubc84 \uc124\uc815 \uc808\ucc28\uc785\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/init-gpu-node/#_1","title":"\ud83d\udcdd \ubcc0\uc218 \uc815\uc758 (\uce58\ud658 \ud544\uc694)","text":"<ul> <li><code>&lt;VENDOR_ID&gt;</code> : GPU \uc81c\uc870\uc0ac ID (\uc608: NVIDIA\uc758 \uacbd\uc6b0 <code>10de</code>)</li> <li><code>&lt;PRODUCT_ID&gt;</code> : GPU \ubaa8\ub378 ID (\uc608: <code>20b7</code>)</li> </ul>"},{"location":"openstack/gpu/init-gpu-node/#1-iommu-grub","title":"1\ub2e8\uacc4: IOMMU \ud65c\uc131\ud654 (Grub \uc124\uc815)","text":"<p>CPU\uc758 \uac00\uc0c1\ud654 \uae30\ub2a5\uc744 \ud65c\uc131\ud654\ud558\uace0, \ud638\uc2a4\ud2b8 OS\uac00 GPU\ub97c \uc810\uc720\ud558\uc9c0 \uc54a\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/init-gpu-node/#1","title":"1. \uc124\uc815 \ud30c\uc77c \uc218\uc815 (\uacf5\ud1b5)","text":"<p><code>/etc/default/grub</code> \ud30c\uc77c\uc744 \uc5f4\uc5b4 <code>GRUB_CMDLINE_LINUX</code> \ub77c\uc778\uc744 \uc218\uc815\ud569\ub2c8\ub2e4.</p> <pre><code># \uc778\ud154 CPU \uae30\uc900 \uc124\uc815 (AMD\uc758 \uacbd\uc6b0 intel_iommu \ub300\uc2e0 amd_iommu=on \uc0ac\uc6a9)\n# \uae30\uc874 \ub77c\uc778 \ub4a4\uc5d0 \uc544\ub798 \uc635\uc158\ub4e4\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4.\n# nouveau, nvidia \ub4dc\ub77c\uc774\ubc84\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\ub3c4\ub85d blacklist \ucc98\ub9ac\ud569\ub2c8\ub2e4.\nGRUB_CMDLINE_LINUX=\"... intel_iommu=on iommu=pt modprobe.blacklist=nouveau,nvidia,nvidia_drm vfio-pci.ids=&lt;VENDOR_ID&gt;:&lt;PRODUCT_ID&gt;\"\n</code></pre>"},{"location":"openstack/gpu/init-gpu-node/#2-grub-os","title":"2. Grub \uc801\uc6a9 \ubc0f \uc7ac\ubd80\ud305 (OS\ubcc4 \uc120\ud0dd)","text":"<p>\ud83c\udd70\ufe0f Ubuntu 22.04:</p> <pre><code>sudo update-grub\nsudo reboot\n</code></pre> <p>\ud83c\udd71\ufe0f Rocky Linux:</p> <pre><code># BIOS \ubaa8\ub4dc\uc77c \uacbd\uc6b0\nsudo grub2-mkconfig -o /boot/grub2/grub.cfg\n# UEFI \ubaa8\ub4dc\uc77c \uacbd\uc6b0 (\ub300\ubd80\ubd84\uc758 \ucd5c\uc2e0 \uc11c\ubc84)\nsudo grub2-mkconfig -o /boot/efi/EFI/rocky/grub.cfg\n\nsudo reboot\n</code></pre>"},{"location":"openstack/gpu/init-gpu-node/#3-iommu","title":"3. IOMMU \ud65c\uc131\ud654 \ud655\uc778","text":"<p>\uc7ac\ubd80\ud305 \ud6c4 \uc124\uc815\uc774 \uc801\uc6a9\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>cat /proc/cmdline\n# \ucd9c\ub825 \uacb0\uacfc\uc5d0 intel_iommu=on \ub4f1\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\uc5b4\uc57c \ud568\n</code></pre>"},{"location":"openstack/gpu/init-gpu-node/#2-gpu-id","title":"2\ub2e8\uacc4: GPU \uc7a5\uce58 ID \ud655\uc778 \ubc0f \ubcc0\uc218 \ud655\ubcf4","text":"<p>\uc2dc\uc2a4\ud15c\uc5d0 \uc7a5\ucc29\ub41c GPU\uc758 PCI ID\ub97c \uc2dd\ubcc4\ud569\ub2c8\ub2e4.</p> <pre><code># NVIDIA GPU \uac80\uc0c9 \uc608\uc2dc\nlspci -nn | grep -i NVIDIA\n</code></pre> <p>\ucd9c\ub825 \uc608\uc2dc: <code>03:00.0 3D controller [0302]: NVIDIA Corporation ... [10de:20b7] ...</code></p> <ul> <li>\uc704 \uc608\uc2dc\uc5d0\uc11c <code>&lt;VENDOR_ID&gt;</code>\ub294 <code>10de</code>, <code>&lt;PRODUCT_ID&gt;</code>\ub294 <code>20b7</code>\uc785\ub2c8\ub2e4.</li> </ul>"},{"location":"openstack/gpu/init-gpu-node/#3-vfio","title":"3\ub2e8\uacc4: VFIO \ubaa8\ub4c8 \ub85c\ub4dc \uc124\uc815","text":"<p>GPU\ub97c \ud638\uc2a4\ud2b8 OS \ub300\uc2e0 VM\uc774 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub3c4\ub85d VFIO \ub4dc\ub77c\uc774\ubc84\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/init-gpu-node/#1_1","title":"1. \uc218\ub3d9 \ub85c\ub4dc (\ud14c\uc2a4\ud2b8\uc6a9)","text":"<pre><code>sudo modprobe vfio\nsudo modprobe vfio_iommu_type1\nsudo modprobe vfio-pci\n</code></pre>"},{"location":"openstack/gpu/init-gpu-node/#2-os","title":"2. \uc601\uad6c \uc801\uc6a9 \uc124\uc815 (OS\ubcc4 \uc120\ud0dd)","text":"<p>\ubd80\ud305 \uc2dc \uc790\ub3d9\uc73c\ub85c \ubaa8\ub4c8\uc774 \ub85c\ub4dc\ub418\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4.</p> <p>\ud83c\udd70\ufe0f Ubuntu 22.04:</p> <pre><code># /etc/modules \ud30c\uc77c \ud3b8\uc9d1\nsudo vi /etc/modules\n\n# \uc544\ub798 \ub0b4\uc6a9 \ucd94\uac00\nvfio\nvfio_iommu_type1\nvfio_pci\n</code></pre> <p>\ud83c\udd71\ufe0f Rocky Linux:</p> <pre><code># /etc/modules-load.d/vfio.conf \ud30c\uc77c \uc0dd\uc131\nsudo vi /etc/modules-load.d/vfio.conf\n\n# \uc544\ub798 \ub0b4\uc6a9 \ucd94\uac00\nvfio\nvfio_iommu_type1\nvfio-pci\n</code></pre>"},{"location":"openstack/gpu/init-gpu-node/#4-gpu-driver-binding","title":"4\ub2e8\uacc4: GPU \uc7a5\uce58 \ubc14\uc778\ub529 (Driver Binding)","text":"<p>\uc2dd\ubcc4\ud55c GPU ID\ub97c VFIO \ub4dc\ub77c\uc774\ubc84\uc5d0 \ubc14\uc778\ub529\ud558\uc5ec \ud638\uc2a4\ud2b8\uac00 \uc0ac\uc6a9\ud558\uc9c0 \ubabb\ud558\uac8c \ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/init-gpu-node/#1_2","title":"1. \ubc14\uc778\ub529 \uc124\uc815 \ud30c\uc77c \uc0dd\uc131 (\uacf5\ud1b5)","text":"<pre><code># /etc/modprobe.d/vfio.conf \ud30c\uc77c \uc0dd\uc131 \ub610\ub294 \uc218\uc815\nsudo vi /etc/modprobe.d/vfio.conf\n\n# \uc544\ub798 \ub0b4\uc6a9 \ucd94\uac00 (\ubcc0\uc218 \uce58\ud658 \ud544\uc694)\noptions vfio-pci ids=&lt;VENDOR_ID&gt;:&lt;PRODUCT_ID&gt;\n</code></pre>"},{"location":"openstack/gpu/init-gpu-node/#2-ramdisk-os","title":"2. \ub7a8\ub514\uc2a4\ud06c(Ramdisk) \uc5c5\ub370\uc774\ud2b8 \ubc0f \uc7ac\ubd80\ud305 (OS\ubcc4 \uc120\ud0dd)","text":"<p>\uc124\uc815 \ub0b4\uc6a9\uc744 \ucd08\uae30 \ubd80\ud305 \uc774\ubbf8\uc9c0\uc5d0 \ubc18\uc601\ud569\ub2c8\ub2e4.</p> <p>\ud83c\udd70\ufe0f Ubuntu 22.04:</p> <pre><code>sudo update-initramfs -u\nsudo reboot\n</code></pre> <p>\ud83c\udd71\ufe0f Rocky Linux:</p> <pre><code>sudo dracut -f\nsudo reboot\n</code></pre>"},{"location":"openstack/gpu/init-gpu-node/#5","title":"5\ub2e8\uacc4: \ucd5c\uc885 \uac80\uc99d","text":"<p>\uc7ac\ubd80\ud305 \ud6c4 GPU\uac00 <code>vfio-pci</code> \ub4dc\ub77c\uc774\ubc84\ub97c \uc0ac\uc6a9 \uc911\uc778\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/init-gpu-node/#1_3","title":"1. \ub4dc\ub77c\uc774\ubc84 \ud655\uc778","text":"<pre><code># Kernel driver in use\uac00 vfio-pci\ub85c \ub418\uc5b4 \uc788\uc5b4\uc57c \uc131\uacf5\nlspci -nnk -d &lt;VENDOR_ID&gt;:&lt;PRODUCT_ID&gt;\n</code></pre>"},{"location":"openstack/gpu/init-gpu-node/#2","title":"2. (\ud2b8\ub7ec\ube14\uc288\ud305) \ubc14\uc778\ub529\uc774 \uc548 \ub41c \uacbd\uc6b0 \uac15\uc81c \uc801\uc6a9","text":"<p>\ub9cc\uc57d \uc704 \ub2e8\uacc4 \ud6c4\uc5d0\ub3c4 \ub4dc\ub77c\uc774\ubc84\uac00 \uc7a1\ud788\uc9c0 \uc54a\ub294\ub2e4\uba74 \uc544\ub798 \uba85\ub839\uc5b4\ub85c \uac15\uc81c \ubc14\uc778\ub529\uc744 \uc2dc\ub3c4\ud569\ub2c8\ub2e4.</p> <pre><code>echo \"&lt;VENDOR_ID&gt; &lt;PRODUCT_ID&gt;\" | sudo tee /sys/bus/pci/drivers/vfio-pci/new_id\n</code></pre> <p>\uc774\ud6c4 \ub2e4\uc2dc <code>lspci -nnk</code> \uba85\ub839\uc5b4\ub85c \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/init-gpu-node/#rtx-gpu","title":"RTX \uacc4\uc5f4\uc758 GPU \uc0ac\uc6a9 \uc2dc","text":"<p>RTX \uacc4\uc5f4\uacfc \uac19\uc740 \uc18c\ube44\uc790\uc6a9 GPU\ub294 \uac00\uc0c1\ud654 \ud658\uacbd\uc744 \uace0\ub824\ud558\uc9c0 \uc54a\uae30\uc5d0 FLR(Function Level Reset) \uae30\ub2a5\uc744 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c GPU \uc778\uc2a4\ud134\uc2a4\ub97c \uc885\ub8cc\ud558\uac70\ub098 \uc7ac\ubd80\ud305\ud558\uba74, GPU \ud558\ub4dc\uc6e8\uc5b4\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uace0 Stuck \uc0c1\ud0dc\ub85c \ub0a8\uc544 \ub370\uc774\ud130 \ucc0c\uaebc\uae30\ub97c \uac00\uc9c0\uace0 \uc788\ub2e4\uac00 VM\uc758 \ub2e4\uc74c \ub3d9\uc791\uc744 \ubc29\ud574\ud558\uace0, \uc774\ub97c \ud638\uc2a4\ud2b8\uac00 \uc751\ub2f5\uc774 \uc5c6\ub294 \uac83\uc73c\ub85c \uc778\uc2dd\ud558\uace0 \uc778\uc2a4\ud134\uc2a4\ub97c PAUSED \uc0c1\ud0dc\ub85c \uac15\uc81c \uc815\uc9c0\uc2dc\ucf1c\ubc84\ub9bd\ub2c8\ub2e4.</p> <p>\uc774\ub97c \ub9c9\uae30 \uc704\ud574 <code>vendor-reset</code> \ub4f1\uc758 \ud504\ub85c\uadf8\ub7a8\uc744 \uc0ac\uc6a9\ud558\uac70\ub098 \uc784\uc2dc\ub85c \uc258 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud558\ub294 \ubc29\ubc95\uc774 \uc788\uc2b5\ub2c8\ub2e4. \uc544\ub798\ub294 \uc258 \uc2a4\ud06c\ub9bd\ud2b8\ub85c FLR \uae30\ub2a5\uc744 \uc784\uc2dc \uc870\uce58\ud558\ub294 \ubc29\ubc95\uc785\ub2c8\ub2e4. \ubaa8\ub4e0 \uba85\ub839\uc740 GPU \ud638\uc2a4\ud2b8 \ub178\ub4dc\uc5d0\uc11c \uc2e4\ud589\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>cat &lt;&lt; 'EOF' &gt; qemu-hook.sh\n#!/bin/bash\n# GPU reset hook for RTX Passthrough VMs\n\nVM_NAME=\"$1\"\nACTION=\"$2\"\nPHASE=\"$3\"\n\n# \uc2e4\uc81c ID\ub294 lspci\ub85c \ud655\uc778 \ud6c4 \uc218\uc815 \ud544\uc694\nGPU_PCI=\"0000:01:00.0\"\nAUDIO_PCI=\"0000:01:00.1\" # \uc624\ub514\uc624 \uc7a5\uce58\uac00 \uc788\ub2e4\uba74 \uac19\uc774 \ub9ac\uc14b\ud574\uc57c \uc548\uc804\ud568\n\n# \ub85c\uadf8 \ud30c\uc77c \uc704\uce58 (Kolla \ub85c\uadf8 \ud3f4\ub354\ub85c \uc9c0\uc815\ud558\uc5ec \ud638\uc2a4\ud2b8\uc5d0\uc11c\ub3c4 \ubcfc \uc218 \uc788\uac8c \ud568)\nLOGFILE=\"/var/log/libvirt/gpu-reset.log\"\n\nif [[ \"$ACTION\" == \"stopped\" &amp;&amp; \"$PHASE\" == \"end\" ]]; then\n    echo \"[$(date)] VM $VM_NAME stopped. Resetting GPU...\" &gt;&gt; $LOGFILE\n\n    # 1. Remove (\uc7a5\uce58 \uc81c\uac70)\n    echo 1 &gt; /sys/bus/pci/devices/$GPU_PCI/remove\n    echo 1 &gt; /sys/bus/pci/devices/$AUDIO_PCI/remove 2&gt;/dev/null\n\n    # \uc7a0\uc2dc \ub300\uae30\n    sleep 2\n\n    # 2. Rescan (\uc7a5\uce58 \uc7ac\uc778\uc2dd)\n    echo 1 &gt; /sys/bus/pci/rescan\n\n    echo \"[$(date)] GPU Reset done.\" &gt;&gt; $LOGFILE\nfi\nEOF\n</code></pre> <p>\uc704 \uc258 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \ucee8\ud14c\uc774\ub108 \ub0b4\ubd80\uc5d0 \ubcf5\uc0ac\ud558\uace0, \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \ucee8\ud14c\uc774\ub108 \ub0b4\ubd80 \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131\nsudo docker exec -u root nova_libvirt mkdir -p /etc/libvirt/hooks\n\n# 2. \ud30c\uc77c \ubcf5\uc0ac (docker cp \uc0ac\uc6a9)\nsudo docker cp qemu-hook.sh nova_libvirt:/etc/libvirt/hooks/qemu\n\n# 3. \uad8c\ud55c \uc124\uc815 (\uc2e4\ud589 \uad8c\ud55c \ud544\uc218)\nsudo docker exec -u root nova_libvirt chmod +x /etc/libvirt/hooks/qemu\nsudo docker exec -u root nova_libvirt chown root:root /etc/libvirt/hooks/qemu\n\n# 4. \ucee8\ud14c\uc774\ub108 \uc7ac\uc2dc\uc791\nsudo docker restart nova_libvirt\n</code></pre> <p>\uc124\uc815\uc774 \uc798 \uc801\uc6a9\ub418\uc5c8\ub2e4\uba74, gpu \uc778\uc2a4\ud134\uc2a4\uac00 \uc0ad\uc81c\ub418\uc5c8\uc744 \ub54c\ub9c8\ub2e4 \uc544\ub798 \ub85c\uadf8\uac00 \ucc0d\ud788\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code>sudo docker exec -it nova_libvirt cat /var/log/libvirt/gpu-reset.log\n</code></pre> <pre><code>[Wed Nov 26 09:44:01 KST 2025] VM instance-0000001a stopped. Resetting GPU...\n[Wed Nov 26 09:44:03 KST 2025] GPU Reset done.\n[Wed Nov 26 09:49:32 KST 2025] VM instance-0000001b stopped. Resetting GPU...\n[Wed Nov 26 09:49:34 KST 2025] GPU Reset done.\n[Wed Nov 26 09:51:46 KST 2025] VM instance-0000001b stopped. Resetting GPU...\n[Wed Nov 26 09:51:49 KST 2025] GPU Reset done.\n[Wed Nov 26 09:56:32 KST 2025] VM instance-0000001c stopped. Resetting GPU...\n[Wed Nov 26 09:56:35 KST 2025] GPU Reset done.\n[Wed Nov 26 10:02:11 KST 2025] VM instance-0000001d stopped. Resetting GPU...\n[Wed Nov 26 10:02:13 KST 2025] GPU Reset done.\n[Wed Nov 26 10:03:10 KST 2025] VM instance-0000001d stopped. Resetting GPU...\n[Wed Nov 26 10:03:12 KST 2025] GPU Reset done.\n</code></pre>"},{"location":"openstack/gpu/pci-placement/","title":"PCI Passthrougu + Placement API \uc801\uc6a9","text":""},{"location":"openstack/gpu/pci-placement/#0","title":"0. \uc0ac\uc804 \ud655\uc778 \uc0ac\ud56d","text":"<ul> <li>Ubuntu 24.04 + Openstack 2025.2 \ud658\uacbd\uc5d0\uc11c \uc9c4\ud589</li> <li>GPU \ub178\ub4dc\uc5d0 IOMMU \ucee4\ub110 \uc124\uc815 \ud655\uc778</li> <li>GPU \uad00\ub9ac\uc790\uac00 VFIO\uc778\uc9c0 \ud655\uc778</li> </ul>"},{"location":"openstack/gpu/pci-placement/#1-nova-gpu","title":"1. Nova \uc124\uc815 \uc624\ubc84\ub77c\uc774\ub529 (GPU \uc778\uc2dd\uc2dc\ud0a4\uae30)","text":"<p>Kolla-Ansible\uc740 <code>/etc/kolla/config/nova/nova.conf</code> \ud30c\uc77c\uc744 \uc6b0\uc120\uc21c\uc704\ub85c \uc801\uc6a9\ud569\ub2c8\ub2e4. \uc5ec\uae30\uc5d0 GPU \uc815\ubcf4\ub97c \ubc15\uc81c\ud569\ub2c8\ub2e4.</p> <pre><code># \uc0ac\uc6a9\ud560 PCI \uc7a5\ube44\uc758 \uc774\ub984 \uc0dd\uc131\n# CUSTOM_ \uc811\ub450\uc0ac\ub294 \ud544\uc218\ub85c \ub4e4\uc5b4\uac00\uc57c \ud568\nopenstack resource class create CUSTOM_&lt;RESOURCE_NAME&gt;\n</code></pre> <pre><code># \uc124\uc815 \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131\nsudo mkdir -p /etc/kolla/config/nova\n\n# \uc124\uc815 \ud30c\uc77c \uc791\uc131\nsudo vi /etc/kolla/config/nova/nova.conf\n</code></pre> <pre><code>[pci]\n# 1. [Compute \ub178\ub4dc\uc6a9] \ubb3c\ub9ac \uc11c\ubc84\uc758 PCI \uc7a5\uce58 \ud654\uc774\ud2b8\ub9ac\uc2a4\ud2b8\ndevice_spec = [{\"vendor_id\": \"&lt;VENDOR_ID&gt;\", \"product_id\": \"&lt;PRODUCT_ID&gt;\"}]\n\n# 2. [API \ub178\ub4dc\uc6a9] Flavor\uc5d0\uc11c \uc0ac\uc6a9\ud560 \ubcc4\uce6d(Alias) \uc815\uc758\n# name\uc740 \ub098\uc911\uc5d0 Flavor \ub9cc\ub4e4 \ub54c \uc501\ub2c8\ub2e4. (\uc5ec\uae30\uc11c\ub294 'nvidia-gpu'\ub85c \uc815\ud568)\n# nova\uac00 \uc7a5\uce58\ub97c \ubabb \ucc3e\uaca0\ub2e4 \ud560 \ub54c, type-PCI \ubcc0\uacbd \ud544\uc694\nalias = {\"vendor_id\": \"&lt;VENDOR_ID&gt;\", \"product_id\": \"&lt;PRODUCT_ID&gt;\", \"device_type\": \"type-PCI\", \"name\": \"&lt;RESOURCE_NAME&gt;\"}\n\n# 3. PCI\ub97c placement\uc5d0 \ud1b5\ud569\nreport_in_placement = true\n\n[filter_scheduler]\n# 3. [Scheduler \ub178\ub4dc\uc6a9] PCI \ud544\ud130 \ud65c\uc131\ud654 (\uae30\uc874 \ud544\ud130 \ub4a4\uc5d0 \ucd94\uac00)\navailable_filters = nova.scheduler.filters.all_filters\nenabled_filters = ComputeFilter,ImagePropertiesFilter,PciPassthroughFilter\n\npci_in_placement = true\n</code></pre> <p>\ucc38\uace0\ub85c <code>device_type</code> \uc740 \uc544\ub798\uc640 \uac19\uc740 \uc635\uc158\uc774 \uc788\uc2b5\ub2c8\ub2e4. <code>SR-IOV</code> \uae30\ub2a5\uc774 \uc788\ub2e4\uba74 <code>type-PF</code> \ub85c \ud574\uc57c \uc778\uc2dd\ud569\ub2c8\ub2e4.</p> \ud0c0\uc785 \uba85\uce6d \uc124\uba85 \ube44\uc720 \uc6a9\ub3c4 type-PCI \uc77c\ubc18 PCI \uc7a5\uce58 \"SR-IOV \uae30\ub2a5\uc774 \uc5c6\uac70\ub098, \uc548 \uc4f0\ub294 \uc77c\ubc18 \uc7a5\uce58.\" \"\ub2e8\ub3c5\uc8fc\ud0dd (\ucabc\uac24 \uc218 \uc5c6\uc74c, \ud1b5\uc9f8\ub85c \uc368\uc57c \ud568)\" \"\uc77c\ubc18\uc801\uc778 GPU Passthrough (RTX, T4 \ub4f1\uc744 \ud1b5\uc73c\ub85c \uc4f8 \ub54c)\" type-PF Physical Function SR-IOV\ub97c \uc9c0\uc6d0\ud558\ub294 \ubd80\ubaa8 \uc7a5\uce58. \uc790\uc2dd(VF)\uc744 \uc0dd\uc131\ud560 \ub2a5\ub825\uc774 \uc788\uc74c. \uc544\ud30c\ud2b8 \uc8fc\uc778 (\uc138\ub97c \ub193\uc744 \uc218 \uc788\uc74c) \ud638\uc2a4\ud2b8 OS\uac00 VF\ub97c \uad00\ub9ac\ud558\uae30 \uc704\ud574 \ubd99\ub4e4\uace0 \uc788\ub294 \uc6a9\ub3c4. (VM\uc5d0 \uc798 \uc548 \uc90c) type-VF Virtual Function \ubd80\ubaa8(PF)\ub85c\ubd80\ud130 \ud30c\uc0dd\ub41c \uc790\uc2dd \uc7a5\uce58. \uc544\ud30c\ud2b8 \uc138\uc785\uc790 (\ud55c \ud638\uc2e4\ub9cc \ube4c\ub824 \uc500) \uace0\uc131\ub2a5 \ub124\ud2b8\uc6cc\ud06c(SR-IOV)\ub098 vGPU\ub97c VM\uc5d0 \ud560\ub2f9\ud560 \ub54c \uc0ac\uc6a9. <p>SR-IOV\ub97c \uc9c0\uc6d0\ud558\ub294\uc9c0\ub294 \uc544\ub798\uc640 \uac19\uc740 \uba85\ub839\uc73c\ub85c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code># 1. \uba3c\uc800 GPU\uc758 PCI \uc8fc\uc18c\ub97c \ucc3e\uc2b5\ub2c8\ub2e4.\nlspci | grep -i nvidia\n# \uc608: 41:00.0 3D controller: NVIDIA Corporation ...\n\n# 2. \ud574\ub2f9 \uc8fc\uc18c(-s)\uc758 \uc0c1\uc138 \uc815\ubcf4(-vvv)\uc5d0\uc11c SR-IOV \ud0a4\uc6cc\ub4dc\ub97c \uac80\uc0c9\ud569\ub2c8\ub2e4.\nsudo lspci -s &lt;PCI_ADDRESS&gt; -vvv | grep -i \"Single Root I/O Virtualization\"\n</code></pre>"},{"location":"openstack/gpu/pci-placement/#11-20252","title":"1.1 2025.2 \ubc84\uc804\uc5d0 \ucd94\uac00\ub41c \ud56d\ubaa9","text":""},{"location":"openstack/gpu/pci-placement/#gpu","title":"GPU \ubcf4\uc548 \uad00\ub828","text":"<p><code>device_spec</code> \uc5d0\uc11c <code>one_time_use</code> \ud56d\ubaa9\uc744 \ucd94\uac00 \uc2dc, \uc0ac\uc6a9\uc790\uac00 \uc4f0\uace0 \ubc18\ub0a9\ud55c GPU\ub294 <code>reserved</code> \uc0c1\ud0dc\uac00 \ub418\uc5b4 \ub2e4\ub978 \uc0ac\uc6a9\uc790\uac00 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \uc0c1\ud0dc\uac00 \ub429\ub2c8\ub2e4.</p> <p>\uc774\ub97c \uad00\ub9ac\uc790\uac00 \uc2a4\ud06c\ub9bd\ud2b8\ub85c GPU \ucd08\uae30\ud654 \ud6c4, <code>openstack resource provider inventory set --reserved 0 ...</code> \uba85\ub839\uc744 \uc2e4\ud589\ud574\uc57c \ub2e4\uc2dc \uc0ac\uc6a9\ud560 \uc218 \uc788\uac8c \ub429\ub2c8\ub2e4.</p> <pre><code>[pci]\ndevice_spec = [{\"vendor_id\": \"&lt;VENDOR_ID&gt;\", \"product_id\": \"&lt;PRODUCT_ID&gt;\", \"one_time_use\": \"true\"}]\n</code></pre>"},{"location":"openstack/gpu/pci-placement/#live-migration","title":"Live Migration","text":"<p>live_migratable\uc740 \"GPU\ub97c \ub2ec\uace0 \uc788\ub294 VM\ub3c4 \ub044\uc9c0 \uc54a\uace0 \ub2e4\ub978 \uc11c\ubc84\ub85c \uc774\uc0ac(Live Migration)\uac08 \uc218 \uc788\uac8c \ud574\uc8fc\ub294 \uc2a4\uc704\uce58\"\uc785\ub2c8\ub2e4.</p> <p>\uc774\ub97c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574\uc120 \uc544\ub798\uc640 \uac19\uc740 \uc870\uac74\uc744 \ucda9\uc871\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <ol> <li>SR-IOV \uc0ac\uc6a9 \uac00\ub2a5 \uc5ec\ubd80</li> <li>NVIDIA vGPU \ub77c\uc774\uc120\uc2a4</li> </ol> <pre><code>[pci]\ndevice_spec = [{ \"vendor_id\": \"&lt;VENDOR_ID&gt;\", \"product_id\": \"&lt;PRODUCT_ID&gt;\", \"live_migratable\": \"true\" }]\nalias = { \"name\": \"&lt;RESOURCE_NAME&gt;\", ... \"live_migratable\": \"true\" }\n</code></pre>"},{"location":"openstack/gpu/pci-placement/#2-reconfigure","title":"2. \uc124\uc815 \uc801\uc6a9 (Reconfigure)","text":"<p>\uae30\uc874 \uc624\ud508\uc2a4\ud0dd\uc744 \ub044\uc9c0 \uc54a\uace0 \uc124\uc815\ub9cc \uc5c5\ub370\uc774\ud2b8\ud569\ub2c8\ub2e4.</p> <pre><code># \uac00\uc0c1\ud658\uacbd \ud65c\uc131\ud654 \ud544\uc218\nsource ~/kolla-venv/bin/activate\n\n# \uc7ac\uc124\uc815 \uc801\uc6a9 (Nova \uc11c\ube44\uc2a4\ub4e4\ub9cc \uc7ac\uc2dc\uc791\ub428)\nkolla-ansible reconfigure -i multinode --tags nova\n</code></pre> <p>(\uc804\uccb4\ub97c \ub2e4 \ub3cc\ub9ac\uba74 \uc624\ub798 \uac78\ub9ac\ub2c8 <code>--tags nova</code>\ub85c \uc2dc\uac04 \ub2e8\ucd95 \uac00\ub2a5\ud569\ub2c8\ub2e4.)</p>"},{"location":"openstack/gpu/pci-placement/#3-placement","title":"3. Placement \ub4f1\ub85d \uac80\uc99d","text":"<p>Nova\uac00 GPU\ub97c \uac10\uc9c0\ud558\uace0 Placement\uc5d0 \"\ub098 GPU \uc788\uc5b4!\"\ub77c\uace0 \ubcf4\uace0\ud588\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/pci-placement/#31-compute-node-uuid","title":"3.1. \ubb3c\ub9ac \uc11c\ubc84(Compute Node) UUID \ud655\uc778","text":"<pre><code>openstack resource provider list\n</code></pre> <ul> <li>\uc5ec\uae30\uc11c GPU \ub178\ub4dc\uc758 \uc790\uc2dd <code>ID</code> (UUID)\ub97c \ubcf5\uc0ac\ud558\uc138\uc694.</li> </ul>"},{"location":"openstack/gpu/pci-placement/#32","title":"3.2. \uc778\ubca4\ud1a0\ub9ac \uc870\ud68c","text":"<pre><code># [UUID] \uc790\ub9ac\uc5d0 \ubcf5\uc0ac\ud55c ID\ub97c \ub123\uc73c\uc138\uc694\nopenstack resource provider inventory list [UUID]\n</code></pre> <p>[\uc131\uacf5 \ud310\ub3c5] \ucd9c\ub825 \uacb0\uacfc\uc5d0 \uc544\ub798\uc640 \ube44\uc2b7\ud55c \ud56d\ubaa9\uc774 \ubcf4\uc5ec\uc57c \ud569\ub2c8\ub2e4.</p> <ul> <li><code>PCI_DEVICE</code>: <code>total: 1</code> (\ub610\ub294 GPU \uac1c\uc218\ub9cc\ud07c)</li> <li>\ub610\ub294 <code>CUSTOM_PCI_10DE_20B7</code>: <code>total: ...</code></li> </ul>"},{"location":"openstack/gpu/pci-placement/#4","title":"4. \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 \ud14c\uc2a4\ud2b8","text":"<p>\uc774\uc81c \"GPU\uac00 \ub2ec\ub9b0 + \uc778\ud130\ub137\uc774 \ub418\ub294\" \uc778\uc2a4\ud134\uc2a4\ub97c \ub9cc\ub4ed\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/pci-placement/#41-gpu-flavor","title":"4.1. GPU Flavor \uc0dd\uc131","text":"<p>\uc544\uae4c <code>nova.conf</code>\uc5d0\uc11c \uc815\ud55c alias \uc774\ub984(<code>nvidia-gpu</code>)\uc744 \uc501\ub2c8\ub2e4.</p> <pre><code>openstack flavor create --ram 8192 --disk 50 --vcpus 4 &lt;FLAVOR_NAME&gt;\nopenstack flavor set \\\n  --property \"pci_passthrough:alias\"=\"&lt;RESOURCE_NAME&gt;:1\" \\\n  --property \"resources:&lt;CUSTOM_RESOURCE_CLASS&gt;=1\" \\\n  --property \"hw:pci_numa_affinity_policy\"=\"preferred\" \\\n  --property hw_machine_type=q35 \\\n  &lt;FLAVOR_NAME&gt;\n</code></pre> <p>\ub9cc\uc57d RTX \uacc4\uc5f4\uc758 \uac1c\uc778\uc6a9 GPU\ub97c \uc0ac\uc6a9\ud55c\ub2e4\uba74 <code>--property hw:kvm_hidden=true</code> \uc635\uc158\ub3c4 \ud568\uaed8 \uc801\uc6a9\ud569\ub2c8\ub2e4.</p> <p>\u203b \uc77c\ubd80 \ud658\uacbd\uc5d0\uc11c\ub294 alias + resources\ub97c \ub3d9\uc2dc\uc5d0 \uc4f8 \uacbd\uc6b0 \uc774\uc911 \ucc28\uac10\ub428. \uc774 \uacbd\uc6b0 resources \ud56d\ubaa9\ub9cc \uc81c\uac70\ud558\uace0 alias\ub9cc \uc0ac\uc6a9 \uad8c\uc7a5.</p>"},{"location":"openstack/gpu/pci-placement/#42","title":"4.2. \uc778\uc2a4\ud134\uc2a4 \uc2dc\uc791","text":"<pre><code>openstack server create --flavor gpu.flavor \\\n  --image \"Ubuntu 24.04\" \\\n  --network internal \\\n  my-gpu-vm\n</code></pre>"},{"location":"openstack/gpu/pci-placement/#43","title":"4.3. \ucd5c\uc885 \ud655\uc778","text":"<p>VM \uc811\uc18d \ud6c4:</p> <ul> <li><code>lspci</code>: NVIDIA \uc7a5\uce58\uac00 \ubcf4\uc774\ub294\uc9c0?</li> <li><code>ping 8.8.8.8</code>: \uc778\ud130\ub137\uc774 \ub418\ub294\uc9c0?</li> <li><code>nvidia-smi</code>: \ub4dc\ub77c\uc774\ubc84 \uc124\uce58 \ud6c4 GPU\uac00 \uc7a1\ud788\ub294\uc9c0?</li> </ul>"},{"location":"openstack/gpu/pci-placement/#5-api-advanced-verification","title":"5. API \uae30\ubc18 \ud560\ub2f9 \uac80\uc99d (Advanced Verification)","text":"<p>CLI\ub098 \ub300\uc2dc\ubcf4\ub4dc \uc0c1\uc5d0\uc11c\ub294 \ud655\uc778\ud558\uae30 \uc5b4\ub824\uc6b4 \"\uc2e4\uc81c \ub9ac\uc18c\uc2a4 \uc810\uc720 \ud604\ud669(Placement)\"\uacfc \"Flavor \ub0b4\ubd80 \uc124\uc815(Nova)\"\uc744 API\ub97c \ud1b5\ud574 \uc9c1\uc811 \uac80\uc99d\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/pci-placement/#50","title":"5.0. \ud658\uacbd \ubcc0\uc218 \uc124\uc815","text":"<p>\uac80\uc99d\uc5d0 \ud544\uc694\ud55c \ubcc0\uc218\ub4e4\uc744 \ubbf8\ub9ac \uc120\uc5b8\ud569\ub2c8\ub2e4. <code>&lt; &gt;</code>\ub85c \ud45c\uc2dc\ub41c \ubd80\ubd84\uc5d0 \uc2e4\uc81c \uac12\uc744 \uc785\ub825\ud558\uc138\uc694.</p> <pre><code># 1. \uc811\uc18d \uc815\ubcf4\nexport CONTROLLER_IP=$(openstack endpoint list --service keystone --interface public -c URL -f value | awk -F/ '{print $3}' | cut -d: -f1)\nexport PLACEMENT_PORT=$(openstack endpoint list --service placement --interface public -c URL -f value | awk -F: '{print $3}' | cut -d/ -f1)\nexport NOVA_PORT=$(openstack endpoint list --service compute --interface public -c URL -f value | awk -F: '{print $3}' | cut -d/ -f1)\n\n# 2. \uac80\uc99d \ub300\uc0c1 UUID (\uc0ac\uc804 \ud655\uc778 \ud544\uc694)\n# \uc0dd\uc131\ub41c \uc778\uc2a4\ud134\uc2a4\uc758 ID\nexport SERVER_ID=\"&lt;INSTANCE_ID&gt;\"\n# \uc0dd\uc131\ud55c GPU Flavor\uc758 ID\nexport FLAVOR_ID=\"&lt;FLAVOR_ID&gt;\"\n# GPU \uc790\uc6d0\uc744 \uac00\uc9c4 \ubb3c\ub9ac \ub178\ub4dc(\ud639\uc740 \uc790\uc2dd \ub178\ub4dc)\uc758 UUID\nexport RP_UUID=$(openstack resource provider allocation show $SERVER_ID -c resource_provider -c resources -f value | grep \"CUSTOM_\" | awk '{print $1}')\n</code></pre>"},{"location":"openstack/gpu/pci-placement/#51","title":"5.1. \uc778\uc99d \ud1a0\ud070 \ubc1c\uae09 (\ud1a0\ud070\uc774 \uc5c6\ub294 \uacbd\uc6b0)","text":"<pre><code># \uad00\ub9ac\uc790 \uad8c\ud55c \ub85c\ub4dc \ud6c4 \ud1a0\ud070 \ubc1c\uae09\nsource /etc/kolla/admin-openrc.sh\nexport OS_TOKEN=$(openstack token issue -c id -f value)\necho \"Token: $OS_TOKEN\"\n</code></pre>"},{"location":"openstack/gpu/pci-placement/#52-placement-api","title":"5.2. Placement API \uac80\uc99d (\ud558\ub4dc\uc6e8\uc5b4 \uad00\uc810)","text":"<p>GPU \uc790\uc6d0\uc774 \ubb3c\ub9ac\uc801\uc73c\ub85c \uc874\uc7ac\ud558\uba70, \uc0dd\uc131\ud55c \uc778\uc2a4\ud134\uc2a4\uac00 \uc774\ub97c \uc2e4\uc81c\ub85c \uc810\uc720\ud558\uace0 \uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/pci-placement/#1-resource-inventory","title":"1) Resource Inventory \uc870\ud68c (\uc7ac\uace0 \ud655\uc778)","text":"<pre><code>curl -s -X GET \"http://${CONTROLLER_IP}:${PLACEMENT_PORT}/resource_providers/${RP_UUID}/inventories\" \\\n  -H \"X-Auth-Token: ${OS_TOKEN}\" \\\n  -H \"OpenStack-API-Version: placement 1.28\" \\\n  -H \"Content-Type: application/json\" | json_pp\n</code></pre> <p>[\ud655\uc778 \ud3ec\uc778\ud2b8]</p> <ul> <li><code>total</code> \uac12\uc774 \uc2e4\uc81c \ubb3c\ub9ac GPU \uac1c\uc218\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778</li> <li>\ub9ac\uc18c\uc2a4 \ud074\ub798\uc2a4 \uc774\ub984\uc774 <code>CUSTOM_&lt;RESOURCE_NAME&gt;</code> (\ub610\ub294 \uc790\ub3d9 \uc0dd\uc131\ub41c \uc774\ub984)\uc778\uc9c0 \ud655\uc778</li> </ul>"},{"location":"openstack/gpu/pci-placement/#2-resource-allocations","title":"2) Resource Allocations \uc870\ud68c (\uc810\uc720 \ud655\uc778 \u2605\uc911\uc694)","text":"<pre><code>curl -s -X GET \"http://${CONTROLLER_IP}:${PLACEMENT_PORT}/resource_providers/${RP_UUID}/allocations\" \\\n  -H \"X-Auth-Token: ${OS_TOKEN}\" \\\n  -H \"OpenStack-API-Version: placement 1.28\" \\\n  -H \"Content-Type: application/json\" | json_pp\n</code></pre> <p>[\ud655\uc778 \ud3ec\uc778\ud2b8]</p> <ul> <li>\uc751\ub2f5 JSON\uc758 Key \uac12(Consumer UUID)\uc5d0 <code>&lt;INSTANCE_ID&gt;</code>\uac00 \ud3ec\ud568\ub418\uc5b4 \uc788\uc5b4\uc57c \ud568</li> <li>\ud574\ub2f9 \uc778\uc2a4\ud134\uc2a4\uac00 <code>CUSTOM_&lt;RESOURCE_NAME&gt;</code> \uc790\uc6d0\uc744 <code>1</code>\uac1c \uc0ac\uc6a9 \uc911\uc774\uc5b4\uc57c \ud568</li> </ul>"},{"location":"openstack/gpu/pci-placement/#53-nova-api","title":"5.3. Nova API \uac80\uc99d (\uc18c\ud504\ud2b8\uc6e8\uc5b4 \uad00\uc810)","text":"<p>\uc778\uc2a4\ud134\uc2a4\uac00 \uc62c\ubc14\ub978 Flavor\uc640 \uc2a4\ud399\uc73c\ub85c \uc0dd\uc131\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/gpu/pci-placement/#1-flavor-extra-specs","title":"1) Flavor \uc0c1\uc138 \uc2a4\ud399(Extra Specs) \uc870\ud68c","text":"<p>Flavor \uc870\ud68c \uc2dc \uae30\ubcf8 \uc815\ubcf4\uc5d0\ub294 GPU \uad00\ub828 \uc124\uc815\uc774 \ub098\uc624\uc9c0 \uc54a\uc73c\ubbc0\ub85c, <code>/os-extra_specs</code> \uc5d4\ub4dc\ud3ec\uc778\ud2b8\ub97c \ud638\ucd9c\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>curl -s -X GET \"http://${CONTROLLER_IP}:${NOVA_PORT}/v2.1/flavors/${FLAVOR_ID}/os-extra_specs\" \\\n  -H \"X-Auth-Token: ${OS_TOKEN}\" \\\n  -H \"Content-Type: application/json\" | json_pp\n</code></pre> <p>[\ud655\uc778 \ud3ec\uc778\ud2b8]</p> <ul> <li><code>\"pci_passthrough:alias\": \"&lt;RESOURCE_NAME&gt;:1\"</code> \uc124\uc815 \uc874\uc7ac \uc5ec\ubd80</li> <li><code>\"resources:CUSTOM_&lt;RESOURCE_CLASS&gt;\": \"1\"</code> \uc124\uc815 \uc874\uc7ac \uc5ec\ubd80</li> <li><code>\"hw:pci_numa_affinity_policy\": \"preferred\"</code> \uc124\uc815 \uc874\uc7ac \uc5ec\ubd80</li> </ul>"},{"location":"openstack/gpu/pci-placement/#2-instance","title":"2) Instance \uc0c1\uc138 \uc815\ubcf4 \uc870\ud68c","text":"<pre><code>curl -s -X GET \"http://${CONTROLLER_IP}:${NOVA_PORT}/v2.1/servers/${SERVER_ID}\" \\\n  -H \"X-Auth-Token: ${OS_TOKEN}\" \\\n  -H \"Content-Type: application/json\" | json_pp\n</code></pre> <p>[\ud655\uc778 \ud3ec\uc778\ud2b8]</p> <ul> <li><code>status</code>: \"ACTIVE\"</li> <li><code>flavor.id</code>: \uc704\uc5d0\uc11c \uc870\ud68c\ud55c <code>&lt;FLAVOR_ID&gt;</code>\uc640 \uc77c\uce58\ud574\uc57c \ud568</li> </ul>"},{"location":"openstack/tools/add-ironic/","title":"\ud83d\udfe5 OpenStack Ironic \ubca0\uc5b4\uba54\ud0c8 \uad6c\ucd95 \uac00\uc774\ub4dc (Final Master)","text":"<p>\uc791\uc131\uc77c: 2026-01-14 \uc544\ud0a4\ud14d\ucc98: Controller-Network \ubd84\ub9ac\ud615 (Ironic \uc11c\ube44\uc2a4 \uc804\uccb4\ub97c Network Node\ub85c \uc774\ub3d9) \ub300\uc0c1 \uc7a5\ube44:</p> <ul> <li>Controller (<code>cstation</code>): \uc81c\uc5b4(API), DB, \uba54\uc2dc\uc9c0\ud050 (\uae30\uc874 \uc720\uc9c0)</li> <li>Network Node (<code>cstrato1</code>): Ironic \uc11c\ube44\uc2a4, OVS, \ubb3c\ub9ac \uc5f0\uacb0(<code>eno4</code>)</li> <li>Baremetal (<code>HP G8</code>): \ud0c0\uac9f \uc7a5\ube44 (2\ub300)</li> </ul>"},{"location":"openstack/tools/add-ironic/#1-controller","title":"1. [Controller] \uc794\uc5ec \uc124\uc815 \ud655\uc778 (\ucda9\ub3cc \ubc29\uc9c0)","text":"<p><code>[Controller Node - cstation]</code>\uc5d0\uc11c \uc218\ud589</p> <p>Network Node\ub85c \uc5ed\ud560\uc744 \ub118\uae30\uae30 \uc804, Controller\uc5d0 \ud639\uc2dc \ub0a8\uc544\uc788\uc744 \uc218 \uc788\ub294 \uc124\uc815\uc744 \uc815\ub9ac\ud569\ub2c8\ub2e4.</p> <pre><code># 1. Controller\uc5d0 br-ironic\uc774 \uc5c6\uc5b4\uc57c \uc815\uc0c1\nip addr show br-ironic\n# -&gt; \ub9cc\uc57d \uc788\ub2e4\uba74: sudo ip link delete br-ironic\n\n# 2. Netplan\uc5d0\uc11c eno4 IP\uac00 \uc5c6\ub294\uc9c0 \ud655\uc778\ncat /etc/netplan/50-cloud-init.yaml\n\n# 3. Systemd \uc794\uc5ec \ud655\uc778\nls /etc/systemd/system/setup-br-ironic.service\n# -&gt; \ub9cc\uc57d \uc788\ub2e4\uba74: sudo rm /etc/systemd/system/setup-br-ironic.service &amp;&amp; sudo systemctl daemon-reload\n</code></pre>"},{"location":"openstack/tools/add-ironic/#2-baremetal-target-node-","title":"2. [Baremetal] \uc0ac\uc804 \uc900\ube44 (Target Node) - \ubc29\ubc95 \uc120\ud0dd","text":"<p>\ubca0\uc5b4\uba54\ud0c8 \ub178\ub4dc(HP G8)\uc758 BIOS\uc640 iLO\ub97c \uc124\uc815\ud569\ub2c8\ub2e4. \uc544\ub798 \ub450 \uac00\uc9c0 \ubc29\ubc95 \uc911 \ud558\ub098\ub97c \uc120\ud0dd\ud558\uc138\uc694.</p>"},{"location":"openstack/tools/add-ironic/#a","title":"\u2705 [\uc635\uc158 A] \ud604\uc7a5 \uc791\uc5c5 (\ubaa8\ub2c8\ud130/\ud0a4\ubcf4\ub4dc \uc5f0\uacb0)","text":"<p>\uc11c\ubc84\uc2e4\uc5d0 \ub4e4\uc5b4\uac00\uc11c \uc9c1\uc811 \ubaa8\ub2c8\ud130\ub97c \ubcf4\uace0 \uc791\uc5c5\ud558\ub294 \uacbd\uc6b0\uc785\ub2c8\ub2e4.</p> <ol> <li>iLO IP \uc124\uc815: \ubd80\ud305 \uc2dc F8 \uc9c4\uc785 \u2192 IP 10.10.10.69 (Node1) / 10.10.10.70 (Node2) \uc124\uc815.</li> <li>BIOS \uc124\uc815: \ubd80\ud305 \uc2dc F9 \uc9c4\uc785.<ul> <li>Boot Mode: Legacy BIOS Mode (\ud544\uc218)</li> <li>Network Boot Options: NIC 1\uc744 1\uc21c\uc704\ub85c.</li> <li>Power Management: Static High Performance.</li> </ul> </li> <li>MAC \ud655\uc778: OS \uc9c4\uc785 \ud6c4 ip link show eno1 \ub610\ub294 BIOS \uba54\ub274\uc5d0\uc11c \ud655\uc778.</li> </ol>"},{"location":"openstack/tools/add-ironic/#b-ssh-text-console","title":"\u2705 [\uc635\uc158 B] \uc6d0\uaca9 \uc791\uc5c5 (SSH &amp; Text Console)","text":"<p>\uc11c\ubc84\uc2e4\uc5d0 \uac00\uc9c0 \uc54a\uace0, \ud604\uc7ac \uc124\uce58\ub41c OS(Ubuntu \ub4f1)\uc5d0 SSH\ub85c \uc811\uc18d\ud574 \uc791\uc5c5\ud558\ub294 \uacbd\uc6b0\uc785\ub2c8\ub2e4.</p>"},{"location":"openstack/tools/add-ironic/#step-1-os-ilo-ip-mac","title":"Step 1: OS\uc5d0\uc11c iLO IP \uc124\uc815 \ubc0f MAC \ud655\uc778","text":"<pre><code># (Baremetal OS \ud130\ubbf8\ub110\uc5d0\uc11c \uc218\ud589)\n# 1. MAC \uc8fc\uc18c \uae30\ub85d\nip link show eno1 | grep ether\n# \uc608: ac:16:2d:77:93:94\n\n# 2. ipmitool \uc124\uce58\nsudo apt update &amp;&amp; sudo apt install ipmitool -y\nsudo modprobe ipmi_devintf &amp;&amp; sudo modprobe ipmi_si\n\n# [\uc911\uc694] 2-1. IPMI \ub4dc\ub77c\uc774\ubc84 \uc815\uc0c1 \ub3d9\uc791 \ud655\uc778\n# \uc544\ub798 \uba85\ub839\uc5b4\ub97c \ucce4\uc744 \ub54c \uc81c\uc870\uc0ac \uc815\ubcf4(Device ID, Manufacturer \ub4f1)\uac00 \ub5a0\uc57c \uc815\uc0c1\uc785\ub2c8\ub2e4.\n# \ub9cc\uc57d \"Could not open device...\" \uc5d0\ub7ec\uac00 \ub098\uba74 \ud558\ub4dc\uc6e8\uc5b4 \uc9c0\uc6d0 \ubb38\uc81c\uac70\ub098 \uc7ac\ubd80\ud305 \ud544\uc694.\nsudo ipmitool mc info\n\n# [\uc911\uc694] 2-2. \uc62c\ubc14\ub978 LAN \ucc44\ub110 \ubc88\ud638 \ucc3e\uae30 (1\ubc88 \ub610\ub294 2\ubc88, \ub4dc\ubb3c\uac8c 8\ubc88)\n# \ubcf4\ud1b5 HPE\ub294 2\ubc88, Dell\uc740 1\ubc88\uc785\ub2c8\ub2e4.\n# \uc544\ub798 \uba85\ub839\uc5b4\ub97c \ud558\ub098\uc529 \uc785\ub825\ud574\uc11c \"IP Address\" \ub4f1\uc758 \uc815\ubcf4\uac00 \ub728\ub294 \ucc44\ub110\uc774 \uc815\ub2f5\uc785\ub2c8\ub2e4.\n\necho \"--- Channel 1 \ud655\uc778 ---\"\nsudo ipmitool lan print 1\n\necho \"--- Channel 2 \ud655\uc778 ---\"\nsudo ipmitool lan print 2\n\n# (Tip: \"Invalid channel\" \uc774\ub77c\uace0 \ub728\uba74 \uadf8 \ubc88\ud638\ub294 \uc544\ub2d9\ub2c8\ub2e4.)\n# (HPE G8/G9/G10\uc740 \ub300\ubd80\ubd84 '2\ubc88'\uc774 \uc815\ub2f5\uc785\ub2c8\ub2e4.)\n\n# 3. iLO IP \uc124\uc815 (\uc608: Node 1)\nsudo ipmitool lan set 2 ipsrc static\nsudo ipmitool lan set 2 ipaddr 10.10.10.69\nsudo ipmitool lan set 2 netmask 255.255.255.0\nsudo ipmitool lan set 2 defgw ipaddr 10.10.10.1\n\n# 4. iLO \uacc4\uc815 \uc124\uc815\nsudo ipmitool user set password 2 \"FVQBAQ2Q\"\nsudo ipmitool user enable 2\n</code></pre> <p>\uc124\uc815\uc774 \uc801\uc6a9\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code># \ucc44\ub110 2\ubc88(HP Dedicated iLO Port)\uc758 \uc124\uc815\uac12 \ucd9c\ub825\nsudo ipmitool lan print 2\n\n# \uacb0\uacfc \uc608\uc2dc\n# IP Address Source: Static Address (\uc911\uc694)\n# IP Address: 10.10.10.69\n# Subnet Mask: 255.255.255.0\n# Default Gateway IP: 10.10.10.1\n</code></pre> <pre><code># \uc0ac\uc6a9\uc790 \ud65c\uc131\ud654 \ud655\uc778\nsudo ipmitool user list 2\n\n# \uacb0\uacfc \uc608\uc2dc\n# ID  Name             Callin  Link Auth  IPMI Msg   Channel Priv Limit\n# 1   Administrator    true    false      true       ADMINISTRATOR\n# 2   admin            true    false      true       ADMINISTRATOR\n</code></pre> <p><code>iLO Advanced</code> \ub77c\uc774\uc13c\uc2a4 \uc720\ubb34\uc5d0 \ub530\ub77c \ub458 \uc911 \ud558\ub098\ub97c \ud0dd\ud574\uc11c \uc9c4\ud589\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/tools/add-ironic/#step-2-1-ilo-advanced-x","title":"Step 2-1: \uc11c\ubc84\uc2e4 \uc774\ub3d9(iLO Advanced \ub77c\uc774\uc13c\uc2a4 X)","text":"<p>\uc544\ub798 \uc124\uc815\ub9cc \uc9c1\uc811 \ud574\uc90d\ub2c8\ub2e4.</p> <ol> <li>BIOS \uc124\uc815: \ubd80\ud305 \uc2dc F9 \uc9c4\uc785.<ul> <li>Boot Mode: Legacy BIOS Mode (\ud544\uc218)</li> <li>Network Boot Options: NIC 1\uc744 1\uc21c\uc704\ub85c.</li> </ul> </li> </ol>"},{"location":"openstack/tools/add-ironic/#step-2-2-ilo-bios-ilo-advanced","title":"Step 2-2: iLO \uc6d0\uaca9 \ucf58\uc194\ub85c BIOS \uc124\uc815(iLO Advanced \ub77c\uc774\uc13c\uc2a4 \ud544\uc694)","text":"<p>\uc544\ub798 \uc791\uc5c5\uc740 <code>iLO Advanced</code> \ub77c\uc774\uc13c\uc2a4\uac00 \ud544\uc694\ud569\ub2c8\ub2e4. \ub610\ud55c \uc544\ub798 iLO \ud3ec\ud2b8\uac00 \uc5f0\uacb0\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># (\ub0b4 PC \ub610\ub294 Controller\uc5d0\uc11c \uc218\ud589)\n# 1. iLO SSH \uc811\uc18d\nssh Administrator@10.10.10.69\n# (\ube44\ubc00\ubc88\ud638: FVQBAQ2Q)\n\n# 2. \ud14d\uc2a4\ud2b8 \ucf58\uc194 \uc2e4\ud589\nhpiLO-&gt; TEXTCONS\n\n# 3. \uc7ac\ubd80\ud305 \ubc0f F9 \uc9c4\uc785\n# (\ub2e4\ub978 \ud130\ubbf8\ub110\uc5d0\uc11c \uc11c\ubc84\ub97c reboot \ud558\uac70\ub098, iLO\uc5d0\uc11c power reset)\n# \ud654\uba74\uc5d0 \"Press F9\"\uac00 \ub098\uc624\uba74 [F9] \ud0a4 \uc5f0\ud0c0 (\uc548 \ub418\uba74 [Esc]+[9])\n\n# 4. BIOS \uc124\uc815 (\ubc29\ud5a5\ud0a4 \uc0ac\uc6a9)\n# - System Options -&gt; Boot Mode -&gt; Legacy BIOS Mode\n# - Network Options -&gt; Network Boot -&gt; NIC 1 (1st)\n# - Power Management -&gt; Static High Performance\n# - [F10] \uc800\uc7a5 \ubc0f \uc885\ub8cc\n</code></pre>"},{"location":"openstack/tools/add-ironic/#3","title":"3. [\ubb3c\ub9ac \uc791\uc5c5] \ucf00\uc774\ube14 \uc5f0\uacb0","text":"<p>\uc11c\ubc84\uc2e4\uc5d0 \ub4e4\uc5b4\uac00\uc11c \ubb3c\ub9ac \ud3ec\ud2b8 \uc704\uce58\ub97c \ubcc0\uacbd\ud574\uc90d\ub2c8\ub2e4. \ud658\uacbd\uc5d0 \ub530\ub77c \uc5f0\uacb0\ud560 \ud3ec\ud2b8, \uc2a4\uc704\uce58 \ub4f1\uc774 \ub2e4\ub97c \uc218 \uc788\uc73c\ub2c8 \ud658\uacbd\uc5d0 \ub9de\ucdb0 \uc9c4\ud589\ud569\ub2c8\ub2e4.</p> <pre><code>+-------------------------+              +-------------------------+\n| Network Node (cstrato1) |              | Baremetal Node (HP G8)  |\n|                         |              |                         |\n|      [eno4] (New)       |              |      [NIC 1] (Data)     |\n+---------+---------------+              +------------+------------+\n          |                                           |\n          |                                           |\n          v                                           v\n+------------------------------------------------------------------+\n|               Unmanaged Switch (Provisioning Net)                |\n|           (DO NOT CONNECT TO OFFICE NETWORK / INTERNET)          |\n|                 subnet: 172.20.50.0/24                           |\n+------------------------------------------------------------------+\n\n\n--------------------------------------------------------------------\n\n\n+-------------------------+              +-------------------------+\n|     Intranet Switch     |              | Baremetal Node (HP G8)  |\n|   (Office Network)      |              |                         |\n|   subnet: 10.10.10.x    +-------------&gt;|       [iLO] (Mgmt)      |\n+-------------------------+              +-------------------------+\n</code></pre> <p>\ud3ec\ud2b8 \uc791\uc5c5 \uc644\ub8cc \ud6c4, \ucee8\ud2b8\ub864 \ub178\ub4dc\uc5d0\uc11c \uc544\ub798 \uc791\uc5c5\uc744 \uc218\ud589\ud558\uc5ec \uc815\uc0c1 \ub3d9\uc791\uc744 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <p><code>[Controller Node - cstation]</code>\uc5d0\uc11c \uc218\ud589</p> <pre><code># 1. \ud551 \ud14c\uc2a4\ud2b8 (\ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0 \ud655\uc778)\nping -c 3 10.10.10.69\n\n# 2. \uc2e4\uc81c \ub85c\uadf8\uc778 \ubc0f \uc804\uc6d0 \uc0c1\ud0dc \ud655\uc778 (\ube44\ubc00\ubc88\ud638 \uac80\uc99d)\n# (\ube44\ubc00\ubc88\ud638 'FVQBAQ2Q'\ub294 \uc608\uc2dc\uc785\ub2c8\ub2e4. \uc2e4\uc81c \uc124\uc815\ud55c \uac12\uc744 \ub123\uc73c\uc138\uc694)\nipmitool -I lanplus -H 10.10.10.69 -U Administrator -P 'FVQBAQ2Q' power status\n</code></pre>"},{"location":"openstack/tools/add-ironic/#4-network-node-ovs","title":"4. [Network Node] \ub124\ud2b8\uc6cc\ud06c \ubc0f OVS \uc124\uc815","text":"<p><code>[Network Node - cstrato1]</code> \uc5d0\uc11c \uc218\ud589</p>"},{"location":"openstack/tools/add-ironic/#4-1-netplan-ip","title":"4-1. Netplan \uc218\uc815 (IP \uc81c\uac70)","text":"<pre><code>sudo nano /etc/netplan/50-cloud-init.yaml\n# \uc544\ub798 \ub0b4\uc6a9\uc744 \ucd94\uac00 \ud639\uc740 \uc218\uc815\n...\n    eno4:\n      dhcp4: false\n      dhcp6: false\n      optional: true\n</code></pre> <p>\uc218\uc815\ud588\uc73c\uba74 \uc544\ub798 \uba85\ub839\uc5b4\ub85c \uc801\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code>sudo netplan apply\n</code></pre>"},{"location":"openstack/tools/add-ironic/#4-2-ip","title":"4-2. \ube0c\ub9ac\uc9c0 \uc0dd\uc131 \ubc0f IP \ud560\ub2f9 \uc2a4\ud06c\ub9bd\ud2b8","text":"<p>Ironic\uc774 \uc774 \ub178\ub4dc\uc5d0 \uc788\uc73c\ubbc0\ub85c, Gateway IP(172.20.50.1) \ub97c \uc5ec\uae30\uc11c \ud560\ub2f9\ud569\ub2c8\ub2e4.</p> <pre><code>sudo tee /usr/local/bin/setup-br-ironic.sh &lt;&lt; 'EOF'\n#!/bin/bash\nset -e\nif ! docker ps | grep -q openvswitch_vswitchd; then\n    echo \"\u274c OVS \ucee8\ud14c\uc774\ub108 \uc5c6\uc74c. Network Node \ud655\uc778 \uc694\ub9dd\"\n    exit 1\nfi\n\n# 1. \ube0c\ub9ac\uc9c0 \ubc0f \ud3ec\ud2b8 \uc5f0\uacb0\ndocker exec openvswitch_vswitchd ovs-vsctl --may-exist add-br br-ironic\ndocker exec openvswitch_vswitchd ovs-vsctl --may-exist add-port br-ironic eno4\n\n# 2. [\ud544\uc218] Gateway IP \ud560\ub2f9\nsudo ip link set br-ironic up\nsudo ip addr flush dev br-ironic 2&gt;/dev/null || true\nsudo ip addr add 172.20.50.1/24 dev br-ironic\n\n# 3. \ubb3c\ub9ac \ud3ec\ud2b8 \uc815\ub9ac\nsudo ip addr flush dev eno4 2&gt;/dev/null || true\n\necho \"\u2705 br-ironic (172.20.50.1) \uc124\uc815 \uc644\ub8cc\"\nEOF\n\nsudo chmod +x /usr/local/bin/setup-br-ironic.sh\nsudo /usr/local/bin/setup-br-ironic.sh\n</code></pre>"},{"location":"openstack/tools/add-ironic/#4-3-systemd","title":"4-3. \uc7ac\ubd80\ud305 \ub300\ube44 (Systemd \ub4f1\ub85d)","text":"<p>\ubc30\ud3ec \ub3c4\uc911 \uc7ac\ubd80\ud305\ub418\uc5b4\ub3c4 \uc124\uc815\uc774 \uc720\uc9c0\ub418\ub3c4\ub85d \ubbf8\ub9ac \ub4f1\ub85d\ud569\ub2c8\ub2e4.</p> <pre><code>sudo tee /etc/systemd/system/setup-br-ironic.service &lt;&lt; 'EOF'\n[Unit]\nDescription=Setup OVS br-ironic bridge for Ironic\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nType=oneshot\nExecStartPre=/bin/sleep 30\nExecStart=/usr/local/bin/setup-br-ironic.sh\nRemainAfterExit=yes\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsudo systemctl daemon-reload\nsudo systemctl enable setup-br-ironic.service\n</code></pre>"},{"location":"openstack/tools/add-ironic/#5-controller-kolla","title":"5. [Controller] Kolla \uc124\uc815 \ubc0f \ubc30\ud3ec","text":"<p><code>[Controller Node - cstation]</code> \uc5d0\uc11c \uc218\ud589</p>"},{"location":"openstack/tools/add-ironic/#5-1-inventory","title":"5-1. Inventory \uc218\uc815 (\ud575\uc2ec)","text":"<p>Ironic \uc11c\ube44\uc2a4\ub97c Network Node \uadf8\ub8f9\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4.</p> <pre><code>sudo nano /etc/kolla/inventory/multinode\n</code></pre> <pre><code># [\uc218\uc815 \uc804]\n# [ironic:children]\n# control\n\n# [\uc218\uc815 \ud6c4] \uae30\uc874 control\uc744 \uc9c0\uc6b0\uace0 network\ub85c \ubcc0\uacbd\n[ironic:children]\nnetwork\n</code></pre>"},{"location":"openstack/tools/add-ironic/#5-2-globalsyml","title":"5-2. globals.yml \uc218\uc815","text":"<pre><code>sudo nano /etc/kolla/globals.yml\n</code></pre> <pre><code>enable_ironic: \"yes\"\nenable_ironic_neutron_agent: \"yes\"\nenable_ironic_pxe: \"yes\"\nenable_ironic_ipxe: \"yes\"\n\n# [\uc911\uc694] Network Node\uc758 \ube0c\ub9ac\uc9c0 \uc774\ub984 \uc9c0\uc815\nironic_dnsmasq_interface: \"br-ironic\"\n\n# DHCP \ubc94\uc704\nironic_dnsmasq_dhcp_ranges:\n  - range: \"172.20.50.10,172.20.50.50\"\n    routers: \"172.20.50.1\"\n\n# \ucd08\uae30\uc5d4 none\nironic_cleaning: \"none\"\n\nneutron_ml2_flat_networks: \"physnet1,physnet_ironic\"\n\n# Ironic API\uac00 Network Node\uc5d0 \uc788\uc73c\ubbc0\ub85c, \ud574\ub2f9 \ub178\ub4dc\uc758 IP\ub97c \uc9c0\uc815\nironic_internal_fqdn: \"10.10.10.61\"\nironic_external_fqdn: \"10.10.10.61\"\nironic_api_port: \"6385\"\n</code></pre>"},{"location":"openstack/tools/add-ironic/#5-3-neutron-config-override","title":"5-3. Neutron Config Override","text":"<pre><code>sudo mkdir -p /etc/kolla/config/neutron\nsudo tee /etc/kolla/config/neutron/openvswitch_agent.ini &lt;&lt; 'EOF'\n[ovs]\nbridge_mappings = physnet1:br-ex,physnet_ironic:br-ironic\nEOF\n\nsudo tee /etc/kolla/config/neutron/ml2_conf.ini &lt;&lt; 'EOF'\n[ml2_type_flat]\nflat_networks = physnet1,physnet_ironic\nEOF\n</code></pre>"},{"location":"openstack/tools/add-ironic/#5-4","title":"5-4. \uc11c\ube44\uc2a4 \ubc30\ud3ec","text":"<pre><code># 1. Ironic \ubc30\ud3ec (cstrato1\uc5d0 \uc124\uce58\ub428)\nkolla-ansible deploy -i multinode --tags ironic\n\n# 2. Neutron \uc124\uc815 \uac31\uc2e0 (\ub9e4\ud551 \uc801\uc6a9)\nkolla-ansible reconfigure -i multinode --tags neutron\n\n# 3. Nova \uc124\uc815 \uac31\uc2e0 (Driver \uc778\uc2dd)\nkolla-ansible reconfigure -i multinode --tags nova\n</code></pre>"},{"location":"openstack/tools/add-ironic/#6-controller","title":"6. [Controller] \ub9ac\uc18c\uc2a4 \uc0dd\uc131","text":"<p><code>[Controller Node - cstation]</code>\uc5d0\uc11c \uc218\ud589</p>"},{"location":"openstack/tools/add-ironic/#6-1","title":"6-1. \ub124\ud2b8\uc6cc\ud06c \uc0dd\uc131","text":"<pre><code>openstack network create --share --provider-network-type flat \\\n  --provider-physical-network physnet_ironic provisioning-net\n\n# Gateway\ub294 Network Node\uc5d0 \ud560\ub2f9\ud55c IP(172.20.50.1)\uc640 \uc77c\uce58\ud574\uc57c \ud568\nopenstack subnet create --network provisioning-net \\\n  --subnet-range 172.20.50.0/24 \\\n  --gateway 172.20.50.1 \\\n  --allocation-pool start=172.20.50.10,end=172.20.50.50 \\\n  --dns-nameserver 8.8.8.8 provisioning-subnet\n</code></pre>"},{"location":"openstack/tools/add-ironic/#6-2","title":"6-2. \ub77c\uc6b0\ud130 \uc0dd\uc131(\uc678\ubd80 \uc811\uadfc\uc6a9)","text":"<pre><code># 1. \ud604\uc7ac \uc678\ubd80\ub9dd \uc774\ub984 \ud655\uc778\nopenstack network list --external\n# \uacb0\uacfc \uc608: external (\uc774 \uc774\ub984\uc744 \uc544\ub798\uc5d0\uc11c \uc0ac\uc6a9)\n\n# 2. \ub77c\uc6b0\ud130 \uc0dd\uc131\nopenstack router create ironic-router\n\n# 3. \uc678\ubd80\ub9dd \uc5f0\uacb0 (Gateway \uc124\uc815)\n# \"external\" \ubd80\ubd84\uc744 \uc2e4\uc81c \uc678\ubd80\ub9dd \uc774\ub984\uc73c\ub85c \ubcc0\uacbd\ud558\uc138\uc694\nopenstack router set --external-gateway external ironic-router\n\n# 4. \ubc30\ud3ec\ub9dd \uc5f0\uacb0 (Interface \ucd94\uac00)\nopenstack router add subnet ironic-router provisioning-subnet\n\n# 5. \ub77c\uc6b0\ud130 \uc0c1\ud0dc \ud655\uc778\nopenstack router show ironic-router\n</code></pre>"},{"location":"openstack/tools/add-ironic/#6-3-cleaning","title":"6-3. Cleaning \ud65c\uc131\ud654","text":"<p>\ub124\ud2b8\uc6cc\ud06c\uac00 \uc0dd\uc131\ub418\uc5c8\uc73c\ubbc0\ub85c Cleaning\uc744 \ucf2d\ub2c8\ub2e4.</p> <pre><code>sudo nano /etc/kolla/globals.yml\n</code></pre> <pre><code>ironic_cleaning: \"metadata\"\nironic_cleaning_network: \"provisioning-net\"\n</code></pre> <pre><code># \uc124\uc815 \uc801\uc6a9\nkolla-ansible reconfigure -i multinode --tags ironic\n</code></pre>"},{"location":"openstack/tools/add-ironic/#6-4-flavor","title":"6-4. \uc774\ubbf8\uc9c0 \ubc0f Flavor \uc0dd\uc131","text":"<pre><code># \uc791\uc5c5 \ub514\ub809\ud1a0\ub9ac\nmkdir -p ~/ironic_images &amp;&amp; cd ~/ironic_images\n\n# IPA \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc\nwget https://tarballs.opendev.org/openstack/ironic-python-agent/dib/files/ipa-centos9-master.kernel\nwget https://tarballs.opendev.org/openstack/ironic-python-agent/dib/files/ipa-centos9-master.initramfs\n\n# IPA \uc774\ubbf8\uc9c0 \ub4f1\ub85d\nopenstack image create --file ipa-centos9-master.kernel \\\n  --public --container-format aki --disk-format aki deploy-kernel\nopenstack image create --file ipa-centos9-master.initramfs \\\n  --public --container-format ari --disk-format ari deploy-ramdisk\n\n# OS \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc \ubc0f \ub4f1\ub85d\nwget https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.img\nopenstack image create --file jammy-server-cloudimg-amd64.img \\\n  --disk-format qcow2 --container-format bare \\\n  --property hypervisor_type=ironic \\\n  --public ubuntu-22.04\n\n# Flavor \uc0dd\uc131\nopenstack flavor create --ram 65536 --vcpus 24 --disk 500 \\\n  --property resources:VCPU=0 \\\n  --property resources:MEMORY_MB=0 \\\n  --property resources:DISK_GB=0 \\\n  --property resources:CUSTOM_BAREMETAL_HP_G8=1 \\\n  bm.hp-g8\n</code></pre>"},{"location":"openstack/tools/add-ironic/#6-5-2","title":"6-5. \ub178\ub4dc \ub4f1\ub85d (2\ub300)","text":"<p>\ub9cc\uc57d <code>Ironic</code> \ud50c\ub7ec\uadf8\uc778\uc774 \uc5c6\ub2e4\uba74 \uba3c\uc800 \uc124\uce58\ud569\ub2c8\ub2e4.</p> <pre><code># 1. Ironic \ud074\ub77c\uc774\uc5b8\ud2b8 \ud50c\ub7ec\uadf8\uc778 \uc124\uce58\npip install python-ironicclient\n\n# 2. \uc124\uce58\uac00 \uc798 \ub410\ub294\uc9c0 \ud655\uc778 (\uc774\uc81c \uba85\ub839\uc5b4\uac00 \uba39\ud600\uc57c \ud569\ub2c8\ub2e4)\nopenstack baremetal list\n</code></pre> <p>\uc544\ub798 node1\uc744 \ub4f1\ub85d\ud558\ub4ef\uc774, \uac12\ub9cc \ubc14\uafd4\uc11c \uc5ec\ub7ec \ub178\ub4dc\ub97c \ub4f1\ub85d\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code>KERNEL_ID=$(openstack image show deploy-kernel -f value -c id)\nRAMDISK_ID=$(openstack image show deploy-ramdisk -f value -c id)\nILO_PASS=\"FVQBAQ2Q\"\n\n# Node 1 \ub4f1\ub85d\nopenstack baremetal node create --driver ipmi --name hp-g8-01 \\\n  --driver-info ipmi_address=10.10.10.69 \\\n  --driver-info ipmi_username=Administrator \\\n  --driver-info ipmi_password=$ILO_PASS \\\n  --driver-info deploy_kernel=$KERNEL_ID \\\n  --driver-info deploy_ramdisk=$RAMDISK_ID \\\n  --resource-class BAREMETAL_HP_G8 \\\n  --network-interface flat \\\n  --property cpus=24 --property memory_mb=65536 --property local_gb=500\n\n# \uc0dd\uc131\ub41c baremetal node\uc758 uuid \ud655\uc778\nopenstack baremetal node list | grep hp-g8-01\n\n# \ub4f1\ub85d\nopenstack baremetal port create --node &lt;hp-g8-01\uc758 uuid&gt; \"ac:16:2d:77:93:94\"\n</code></pre>"},{"location":"openstack/tools/add-ironic/#7-controller","title":"7. [Controller] \ucd5c\uc885 \uac80\uc99d","text":"<p><code>[Controller Node - cstation]</code>\uc5d0\uc11c \uc218\ud589</p> <pre><code># 1. \uad00\ub9ac \ubaa8\ub4dc \uc804\ud658 (Ironic -&gt; iLO \uc5f0\uacb0 \ud14c\uc2a4\ud2b8)\nopenstack baremetal node manage hp-g8-01\n\n# 2. \uc0c1\ud0dc \ud655\uc778 (manageable)\nwatch -n 5 \"openstack baremetal node list\"\n\n# 3. \uc0ac\uc6a9 \uac00\ub2a5 \ubaa8\ub4dc \uc804\ud658 (Cleaning \uc218\ud589\ub428 -&gt; \uc804\uc6d0 \ucf1c\uc9d0/\uaebc\uc9d0 \ubc18\ubcf5)\nopenstack baremetal node provide hp-g8-01\n\n# 4. Keypair \uc0dd\uc131\nopenstack keypair create --public-key ~/.ssh/id_rsa.pub mykey 2&gt;/dev/null || true\n\n# 5. \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 (available \uc0c1\ud0dc\uac00 \ub41c \ud6c4)\nopenstack server create --flavor bm.hp-g8 --image ubuntu-22.04 --network provisioning-net --key-name mykey test-bm\n\n# 6. \uc0c1\ud0dc \ud655\uc778\nwatch openstack server list\n</code></pre>"},{"location":"openstack/tools/add-ironic/#8","title":"8. \ud2b8\ub7ec\ube14\uc288\ud305","text":"<ul> <li>IPMI \uc5d0\ub7ec:</li> </ul> <pre><code># Controller\uc5d0\uc11c \uc2e4\ud589\nipmitool -I lanplus -H 10.10.10.69 -U Administrator -P 'FVQBAQ2Q' power status\n</code></pre> <ul> <li>OVS \ud655\uc778:</li> </ul> <pre><code># Network Node\uc5d0\uc11c\ndocker exec openvswitch_vswitchd ovs-vsctl show\n</code></pre> <ul> <li>Ironic \ub85c\uadf8:</li> </ul> <pre><code># Network Node\uc5d0\uc11c\ndocker logs ironic_conductor --tail 100\n</code></pre> <ul> <li>PXE \ud328\ud0b7:</li> </ul> <pre><code># Network Node\uc5d0\uc11c\nsudo tcpdump -i br-ironic -n port 67 or port 68\n</code></pre> <ul> <li>Node \uc5d0\ub7ec:</li> </ul> <pre><code># Controller\uc5d0\uc11c \uc2e4\ud589\nopenstack baremetal node show hp-g8-01 -f json | jq '.last_error'\n</code></pre>"},{"location":"openstack/tools/add-ironic/#_1","title":"\ud83d\udccb \ucd5c\uc885 \uccb4\ud06c\ub9ac\uc2a4\ud2b8","text":"<ul> <li>[ ] 1. Controller \uc794\uc5ec \uc124\uc815 \ud655\uc778/\uc0ad\uc81c</li> <li>[ ] 2. Baremetal BIOS(Legacy) \ubc0f iLO \uc124\uc815</li> <li>[ ] 3. \ubb3c\ub9ac \ucf00\uc774\ube14 \uc5f0\uacb0 (Network Node)</li> <li>[ ] 4. Network Node \uc124\uc815 (Netplan, Script, Systemd)</li> <li>[ ] 5. Inventory \uc218\uc815 (<code>[ironic] -&gt; network</code>)</li> <li>[ ] 6. \uc11c\ube44\uc2a4 \ubc30\ud3ec (deploy -&gt; reconfigure)</li> <li>[ ] 7. \ub9ac\uc18c\uc2a4 \uc0dd\uc131 (Network, Cleaning\ud65c\uc131\ud654, Image, Node)</li> <li>[ ] 8. \uac80\uc99d (Manage -&gt; Provide -&gt; Create)</li> </ul>"},{"location":"openstack/troubleshooting/k8s-network-error/","title":"OpenStack K8s \ub124\ud2b8\uc6cc\ud06c \ud1b5\uc2e0 \uc7a5\uc560 \ubc0f Harbor \ubc30\ud3ec \uc2e4\ud328","text":""},{"location":"openstack/troubleshooting/k8s-network-error/#1-issue-summary","title":"1. \uac1c\uc694 (Issue Summary)","text":"<ul> <li> <p>\uc99d\uc0c1:</p> </li> <li> <p>OpenStack \uae30\ubc18 Kubernetes \ud074\ub7ec\uc2a4\ud130 \uad6c\ucd95 \ud6c4, Pod \uac04 \ud1b5\uc2e0 \ubc0f Service IP(<code>ClusterIP</code>) \ud1b5\uc2e0 \ubd88\uac00.</p> </li> <li><code>nslookup</code> \ud0c0\uc784\uc544\uc6c3 \ubc0f Pod \ub0b4\ubd80\uc5d0\uc11c \uc678\ubd80 \uc778\ud130\ub137 \ud1b5\uc2e0 \ubd88\uac00.</li> <li> <p>\ub124\ud2b8\uc6cc\ud06c \uc7a5\uc560\ub85c \uc778\ud574 Harbor \uc124\uce58\uac00 \uc911\ub2e8\ub418\uc5c8\uc73c\uba70, <code>harbor-jobservice</code>\uac00 <code>harbor-core</code>\uc5d0 \uc5f0\uacb0\ud558\uc9c0 \ubabb\ud558\ub294 \uc624\ub958(<code>connection refused</code>) \ubc1c\uc0dd</p> </li> <li> <p>\uc601\ud5a5\ub3c4: \ud074\ub7ec\uc2a4\ud130 \ub0b4 \ubaa8\ub4e0 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud1b5\uc2e0 \ub450\uc808, \uc2e0\uaddc \uc194\ub8e8\uc158(Harbor) \ubc30\ud3ec \ubd88\uac00.</p> </li> </ul>"},{"location":"openstack/troubleshooting/k8s-network-error/#2-environment","title":"2. \ud658\uacbd \uc815\ubcf4 (Environment)","text":"<ul> <li>Infra: OpenStack Flamingo (2025.2)</li> <li>OS: Ubuntu 22.04 LTS</li> <li>Kubernetes: v1.33 (Master 1, Worker 3)</li> <li>CNI: Calico (Overlay Network)</li> <li>Application: Harbor Registry</li> </ul>"},{"location":"openstack/troubleshooting/k8s-network-error/#3-root-cause-analysis","title":"3. \uc6d0\uc778 \ubd84\uc11d (Root Cause Analysis)","text":""},{"location":"openstack/troubleshooting/k8s-network-error/#31-openstack-port-security","title":"3.1. \ud575\uc2ec \uc6d0\uc778: OpenStack Port Security","text":"<ul> <li>\ud604\uc0c1: Kubernetes CNI(Calico)\ub294 Pod\ub9c8\ub2e4 \uace0\uc720 IP \ub300\uc5ed(\uc608: <code>10.244.x.x</code>)\uc744 \ud560\ub2f9\ud568.</li> <li>\uc6d0\uc778: OpenStack Neutron\uc758 Port Security(\ud3ec\ud2b8 \ubcf4\uc548) \uae30\ub2a5\uc740 VM\uc758 \ub124\ud2b8\uc6cc\ud06c \uc778\ud130\ud398\uc774\uc2a4(Port)\uc5d0 \ud560\ub2f9\ub41c \uace0\uc815 IP(<code>Fixed IP</code>) \uc774\uc678\uc758 \ud2b8\ub798\ud53d\uc774 \uac10\uc9c0\ub418\uba74 \uc774\ub97c **IP \uc2a4\ud478\ud551(IP Spoofing) \uacf5\uaca9\uc73c\ub85c \uac04\uc8fc\ud558\uc5ec \ucc28\ub2e8(Drop)**\ud568.</li> <li>\uacb0\uacfc: Pod\uc5d0\uc11c \ub098\uac00\ub294 \ubaa8\ub4e0 \uc624\ubc84\ub808\uc774 \ud2b8\ub798\ud53d\uc774 OpenStack \ub124\ud2b8\uc6cc\ud06c \ub808\ubca8\uc5d0\uc11c \ucc28\ub2e8\ub428.</li> </ul>"},{"location":"openstack/troubleshooting/k8s-network-error/#32-clusterip","title":"3.2. \ubd80\ucc28\uc801 \ud63c\ub780: ClusterIP\uc758 \ud2b9\uc131","text":"<ul> <li>\ud604\uc0c1: \ub124\ud2b8\uc6cc\ud06c \uc870\uce58 \ud6c4\uc5d0\ub3c4 Service IP(<code>10.96.0.1</code>)\ub85c Ping\uc774 \ub418\uc9c0 \uc54a\uc544 \ud574\uacb0\ub418\uc9c0 \uc54a\uc740 \uac83\uc73c\ub85c \uc624\uc778.</li> <li>\uc6d0\uc778: K8s\uc758 ClusterIP\ub294 \uac00\uc0c1 IP(iptables/IPVS \uaddc\uce59)\uc774\uba70, \uae30\ubcf8\uc801\uc73c\ub85c ICMP(Ping) \ud504\ub85c\ud1a0\ucf5c\uc744 \ucc98\ub9ac\ud558\uc9c0 \uc54a\uc74c.</li> <li>\uacb0\uacfc: Ping \uc2e4\ud328\ub294 \uc815\uc0c1\uc774\uc9c0\ub9cc, \uc774\ub97c \ub124\ud2b8\uc6cc\ud06c \uc7a5\uc560\ub85c \uc624\ud310\ud560 \ubed4\ud568. (TCP/UDP \uc5f0\uacb0 \ud14c\uc2a4\ud2b8\ub85c \uac80\uc99d \ud544\uc694)</li> </ul>"},{"location":"openstack/troubleshooting/k8s-network-error/#33-harbor","title":"3.3. Harbor \uc124\uce58 \uc2e4\ud328 \uc6d0\uc778","text":"<ul> <li>\ucd08\uae30 \ub124\ud2b8\uc6cc\ud06c \ub2e8\uc808 \uc0c1\ud0dc\uc5d0\uc11c \uc124\uce58\ub97c \uc2dc\ub3c4\ud558\uc5ec \ucd08\uae30\ud654 Job\uc774 \uc2e4\ud328\ud568.</li> <li>Helm \ucc28\ud2b8 \uc124\uce58 \uc2dc \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \ubbf8\uc9c0\uc815\uc73c\ub85c \uc778\ud574 PVC\uac00 <code>default</code> \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \uc0dd\uc131\ub418\uc5b4, \uc7ac\uc124\uce58 \uc2dc\uc5d0\ub3c4 \uae30\uc874 \uc624\uc5fc\ub41c \ubcfc\ub968\uc744 \ucc38\uc870\ud558\ub294 \ubb38\uc81c \ubc1c\uc0dd.</li> </ul>"},{"location":"openstack/troubleshooting/k8s-network-error/#4-troubleshooting-steps","title":"4. \ud574\uacb0 \uacfc\uc815 (Troubleshooting Steps)","text":""},{"location":"openstack/troubleshooting/k8s-network-error/#41","title":"4.1. \ub124\ud2b8\uc6cc\ud06c \uc9c4\ub2e8","text":"<ol> <li>\ud14c\uc2a4\ud2b8 Pod \ubc30\ud3ec: <code>dns-test</code> \ubc0f <code>netshoot</code> Pod \ubc30\ud3ec.</li> <li>\uc99d\uc0c1 \ud655\uc778:<ul> <li><code>ping 10.96.0.1</code> (API Server) -&gt; \uc2e4\ud328 (\uc815\uc0c1 \ub3d9\uc791\uc784)</li> <li><code>nslookup kubernetes.default</code> -&gt; \uc2e4\ud328 (Timeout, \ube44\uc815\uc0c1)</li> <li><code>wget https://10.96.0.1:443</code> -&gt; \uc2e4\ud328 (Timeout, \ube44\uc815\uc0c1)</li> </ul> </li> <li>\uc870\uce58 \uc218\ud589 (OpenStack): \ub9c8\uc2a4\ud130 \ubc0f \uc6cc\ucee4 \ub178\ub4dc\uc758 OpenStack Port\uc5d0 \uc124\uc815\ub41c Port Security \ube44\ud65c\uc131\ud654 \ubc0f Security Group \uc81c\uac70.</li> <li>\uac80\uc99d:<ul> <li><code>nslookup kubernetes.default</code> -&gt; \uc131\uacf5 (DNS \uc751\ub2f5 \uc218\uc2e0)</li> <li><code>wget https://10.96.0.1:443</code> -&gt; TLS Handshake Error \ubc1c\uc0dd (\ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0 \uc131\uacf5 \uc758\ubbf8)</li> <li><code>nc -zv 10.96.0.1 443</code> -&gt; Open \ud655\uc778.</li> </ul> </li> </ol>"},{"location":"openstack/troubleshooting/k8s-network-error/#42-harbor","title":"4.2. Harbor \ubcf5\uad6c","text":"<ol> <li>\uae30\uc874 \uc124\uce58 \uc81c\uac70: <code>helm uninstall harbor -n harbor</code></li> <li>\uc794\uc874 \ub370\uc774\ud130 \uc0ad\uc81c (\uc911\uc694): <code>default</code> \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \uc798\ubabb \uc0dd\uc131\ub41c PVC \uc77c\uad04 \uc0ad\uc81c.</li> <li><code>kubectl delete pvc --all -n default</code> (Harbor \uad00\ub828)</li> <li>\uc7ac\uc124\uce58: \ub124\ud2b8\uc6cc\ud06c \uc815\uc0c1\ud654 \ud655\uc778 \ud6c4 Helm \uc7ac\ubc30\ud3ec.</li> </ol>"},{"location":"openstack/troubleshooting/k8s-network-error/#5-solution","title":"5. \ucd5c\uc885 \ud574\uacb0\ucc45 (Solution)","text":""},{"location":"openstack/troubleshooting/k8s-network-error/#51-openstack","title":"5.1. OpenStack \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \ubcc0\uacbd","text":"<p>K8s \ub178\ub4dc(VM)\uac00 \uc0ac\uc6a9\ud558\ub294 Port\uc5d0 \ub300\ud574 \uc544\ub798 \ub450 \uac00\uc9c0 \ubc29\ubc95 \uc911 \ud558\ub098 \uc801\uc6a9.</p> <p>\ubc29\ubc95 A: Port Security \ube44\ud65c\uc131\ud654 (\ube60\ub978 \ud574\uacb0) \ubcf4\uc548 \uadf8\ub8f9\uc744 \uc81c\uac70\ud558\uace0 \ud3ec\ud2b8 \ubcf4\uc548\uc744 \ub054\uc73c\ub85c\uc368 \ubaa8\ub4e0 \ud2b8\ub798\ud53d \ud5c8\uc6a9.</p> <pre><code>openstack port set --no-security-group --disable-port-security &lt;PORT_ID&gt;\n</code></pre> <p>\ubc29\ubc95 B: Allowed Address Pairs \uc124\uc815 (\uad8c\uc7a5, \ubcf4\uc548 \uac15\ud654) Port Security\ub97c \ucf1c\ub450\ub418, Pod/Service \ub300\uc5ed\uc744 \uc608\uc678\ub85c \ud5c8\uc6a9.</p> <pre><code># 1. Pod \ubc0f Service CIDR \ud5c8\uc6a9\nopenstack port set --allowed-address ip_address=10.244.0.0/16 &lt;PORT_ID&gt;\nopenstack port set --allowed-address ip_address=10.96.0.0/12 &lt;PORT_ID&gt;\n\n# 2. \ubcf4\uc548 \uadf8\ub8f9\uc5d0 IPIP/VXLAN/BGP \ub4f1 \ud544\uc218 \ud504\ub85c\ud1a0\ucf5c \ud5c8\uc6a9 \uaddc\uce59 \ucd94\uac00\n# 3. Port Security \ud65c\uc131\ud654\nopenstack port set --enable-port-security &lt;PORT_ID&gt;\n</code></pre>"},{"location":"openstack/troubleshooting/k8s-network-error/#52-harbor","title":"5.2. \uc560\ud50c\ub9ac\ucf00\uc774\uc158(Harbor) \uc7ac\ubc30\ud3ec","text":"<p>\ub124\ud2b8\uc6cc\ud06c\uac00 \ubcf5\uad6c\ub41c \ud6c4, \uae30\uc874\uc758 \uc2e4\ud328\ud55c \ub9ac\uc18c\uc2a4(\ud2b9\ud788 PVC)\ub97c \uc644\uc804\ud788 \uc815\ub9ac\ud558\uace0 \uc7ac\uc124\uce58\ud558\uc5ec DB \ucd08\uae30\ud654 \ud504\ub85c\uc138\uc2a4\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \uc218\ud589\ub418\ub3c4\ub85d \ud568.</p>"},{"location":"openstack/troubleshooting/k8s-network-error/#6-lessons-learned","title":"6. \uad50\ud6c8 \ubc0f \ucc38\uace0 (Lessons Learned)","text":"<ol> <li>OpenStack + K8s: OpenStack \uc704\uc5d0 K8s\ub97c \uc62c\ub9b4 \ub54c\ub294 \ubc18\ub4dc\uc2dc Port Security \uc124\uc815\uacfc Allowed Address Pairs\ub97c \uc0ac\uc804\uc5d0 \uacc4\ud68d\ud574\uc57c \ud55c\ub2e4.</li> <li>ClusterIP Ping: Kubernetes Service IP(<code>ClusterIP</code>)\ub294 Ping\uc774 \uc548 \ub418\ub294 \uac83\uc774 \uc815\uc0c1\uc774\ub2e4. \ub124\ud2b8\uc6cc\ud06c \ud14c\uc2a4\ud2b8\ub294 \ubc18\ub4dc\uc2dc <code>curl</code>, <code>wget</code>, <code>nc</code>, <code>nslookup</code>\uc744 \uc0ac\uc6a9\ud574\uc57c \ud55c\ub2e4.</li> <li>Clean Re-install: Stateful\ud55c \uc560\ud50c\ub9ac\ucf00\uc774\uc158(DB \ud3ec\ud568) \uc124\uce58 \uc2e4\ud328 \uc2dc, \ub2e8\uc21c\ud788 Pod\ub9cc \uc7ac\uc2dc\uc791\ud558\uc9c0 \ub9d0\uace0 PVC\ub97c \ud3ec\ud568\ud55c \ubaa8\ub4e0 \ub370\uc774\ud130\ub97c \uc0ad\uc81c \ud6c4 \uc7ac\uc124\uce58\ud558\ub294 \uac83\uc774 \uac00\uc7a5 \ube60\ub974\uace0 \ud655\uc2e4\ud55c \ud574\uacb0\ucc45\uc774\ub2e4.</li> </ol>"},{"location":"openstack/utils/cloud-init/","title":"Cloud-Init\uc774 \uc81c\ub300\ub85c \ub3d9\uc791\ud558\uc9c0 \uc54a\uc744 \ub54c","text":""},{"location":"openstack/utils/cloud-init/#_1","title":"\uc624\ub958","text":"<ul> <li>hostname\uc774 \uc81c\ub300\ub85c \ubcc0\uacbd\ub418\uc9c0 \uc54a\uc74c</li> <li>\ud0a4\ud30c\uc77c\uc774 \ub4f1\ub85d\ub418\uc9c0 \uc54a\uc74c</li> </ul>"},{"location":"openstack/utils/cloud-init/#1-cloud-init","title":"1. \ud83c\udfaf Cloud-init \ud544\uc218 \uaddc\uce59 (\uba54\ud0c0\ub370\uc774\ud130)","text":"<p><code>cloud-init</code>\uc774 \uc791\ub3d9\ud558\ub824\uba74 VM\uc774 \uc774 IP \uc8fc\uc18c\ub85c \uc694\uccad\uc744 \ubcf4\ub0bc \uc218 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4. \ubcf4\uc548 \uadf8\ub8f9\uc758 Outbound(Egress, \uc1a1\uc2e0) \uaddc\uce59\uc5d0 \ucd94\uac00\ud574\uc57c \ud569\ub2c8\ub2e4.</p> \ubc29\ud5a5 (Direction) \ud504\ub85c\ud1a0\ucf5c (Protocol) \ud3ec\ud2b8 (Port) \ubaa9\uc801\uc9c0 (Destination / CIDR) \uc124\uba85 Egress (\uc1a1\uc2e0) TCP 80 169.254.169.254/32 OpenStack \uba54\ud0c0\ub370\uc774\ud130 \uc11c\ube44\uc2a4 \uc804\uc6a9 IP <ul> <li>169.254.169.254/32: \ud074\ub77c\uc6b0\ub4dc \ud45c\uc900(OpenStack, AWS \ub4f1) \uba54\ud0c0\ub370\uc774\ud130 IP\uc785\ub2c8\ub2e4. \uc774 IP \ud558\ub098\ub9cc \ub531 \uc5f4\uc5b4\uc8fc\uba74 \ub429\ub2c8\ub2e4.</li> <li>\uc8fc\uc758: \ubcf4\uc548 \uadf8\ub8f9\uc740 \uae30\ubcf8\uc801\uc73c\ub85c Outbound\uac00 \ubaa8\ub450 \ud5c8\uc6a9(Allow All)\uc778 \uacbd\uc6b0\uac00 \ub9ce\uc2b5\ub2c8\ub2e4. \ub9cc\uc57d Outbound\ub97c \ub2e4 \ub9c9\uc544\ub450\uc168\ub2e4\uba74 \uc774 \uaddc\uce59\uc744 \ubc18\ub4dc\uc2dc \ucd94\uac00\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"openstack/utils/cloud-init/#2-kubernetes","title":"2. \ud83e\udde9 Kubernetes \ubc0f \uae30\ubcf8 \ub3d9\uc791\uc744 \uc704\ud55c \ud544\uc218 \uaddc\uce59","text":"<p>\uba54\ud0c0\ub370\uc774\ud130 \uc678\uc5d0\ub3c4, \ud604\uc7ac K8s \ud074\ub7ec\uc2a4\ud130\ub97c \uad6c\ucd95 \uc911\uc774\uc2dc\ubbc0\ub85c \ub178\ub4dc \uac04 \ud1b5\uc2e0\uacfc DNS\uac00 \ub9c9\ud788\uba74 \uc544\ubb34\uac83\ub3c4 \uc548 \ub429\ub2c8\ub2e4.  \"Any\"\ub97c \uc4f0\uc9c0 \uc54a\uace0 \uc815\ud655\ud788 \uc5f4\uc5b4\uc57c \ud560 IP \ub300\uc5ed\uc740 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4.</p>"},{"location":"openstack/utils/cloud-init/#a","title":"A. \ub0b4\ubd80 \ub124\ud2b8\uc6cc\ud06c \ud1b5\uc2e0 (\ub178\ub4dc\ub07c\ub9ac \ud1b5\uc2e0)","text":"<p>\ub9c8\uc2a4\ud130\uc640 \uc6cc\ucee4 \ub178\ub4dc\uac00 \uc11c\ub85c \ud1b5\uc2e0\ud558\ub824\uba74 VPC(\uc11c\ube0c\ub137) \ub0b4\ubd80 \ub300\uc5ed\uc740 \uc11c\ub85c \uc5f4\ub824 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p> \ubc29\ud5a5 \ud504\ub85c\ud1a0\ucf5c \ud3ec\ud2b8 \uc18c\uc2a4/\ubaa9\uc801\uc9c0 \uc124\uba85 Ingress (\uc218\uc2e0) Any (\ub610\ub294 TCP/UDP) All 10.0.0.0/24 (\uc608\uc2dc) \uc0ac\uc6a9 \uc911\uc778 \ub0b4\ubd80 \uc11c\ube0c\ub137 CIDR\ub97c \ub123\uc73c\uc138\uc694. \ub178\ub4dc\ub07c\ub9ac\ub294 \uc11c\ub85c \ubbff\uc5b4\uc57c \ud569\ub2c8\ub2e4."},{"location":"openstack/utils/cloud-init/#b-dns","title":"B. DNS (\ub3c4\uba54\uc778 \ud574\uc11d)","text":"<p>\uc774\uac8c \ub9c9\ud788\uba74 <code>yum install</code>, <code>docker pull</code> \ub4f1\uc774 \ub2e4 \uc2e4\ud328\ud569\ub2c8\ub2e4.</p> \ubc29\ud5a5 \ud504\ub85c\ud1a0\ucf5c \ud3ec\ud2b8 \ubaa9\uc801\uc9c0 \uc124\uba85 Egress (\uc1a1\uc2e0) UDP / TCP 53 DNS \uc11c\ubc84 IP \ubcf4\ud1b5 \ub0b4\ubd80 DNS IP \ub610\ub294 8.8.8.8 \ub4f1"},{"location":"openstack/utils/golden-image/","title":"OpenStack \uace8\ub4e0 \uc774\ubbf8\uc9c0(Golden Image) \uc0dd\uc131 \uac00\uc774\ub4dc","text":"<p>OpenStack \ud658\uacbd(Nova, Glance)\uc5d0\uc11c \uc778\uc2a4\ud134\uc2a4 \ubc30\ud3ec \uc2dc \uc989\uc2dc \uc0ac\uc6a9 \uac00\ub2a5\ud55c \uae68\ub057\ud55c Cloud Image\ub97c \ub9cc\ub4e4\uae30 \uc704\ud55c \uc808\ucc28\uc785\ub2c8\ub2e4.</p> <p>\ud544\uc218 \uc804\uc81c \uc870\uac74:</p> <ul> <li>\uc791\uc5c5\uc740 \ub85c\uceec KVM/QEMU \ud658\uacbd\uc774\ub098 OpenStack \ub0b4 \uc784\uc2dc \uc778\uc2a4\ud134\uc2a4\uc5d0\uc11c \uc218\ud589\ud569\ub2c8\ub2e4.</li> <li>\ubaa8\ub4e0 \uba85\ub839\uc740 root \uad8c\ud55c\uc73c\ub85c \uc2e4\ud589\ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"openstack/utils/golden-image/#1","title":"1. \ubca0\uc774\uc2a4 \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc","text":"<p>\ud074\ub77c\uc6b0\ub4dc\uc6a9\uc73c\ub85c \ubbf8\ub9ac \ube4c\ub4dc\ub41c Cloud Image(qcow2, img)\ub97c \ubc1b\uc2b5\ub2c8\ub2e4.</p> <pre><code>mkdir -p ~/golden-image-work\ncd ~/golden-image-work\n</code></pre> <p>1. Ubuntu 24.04 LTS (Noble):</p> <pre><code>wget https://cloud-images.ubuntu.com/noble/current/noble-server-cloudimg-amd64.img -O ubuntu-24.04-base.qcow2\n</code></pre> <p>2. Rocky Linux 9:</p> <pre><code>wget https://dl.rockylinux.org/pub/rocky/9/images/x86_64/Rocky-9-GenericCloud-Base.latest.x86_64.qcow2 -O rocky-9-base.qcow2\n</code></pre> <p>3. AlmaLinux 9:</p> <pre><code>wget https://repo.almalinux.org/almalinux/9/cloud/x86_64/images/AlmaLinux-9-GenericCloud-latest.x86_64.qcow2 -O AlmaLinux-9-base.qcow2\n</code></pre> <p>4. CentOS Stream 9:</p> <pre><code>wget https://cloud.centos.org/centos/9-stream/x86_64/images/CentOS-Stream-GenericCloud-9-latest.x86_64.qcow2 -O CentOS-Stream-9-base.qcow2\n</code></pre> <p>5. Debian 12:</p> <pre><code>wget https://cloud.debian.org/images/cloud/bookworm/latest/debian-12-generic-amd64.qcow2 -O debian-12-base.qcow2\n</code></pre> <pre><code># `unable to resolve host addree` \uc624\ub958 \ubc1c\uc0dd \uc2dc, dns \uc11c\ubc84 \ucd94\uac00\necho \"nameserver 8.8.8.8\" | sudo tee -a /etc/resolv.conf\n</code></pre>"},{"location":"openstack/utils/golden-image/#2","title":"2. \uc774\ubbf8\uc9c0 \uc811\uadfc \uad8c\ud55c \uc124\uc815","text":"<p>Cloud Image\ub294 \uae30\ubcf8\uc801\uc73c\ub85c root \ube44\ubc00\ubc88\ud638\uc640 SSH \uc811\uc18d\uc774 \ub9c9\ud600\uc788\uc2b5\ub2c8\ub2e4.</p> <p>\ub530\ub77c\uc11c \ub85c\uceec KVM\uc5d0\uc11c \ubd80\ud305 \ubc0f \uc791\uc5c5\uc744 \uc704\ud574 <code>libguestfs-tools</code> \uc640 <code>virt-customize</code> \ub3c4\uad6c\ub97c \uc124\uce58\ud558\uc5ec \ube44\ubc00\ubc88\ud638\ub97c \uac15\uc81c\ub85c \uc124\uc815\ud569\ub2c8\ub2e4.</p> <pre><code># \ub3c4\uad6c \uc124\uce58 (Ubuntu \uae30\uc900)\nsudo apt update\nsudo apt install -y libguestfs-tools qemu-kvm virt-manager\n\n# \uc774\ubbf8\uc9c0\uc5d0 root \ube44\ubc00\ubc88\ud638 \uc124\uc815 (\uc608: root1234)\n# \uc8fc\uc758: \uc774 \ube44\ubc00\ubc88\ud638\ub294 \ub098\uc911\uc5d0 \uc2a4\ud06c\ub9bd\ud2b8 \uc2e4\ud589 \ud6c4 \uc81c\uac70\ud560 \uac83\uc785\ub2c8\ub2e4.\nsudo virt-customize -a ubuntu-24.04-base.qcow2 --root-password password:root1234\n</code></pre>"},{"location":"openstack/utils/golden-image/#3-kvm-vm","title":"3. KVM\uc73c\ub85c VM \ubd80\ud305 \ubc0f \uc811\uc18d","text":""},{"location":"openstack/utils/golden-image/#31-ubuntudebian","title":"3.1 Ubuntu/Debian","text":"<pre><code># Ubuntu\ub294 \uae30\ubcf8 \uc6a9\ub7c9\uc774 \uc801\uc5b4 \uc6a9\ub7c9\uc744 \ub298\ub824\uc90d\ub2c8\ub2e4.\nqemu-img resize ubuntu-24.04-base.qcow2 +10G\n\n# KVM\uc73c\ub85c \ubd80\ud305 (\uba54\ubaa8\ub9ac 4G, CPU 2 Core)\nsudo kvm -m 2048 -smp 2 -hda ubuntu-24.04-base.qcow2 -net nic -net user,hostfwd=tcp::2222-:22 -nographic\n</code></pre> <p>\uc704\uc5d0\uc11c <code>login:</code> \ud654\uba74\uc774 \ub728\uba74 \uc704\uc5d0\uc11c \uc124\uc815\ud55c \ube44\ubc00\ubc88\ud638\ub85c \uc811\uc18d\ud569\ub2c8\ub2e4.</p> <p>\ud3b8\ud558\uac8c \ubd99\uc5ec\ub123\uae30 \uc704\ud574\uc11c ssh \uc811\uc18d \uc124\uc815\uc744 \ud65c\uc131\ud654\ud574\uc90d\ub2c8\ub2e4. (\uae30\uc874 \ud130\ubbf8\ub110\uc740 \uae00\uc790\uac00 \ubc00\ub9bd\ub2c8\ub2e4.)</p> <p>\uae30\ubcf8 \uc774\ubbf8\uc9c0\uc5d0 \ud0a4\uac00 \uc5c6\ub294 \uacbd\uc6b0\uac00 \uc788\uc5b4\uc11c \ud0a4\ubd80\ud130 \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <pre><code># \ucd9c\ub825 \uacb0\uacfc\uac00 \uc5c6\ub2e4\uba74 \ud0a4\ub97c \ub9cc\ub4e4\uc5b4\uc918\uc57c \ud569\ub2c8\ub2e4.\nls -l /etc/ssh/ssh_host_*\n</code></pre> <pre><code># \ud0a4 \uc0dd\uc131\nssh-keygen -A\n\n# sshd \uc124\uc815 \uc911 \uc544\ub798 \ub450 \ud56d\ubaa9\uc744 yes\ub85c \ubcc0\uacbd\nvi /etc/ssh/sshd_config\n...\nPermitRootLogin yes\nPasswordAuthentication yes\n...\n\n# Override \ud558\ub294 \uc124\uc815 \ud30c\uc77c \uc81c\uac70\nrm -f /etc/ssh/sshd_config.d/60-cloudimg-settings.conf\n\n# ssh \uc7ac\uc2dc\uc791\nsystemctl restart ssh\n\n# \uc124\uc815 \ud655\uc778\nsshd -T | grep passwordauthentication\n</code></pre> <pre><code># \uc0c1\ud0dc \ud655\uc778\nsystemctl status ssh\n\n# \ud639\uc2dc disable\uc774\ub77c\uba74 enable\ub85c \ubcc0\uacbd\nsystemctl enable ssh\n</code></pre> <p>\uc544\ub798 \uba85\ub839 \uc2e4\ud589 \uc2dc, ens3\uacfc \uac19\uc740 \ub124\ud2b8\uc6cc\ud06c\uac00 DOWN \uc0c1\ud0dc\ub77c\uba74 \uc544\ub798 \uc870\uce58\ub97c \ucde8\ud569\ub2c8\ub2e4.</p> <pre><code>ip a\n</code></pre> <p>ens3\uc740 \uc2e4\uc81c \ub124\ud2b8\uc6cc\ud06c \uc774\ub984\uc73c\ub85c \ubcc0\uacbd\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># \uc778\ud130\ud398\uc774\uc2a4 \ucf1c\uae30\nip link set ens3 up\n\n# IP \uc8fc\uc18c \ud560\ub2f9(10.0.2.15\ub294 KVM \uae30\ubcf8 IP)\nip addr add 10.0.2.15/24 dev ens3\n\n# \uac8c\uc774\ud2b8\uc6e8\uc774 \uc5f0\uacb0\nip route add default via 10.0.2.2\n\n# DNS \uc124\uc815\necho \"nameserver 8.8.8.8\" &gt; /etc/resolv.conf\n</code></pre> <pre><code># \ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0 \ud655\uc778\nping -c 3 8.8.8.8\n</code></pre>"},{"location":"openstack/utils/golden-image/#32-rockyrhel","title":"3.2 Rocky/RHEL","text":"<p>Rocky\ub294 CPU\uc758 \uc5ec\ub7ec \uae30\ub2a5\uc744 \uc694\uad6c\ud569\ub2c8\ub2e4. \ub530\ub77c\uc11c \uc544\ub798\uc640 \uac19\uc774 \ud638\uc2a4\ud2b8 CPU\ub97c \uadf8\ub300\ub85c VM\uc5d0 \uc804\ub2ec\ud558\ub3c4\ub85d <code>-cpu host</code> \uc635\uc158\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <pre><code>sudo kvm -m 4096 -smp 2 -cpu host -hda rocky-9-base.qcow2 -net nic -net user,hostfwd=tcp::2222-:22 -nographic\n</code></pre> <p>ssh \uc811\uc18d\uc744 \uc704\ud574 \uc124\uc815\uc744 \ubcc0\uacbd\ud569\ub2c8\ub2e4.</p> <pre><code># sshd \uc124\uc815 \uc911 \uc544\ub798 \ub450 \ud56d\ubaa9\uc744 yes\ub85c \ubcc0\uacbd\nvi /etc/ssh/sshd_config\n\n...\nPermitRootLogin yes\nPasswordAuthentication yes\n...\n\n# ssh \uc7ac\uc2dc\uc791\nsystemctl restart sshd\n</code></pre> <p>\uc0c8\ub85c\uc6b4 \ud130\ubbf8\ub110\uc744 \uc5f4\uc5b4 ssh\ub85c \uc811\uc18d\ud569\ub2c8\ub2e4.</p> <pre><code>ssh root@localhost -p 2222\n</code></pre> <p>\uc791\uc5c5 \uc911 VM\uc744 \uba48\ucd94\uac70\ub098 \uc885\ub8cc\ud558\uace0 \uc2f6\ub2e4\uba74 <code>Ctrl + A</code> \ud0a4\ub97c  \ub20c\ub800\ub2e4\uac00 \ub5bc\uace0, \ubc14\ub85c <code>x</code> \ud0a4\ub97c \ub204\ub974\uba74 KVM\uc774 \uac15\uc81c \uc885\ub8cc\ub429\ub2c8\ub2e4.</p>"},{"location":"openstack/utils/golden-image/#kvm","title":"KVM \uad00\ub828 \uc624\ub958","text":""},{"location":"openstack/utils/golden-image/#1-lock","title":"1 ) <code>Lock</code> \uc624\ub958","text":"<p>KVM \ubd80\ud305 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uac70\ub098, <code>lock</code> \uc624\ub958\uac00 \ubc1c\uc0dd\ud55c\ub2e4\uba74 \ud504\ub85c\uc138\uc2a4\ub97c \uc8fd\uc774\uace0 \ub2e4\uc2dc \uc704 \uacfc\uc815\uc744 \uc9c4\ud589\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code># \uc2e4\ud589 \uc911\uc778 kvm \ud504\ub85c\uc138\uc2a4 \ud655\uc778\nps -ef | grep kvm\n</code></pre> <pre><code># 'ubuntu-24.04-base.qcow2'\uac00 \ud3ec\ud568\ub41c \ubaa8\ub4e0 \ud504\ub85c\uc138\uc2a4 \uac15\uc81c \uc885\ub8cc\npkill -f ubuntu-24.04-base.qcow2\n\n# \ub9cc\uc57d \uc704\uc5d0 \uba85\ub839\uc774 \uc2e4\ud589\ub418\uc9c0 \uc54a\ub294\ub2e4\uba74\npkill -9 &lt;PID&gt;\n</code></pre>"},{"location":"openstack/utils/golden-image/#2-kvm-vm","title":"2) KVM \uc6a9\ub7c9\uc744 \ub298\ub824\ub3c4 VM \uc6a9\ub7c9\uc774 \ub3d9\uc77c\ud55c \uacbd\uc6b0","text":"<p>\ud604\uc7ac \uc544\ub798 \uba85\ub839\uc744 \ud1b5\ud574 <code>sda</code> \ub294 \ub298\ub9b0 \uc6a9\ub7c9\uc778\ub370, <code>sda1</code> \uc774 \uc5ec\uc804\ud788 \uadf8\ub300\ub85c\uc778 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code># \ud604\uc7ac \uc0c1\ud669 \ud655\uc778\nlsblk\n</code></pre> <p>\uc6b0\uc120 \ud30c\ud2f0\uc158\uc744 \ub514\uc2a4\ud06c \ub05d\uae4c\uc9c0 \ub298\ub9bd\ub2c8\ub2e4.</p> <pre><code>growpart /dev/sda 1\n</code></pre> <p>\ub298\uc5b4\ub09c \ud30c\ud2f0\uc158\uc5d0 \ub9de\ucdb0\uc11c \ud30c\uc77c\uc2dc\uc2a4\ud15c\uc744 \ud655\uc7a5\ud569\ub2c8\ub2e4.</p> <pre><code>resize2fs /dev/sda1\n</code></pre> <p>\uc6a9\ub7c9\uc774 \ub298\uc5b4\ub0ac\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</p> <pre><code>df -h\n</code></pre>"},{"location":"openstack/utils/golden-image/#4-vm","title":"4. VM \ub0b4\ubd80 \uc124\uc815 \ubcc0\uacbd","text":"<p>OpenStack\uc758 Horizon \ucf58\uc194 \ub85c\uadf8 \ud655\uc778 \ubc0f \ud558\uc774\ud37c\ubc14\uc774\uc800 \ud1b5\uc2e0\uc744 \uc704\ud574 \uc544\ub798 \uc124\uc815\uc774 \ubaa8\ub4e0 \uc774\ubbf8\uc9c0\uc5d0 \uc801\uc6a9\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/utils/golden-image/#41-serial-console-openstack","title":"4.1 Serial Console \ud65c\uc131\ud654 (OpenStack \ud544\uc218)","text":"<p>OpenStack \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \ub85c\uadf8\ub97c \ubcf4\ub824\uba74 \ucee4\ub110 \ud30c\ub77c\ubbf8\ud130 \uc218\uc815\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.</p> <p>Ubuntu/Debian:</p> <pre><code># /etc/default/grub \ud30c\uc77c \uc218\uc815\nsed -i 's/^GRUB_CMDLINE_LINUX_DEFAULT.*/GRUB_CMDLINE_LINUX_DEFAULT=\"console=tty0 console=ttyS0,115200n8 earlyprintk=ttyS0,115200 rootdelay=300\"/' /etc/default/grub\n\n# \uc218\uc815 \ub0b4\uc6a9 \uc801\uc6a9\nupdate-grub\n</code></pre> <p>RHEL/Rocky/CentOS:</p> <pre><code># /etc/default/grub \ud30c\uc77c \uc218\uc815\ncat &gt; /etc/default/grub &lt;&lt; 'EOF'\nGRUB_TIMEOUT=1\nGRUB_DISTRIBUTOR=\"$(sed 's, release .*$,,g' /etc/system-release)\"\nGRUB_DEFAULT=saved\nGRUB_DISABLE_SUBMENU=true\nGRUB_TERMINAL_OUTPUT=\"console\"\nGRUB_CMDLINE_LINUX=\"crashkernel=auto console=tty1 console=ttyS0,115200n8\"\nGRUB_DISABLE_RECOVERY=\"true\"\nGRUB_ENABLE_BLSCFG=true\nEOF\n\n# \uc218\uc815 \ub0b4\uc6a9 \uc801\uc6a9\ngrub2-mkconfig -o /boot/grub2/grub.cfg\n</code></pre>"},{"location":"openstack/utils/golden-image/#42","title":"4.2 \uae30\ubcf8 \ud328\ud0a4\uc9c0 \uc124\uce58","text":"<p>VMware Tools \ub300\uc2e0 QEMU Guest Agent\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</p> <p>Ubuntu/Debian:</p> <pre><code># DNS \uc11c\ubc84 \uc218\ub3d9 \ub4f1\ub85d\necho \"nameserver 8.8.8.8\" &gt; /etc/resolv.conf\n\n# \ud544\uc218 \ud328\ud0a4\uc9c0 \uc124\uce58\napt update\napt install -y qemu-guest-agent cloud-init\n</code></pre> <p>Rocky/RHEL:</p> <pre><code># DNS \uc11c\ubc84 \uc218\ub3d9 \ub4f1\ub85d\necho \"nameserver 8.8.8.8\" &gt; /etc/resolv.conf\n\n# \ud544\uc218 \ud328\ud0a4\uc9c0 \uc124\uce58\nyum install -y qemu-guest-agent cloud-init\n</code></pre>"},{"location":"openstack/utils/golden-image/#5","title":"5. \uc635\uc158 \uc18c\ud504\ud2b8\uc6e8\uc5b4 \uc124\uce58","text":""},{"location":"openstack/utils/golden-image/#51-docker","title":"5.1 \uc635\uc158: Docker \uc124\uce58","text":"<p>Docker\ub97c \ud3ec\ud568\ud558\ub294 \uacbd\uc6b0\uc5d0\ub9cc \uc774 \ub2e8\uacc4\ub97c \uc218\ud589\ud558\uc138\uc694.</p> <p>Ubuntu/Debian:</p> <pre><code># 1. \ud544\uc218 \ud328\ud0a4\uc9c0 \ubc0f GPG Key \uc124\uc815\napt-get install -y ca-certificates curl\ninstall -m 0755 -d /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nchmod a+r /etc/apt/keyrings/docker.asc\n\n# 2. \uc800\uc7a5\uc18c \ucd94\uac00\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n  $(. /etc/os-release &amp;&amp; echo \"$VERSION_CODENAME\") stable\" | \\\n  tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\napt-get update\n\n# 3. Docker \uc124\uce58\napt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# 4. \ud65c\uc131\ud654\nsystemctl enable --now docker\n\n# -------------------------------------------------------\n# [GPU \uc774\ubbf8\uc9c0\uc778 \uacbd\uc6b0\ub9cc] NVIDIA Container Toolkit \uc124\uce58\n# -------------------------------------------------------\n\n# 5. \uc800\uc7a5\uc18c \ucd94\uac00 \ubc0f \uc124\uce58\ncurl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \\\n  &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \\\n    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \\\n    tee /etc/apt/sources.list.d/nvidia-container-toolkit.list\n\napt-get update\napt-get install -y nvidia-container-toolkit\n\n# 6. Docker \uc124\uc815 \ubc0f \uc7ac\uc2dc\uc791\nnvidia-ctk runtime configure --runtime=docker\nsystemctl restart docker\n</code></pre> <p>Rocky/RHEL:</p> <pre><code># 1. Docker \uc800\uc7a5\uc18c \ucd94\uac00\ndnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n\n# 2. Docker \uc5d4\uc9c4 \uc124\uce58\ndnf install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# \uc635\uc158. Rocky 10\uc758 \uacbd\uc6b0 \uc544\ub798 \ud328\ud0a4\uc9c0\ub3c4 \uc124\uce58\ndnf install -y iptables-nft iptables-services\n\n# 3. Docker \uc2e4\ud589 \ubc0f \uc790\ub3d9 \uc2dc\uc791 \uc124\uc815\nsystemctl enable --now docker\n\n# -------------------------------------------------------\n# [GPU \uc774\ubbf8\uc9c0\uc778 \uacbd\uc6b0\ub9cc] NVIDIA Container Toolkit \uc124\uce58\n# (Docker\uac00 GPU\ub97c \uc4f0\uac8c \ud574\uc8fc\ub294 \ud544\uc218 \ub3c4\uad6c\uc785\ub2c8\ub2e4)\n# -------------------------------------------------------\n\n# 4. NVIDIA Toolkit \uc800\uc7a5\uc18c \ucd94\uac00\ncurl -s -L https://nvidia.github.io/libnvidia-container/stable/rpm/nvidia-container-toolkit.repo | \\\n  tee /etc/yum.repos.d/nvidia-container-toolkit.repo\n\n# 5. Toolkit \uc124\uce58\ndnf install -y nvidia-container-toolkit\n\n# 6. Docker\uac00 NVIDIA Runtime\uc744 \uc4f0\ub3c4\ub85d \uc124\uc815 (\uc911\uc694!)\n# \uc774 \uba85\ub839\uc5b4\uac00 /etc/docker/daemon.json \ud30c\uc77c\uc744 \uc790\ub3d9\uc73c\ub85c \uc218\uc815\ud574\uc90d\ub2c8\ub2e4.\nnvidia-ctk runtime configure --runtime=docker\n\n# 7. \uc801\uc6a9\uc744 \uc704\ud574 Docker \uc7ac\uc2dc\uc791\nsystemctl restart docker\n</code></pre>"},{"location":"openstack/utils/golden-image/#52-nvidia-gpu","title":"5.2 \uc635\uc158: NVIDIA GPU \ub4dc\ub77c\uc774\ubc84 \uc124\uce58","text":"<p>GPU \ubc84\uc804 \uc774\ubbf8\uc9c0\ub97c \uc0dd\uc131\ud560 \ub54c\ub9cc \uc774 \ub2e8\uacc4\ub97c \uc218\ud589\ud558\uc138\uc694. CPU \uc804\uc6a9 \uc774\ubbf8\uc9c0\ub294 \uc774 \ub2e8\uacc4\ub97c \uac74\ub108\ub701\ub2c8\ub2e4.</p> <p>\uc804\uc81c: \uc778\uc2a4\ud134\uc2a4\uc5d0 \uc774\ubbf8 NVIDIA GPU\uac00 Passthrough \ub418\uc5b4 \uc788\uac70\ub098, \ub85c\uceec\uc5d0\uc11c \ub4dc\ub77c\uc774\ubc84 \ube4c\ub4dc \ud658\uacbd\uc774 \uac16\ucdb0\uc838\uc57c \ud569\ub2c8\ub2e4.</p> <p>Ubuntu/Debian:</p> <pre><code># 1. Nouveau \ube14\ub799\ub9ac\uc2a4\ud2b8 \ucc98\ub9ac\ncat &lt;&lt;EOF &gt; /etc/modprobe.d/blacklist-nouveau.conf\nblacklist nouveau\noptions nouveau modeset=0\nEOF\n\n# \uc635\uc158. RTX \uacc4\uc5f4\uc758 \uac1c\uc778 GPU \uc0ac\uc6a9 \uc2dc MSI \ube44\ud65c\uc131\ud654\necho \"options nvidia NVreg_EnableMSI=0\" | sudo tee /etc/modprobe.d/nvidia.conf\n\n# 2. \ubcc0\uacbd \uc0ac\ud56d \ucee4\ub110\uc5d0 \uc801\uc6a9\nupdate-initramfs -u\n\n# 3. \ube4c\ub4dc \uc758\uc874\uc131 \ud328\ud0a4\uc9c0 \uc124\uce58\napt-get install -y build-essential linux-headers-$(uname -r) pkg-config libglvnd-dev\n\n# 4. NVIDIA \ub4dc\ub77c\uc774\ubc84 \ub2e4\uc6b4\ub85c\ub4dc\ncd /root\nwget https://us.download.nvidia.com/XFree86/Linux-x86_64/550.127.05/NVIDIA-Linux-x86_64-550.127.05.run\nchmod +x NVIDIA-Linux-x86_64-*.run\n\n# 5. \ub4dc\ub77c\uc774\ubc84 \uc124\uce58 (\ud558\ub4dc\uc6e8\uc5b4 \uc5c6\uc774 \uc124\uce58)\n# \ub098\uc911\uc5d0 \ub85c\uadf8\uc778\ud574\uc11c 'install-gpu'\ub9cc \uce58\uba74 \uc124\uce58\ub418\ub3c4\ub85d \uc124\uc815\necho \"alias install-gpu='/root/NVIDIA-Linux-x86_64-*.run --silent --dkms &amp;&amp; echo \\\"\uc124\uce58 \uc644\ub8cc! nvidia-smi\ub97c \uc785\ub825\ud574\ubcf4\uc138\uc694.\\\"' \" &gt;&gt; /root/.bashrc\n</code></pre> <p>Rocky/RHEL:</p> <pre><code># 1. Nouveau(\uc624\ud508\uc18c\uc2a4 \ub4dc\ub77c\uc774\ubc84) \ube14\ub799\ub9ac\uc2a4\ud2b8 \ucc98\ub9ac\ncat &lt;&lt;EOF &gt; /etc/modprobe.d/blacklist-nouveau.conf\nblacklist nouveau\noptions nouveau modeset=0\nEOF\n\n# \uc635\uc158. RTX \uacc4\uc5f4\uc758 \uac1c\uc778 GPU \uc0ac\uc6a9 \uc2dc MSI \ube44\ud65c\uc131\ud654\necho \"options nvidia NVreg_EnableMSI=0\" | sudo tee /etc/modprobe.d/nvidia.conf\n\n# 2. \ubcc0\uacbd \uc0ac\ud56d \ucee4\ub110\uc5d0 \uc801\uc6a9 (initramfs \uac31\uc2e0)\ndracut --force\n\n# 3. \ube4c\ub4dc \uc758\uc874\uc131 \ud328\ud0a4\uc9c0 \uc124\uce58\n# (\ub4dc\ub77c\uc774\ubc84 \ucef4\ud30c\uc77c\uc744 \uc704\ud574 gcc, make, kernel source \ub4f1\uc774 \ud544\uc694\ud568)\nyum groupinstall -y \"Development Tools\"\nyum install -y epel-release\nyum update -y  # \ucee4\ub110 \ucd5c\uc2e0\ud654 (\uc911\uc694)\nyum install -y kernel-devel kernel-headers dkms gcc make wget pciutils\n\n# \ub4dc\ub77c\uc774\ubc84 \ub2e4\uc6b4\ub85c\ub4dc\ncd /root\nwget https://us.download.nvidia.com/XFree86/Linux-x86_64/550.127.05/NVIDIA-Linux-x86_64-550.127.05.run\nchmod +x NVIDIA-Linux-x86_64-*.run\n\n# 5. \ub4dc\ub77c\uc774\ubc84 \uc124\uce58 (\ud558\ub4dc\uc6e8\uc5b4 \uc5c6\uc774 \uc124\uce58)\n# --silent: \ubb34\uc778 \uc124\uce58\n# \ub098\uc911\uc5d0 \ub85c\uadf8\uc778\ud574\uc11c 'install-gpu'\ub9cc \uce58\uba74 \uc124\uce58\ub418\ub3c4\ub85d \uc124\uc815\necho \"alias install-gpu='/root/NVIDIA-Linux-x86_64-*.run --silent --dkms &amp;&amp; echo \\\"\uc124\uce58 \uc644\ub8cc! nvidia-smi\ub97c \uc785\ub825\ud574\ubcf4\uc138\uc694.\\\"' \" &gt;&gt; /root/.bashrc\n</code></pre>"},{"location":"openstack/utils/golden-image/#6-vm","title":"6. VM \uc815\ub9ac \uc791\uc5c5","text":"<p><code>Cloud-init</code> \uc774 \uc815\uc0c1\uc801\uc73c\ub85c \uc791\ub3d9\ud558\ub3c4\ub85d \uc124\uc815\ub4e4\uc744 \ucd08\uae30\ud654 \ud569\ub2c8\ub2e4.</p> <p>Ubuntu/Debian:</p> <pre><code># 1. DataSource \uc124\uc815\ncat &gt; /etc/cloud/cloud.cfg.d/90_datasource.cfg &lt;&lt; 'EOF'\ndatasource_list: [ OpenStack, ConfigDrive, None ]\nEOF\n\n# 2. SSH \ubcf4\uc548 \uc124\uc815\n# (Ubuntu\ub294 \uc11c\ube44\uc2a4\uba85\uc774 'ssh' \uc785\ub2c8\ub2e4)\nsed -i 's/^#*PermitRootLogin.*/PermitRootLogin prohibit-password/' /etc/ssh/sshd_config\nsed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' /etc/ssh/sshd_config\nsystemctl restart ssh\n\n# 3. \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \ucd08\uae30\ud654\n# Netplan \uc124\uc815 \uc0ad\uc81c\nrm -f /etc/netplan/*.yaml\n# \uad6c\ubc84\uc804 \uc778\ud130\ud398\uc774\uc2a4 \uc124\uc815 \uc0ad\uc81c\nrm -f /etc/network/interfaces.d/*\n\n# 4. \uace0\uc720 \uc2dd\ubcc4\uc790 \ubc0f Cloud-init \ucd08\uae30\ud654\nrm -f /etc/udev/rules.d/70-persistent-net.rules\nrm -f /etc/ssh/ssh_host_*key*\ntruncate -s 0 /etc/machine-id\nrm -f /var/lib/dbus/machine-id\n\n# Cloud-init \ub370\uc774\ud130 \uc0ad\uc81c\nrm -rf /var/lib/cloud/*\nrm -rf /var/log/cloud-init*\n\n# 5. \ud328\ud0a4\uc9c0 \uce90\uc2dc \uc815\ub9ac\napt-get clean\nrm -rf /var/lib/apt/lists/*\n</code></pre> <p>Rocky/RHEL:</p> <pre><code># 1. DataSource \uc124\uc815 (OpenStack \ucd5c\uc6b0\uc120)\ncat &gt; /etc/cloud/cloud.cfg.d/90_datasource.cfg &lt;&lt; 'EOF'\ndatasource_list: [ OpenStack, ConfigDrive, None ]\nEOF\n\n# 2. SSH \ubcf4\uc548 \uc124\uc815 (\ud074\ub77c\uc6b0\ub4dc \ud45c\uc900: \ud328\uc2a4\uc6cc\ub4dc \uc778\uc99d \ube44\ud65c\uc131\ud654)\n# (Root \ub85c\uadf8\uc778\uc740 \ubcf4\uc548 \uc815\ucc45\uc5d0 \ub530\ub77c 'prohibit-password' \ub610\ub294 'yes'\ub85c \uc124\uc815)\nsed -i 's/^#*PermitRootLogin.*/PermitRootLogin prohibit-password/' /etc/ssh/sshd_config\nsed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' /etc/ssh/sshd_config\nsystemctl restart sshd\n\n# 2.1 cloud-init \ub2e8\uacc4\uc5d0\uc11c\ub3c4 root \ub85c\uadf8\uc778 \ucc28\ub2e8\necho \"disable_root: true\" &gt;&gt; /etc/cloud/cloud.cfg\n\n# 3. \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \ucd08\uae30\ud654 (\uae30\uc874 IP \uc815\ubcf4 \uc0ad\uc81c)\n# NetworkManager \uc5f0\uacb0 \uc815\ubcf4 \uc0ad\uc81c\nrm -f /etc/NetworkManager/system-connections/*.nmconnection\n# \uad6c\ubc84\uc804 \uc2a4\ud06c\ub9bd\ud2b8\uac00 \uc788\ub2e4\uba74 \uc0ad\uc81c (ifcfg-lo \uc81c\uc678)\nrm -f /etc/sysconfig/network-scripts/ifcfg-e*\n\n# 4. \uace0\uc720 \uc2dd\ubcc4\uc790 \ubc0f Cloud-init \ucd08\uae30\ud654\nrm -f /etc/udev/rules.d/70-persistent-net.rules\nrm -f /etc/ssh/ssh_host_*key*\ntruncate -s 0 /etc/machine-id\nrm -f /var/lib/dbus/machine-id\n\n# Cloud-init \ub370\uc774\ud130 \uc0ad\uc81c (\uc7ac\ubd80\ud305 \uc2dc \uc0c8\ub85c \ubc1b\uae30 \uc704\ud568)\nrm -rf /var/lib/cloud/*\nrm -rf /var/log/cloud-init*\n\n# 5. \ud328\ud0a4\uc9c0 \uce90\uc2dc \uc815\ub9ac\nyum clean all\nrm -rf /var/cache/yum\n</code></pre>"},{"location":"openstack/utils/golden-image/#7","title":"7. \ucd5c\uc885 \uc815\ub9ac \ubc0f \uc774\ubbf8\uc9c0 \ubcc0\ud658","text":"<p>\ubaa8\ub4e0 \uc124\uc815\uc774 \ub05d\ub0ac\uc73c\uba74 \ub9c8\uc9c0\ub9c9\uc73c\ub85c cloud-init\uc744 \ucd08\uae30\ud654\ud558\uace0 VM\uc744 \uc885\ub8cc\ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/utils/golden-image/#71","title":"7.1 \ucd5c\uc885 \uba85\ub839\uc5b4","text":"<pre><code># \ub85c\uadf8 \ud30c\uc77c \ube44\uc6b0\uae30\nfind /var/log -type f -exec truncate -s 0 {} \\;\n\n# cloud-init \uc815\ub9ac (\uac00\uc7a5 \uc911\uc694)\ncloud-init clean --logs\n\n# history \uc0ad\uc81c\nhistory -c\n\n# \uc2dc\uc2a4\ud15c \uc885\ub8cc (\uc7ac\ubd80\ud305 \ud558\uc9c0 \ub9c8\uc138\uc694!)\nshutdown -h now\n</code></pre>"},{"location":"openstack/utils/golden-image/#72-glance-openstack-cli","title":"7.2 Glance \uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc (OpenStack CLI)","text":"<p>VM \uc774\ubbf8\uc9c0 \ud30c\uc77c(qcow2 \ub4f1)\uc744 OpenStack Glance\uc5d0 \uc5c5\ub85c\ub4dc\ud569\ub2c8\ub2e4.</p> <pre><code># 1. \uc774\ubbf8\uc9c0 \uc555\ucd95 (Shrink)\n# \uc6d0\ubcf8(base) -&gt; \ucd5c\uc885\ubcf8(golden)\nqemu-img convert -c -O qcow2 ubuntu-24.04-base.qcow2 ubuntu-24.04-golden.qcow2\n\n# 2. \uc6a9\ub7c9 \ud655\uc778 (\ud655 \uc904\uc5b4\ub4e4\uc5c8\ub294\uc9c0 \ud655\uc778)\nls -lh ubuntu-24.04-golden.qcow2\n</code></pre> <p>CPU \uc804\uc6a9 \uc774\ubbf8\uc9c0:</p> <pre><code>openstack image create \"Ubuntu-24.04-Golden\" \\\n  --file ubuntu-24.04-golden.qcow2 \\\n  --disk-format qcow2 \\\n  --container-format bare \\\n  --public \\\n  --property hw_machine_type=q35 \\\n  --property hw_qemu_guest_agent=yes\n</code></pre> <p>GPU \ud3ec\ud568 \uc774\ubbf8\uc9c0 (\uba54\ud0c0\ub370\uc774\ud130 \uc911\uc694): OpenStack Nova\uac00 GPU\ub97c \uc801\uc808\ud788 \uc2a4\ucf00\uc904\ub9c1\ud558\ub3c4\ub85d \uba54\ud0c0\ub370\uc774\ud130\ub97c \ucd94\uac00\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code>openstack image create \"Ubuntu-24.04-Golden-GPU\" \\\n  --file ubuntu-24.04-golden.qcow2 \\\n  --disk-format qcow2 \\\n  --container-format bare \\\n  --public \\\n  --property hw_video_model=vga \\\n  --property hw_machine_type=q35 \\\n  --property hw_qemu_guest_agent=yes\n</code></pre> <p>\ub9cc\uc57d RTX \uacc4\uc5f4\uc758 \uac1c\uc778\uc6a9 GPU \uc0ac\uc6a9\ud55c\ub2e4\uba74 \uc774\ubbf8\uc9c0 \ud639\uc740 flavor\uc5d0 <code>--property hw:kvm_hidden=true</code> \uac12\uc744 \ub123\uc5b4\uc8fc\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"openstack/utils/golden-image/#8-gpu","title":"8. \uc635\uc158: GPU \ub4dc\ub77c\uc774\ubc84 \uc124\uce58","text":"<p>GPU \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131\ud558\uace0, \ud50c\ub85c\ud305 IP\ub97c \uc5f0\uacb0\ud558\uc5ec VM \ub0b4\ubd80\uc5d0 \uc811\uc18d\ud55c \ub4a4, \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\uc2dc\ud0b5\ub2c8\ub2e4.</p> <pre><code># root \uacc4\uc815 \uc0ac\uc6a9\nsudo su -\n</code></pre> <pre><code># \uc0ac\uc804\uc5d0 \ubc1b\uc544\ub454 nvidia \ub4dc\ub77c\uc774\ubc84 \uc124\uce58\ninstall-gpu\n</code></pre>"},{"location":"openstack/utils/golden-image/#rtx-gpu-reset-bug","title":"RTX \uacc4\uc5f4 GPU \uc0ac\uc6a9 \uc2dc \ubb38\uc81c\uc810(Reset Bug)","text":"<p>RTX \uacc4\uc5f4\uacfc \uac19\uc740 \uc18c\ube44\uc790\uc6a9 GPU\ub294 \uac00\uc0c1\ud654 \ud658\uacbd\uc744 \uace0\ub824\ud558\uc9c0 \uc54a\uae30\uc5d0 FLR(Function Level Reset) \uae30\ub2a5\uc744 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c GPU \uc778\uc2a4\ud134\uc2a4\ub97c \uc885\ub8cc\ud558\uac70\ub098 \uc7ac\ubd80\ud305\ud558\uba74, GPU \ud558\ub4dc\uc6e8\uc5b4\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uace0 Stuck \uc0c1\ud0dc\ub85c \ub0a8\uc544 \ub370\uc774\ud130 \ucc0c\uaebc\uae30\ub97c \uac00\uc9c0\uace0 \uc788\ub2e4\uac00 VM\uc758 \ub2e4\uc74c \ub3d9\uc791\uc744 \ubc29\ud574\ud558\uace0, \uc774\ub97c \ud638\uc2a4\ud2b8\uac00 \uc751\ub2f5\uc774 \uc5c6\ub294 \uac83\uc73c\ub85c \uc778\uc2dd\ud558\uace0 \uc778\uc2a4\ud134\uc2a4\ub97c PAUSED \uc0c1\ud0dc\ub85c \uac15\uc81c \uc815\uc9c0\uc2dc\ucf1c\ubc84\ub9bd\ub2c8\ub2e4.</p> <p>\uc704\uc5d0\uc11c RTX \uacc4\uc5f4 GPU\ub97c \uc704\ud55c \uc124\uc815\uc744 \ucd94\uac00\ud588\uc9c0\ub9cc, \uc774\uac83\ub9cc\uc73c\ub85c \ubb38\uc81c\ub97c \ub9c9\uc744 \uc218\ub294 \uc5c6\uc2b5\ub2c8\ub2e4. FLR \uae30\ub2a5\uc774 \uc5c6\ub294 \ud55c \uc7ac\ubd80\ud305 \ud639\uc740 \uc0ad\uc81c \uc2dc \ub192\uc740 \ud655\ub960\ub85c \ud558\ub4dc\uc6e8\uc5b4 \ub9ac\uc14b \uc2e4\ud328\uac00 \ubc1c\uc0dd\ud558\uae30\uc5d0 RTX \uacc4\uc5f4 GPU\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294 \uac83\uc744 \uad8c\uc7a5\ud569\ub2c8\ub2e4.</p> <p>\ud14c\uc2a4\ud2b8 \uc6a9\ub3c4\ub85c \uc0ac\uc6a9 \uc608\uc815 \uc2dc, FLR \ub3d9\uc791 \uc784\uc2dc \uc801\uc6a9\ubc95\uc744 \ucc38\uace0\ubc14\ub78d\ub2c8\ub2e4.</p>"},{"location":"ubuntu/init-ubuntu-env/","title":"Ubuntu \uae30\ubcf8 \uc138\ud305","text":"<ul> <li>Ubuntu 24.04 \uae30\uc900</li> </ul>"},{"location":"ubuntu/init-ubuntu-env/#index","title":"Index","text":"<ul> <li>Oh My Zsh \uc124\uce58</li> <li>npm \uc124\uce58</li> </ul>"},{"location":"ubuntu/init-ubuntu-env/#oh-my-zsh","title":"Oh My Zsh \uc124\uce58","text":""},{"location":"ubuntu/init-ubuntu-env/#1-oh-my-zsh","title":"1. Oh My Zsh \uc124\uce58","text":"<pre><code># zsh \uc124\uce58\nsudo apt install zsh\n</code></pre> <pre><code># oh-my-zsh \uc124\uce58\nsh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"\n</code></pre>"},{"location":"ubuntu/init-ubuntu-env/#2-powerlevel10k","title":"2. Powerlevel10k \ubc0f \ud50c\ub7ec\uadf8\uc778 \uc124\uce58","text":"<pre><code># Powerlevel10k\ngit clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/themes/powerlevel10k\n\n# zsh-autosuggestions\ngit clone https://github.com/zsh-users/zsh-autosuggestions.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions\n\n# zsh-syntax-highlighting\ngit clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting\n</code></pre>"},{"location":"ubuntu/init-ubuntu-env/#3-zshrc","title":"3. ~/.zshrc \ud30c\uc77c \uc218\uc815","text":"<pre><code># ZSH_THEME=\"robbyrussell\"\nZSH_THEME=\"powerlevel10k/powerlevel10k\"\n\nplugins=(\n    git\n    zsh-autosuggestions\n    zsh-syntax-highlighting\n)\n</code></pre>"},{"location":"ubuntu/init-ubuntu-env/#4","title":"4. \uc178 \uc0c8\ub85c\uace0\uce68","text":"<pre><code>source ~/.zshrc\n</code></pre> <p>\uc124\uc815: source ~/.zshrc\ub97c \uc2e4\ud589\ud558\uba74, \uc124\uc815 \ub9c8\ubc95\uc0ac(p10k configure)\uac00 \uc790\ub3d9\uc73c\ub85c \uc2e4\ud589\ub429\ub2c8\ub2e4. \uc9c8\ubb38\uc5d0 \ub2f5\ud558\uba74\uc11c \uc6d0\ud558\ub294 \uc544\uc774\ucf58\uacfc \ubaa8\uc591\uc744 \uc120\ud0dd\ud558\uba74 \ub429\ub2c8\ub2e4. \ud544\uc218: \uc774 \ud14c\ub9c8\ub97c \uc81c\ub300\ub85c \uc0ac\uc6a9\ud558\ub824\uba74 Nerd Fonts (\uc608: MesloLGS NF)\ub97c Tabby \ud130\ubbf8\ub110\uc758 \uae00\uaf34\ub85c \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4.</p>"},{"location":"ubuntu/init-ubuntu-env/#npm","title":"npm \uc124\uce58","text":""},{"location":"ubuntu/init-ubuntu-env/#1-nvm","title":"1. NVM \uc124\uce58","text":"<pre><code># NVM \uc124\uce58\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash\n\n# NVM \ud65c\uc131\ud654\nsource ~/.zshrc\n</code></pre>"},{"location":"ubuntu/init-ubuntu-env/#2-nodejs","title":"2. Node.js \uc124\uce58","text":"<pre><code># Node.js LTS \ubc84\uc804 \uc124\uce58\nnvm install --lts\n</code></pre> <pre><code># \uc124\uce58 \ud655\uc778\nnode -v\nnpm -v\n</code></pre>"},{"location":"ubuntu/wsl/wsl-network-setting/","title":"WSL \uc18d\ub3c4 \ud5a5\uc0c1 \uc124\uc815","text":""},{"location":"ubuntu/wsl/wsl-network-setting/#1-dns","title":"\ud83d\ude80 \ud574\uacb0 \ubc29\ubc95 1: DNS \uc11c\ubc84 \uc218\ub3d9 \uace0\uc815 (\uac00\uc7a5 \ud6a8\uacfc\uc801 \u2b50)","text":"<p>WSL2\uac00 \uc708\ub3c4\uc6b0 \ud638\uc2a4\ud2b8\ub97c \uac70\uccd0\uc11c DNS\ub97c \uc870\ud68c\ud558\ub294 \uacfc\uc815\uc774 \ub290\ub9ac\uae30 \ub54c\ubb38\uc5d0, \uad6c\uae00(8.8.8.8)\uc774\ub098 \ud074\ub77c\uc6b0\ub4dc\ud50c\ub808\uc5b4(1.1.1.1) DNS\ub97c \uc9c1\uc811 \ubc14\ub77c\ubcf4\uac8c \uc124\uc815\ud558\uba74 \uc18d\ub3c4\uac00 \ube44\uc57d\uc801\uc73c\ub85c \ube68\ub77c\uc9d1\ub2c8\ub2e4.</p>"},{"location":"ubuntu/wsl/wsl-network-setting/#1-etcwslconf","title":"1. \uc790\ub3d9 \uc0dd\uc131 \uc124\uc815 \ub044\uae30 (<code>/etc/wsl.conf</code>)","text":"<p>WSL \ub0b4\ubd80 \ud130\ubbf8\ub110\uc5d0\uc11c \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc785\ub825\ud574 \uc124\uc815 \ud30c\uc77c\uc744 \ub9cc\ub4ed\ub2c8\ub2e4.</p> <pre><code># wsl.conf \ud30c\uc77c \uc0dd\uc131/\uc218\uc815\nsudo nano /etc/wsl.conf\n</code></pre> <p>\uc544\ub798 \ub0b4\uc6a9\uc744 \ubcf5\uc0ac\ud574\uc11c \ubd99\uc5ec\ub123\uc73c\uc138\uc694. (\uc774\ubbf8 \ub0b4\uc6a9\uc774 \uc788\ub2e4\uba74 <code>[network]</code> \ubd80\ubd84\uc5d0 \ucd94\uac00)</p> <pre><code>[network]\ngenerateResolvConf = false\n</code></pre> <p>(<code>Ctrl + O</code> \uc800\uc7a5, <code>Enter</code>, <code>Ctrl + X</code> \uc885\ub8cc)</p>"},{"location":"ubuntu/wsl/wsl-network-setting/#2-dns-etcresolvconf","title":"2. DNS \ud30c\uc77c \uc9c1\uc811 \uc218\uc815 (<code>/etc/resolv.conf</code>)","text":"<p>\uae30\uc874\uc758 \uc2ec\ubcfc\ub9ad \ub9c1\ud06c\ub97c \ub04a\uace0 \uc9c1\uc811 DNS\ub97c \uc785\ub825\ud569\ub2c8\ub2e4.</p> <pre><code># \uae30\uc874 \ud30c\uc77c \uc0ad\uc81c (\uc2ec\ubcfc\ub9ad \ub9c1\ud06c\uc784)\nsudo rm /etc/resolv.conf\n\n# \uc0c8 \ud30c\uc77c \uc0dd\uc131 \ubc0f DNS \uc785\ub825\nsudo bash -c 'echo \"nameserver 8.8.8.8\" &gt; /etc/resolv.conf'\nsudo bash -c 'echo \"nameserver 1.1.1.1\" &gt;&gt; /etc/resolv.conf'\n</code></pre>"},{"location":"ubuntu/wsl/wsl-network-setting/#3-wsl-powershell","title":"3. WSL \uc7ac\uc2dc\uc791 (PowerShell\uc5d0\uc11c)","text":"<pre><code>wsl --shutdown\n</code></pre> <p>\ub2e4\uc2dc WSL\uc744 \ucf1c\uc11c <code>apt update</code> \ub4f1\uc744 \ud574\ubcf4\uba74 \ud6e8\uc52c \ube68\ub77c\uc9c4 \uac83\uc744 \ub290\ub084 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p>"},{"location":"ubuntu/wsl/wsl-network-setting/#2-mirrored-windows-11","title":"\ud83d\ude80 \ud574\uacb0 \ubc29\ubc95 2: \"Mirrored\" \ubaa8\ub4dc \uc0ac\uc6a9 (Windows 11 \ud544\uc218 \u2b50\u2b50)","text":"<p>\ucd5c\uc2e0 Windows 11(22H2 \uc774\uc0c1)\uacfc \ucd5c\uc2e0 WSL \ubc84\uc804\uc744 \uc4f0\uace0 \uacc4\uc2dc\ub2e4\uba74, **\"\ubbf8\ub7ec\ub9c1 \ubaa8\ub4dc\"**\ub97c \ucf1c\ub294 \uac83\uc774 \uac8c\uc784 \uccb4\uc778\uc800\uc785\ub2c8\ub2e4. NAT\ub97c \uac70\uce58\uc9c0 \uc54a\uace0 \ud638\uc2a4\ud2b8(Windows)\uc758 \ub124\ud2b8\uc6cc\ud06c \uc778\ud130\ud398\uc774\uc2a4\ub97c \uadf8\ub300\ub85c \uacf5\uc720\ud558\ubbc0\ub85c \uc18d\ub3c4\uac00 \ub124\uc774\ud2f0\ube0c \uae09\uc73c\ub85c \ube68\ub77c\uc9d1\ub2c8\ub2e4.</p>"},{"location":"ubuntu/wsl/wsl-network-setting/#1","title":"1. \uc708\ub3c4\uc6b0 \uc0ac\uc6a9\uc790 \ud3f4\ub354\uc5d0 \uc124\uc815 \ud30c\uc77c \uc0dd\uc131","text":"<p>\uc708\ub3c4\uc6b0 \ud0d0\uc0c9\uae30 \uc8fc\uc18c\ucc3d\uc5d0 <code>%UserProfile%</code>\uc744 \uc785\ub825\ud558\uace0 \uc5d4\ud130\ub97c \uce69\ub2c8\ub2e4. \uc5ec\uae30\uc5d0 <code>.wslconfig</code> \ub77c\ub294 \ud30c\uc77c\uc744 \ub9cc\ub4e4\uace0(\uba54\ubaa8\uc7a5 \uc774\uc6a9) \uc544\ub798 \ub0b4\uc6a9\uc744 \ub123\uc73c\uc138\uc694.</p> <pre><code>[wsl2]\nnetworkingMode=mirrored\ndnsTunneling=true\nfirewall=true\nautoProxy=true\n</code></pre> <ul> <li><code>networkingMode=mirrored</code>: NAT\ub97c \uc5c6\uc560\uace0 \uc708\ub3c4\uc6b0 IP\ub97c \uadf8\ub300\ub85c \uc501\ub2c8\ub2e4. (\uc18d\ub3c4 \ub300\ud3ed \ud5a5\uc0c1)</li> <li><code>dnsTunneling=true</code>: DNS \uc694\uccad\uc744 \uac00\uc0c1\ud654 \uacc4\uce35 \ub300\uc2e0 \ud130\ub110\ub9c1\uc73c\ub85c \ucc98\ub9ac\ud574 \ub51c\ub808\uc774\ub97c \uc904\uc785\ub2c8\ub2e4.</li> </ul>"},{"location":"ubuntu/wsl/wsl-network-setting/#2","title":"2. \uc801\uc6a9","text":"<p>PowerShell\uc5d0\uc11c <code>wsl --shutdown</code> \ud6c4 \ub2e4\uc2dc \uc2dc\uc791.</p>"},{"location":"ubuntu/wsl/wsl-network-setting/#3-ipv6","title":"\ud83d\ude80 \ud574\uacb0 \ubc29\ubc95 3: IPv6 \ube44\ud65c\uc131\ud654 (\ud2b9\uc815 \ud1b5\uc2e0\uc0ac/\ud658\uacbd\uc6a9)","text":"<p><code>apt-get</code>\uc774\ub098 <code>curl</code>\uc774 \ucc98\uc74c\uc5d0 \uba48\uce6b\ud558\ub2e4\uac00 \uc9c4\ud589\ub418\ub294 \uacbd\uc6b0, IPv6 \uc5f0\uacb0\uc744 \uc2dc\ub3c4\ud558\ub2e4\uac00 \ud0c0\uc784\uc544\uc6c3\uc774 \ub098\uc11c IPv4\ub85c \ub118\uc5b4\uac00\ub294 \ub51c\ub808\uc774\uc77c \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <p>WSL \ub0b4\ubd80\uc5d0\uc11c \uc2e4\ud589:</p> <pre><code>sudo sysctl -w net.ipv6.conf.all.disable_ipv6=1\nsudo sysctl -w net.ipv6.conf.default.disable_ipv6=1\n</code></pre> <p>(\uc774\uac8c \ud6a8\uacfc\uac00 \uc788\ub2e4\uba74 <code>/etc/sysctl.conf</code>\uc5d0 \uc601\uad6c \ub4f1\ub85d\ud558\uc138\uc694.)</p>"},{"location":"ubuntu/wsl/wsl-network-setting/#_1","title":"\ucd94\uac00 \uc815\ubcf4","text":"<ol> <li>Windows 11 \uc0ac\uc6a9\uc790\ub77c\uba74 **[\ubc29\ubc95 2 (Mirrored Mode)]**\uac00 \uac00\uc7a5 \uae54\ub054\ud558\uace0 \uc131\ub2a5\uc774 \uc88b\uc2b5\ub2c8\ub2e4. (<code>apt</code> \uc18d\ub3c4\ubfd0\ub9cc \uc544\ub2c8\ub77c \ub85c\uceec\ud638\uc2a4\ud2b8 \uc811\uc18d \ubb38\uc81c\ub3c4 \ud574\uacb0\ub428)</li> <li>Windows 10 \uc0ac\uc6a9\uc790\uac70\ub098 Mirrored \ubaa8\ub4dc\uac00 \ubd88\uc548\uc815\ud558\ub2e4\uba74 **[\ubc29\ubc95 1 (DNS \uace0\uc815)]**\ub9cc \uc801\uc6a9\ud574\ub3c4 \ucda9\ubd84\ud788 \ube68\ub77c\uc9d1\ub2c8\ub2e4.</li> </ol>"}]}